import{a as bp,b as yp,c as cr}from"./chunk-RWMLGPN2.js";import{a as hn}from"./chunk-2YVUQK2F.js";import{b as hp,c as fp,d as fi,e as pi,f as vp}from"./chunk-ORKXL3CS.js";import"./chunk-W6OGFD7B.js";import"./chunk-IBU5PB4D.js";import{a as Vs}from"./chunk-U36WB7YA.js";import{c as js,d as _p,e as He,f as Ln}from"./chunk-KSRYDTCA.js";import"./chunk-XPPDT5O2.js";import"./chunk-ZLSPVTZ5.js";import"./chunk-QPWJ32ZV.js";import{a as Us}from"./chunk-LMAHKNVF.js";import{a as ci,b as Bs,c as di,d as In,e as ui,f as Lc,g as hi,h as kn,i as pp,k as lr,l as zt,m as Jt,n as gp,o as Rn,q as En,r as dt,s as mp,z as tt}from"./chunk-OYTWBHQG.js";import{a as Se,c as li}from"./chunk-KGMONOZY.js";import{oa as Rc}from"./chunk-4SNHCYBM.js";import{a as up,b as Fs,h as Ns}from"./chunk-KYYUKRGM.js";import{a as Ut}from"./chunk-YRFI3E2U.js";import{k as Wn,m as Cn,n as lp,o as cp,p as Ls,q as Ds,s as dp}from"./chunk-LR4WFUS2.js";import{$b as Pe,A as Kf,Ab as I,Bb as D,Cb as ge,Db as Ae,Fa as tp,Gb as ce,Hb as z,I as Yf,Ib as rp,Jb as ks,Kb as pt,Lb as kc,Nb as Ve,Ob as Ue,Pb as ze,Qb as Yr,Sb as oe,Tb as lt,U as Qf,Ua as Qt,Ub as Xe,Va as Ts,Vb as op,Wb as Tt,Xb as It,Yb as kt,Z as Jf,Za as H,_ as xn,_a as ve,_b as Be,ac as Qr,bb as Ic,bc as Rs,c as Gf,ca as Pc,cc as sp,da as Oc,dc as ot,ea as Zf,ec as gt,f as Mc,fb as np,fc as ar,g as rr,h as $f,ia as ke,ja as wn,kb as ye,la as ep,lb as Ot,mb as $t,n as Xf,nb as Kr,ob as Is,pb as Q,qb as Nt,ra as Tn,rb as Hn,sa as fe,sb as Ri,ta as pe,tb as or,tc as ap,ub as sr,vb as Ee,wb as ip,xb as et,ya as xt,yb as Je,za as Tc,zb as Ze}from"./chunk-BEVEPN7V.js";import"./chunk-EU2KAMEK.js";import{a as it,b as Ft,e as _e,f as k1,g as Ms,h as qf,i as Vt,j as ai,k as Ps,l as Os,m as Hf,n as ir,o as G,p as Sc,q as Ac,r as Wf}from"./chunk-EMXRSGQS.js";var Op=_e((qk,Pp)=>{"use strict";Pp.exports=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}});var gi=_e(Li=>{"use strict";var Nc,pv=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Li.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};Li.getSymbolTotalCodewords=function(e){return pv[e]};Li.getBCHDigit=function(r){let e=0;for(;r!==0;)e++,r>>>=1;return e};Li.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Nc=e};Li.isKanjiModeEnabled=function(){return typeof Nc<"u"};Li.toSJIS=function(e){return Nc(e)}});var qs=_e(fn=>{"use strict";fn.L={bit:1};fn.M={bit:0};fn.Q={bit:3};fn.H={bit:2};function gv(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return fn.L;case"m":case"medium":return fn.M;case"q":case"quartile":return fn.Q;case"h":case"high":return fn.H;default:throw new Error("Unknown EC Level: "+r)}}fn.isValid=function(e){return e&&typeof e.bit<"u"&&e.bit>=0&&e.bit<4};fn.from=function(e,t){if(fn.isValid(e))return e;try{return gv(e)}catch{return t}}});var kp=_e((Gk,Ip)=>{"use strict";function Tp(){this.buffer=[],this.length=0}Tp.prototype={get:function(r){let e=Math.floor(r/8);return(this.buffer[e]>>>7-r%8&1)===1},put:function(r,e){for(let t=0;t<e;t++)this.putBit((r>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){let e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),r&&(this.buffer[e]|=128>>>this.length%8),this.length++}};Ip.exports=Tp});var Lp=_e(($k,Rp)=>{"use strict";function Jr(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}Jr.prototype.set=function(r,e,t,n){let i=r*this.size+e;this.data[i]=t,n&&(this.reservedBit[i]=!0)};Jr.prototype.get=function(r,e){return this.data[r*this.size+e]};Jr.prototype.xor=function(r,e,t){this.data[r*this.size+e]^=t};Jr.prototype.isReserved=function(r,e){return this.reservedBit[r*this.size+e]};Rp.exports=Jr});var Dp=_e(Hs=>{"use strict";var mv=gi().getSymbolSize;Hs.getRowColCoords=function(e){if(e===1)return[];let t=Math.floor(e/7)+2,n=mv(e),i=n===145?26:Math.ceil((n-13)/(2*t-2))*2,o=[n-7];for(let s=1;s<t-1;s++)o[s]=o[s-1]-i;return o.push(6),o.reverse()};Hs.getPositions=function(e){let t=[],n=Hs.getRowColCoords(e),i=n.length;for(let o=0;o<i;o++)for(let s=0;s<i;s++)o===0&&s===0||o===0&&s===i-1||o===i-1&&s===0||t.push([n[o],n[s]]);return t}});var Bp=_e(Np=>{"use strict";var _v=gi().getSymbolSize,Fp=7;Np.getPositions=function(e){let t=_v(e);return[[0,0],[t-Fp,0],[0,t-Fp]]}});var jp=_e(ut=>{"use strict";ut.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var Di={N1:3,N2:3,N3:40,N4:10};ut.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7};ut.from=function(e){return ut.isValid(e)?parseInt(e,10):void 0};ut.getPenaltyN1=function(e){let t=e.size,n=0,i=0,o=0,s=null,a=null;for(let l=0;l<t;l++){i=o=0,s=a=null;for(let c=0;c<t;c++){let d=e.get(l,c);d===s?i++:(i>=5&&(n+=Di.N1+(i-5)),s=d,i=1),d=e.get(c,l),d===a?o++:(o>=5&&(n+=Di.N1+(o-5)),a=d,o=1)}i>=5&&(n+=Di.N1+(i-5)),o>=5&&(n+=Di.N1+(o-5))}return n};ut.getPenaltyN2=function(e){let t=e.size,n=0;for(let i=0;i<t-1;i++)for(let o=0;o<t-1;o++){let s=e.get(i,o)+e.get(i,o+1)+e.get(i+1,o)+e.get(i+1,o+1);(s===4||s===0)&&n++}return n*Di.N2};ut.getPenaltyN3=function(e){let t=e.size,n=0,i=0,o=0;for(let s=0;s<t;s++){i=o=0;for(let a=0;a<t;a++)i=i<<1&2047|e.get(s,a),a>=10&&(i===1488||i===93)&&n++,o=o<<1&2047|e.get(a,s),a>=10&&(o===1488||o===93)&&n++}return n*Di.N3};ut.getPenaltyN4=function(e){let t=0,n=e.data.length;for(let o=0;o<n;o++)t+=e.data[o];return Math.abs(Math.ceil(t*100/n/5)-10)*Di.N4};function vv(r,e,t){switch(r){case ut.Patterns.PATTERN000:return(e+t)%2===0;case ut.Patterns.PATTERN001:return e%2===0;case ut.Patterns.PATTERN010:return t%3===0;case ut.Patterns.PATTERN011:return(e+t)%3===0;case ut.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(t/3))%2===0;case ut.Patterns.PATTERN101:return e*t%2+e*t%3===0;case ut.Patterns.PATTERN110:return(e*t%2+e*t%3)%2===0;case ut.Patterns.PATTERN111:return(e*t%3+(e+t)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}ut.applyMask=function(e,t){let n=t.size;for(let i=0;i<n;i++)for(let o=0;o<n;o++)t.isReserved(o,i)||t.xor(o,i,vv(e,o,i))};ut.getBestMask=function(e,t){let n=Object.keys(ut.Patterns).length,i=0,o=1/0;for(let s=0;s<n;s++){t(s),ut.applyMask(s,e);let a=ut.getPenaltyN1(e)+ut.getPenaltyN2(e)+ut.getPenaltyN3(e)+ut.getPenaltyN4(e);ut.applyMask(s,e),a<o&&(o=a,i=s)}return i}});var jc=_e(Bc=>{"use strict";var mi=qs(),Ws=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Gs=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Bc.getBlocksCount=function(e,t){switch(t){case mi.L:return Ws[(e-1)*4+0];case mi.M:return Ws[(e-1)*4+1];case mi.Q:return Ws[(e-1)*4+2];case mi.H:return Ws[(e-1)*4+3];default:return}};Bc.getTotalCodewordsCount=function(e,t){switch(t){case mi.L:return Gs[(e-1)*4+0];case mi.M:return Gs[(e-1)*4+1];case mi.Q:return Gs[(e-1)*4+2];case mi.H:return Gs[(e-1)*4+3];default:return}}});var Vp=_e(Xs=>{"use strict";var Zr=new Uint8Array(512),$s=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)Zr[t]=e,$s[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)Zr[t]=Zr[t-255]})();Xs.log=function(e){if(e<1)throw new Error("log("+e+")");return $s[e]};Xs.exp=function(e){return Zr[e]};Xs.mul=function(e,t){return e===0||t===0?0:Zr[$s[e]+$s[t]]}});var Up=_e(eo=>{"use strict";var Vc=Vp();eo.mul=function(e,t){let n=new Uint8Array(e.length+t.length-1);for(let i=0;i<e.length;i++)for(let o=0;o<t.length;o++)n[i+o]^=Vc.mul(e[i],t[o]);return n};eo.mod=function(e,t){let n=new Uint8Array(e);for(;n.length-t.length>=0;){let i=n[0];for(let s=0;s<t.length;s++)n[s]^=Vc.mul(t[s],i);let o=0;for(;o<n.length&&n[o]===0;)o++;n=n.slice(o)}return n};eo.generateECPolynomial=function(e){let t=new Uint8Array([1]);for(let n=0;n<e;n++)t=eo.mul(t,new Uint8Array([1,Vc.exp(n)]));return t}});var Hp=_e((eR,qp)=>{"use strict";var zp=Up();function Uc(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}Uc.prototype.initialize=function(e){this.degree=e,this.genPoly=zp.generateECPolynomial(this.degree)};Uc.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let n=zp.mod(t,this.genPoly),i=this.degree-n.length;if(i>0){let o=new Uint8Array(this.degree);return o.set(n,i),o}return n};qp.exports=Uc});var zc=_e(Wp=>{"use strict";Wp.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}});var qc=_e(Gn=>{"use strict";var Gp="[0-9]+",bv="[A-Z $%*+\\-./:]+",to="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";to=to.replace(/u/g,"\\u");var yv="(?:(?![A-Z0-9 $%*+\\-./:]|"+to+`)(?:.|[\r
]))+`;Gn.KANJI=new RegExp(to,"g");Gn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Gn.BYTE=new RegExp(yv,"g");Gn.NUMERIC=new RegExp(Gp,"g");Gn.ALPHANUMERIC=new RegExp(bv,"g");var xv=new RegExp("^"+to+"$"),wv=new RegExp("^"+Gp+"$"),Cv=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Gn.testKanji=function(e){return xv.test(e)};Gn.testNumeric=function(e){return wv.test(e)};Gn.testAlphanumeric=function(e){return Cv.test(e)}});var _i=_e(Mt=>{"use strict";var Ev=zc(),Hc=qc();Mt.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};Mt.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};Mt.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};Mt.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};Mt.MIXED={bit:-1};Mt.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!Ev.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]};Mt.getBestModeForData=function(e){return Hc.testNumeric(e)?Mt.NUMERIC:Hc.testAlphanumeric(e)?Mt.ALPHANUMERIC:Hc.testKanji(e)?Mt.KANJI:Mt.BYTE};Mt.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")};Mt.isValid=function(e){return e&&e.bit&&e.ccBits};function Sv(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return Mt.NUMERIC;case"alphanumeric":return Mt.ALPHANUMERIC;case"kanji":return Mt.KANJI;case"byte":return Mt.BYTE;default:throw new Error("Unknown mode: "+r)}}Mt.from=function(e,t){if(Mt.isValid(e))return e;try{return Sv(e)}catch{return t}}});var Qp=_e(Fi=>{"use strict";var Ks=gi(),Av=jc(),$p=qs(),vi=_i(),Wc=zc(),Kp=7973,Xp=Ks.getBCHDigit(Kp);function Mv(r,e,t){for(let n=1;n<=40;n++)if(e<=Fi.getCapacity(n,t,r))return n}function Yp(r,e){return vi.getCharCountIndicator(r,e)+4}function Pv(r,e){let t=0;return r.forEach(function(n){let i=Yp(n.mode,e);t+=i+n.getBitsLength()}),t}function Ov(r,e){for(let t=1;t<=40;t++)if(Pv(r,t)<=Fi.getCapacity(t,e,vi.MIXED))return t}Fi.from=function(e,t){return Wc.isValid(e)?parseInt(e,10):t};Fi.getCapacity=function(e,t,n){if(!Wc.isValid(e))throw new Error("Invalid QR Code version");typeof n>"u"&&(n=vi.BYTE);let i=Ks.getSymbolTotalCodewords(e),o=Av.getTotalCodewordsCount(e,t),s=(i-o)*8;if(n===vi.MIXED)return s;let a=s-Yp(n,e);switch(n){case vi.NUMERIC:return Math.floor(a/10*3);case vi.ALPHANUMERIC:return Math.floor(a/11*2);case vi.KANJI:return Math.floor(a/13);case vi.BYTE:default:return Math.floor(a/8)}};Fi.getBestVersionForData=function(e,t){let n,i=$p.from(t,$p.M);if(Array.isArray(e)){if(e.length>1)return Ov(e,i);if(e.length===0)return 1;n=e[0]}else n=e;return Mv(n.mode,n.getLength(),i)};Fi.getEncodedBits=function(e){if(!Wc.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;for(;Ks.getBCHDigit(t)-Xp>=0;)t^=Kp<<Ks.getBCHDigit(t)-Xp;return e<<12|t}});var tg=_e(eg=>{"use strict";var Gc=gi(),Zp=1335,Tv=21522,Jp=Gc.getBCHDigit(Zp);eg.getEncodedBits=function(e,t){let n=e.bit<<3|t,i=n<<10;for(;Gc.getBCHDigit(i)-Jp>=0;)i^=Zp<<Gc.getBCHDigit(i)-Jp;return(n<<10|i)^Tv}});var ig=_e((sR,ng)=>{"use strict";var Iv=_i();function dr(r){this.mode=Iv.NUMERIC,this.data=r.toString()}dr.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};dr.prototype.getLength=function(){return this.data.length};dr.prototype.getBitsLength=function(){return dr.getBitsLength(this.data.length)};dr.prototype.write=function(e){let t,n,i;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),i=parseInt(n,10),e.put(i,10);let o=this.data.length-t;o>0&&(n=this.data.substr(t),i=parseInt(n,10),e.put(i,o*3+1))};ng.exports=dr});var og=_e((aR,rg)=>{"use strict";var kv=_i(),$c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function ur(r){this.mode=kv.ALPHANUMERIC,this.data=r}ur.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};ur.prototype.getLength=function(){return this.data.length};ur.prototype.getBitsLength=function(){return ur.getBitsLength(this.data.length)};ur.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=$c.indexOf(this.data[t])*45;n+=$c.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put($c.indexOf(this.data[t]),6)};rg.exports=ur});var ag=_e((lR,sg)=>{"use strict";sg.exports=function(e){for(var t=[],n=e.length,i=0;i<n;i++){var o=e.charCodeAt(i);if(o>=55296&&o<=56319&&n>i+1){var s=e.charCodeAt(i+1);s>=56320&&s<=57343&&(o=(o-55296)*1024+s-56320+65536,i+=1)}if(o<128){t.push(o);continue}if(o<2048){t.push(o>>6|192),t.push(o&63|128);continue}if(o<55296||o>=57344&&o<65536){t.push(o>>12|224),t.push(o>>6&63|128),t.push(o&63|128);continue}if(o>=65536&&o<=1114111){t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128);continue}t.push(239,191,189)}return new Uint8Array(t).buffer}});var cg=_e((cR,lg)=>{"use strict";var Rv=ag(),Lv=_i();function hr(r){this.mode=Lv.BYTE,typeof r=="string"&&(r=Rv(r)),this.data=new Uint8Array(r)}hr.getBitsLength=function(e){return e*8};hr.prototype.getLength=function(){return this.data.length};hr.prototype.getBitsLength=function(){return hr.getBitsLength(this.data.length)};hr.prototype.write=function(r){for(let e=0,t=this.data.length;e<t;e++)r.put(this.data[e],8)};lg.exports=hr});var ug=_e((dR,dg)=>{"use strict";var Dv=_i(),Fv=gi();function fr(r){this.mode=Dv.KANJI,this.data=r}fr.getBitsLength=function(e){return e*13};fr.prototype.getLength=function(){return this.data.length};fr.prototype.getBitsLength=function(){return fr.getBitsLength(this.data.length)};fr.prototype.write=function(r){let e;for(e=0;e<this.data.length;e++){let t=Fv.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),r.put(t,13)}};dg.exports=fr});var hg=_e((uR,Xc)=>{"use strict";var no={single_source_shortest_paths:function(r,e,t){var n={},i={};i[e]=0;var o=no.PriorityQueue.make();o.push(e,0);for(var s,a,l,c,d,u,h,g,v;!o.empty();){s=o.pop(),a=s.value,c=s.cost,d=r[a]||{};for(l in d)d.hasOwnProperty(l)&&(u=d[l],h=c+u,g=i[l],v=typeof i[l]>"u",(v||g>h)&&(i[l]=h,o.push(l,h),n[l]=a))}if(typeof t<"u"&&typeof i[t]>"u"){var x=["Could not find a path from ",e," to ",t,"."].join("");throw new Error(x)}return n},extract_shortest_path_from_predecessor_list:function(r,e){for(var t=[],n=e,i;n;)t.push(n),i=r[n],n=r[n];return t.reverse(),t},find_path:function(r,e,t){var n=no.single_source_shortest_paths(r,e,t);return no.extract_shortest_path_from_predecessor_list(n,t)},PriorityQueue:{make:function(r){var e=no.PriorityQueue,t={},n;r=r||{};for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t.queue=[],t.sorter=r.sorter||e.default_sorter,t},default_sorter:function(r,e){return r.cost-e.cost},push:function(r,e){var t={value:r,cost:e};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};typeof Xc<"u"&&(Xc.exports=no)});var yg=_e(pr=>{"use strict";var rt=_i(),gg=ig(),mg=og(),_g=cg(),vg=ug(),io=qc(),Ys=gi(),Nv=hg();function fg(r){return unescape(encodeURIComponent(r)).length}function ro(r,e,t){let n=[],i;for(;(i=r.exec(t))!==null;)n.push({data:i[0],index:i.index,mode:e,length:i[0].length});return n}function bg(r){let e=ro(io.NUMERIC,rt.NUMERIC,r),t=ro(io.ALPHANUMERIC,rt.ALPHANUMERIC,r),n,i;return Ys.isKanjiModeEnabled()?(n=ro(io.BYTE,rt.BYTE,r),i=ro(io.KANJI,rt.KANJI,r)):(n=ro(io.BYTE_KANJI,rt.BYTE,r),i=[]),e.concat(t,n,i).sort(function(s,a){return s.index-a.index}).map(function(s){return{data:s.data,mode:s.mode,length:s.length}})}function Kc(r,e){switch(e){case rt.NUMERIC:return gg.getBitsLength(r);case rt.ALPHANUMERIC:return mg.getBitsLength(r);case rt.KANJI:return vg.getBitsLength(r);case rt.BYTE:return _g.getBitsLength(r)}}function Bv(r){return r.reduce(function(e,t){let n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)},[])}function jv(r){let e=[];for(let t=0;t<r.length;t++){let n=r[t];switch(n.mode){case rt.NUMERIC:e.push([n,{data:n.data,mode:rt.ALPHANUMERIC,length:n.length},{data:n.data,mode:rt.BYTE,length:n.length}]);break;case rt.ALPHANUMERIC:e.push([n,{data:n.data,mode:rt.BYTE,length:n.length}]);break;case rt.KANJI:e.push([n,{data:n.data,mode:rt.BYTE,length:fg(n.data)}]);break;case rt.BYTE:e.push([{data:n.data,mode:rt.BYTE,length:fg(n.data)}])}}return e}function Vv(r,e){let t={},n={start:{}},i=["start"];for(let o=0;o<r.length;o++){let s=r[o],a=[];for(let l=0;l<s.length;l++){let c=s[l],d=""+o+l;a.push(d),t[d]={node:c,lastCount:0},n[d]={};for(let u=0;u<i.length;u++){let h=i[u];t[h]&&t[h].node.mode===c.mode?(n[h][d]=Kc(t[h].lastCount+c.length,c.mode)-Kc(t[h].lastCount,c.mode),t[h].lastCount+=c.length):(t[h]&&(t[h].lastCount=c.length),n[h][d]=Kc(c.length,c.mode)+4+rt.getCharCountIndicator(c.mode,e))}}i=a}for(let o=0;o<i.length;o++)n[i[o]].end=0;return{map:n,table:t}}function pg(r,e){let t,n=rt.getBestModeForData(r);if(t=rt.from(e,n),t!==rt.BYTE&&t.bit<n.bit)throw new Error('"'+r+'" cannot be encoded with mode '+rt.toString(t)+`.
 Suggested mode is: `+rt.toString(n));switch(t===rt.KANJI&&!Ys.isKanjiModeEnabled()&&(t=rt.BYTE),t){case rt.NUMERIC:return new gg(r);case rt.ALPHANUMERIC:return new mg(r);case rt.KANJI:return new vg(r);case rt.BYTE:return new _g(r)}}pr.fromArray=function(e){return e.reduce(function(t,n){return typeof n=="string"?t.push(pg(n,null)):n.data&&t.push(pg(n.data,n.mode)),t},[])};pr.fromString=function(e,t){let n=bg(e,Ys.isKanjiModeEnabled()),i=jv(n),o=Vv(i,t),s=Nv.find_path(o.map,"start","end"),a=[];for(let l=1;l<s.length-1;l++)a.push(o.table[s[l]].node);return pr.fromArray(Bv(a))};pr.rawSplit=function(e){return pr.fromArray(bg(e,Ys.isKanjiModeEnabled()))}});var wg=_e(xg=>{"use strict";var Js=gi(),Yc=qs(),Uv=kp(),zv=Lp(),qv=Dp(),Hv=Bp(),Zc=jp(),ed=jc(),Wv=Hp(),Qs=Qp(),Gv=tg(),$v=_i(),Qc=yg();function Xv(r,e){let t=r.size,n=Hv.getPositions(e);for(let i=0;i<n.length;i++){let o=n[i][0],s=n[i][1];for(let a=-1;a<=7;a++)if(!(o+a<=-1||t<=o+a))for(let l=-1;l<=7;l++)s+l<=-1||t<=s+l||(a>=0&&a<=6&&(l===0||l===6)||l>=0&&l<=6&&(a===0||a===6)||a>=2&&a<=4&&l>=2&&l<=4?r.set(o+a,s+l,!0,!0):r.set(o+a,s+l,!1,!0))}}function Kv(r){let e=r.size;for(let t=8;t<e-8;t++){let n=t%2===0;r.set(t,6,n,!0),r.set(6,t,n,!0)}}function Yv(r,e){let t=qv.getPositions(e);for(let n=0;n<t.length;n++){let i=t[n][0],o=t[n][1];for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)s===-2||s===2||a===-2||a===2||s===0&&a===0?r.set(i+s,o+a,!0,!0):r.set(i+s,o+a,!1,!0)}}function Qv(r,e){let t=r.size,n=Qs.getEncodedBits(e),i,o,s;for(let a=0;a<18;a++)i=Math.floor(a/3),o=a%3+t-8-3,s=(n>>a&1)===1,r.set(i,o,s,!0),r.set(o,i,s,!0)}function Jc(r,e,t){let n=r.size,i=Gv.getEncodedBits(e,t),o,s;for(o=0;o<15;o++)s=(i>>o&1)===1,o<6?r.set(o,8,s,!0):o<8?r.set(o+1,8,s,!0):r.set(n-15+o,8,s,!0),o<8?r.set(8,n-o-1,s,!0):o<9?r.set(8,15-o-1+1,s,!0):r.set(8,15-o-1,s,!0);r.set(n-8,8,1,!0)}function Jv(r,e){let t=r.size,n=-1,i=t-1,o=7,s=0;for(let a=t-1;a>0;a-=2)for(a===6&&a--;;){for(let l=0;l<2;l++)if(!r.isReserved(i,a-l)){let c=!1;s<e.length&&(c=(e[s]>>>o&1)===1),r.set(i,a-l,c),o--,o===-1&&(s++,o=7)}if(i+=n,i<0||t<=i){i-=n,n=-n;break}}}function Zv(r,e,t){let n=new Uv;t.forEach(function(l){n.put(l.mode.bit,4),n.put(l.getLength(),$v.getCharCountIndicator(l.mode,r)),l.write(n)});let i=Js.getSymbolTotalCodewords(r),o=ed.getTotalCodewordsCount(r,e),s=(i-o)*8;for(n.getLengthInBits()+4<=s&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);let a=(s-n.getLengthInBits())/8;for(let l=0;l<a;l++)n.put(l%2?17:236,8);return eb(n,r,e)}function eb(r,e,t){let n=Js.getSymbolTotalCodewords(e),i=ed.getTotalCodewordsCount(e,t),o=n-i,s=ed.getBlocksCount(e,t),a=n%s,l=s-a,c=Math.floor(n/s),d=Math.floor(o/s),u=d+1,h=c-d,g=new Wv(h),v=0,x=new Array(s),L=new Array(s),E=0,P=new Uint8Array(r.buffer);for(let B=0;B<s;B++){let W=B<l?d:u;x[B]=P.slice(v,v+W),L[B]=g.encode(x[B]),v+=W,E=Math.max(E,W)}let S=new Uint8Array(n),w=0,T,V;for(T=0;T<E;T++)for(V=0;V<s;V++)T<x[V].length&&(S[w++]=x[V][T]);for(T=0;T<h;T++)for(V=0;V<s;V++)S[w++]=L[V][T];return S}function tb(r,e,t,n){let i;if(Array.isArray(r))i=Qc.fromArray(r);else if(typeof r=="string"){let c=e;if(!c){let d=Qc.rawSplit(r);c=Qs.getBestVersionForData(d,t)}i=Qc.fromString(r,c||40)}else throw new Error("Invalid data");let o=Qs.getBestVersionForData(i,t);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=o;else if(e<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);let s=Zv(e,t,i),a=Js.getSymbolSize(e),l=new zv(a);return Xv(l,e),Kv(l),Yv(l,e),Jc(l,t,0),e>=7&&Qv(l,e),Jv(l,s),isNaN(n)&&(n=Zc.getBestMask(l,Jc.bind(null,l,t))),Zc.applyMask(n,l),Jc(l,t,n),{modules:l,version:e,errorCorrectionLevel:t,maskPattern:n,segments:i}}xg.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let n=Yc.M,i,o;return typeof t<"u"&&(n=Yc.from(t.errorCorrectionLevel,Yc.M),i=Qs.from(t.version),o=Zc.from(t.maskPattern),t.toSJISFunc&&Js.setToSJISFunction(t.toSJISFunc)),tb(e,i,n,o)}});var td=_e(Ni=>{"use strict";function Cg(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let e=r.slice().replace("#","").split("");if(e.length<3||e.length===5||e.length>8)throw new Error("Invalid hex color: "+r);(e.length===3||e.length===4)&&(e=Array.prototype.concat.apply([],e.map(function(n){return[n,n]}))),e.length===6&&e.push("F","F");let t=parseInt(e.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:t&255,hex:"#"+e.slice(0,6).join("")}}Ni.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=typeof e.margin>"u"||e.margin===null||e.margin<0?4:e.margin,n=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:n,scale:n?4:i,margin:t,color:{dark:Cg(e.color.dark||"#000000ff"),light:Cg(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}};Ni.getScale=function(e,t){return t.width&&t.width>=e+t.margin*2?t.width/(e+t.margin*2):t.scale};Ni.getImageWidth=function(e,t){let n=Ni.getScale(e,t);return Math.floor((e+t.margin*2)*n)};Ni.qrToImageData=function(e,t,n){let i=t.modules.size,o=t.modules.data,s=Ni.getScale(i,n),a=Math.floor((i+n.margin*2)*s),l=n.margin*s,c=[n.color.light,n.color.dark];for(let d=0;d<a;d++)for(let u=0;u<a;u++){let h=(d*a+u)*4,g=n.color.light;if(d>=l&&u>=l&&d<a-l&&u<a-l){let v=Math.floor((d-l)/s),x=Math.floor((u-l)/s);g=c[o[v*i+x]?1:0]}e[h++]=g.r,e[h++]=g.g,e[h++]=g.b,e[h]=g.a}}});var Eg=_e(Zs=>{"use strict";var nd=td();function nb(r,e,t){r.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=t,e.width=t,e.style.height=t+"px",e.style.width=t+"px"}function ib(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}Zs.render=function(e,t,n){let i=n,o=t;typeof i>"u"&&(!t||!t.getContext)&&(i=t,t=void 0),t||(o=ib()),i=nd.getOptions(i);let s=nd.getImageWidth(e.modules.size,i),a=o.getContext("2d"),l=a.createImageData(s,s);return nd.qrToImageData(l.data,e,i),nb(a,o,s),a.putImageData(l,0,0),o};Zs.renderToDataURL=function(e,t,n){let i=n;typeof i>"u"&&(!t||!t.getContext)&&(i=t,t=void 0),i||(i={});let o=Zs.render(e,t,i),s=i.type||"image/png",a=i.rendererOpts||{};return o.toDataURL(s,a.quality)}});var Mg=_e(Ag=>{"use strict";var rb=td();function Sg(r,e){let t=r.a/255,n=e+'="'+r.hex+'"';return t<1?n+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':n}function id(r,e,t){let n=r+e;return typeof t<"u"&&(n+=" "+t),n}function ob(r,e,t){let n="",i=0,o=!1,s=0;for(let a=0;a<r.length;a++){let l=Math.floor(a%e),c=Math.floor(a/e);!l&&!o&&(o=!0),r[a]?(s++,a>0&&l>0&&r[a-1]||(n+=o?id("M",l+t,.5+c+t):id("m",i,0),i=0,o=!1),l+1<e&&r[a+1]||(n+=id("h",s),s=0)):i++}return n}Ag.render=function(e,t,n){let i=rb.getOptions(t),o=e.modules.size,s=e.modules.data,a=o+i.margin*2,l=i.color.light.a?"<path "+Sg(i.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",c="<path "+Sg(i.color.dark,"stroke")+' d="'+ob(s,o,i.margin)+'"/>',d='viewBox="0 0 '+a+" "+a+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+d+' shape-rendering="crispEdges">'+l+c+`</svg>
`;return typeof n=="function"&&n(null,h),h}});var Og=_e(oo=>{"use strict";var sb=Op(),rd=wg(),Pg=Eg(),ab=Mg();function od(r,e,t,n,i){let o=[].slice.call(arguments,1),s=o.length,a=typeof o[s-1]=="function";if(!a&&!sb())throw new Error("Callback required as last argument");if(a){if(s<2)throw new Error("Too few arguments provided");s===2?(i=t,t=e,e=n=void 0):s===3&&(e.getContext&&typeof i>"u"?(i=n,n=void 0):(i=n,n=t,t=e,e=void 0))}else{if(s<1)throw new Error("Too few arguments provided");return s===1?(t=e,e=n=void 0):s===2&&!e.getContext&&(n=t,t=e,e=void 0),new Promise(function(l,c){try{let d=rd.create(t,n);l(r(d,e,n))}catch(d){c(d)}})}try{let l=rd.create(t,n);i(null,r(l,e,n))}catch(l){i(l)}}oo.create=rd.create;oo.toCanvas=od.bind(null,Pg.render);oo.toDataURL=od.bind(null,Pg.renderToDataURL);oo.toString=od.bind(null,function(r,e,t){return ab.render(r,t)})});var Ig=_e((ta,ad)=>{"use strict";(function(r,e){typeof ta=="object"&&typeof ad=="object"?ad.exports=e():typeof define=="function"&&define.amd?define([],e):typeof ta=="object"?ta.Quagga=e():r.Quagga=e()})(window,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.d=function(n,i,o){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:o})},t.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){if(1&i&&(n=t(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var s in n)t.d(o,s,(function(a){return n[a]}).bind(null,s));return o},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="/",t(t.s=73)}([function(r,e,t){var n=t(61);r.exports=function(i,o,s){return(o=n(o))in i?Object.defineProperty(i,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[o]=s,i},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){function t(n){return r.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},r.exports.__esModule=!0,r.exports.default=r.exports,t(n)}r.exports=t,r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(61);function i(o,s){for(var a=0;a<s.length;a++){var l=s[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,n(l.key),l)}}r.exports=function(o,s,a){return s&&i(o.prototype,s),a&&i(o,a),Object.defineProperty(o,"prototype",{writable:!1}),o},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){"use strict";t.d(e,"a",function(){return n}),t.d(e,"b",function(){return i}),t.d(e,"c",function(){return o}),t.d(e,"d",function(){return s});var n={};t.r(n),t.d(n,"EPSILON",function(){return a}),t.d(n,"ARRAY_TYPE",function(){return l}),t.d(n,"RANDOM",function(){return c}),t.d(n,"setMatrixArrayType",function(){return d}),t.d(n,"toRadian",function(){return h}),t.d(n,"equals",function(){return g});var i={};t.r(i),t.d(i,"create",function(){return v}),t.d(i,"clone",function(){return x}),t.d(i,"copy",function(){return L}),t.d(i,"identity",function(){return E}),t.d(i,"fromValues",function(){return P}),t.d(i,"set",function(){return S}),t.d(i,"transpose",function(){return w}),t.d(i,"invert",function(){return T}),t.d(i,"adjoint",function(){return V}),t.d(i,"determinant",function(){return B}),t.d(i,"multiply",function(){return W}),t.d(i,"rotate",function(){return M}),t.d(i,"scale",function(){return q}),t.d(i,"fromRotation",function(){return U}),t.d(i,"fromScaling",function(){return ee}),t.d(i,"str",function(){return ie}),t.d(i,"frob",function(){return re}),t.d(i,"LDU",function(){return ae}),t.d(i,"add",function(){return he}),t.d(i,"subtract",function(){return Z}),t.d(i,"exactEquals",function(){return ne}),t.d(i,"equals",function(){return Oe}),t.d(i,"multiplyScalar",function(){return Y}),t.d(i,"multiplyScalarAndAdd",function(){return K}),t.d(i,"mul",function(){return te}),t.d(i,"sub",function(){return xe});var o={};t.r(o),t.d(o,"create",function(){return Ce}),t.d(o,"clone",function(){return Ne}),t.d(o,"fromValues",function(){return Re}),t.d(o,"copy",function(){return Ie}),t.d(o,"set",function(){return Qe}),t.d(o,"add",function(){return _t}),t.d(o,"subtract",function(){return jt}),t.d(o,"multiply",function(){return Gt}),t.d(o,"divide",function(){return Ko}),t.d(o,"ceil",function(){return Gl}),t.d(o,"floor",function(){return Yo}),t.d(o,"min",function(){return Qi}),t.d(o,"max",function(){return $l}),t.d(o,"round",function(){return Xl}),t.d(o,"scale",function(){return Qo}),t.d(o,"scaleAndAdd",function(){return Kl}),t.d(o,"distance",function(){return Jo}),t.d(o,"squaredDistance",function(){return Zo}),t.d(o,"length",function(){return Vr}),t.d(o,"squaredLength",function(){return es}),t.d(o,"negate",function(){return Ur}),t.d(o,"inverse",function(){return ts}),t.d(o,"normalize",function(){return ns}),t.d(o,"dot",function(){return is}),t.d(o,"cross",function(){return zr}),t.d(o,"lerp",function(){return Yl}),t.d(o,"random",function(){return Ql}),t.d(o,"transformMat2",function(){return rs}),t.d(o,"transformMat2d",function(){return Jl}),t.d(o,"transformMat3",function(){return os}),t.d(o,"transformMat4",function(){return ss}),t.d(o,"rotate",function(){return Pn}),t.d(o,"angle",function(){return Zl}),t.d(o,"zero",function(){return as}),t.d(o,"str",function(){return ec}),t.d(o,"exactEquals",function(){return tc}),t.d(o,"equals",function(){return ls}),t.d(o,"len",function(){return cs}),t.d(o,"sub",function(){return nc}),t.d(o,"mul",function(){return ds}),t.d(o,"div",function(){return us}),t.d(o,"dist",function(){return ic}),t.d(o,"sqrDist",function(){return hs}),t.d(o,"sqrLen",function(){return rc}),t.d(o,"forEach",function(){return fs});var s={};t.r(s),t.d(s,"create",function(){return Pi}),t.d(s,"clone",function(){return Ji}),t.d(s,"length",function(){return qr}),t.d(s,"fromValues",function(){return oc}),t.d(s,"copy",function(){return ps}),t.d(s,"set",function(){return Oi}),t.d(s,"add",function(){return Hr}),t.d(s,"subtract",function(){return On}),t.d(s,"multiply",function(){return gs}),t.d(s,"divide",function(){return ms}),t.d(s,"ceil",function(){return sc}),t.d(s,"floor",function(){return ac}),t.d(s,"min",function(){return si}),t.d(s,"max",function(){return Wr}),t.d(s,"round",function(){return _s}),t.d(s,"scale",function(){return lc}),t.d(s,"scaleAndAdd",function(){return cc}),t.d(s,"distance",function(){return vs}),t.d(s,"squaredDistance",function(){return bs}),t.d(s,"squaredLength",function(){return Gr}),t.d(s,"negate",function(){return dc}),t.d(s,"inverse",function(){return uc}),t.d(s,"normalize",function(){return ys}),t.d(s,"dot",function(){return Ti}),t.d(s,"cross",function(){return Ii}),t.d(s,"lerp",function(){return Zi}),t.d(s,"hermite",function(){return xs}),t.d(s,"bezier",function(){return hc}),t.d(s,"random",function(){return un}),t.d(s,"transformMat4",function(){return er}),t.d(s,"transformMat3",function(){return ws}),t.d(s,"transformQuat",function(){return fc}),t.d(s,"rotateX",function(){return pc}),t.d(s,"rotateY",function(){return tr}),t.d(s,"rotateZ",function(){return Cs}),t.d(s,"angle",function(){return gc}),t.d(s,"zero",function(){return mc}),t.d(s,"str",function(){return _c}),t.d(s,"exactEquals",function(){return vc}),t.d(s,"equals",function(){return bc}),t.d(s,"sub",function(){return Es}),t.d(s,"mul",function(){return yc}),t.d(s,"div",function(){return xc}),t.d(s,"dist",function(){return Ss}),t.d(s,"sqrDist",function(){return wc}),t.d(s,"len",function(){return $r}),t.d(s,"sqrLen",function(){return Cc}),t.d(s,"forEach",function(){return As});var a=1e-6,l=typeof Float32Array<"u"?Float32Array:Array,c=Math.random;function d(_){l=_}var u=Math.PI/180;function h(_){return _*u}function g(_,C){return Math.abs(_-C)<=a*Math.max(1,Math.abs(_),Math.abs(C))}function v(){var _=new l(4);return l!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_}function x(_){var C=new l(4);return C[0]=_[0],C[1]=_[1],C[2]=_[2],C[3]=_[3],C}function L(_,C){return _[0]=C[0],_[1]=C[1],_[2]=C[2],_[3]=C[3],_}function E(_){return _[0]=1,_[1]=0,_[2]=0,_[3]=1,_}function P(_,C,R,X){var J=new l(4);return J[0]=_,J[1]=C,J[2]=R,J[3]=X,J}function S(_,C,R,X,J){return _[0]=C,_[1]=R,_[2]=X,_[3]=J,_}function w(_,C){if(_===C){var R=C[1];_[1]=C[2],_[2]=R}else _[0]=C[0],_[1]=C[2],_[2]=C[1],_[3]=C[3];return _}function T(_,C){var R=C[0],X=C[1],J=C[2],de=C[3],we=R*de-J*X;return we?(we=1/we,_[0]=de*we,_[1]=-X*we,_[2]=-J*we,_[3]=R*we,_):null}function V(_,C){var R=C[0];return _[0]=C[3],_[1]=-C[1],_[2]=-C[2],_[3]=R,_}function B(_){return _[0]*_[3]-_[2]*_[1]}function W(_,C,R){var X=C[0],J=C[1],de=C[2],we=C[3],Te=R[0],$e=R[1],Et=R[2],Dt=R[3];return _[0]=X*Te+de*$e,_[1]=J*Te+we*$e,_[2]=X*Et+de*Dt,_[3]=J*Et+we*Dt,_}function M(_,C,R){var X=C[0],J=C[1],de=C[2],we=C[3],Te=Math.sin(R),$e=Math.cos(R);return _[0]=X*$e+de*Te,_[1]=J*$e+we*Te,_[2]=X*-Te+de*$e,_[3]=J*-Te+we*$e,_}function q(_,C,R){var X=C[0],J=C[1],de=C[2],we=C[3],Te=R[0],$e=R[1];return _[0]=X*Te,_[1]=J*Te,_[2]=de*$e,_[3]=we*$e,_}function U(_,C){var R=Math.sin(C),X=Math.cos(C);return _[0]=X,_[1]=R,_[2]=-R,_[3]=X,_}function ee(_,C){return _[0]=C[0],_[1]=0,_[2]=0,_[3]=C[1],_}function ie(_){return"mat2("+_[0]+", "+_[1]+", "+_[2]+", "+_[3]+")"}function re(_){return Math.hypot(_[0],_[1],_[2],_[3])}function ae(_,C,R,X){return _[2]=X[2]/X[0],R[0]=X[0],R[1]=X[1],R[3]=X[3]-_[2]*R[1],[_,C,R]}function he(_,C,R){return _[0]=C[0]+R[0],_[1]=C[1]+R[1],_[2]=C[2]+R[2],_[3]=C[3]+R[3],_}function Z(_,C,R){return _[0]=C[0]-R[0],_[1]=C[1]-R[1],_[2]=C[2]-R[2],_[3]=C[3]-R[3],_}function ne(_,C){return _[0]===C[0]&&_[1]===C[1]&&_[2]===C[2]&&_[3]===C[3]}function Oe(_,C){var R=_[0],X=_[1],J=_[2],de=_[3],we=C[0],Te=C[1],$e=C[2],Et=C[3];return Math.abs(R-we)<=a*Math.max(1,Math.abs(R),Math.abs(we))&&Math.abs(X-Te)<=a*Math.max(1,Math.abs(X),Math.abs(Te))&&Math.abs(J-$e)<=a*Math.max(1,Math.abs(J),Math.abs($e))&&Math.abs(de-Et)<=a*Math.max(1,Math.abs(de),Math.abs(Et))}function Y(_,C,R){return _[0]=C[0]*R,_[1]=C[1]*R,_[2]=C[2]*R,_[3]=C[3]*R,_}function K(_,C,R,X){return _[0]=C[0]+R[0]*X,_[1]=C[1]+R[1]*X,_[2]=C[2]+R[2]*X,_[3]=C[3]+R[3]*X,_}Math.hypot||(Math.hypot=function(){for(var _=0,C=arguments.length;C--;)_+=arguments[C]*arguments[C];return Math.sqrt(_)});var te=W,xe=Z;function Ce(){var _=new l(2);return l!=Float32Array&&(_[0]=0,_[1]=0),_}function Ne(_){var C=new l(2);return C[0]=_[0],C[1]=_[1],C}function Re(_,C){var R=new l(2);return R[0]=_,R[1]=C,R}function Ie(_,C){return _[0]=C[0],_[1]=C[1],_}function Qe(_,C,R){return _[0]=C,_[1]=R,_}function _t(_,C,R){return _[0]=C[0]+R[0],_[1]=C[1]+R[1],_}function jt(_,C,R){return _[0]=C[0]-R[0],_[1]=C[1]-R[1],_}function Gt(_,C,R){return _[0]=C[0]*R[0],_[1]=C[1]*R[1],_}function Ko(_,C,R){return _[0]=C[0]/R[0],_[1]=C[1]/R[1],_}function Gl(_,C){return _[0]=Math.ceil(C[0]),_[1]=Math.ceil(C[1]),_}function Yo(_,C){return _[0]=Math.floor(C[0]),_[1]=Math.floor(C[1]),_}function Qi(_,C,R){return _[0]=Math.min(C[0],R[0]),_[1]=Math.min(C[1],R[1]),_}function $l(_,C,R){return _[0]=Math.max(C[0],R[0]),_[1]=Math.max(C[1],R[1]),_}function Xl(_,C){return _[0]=Math.round(C[0]),_[1]=Math.round(C[1]),_}function Qo(_,C,R){return _[0]=C[0]*R,_[1]=C[1]*R,_}function Kl(_,C,R,X){return _[0]=C[0]+R[0]*X,_[1]=C[1]+R[1]*X,_}function Jo(_,C){var R=C[0]-_[0],X=C[1]-_[1];return Math.hypot(R,X)}function Zo(_,C){var R=C[0]-_[0],X=C[1]-_[1];return R*R+X*X}function Vr(_){var C=_[0],R=_[1];return Math.hypot(C,R)}function es(_){var C=_[0],R=_[1];return C*C+R*R}function Ur(_,C){return _[0]=-C[0],_[1]=-C[1],_}function ts(_,C){return _[0]=1/C[0],_[1]=1/C[1],_}function ns(_,C){var R=C[0],X=C[1],J=R*R+X*X;return J>0&&(J=1/Math.sqrt(J)),_[0]=C[0]*J,_[1]=C[1]*J,_}function is(_,C){return _[0]*C[0]+_[1]*C[1]}function zr(_,C,R){var X=C[0]*R[1]-C[1]*R[0];return _[0]=_[1]=0,_[2]=X,_}function Yl(_,C,R,X){var J=C[0],de=C[1];return _[0]=J+X*(R[0]-J),_[1]=de+X*(R[1]-de),_}function Ql(_,C){C=C||1;var R=2*c()*Math.PI;return _[0]=Math.cos(R)*C,_[1]=Math.sin(R)*C,_}function rs(_,C,R){var X=C[0],J=C[1];return _[0]=R[0]*X+R[2]*J,_[1]=R[1]*X+R[3]*J,_}function Jl(_,C,R){var X=C[0],J=C[1];return _[0]=R[0]*X+R[2]*J+R[4],_[1]=R[1]*X+R[3]*J+R[5],_}function os(_,C,R){var X=C[0],J=C[1];return _[0]=R[0]*X+R[3]*J+R[6],_[1]=R[1]*X+R[4]*J+R[7],_}function ss(_,C,R){var X=C[0],J=C[1];return _[0]=R[0]*X+R[4]*J+R[12],_[1]=R[1]*X+R[5]*J+R[13],_}function Pn(_,C,R,X){var J=C[0]-R[0],de=C[1]-R[1],we=Math.sin(X),Te=Math.cos(X);return _[0]=J*Te-de*we+R[0],_[1]=J*we+de*Te+R[1],_}function Zl(_,C){var R=_[0],X=_[1],J=C[0],de=C[1],we=Math.sqrt(R*R+X*X)*Math.sqrt(J*J+de*de),Te=we&&(R*J+X*de)/we;return Math.acos(Math.min(Math.max(Te,-1),1))}function as(_){return _[0]=0,_[1]=0,_}function ec(_){return"vec2("+_[0]+", "+_[1]+")"}function tc(_,C){return _[0]===C[0]&&_[1]===C[1]}function ls(_,C){var R=_[0],X=_[1],J=C[0],de=C[1];return Math.abs(R-J)<=a*Math.max(1,Math.abs(R),Math.abs(J))&&Math.abs(X-de)<=a*Math.max(1,Math.abs(X),Math.abs(de))}var zn,cs=Vr,nc=jt,ds=Gt,us=Ko,ic=Jo,hs=Zo,rc=es,fs=(zn=Ce(),function(_,C,R,X,J,de){var we,Te;for(C||(C=2),R||(R=0),Te=X?Math.min(X*C+R,_.length):_.length,we=R;we<Te;we+=C)zn[0]=_[we],zn[1]=_[we+1],J(zn,zn,de),_[we]=zn[0],_[we+1]=zn[1];return _});function Pi(){var _=new l(3);return l!=Float32Array&&(_[0]=0,_[1]=0,_[2]=0),_}function Ji(_){var C=new l(3);return C[0]=_[0],C[1]=_[1],C[2]=_[2],C}function qr(_){var C=_[0],R=_[1],X=_[2];return Math.hypot(C,R,X)}function oc(_,C,R){var X=new l(3);return X[0]=_,X[1]=C,X[2]=R,X}function ps(_,C){return _[0]=C[0],_[1]=C[1],_[2]=C[2],_}function Oi(_,C,R,X){return _[0]=C,_[1]=R,_[2]=X,_}function Hr(_,C,R){return _[0]=C[0]+R[0],_[1]=C[1]+R[1],_[2]=C[2]+R[2],_}function On(_,C,R){return _[0]=C[0]-R[0],_[1]=C[1]-R[1],_[2]=C[2]-R[2],_}function gs(_,C,R){return _[0]=C[0]*R[0],_[1]=C[1]*R[1],_[2]=C[2]*R[2],_}function ms(_,C,R){return _[0]=C[0]/R[0],_[1]=C[1]/R[1],_[2]=C[2]/R[2],_}function sc(_,C){return _[0]=Math.ceil(C[0]),_[1]=Math.ceil(C[1]),_[2]=Math.ceil(C[2]),_}function ac(_,C){return _[0]=Math.floor(C[0]),_[1]=Math.floor(C[1]),_[2]=Math.floor(C[2]),_}function si(_,C,R){return _[0]=Math.min(C[0],R[0]),_[1]=Math.min(C[1],R[1]),_[2]=Math.min(C[2],R[2]),_}function Wr(_,C,R){return _[0]=Math.max(C[0],R[0]),_[1]=Math.max(C[1],R[1]),_[2]=Math.max(C[2],R[2]),_}function _s(_,C){return _[0]=Math.round(C[0]),_[1]=Math.round(C[1]),_[2]=Math.round(C[2]),_}function lc(_,C,R){return _[0]=C[0]*R,_[1]=C[1]*R,_[2]=C[2]*R,_}function cc(_,C,R,X){return _[0]=C[0]+R[0]*X,_[1]=C[1]+R[1]*X,_[2]=C[2]+R[2]*X,_}function vs(_,C){var R=C[0]-_[0],X=C[1]-_[1],J=C[2]-_[2];return Math.hypot(R,X,J)}function bs(_,C){var R=C[0]-_[0],X=C[1]-_[1],J=C[2]-_[2];return R*R+X*X+J*J}function Gr(_){var C=_[0],R=_[1],X=_[2];return C*C+R*R+X*X}function dc(_,C){return _[0]=-C[0],_[1]=-C[1],_[2]=-C[2],_}function uc(_,C){return _[0]=1/C[0],_[1]=1/C[1],_[2]=1/C[2],_}function ys(_,C){var R=C[0],X=C[1],J=C[2],de=R*R+X*X+J*J;return de>0&&(de=1/Math.sqrt(de)),_[0]=C[0]*de,_[1]=C[1]*de,_[2]=C[2]*de,_}function Ti(_,C){return _[0]*C[0]+_[1]*C[1]+_[2]*C[2]}function Ii(_,C,R){var X=C[0],J=C[1],de=C[2],we=R[0],Te=R[1],$e=R[2];return _[0]=J*$e-de*Te,_[1]=de*we-X*$e,_[2]=X*Te-J*we,_}function Zi(_,C,R,X){var J=C[0],de=C[1],we=C[2];return _[0]=J+X*(R[0]-J),_[1]=de+X*(R[1]-de),_[2]=we+X*(R[2]-we),_}function xs(_,C,R,X,J,de){var we=de*de,Te=we*(2*de-3)+1,$e=we*(de-2)+de,Et=we*(de-1),Dt=we*(3-2*de);return _[0]=C[0]*Te+R[0]*$e+X[0]*Et+J[0]*Dt,_[1]=C[1]*Te+R[1]*$e+X[1]*Et+J[1]*Dt,_[2]=C[2]*Te+R[2]*$e+X[2]*Et+J[2]*Dt,_}function hc(_,C,R,X,J,de){var we=1-de,Te=we*we,$e=de*de,Et=Te*we,Dt=3*de*Te,bn=3*$e*we,yn=$e*de;return _[0]=C[0]*Et+R[0]*Dt+X[0]*bn+J[0]*yn,_[1]=C[1]*Et+R[1]*Dt+X[1]*bn+J[1]*yn,_[2]=C[2]*Et+R[2]*Dt+X[2]*bn+J[2]*yn,_}function un(_,C){C=C||1;var R=2*c()*Math.PI,X=2*c()-1,J=Math.sqrt(1-X*X)*C;return _[0]=Math.cos(R)*J,_[1]=Math.sin(R)*J,_[2]=X*C,_}function er(_,C,R){var X=C[0],J=C[1],de=C[2],we=R[3]*X+R[7]*J+R[11]*de+R[15];return we=we||1,_[0]=(R[0]*X+R[4]*J+R[8]*de+R[12])/we,_[1]=(R[1]*X+R[5]*J+R[9]*de+R[13])/we,_[2]=(R[2]*X+R[6]*J+R[10]*de+R[14])/we,_}function ws(_,C,R){var X=C[0],J=C[1],de=C[2];return _[0]=X*R[0]+J*R[3]+de*R[6],_[1]=X*R[1]+J*R[4]+de*R[7],_[2]=X*R[2]+J*R[5]+de*R[8],_}function fc(_,C,R){var X=R[0],J=R[1],de=R[2],we=R[3],Te=C[0],$e=C[1],Et=C[2],Dt=J*Et-de*$e,bn=de*Te-X*Et,yn=X*$e-J*Te,qn=J*yn-de*bn,nr=de*Dt-X*yn,Xr=X*bn-J*Dt,A=2*we;return Dt*=A,bn*=A,yn*=A,qn*=2,nr*=2,Xr*=2,_[0]=Te+Dt+qn,_[1]=$e+bn+nr,_[2]=Et+yn+Xr,_}function pc(_,C,R,X){var J=[],de=[];return J[0]=C[0]-R[0],J[1]=C[1]-R[1],J[2]=C[2]-R[2],de[0]=J[0],de[1]=J[1]*Math.cos(X)-J[2]*Math.sin(X),de[2]=J[1]*Math.sin(X)+J[2]*Math.cos(X),_[0]=de[0]+R[0],_[1]=de[1]+R[1],_[2]=de[2]+R[2],_}function tr(_,C,R,X){var J=[],de=[];return J[0]=C[0]-R[0],J[1]=C[1]-R[1],J[2]=C[2]-R[2],de[0]=J[2]*Math.sin(X)+J[0]*Math.cos(X),de[1]=J[1],de[2]=J[2]*Math.cos(X)-J[0]*Math.sin(X),_[0]=de[0]+R[0],_[1]=de[1]+R[1],_[2]=de[2]+R[2],_}function Cs(_,C,R,X){var J=[],de=[];return J[0]=C[0]-R[0],J[1]=C[1]-R[1],J[2]=C[2]-R[2],de[0]=J[0]*Math.cos(X)-J[1]*Math.sin(X),de[1]=J[0]*Math.sin(X)+J[1]*Math.cos(X),de[2]=J[2],_[0]=de[0]+R[0],_[1]=de[1]+R[1],_[2]=de[2]+R[2],_}function gc(_,C){var R=_[0],X=_[1],J=_[2],de=C[0],we=C[1],Te=C[2],$e=Math.sqrt(R*R+X*X+J*J)*Math.sqrt(de*de+we*we+Te*Te),Et=$e&&Ti(_,C)/$e;return Math.acos(Math.min(Math.max(Et,-1),1))}function mc(_){return _[0]=0,_[1]=0,_[2]=0,_}function _c(_){return"vec3("+_[0]+", "+_[1]+", "+_[2]+")"}function vc(_,C){return _[0]===C[0]&&_[1]===C[1]&&_[2]===C[2]}function bc(_,C){var R=_[0],X=_[1],J=_[2],de=C[0],we=C[1],Te=C[2];return Math.abs(R-de)<=a*Math.max(1,Math.abs(R),Math.abs(de))&&Math.abs(X-we)<=a*Math.max(1,Math.abs(X),Math.abs(we))&&Math.abs(J-Te)<=a*Math.max(1,Math.abs(J),Math.abs(Te))}var Es=On,yc=gs,xc=ms,Ss=vs,wc=bs,$r=qr,Cc=Gr,As=function(){var _=Pi();return function(C,R,X,J,de,we){var Te,$e;for(R||(R=3),X||(X=0),$e=J?Math.min(J*R+X,C.length):C.length,Te=X;Te<$e;Te+=R)_[0]=C[Te],_[1]=C[Te+1],_[2]=C[Te+2],de(_,_,we),C[Te]=_[0],C[Te+1]=_[1],C[Te+2]=_[2];return C}}()},function(r,e,t){var n=t(13).default,i=t(1);r.exports=function(o,s){if(s&&(n(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i(o)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(40);r.exports=function(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(o&&o.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),o&&n(i,o)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(141)();r.exports=n;try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(r,e,t){"use strict";e.a={init:function(n,i){n.fill(i)},shuffle:function(n){for(var i=n.length-1;i>0;i--){var o=Math.floor(Math.random()*(i+1)),s=[n[o],n[i]];n[i]=s[0],n[o]=s[1]}return n},toPointList:function(n){var i=n.reduce(function(o,s){var a="[".concat(s.join(","),"]");return o.push(a),o},[]);return"[".concat(i.join(`,\r
`),"]")},threshold:function(n,i,o){return n.reduce(function(s,a){return o.apply(n,[a])>=i&&s.push(a),s},[])},maxIndex:function(n){for(var i=0,o=0;o<n.length;o++)n[o]>n[i]&&(i=o);return i},max:function(n){for(var i=0,o=0;o<n.length;o++)n[o]>i&&(i=n[o]);return i},sum:function(n){for(var i=n.length,o=0;i--;)o+=n[i];return o}}},function(r,e,t){"use strict";t.d(e,"h",function(){return a}),t.d(e,"i",function(){return c}),t.d(e,"b",function(){return d}),t.d(e,"j",function(){return u}),t.d(e,"e",function(){return h}),t.d(e,"c",function(){return g}),t.d(e,"f",function(){return v}),t.d(e,"g",function(){return x}),t.d(e,"a",function(){return E}),t.d(e,"d",function(){return S});var n=t(5),i=t(9);n.a.setMatrixArrayType(Array);var o=function(w,T){var V=[],B={rad:0,vec:n.c.clone([0,0])},W={};function M(U){W[U.id]=U,V.push(U)}function q(){var U,ee=0;for(U=0;U<V.length;U++)ee+=V[U].rad;B.rad=ee/V.length,B.vec=n.c.clone([Math.cos(B.rad),Math.sin(B.rad)])}return M(w),q(),{add:function(U){W[U.id]||(M(U),q())},fits:function(U){return Math.abs(n.c.dot(U.point.vec,B.vec))>T},getPoints:function(){return V},getCenter:function(){return B}}},s=function(w,T,V){return{rad:w[V],point:w,id:T}};function a(w,T){return{x:w,y:T,toVec2:function(){return n.c.clone([this.x,this.y])},toVec3:function(){return n.d.clone([this.x,this.y,1])},round:function(){return this.x=this.x>0?Math.floor(this.x+.5):Math.floor(this.x-.5),this.y=this.y>0?Math.floor(this.y+.5):Math.floor(this.y-.5),this}}}function l(w,T){T||(T=8);for(var V=w.data,B=V.length,W=8-T,M=new Int32Array(1<<T);B--;)M[V[B]>>W]++;return M}function c(w,T){var V=function(B){var W,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,q=8-M;function U(ae,he){for(var Z=0,ne=ae;ne<=he;ne++)Z+=W[ne];return Z}function ee(ae,he){for(var Z=0,ne=ae;ne<=he;ne++)Z+=ne*W[ne];return Z}function ie(){var ae,he,Z,ne,Oe=[0],Y=(1<<M)-1;W=l(B,M);for(var K=1;K<Y;K++)(Z=(ae=U(0,K))*(he=U(K+1,Y)))===0&&(Z=1),ne=ee(0,K)*he-ee(K+1,Y)*ae,Oe[K]=ne*ne/Z;return i.a.maxIndex(Oe)}var re=ie();return re<<q}(w);return function(B,W,M){M||(M=B);for(var q=B.data,U=q.length,ee=M.data;U--;)ee[U]=q[U]<W?1:0}(w,V,T),V}function d(w,T,V){var B,W,M,q,U=[];function ee(ie){var re=!1;for(W=0;W<U.length;W++)(M=U[W]).fits(ie)&&(M.add(ie),re=!0);return re}for(V||(V="rad"),B=0;B<w.length;B++)ee(q=s(w[B],B,V))||U.push(o(q,T));return U}n.a.setMatrixArrayType(Array);function u(w,T,V){var B,W,M,q,U=0,ee=0,ie=[];for(B=0;B<T;B++)ie[B]={score:0,item:null};for(B=0;B<w.length;B++)if((W=V.apply(this,[w[B]]))>ee)for((M=ie[U]).score=W,M.item=w[B],ee=Number.MAX_VALUE,q=0;q<T;q++)ie[q].score<ee&&(ee=ie[q].score,U=q);return ie}function h(w,T,V){for(var B,W=0,M=T.x,q=Math.floor(w.length/4),U=T.x/2,ee=0,ie=T.x;M<q;){for(B=0;B<U;B++)V[ee]=(.299*w[4*W+0]+.587*w[4*W+1]+.114*w[4*W+2]+(.299*w[4*(W+1)+0]+.587*w[4*(W+1)+1]+.114*w[4*(W+1)+2])+(.299*w[4*M+0]+.587*w[4*M+1]+.114*w[4*M+2])+(.299*w[4*(M+1)+0]+.587*w[4*(M+1)+1]+.114*w[4*(M+1)+2]))/4,ee++,W+=2,M+=2;W+=ie,M+=ie}}function g(w,T,V){var B=w.length/4|0;if(V&&V.singleChannel===!0)for(var W=0;W<B;W++)T[W]=w[4*W+0];else for(var M=0;M<B;M++)T[M]=.299*w[4*M+0]+.587*w[4*M+1]+.114*w[4*M+2]}function v(w,T){for(var V=w.data,B=w.size.x,W=T.data,M=0,q=B,U=V.length,ee=B/2,ie=0;q<U;){for(var re=0;re<ee;re++)W[ie]=Math.floor((V[M]+V[M+1]+V[q]+V[q+1])/4),ie++,M+=2,q+=2;M+=B,q+=B}}function x(w){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],V=w[0],B=w[1],W=w[2],M=W*B,q=M*(1-Math.abs(V/60%2-1)),U=W-M,ee=0,ie=0,re=0;return V<60?(ee=M,ie=q):V<120?(ee=q,ie=M):V<180?(ie=M,re=q):V<240?(ie=q,re=M):V<300?(ee=q,re=M):V<360&&(ee=M,re=q),T[0]=255*(ee+U)|0,T[1]=255*(ie+U)|0,T[2]=255*(re+U)|0,T}function L(w){for(var T=[],V=[],B=1;B<Math.sqrt(w)+1;B++)w%B==0&&(V.push(B),B!==w/B&&T.unshift(Math.floor(w/B)));return V.concat(T)}function E(w,T){var V,B=L(T.x),W=L(T.y),M=Math.max(T.x,T.y),q=function(Z,ne){for(var Oe=0,Y=0,K=[];Oe<Z.length&&Y<ne.length;)Z[Oe]===ne[Y]?(K.push(Z[Oe]),Oe++,Y++):Z[Oe]>ne[Y]?Y++:Oe++;return K}(B,W),U=[8,10,15,20,32,60,80],ee={"x-small":5,small:4,medium:3,large:2,"x-large":1},ie=ee[w]||ee.medium,re=U[ie],ae=Math.floor(M/re);function he(Z){for(var ne=0,Oe=Z[Math.floor(Z.length/2)];ne<Z.length-1&&Z[ne]<ae;)ne++;return ne>0&&(Oe=Math.abs(Z[ne]-ae)>Math.abs(Z[ne-1]-ae)?Z[ne-1]:Z[ne]),ae/Oe<U[ie+1]/U[ie]&&ae/Oe>U[ie-1]/U[ie]?{x:Oe,y:Oe}:null}return(V=he(q))||(V=he(L(M)))||(V=he(L(ae*re))),V}var P={top:function(w,T){return w.unit==="%"?Math.floor(T.height*(w.value/100)):null},right:function(w,T){return w.unit==="%"?Math.floor(T.width-T.width*(w.value/100)):null},bottom:function(w,T){return w.unit==="%"?Math.floor(T.height-T.height*(w.value/100)):null},left:function(w,T){return w.unit==="%"?Math.floor(T.width*(w.value/100)):null}};function S(w,T,V){var B={width:w,height:T},W=Object.keys(V).reduce(function(M,q){var U=function(ie){return{value:parseFloat(ie),unit:(ie.indexOf("%"),ie.length,"%")}}(V[q]),ee=P[q](U,B);return M[q]=ee,M},{});return{sx:W.left,sy:W.top,sw:W.right-W.left,sh:W.bottom-W.top}}},function(r,e,t){"use strict";var n=t(62),i=t.n(n),o=t(3),s=t.n(o),a=t(4),l=t.n(a),c=t(0),d=t.n(c),u=t(5),h=t(9),g=t(10);function v(L){if(L<0)throw new Error("expected positive number, received ".concat(L))}u.a.setMatrixArrayType(Array);var x=function(){function L(E,P){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Uint8Array,w=arguments.length>3?arguments[3]:void 0;s()(this,L),d()(this,"data",void 0),d()(this,"size",void 0),d()(this,"indexMapping",void 0),P?this.data=P:(this.data=new S(E.x*E.y),w&&h.a.init(this.data,0)),this.size=E}return l()(L,[{key:"inImageWithBorder",value:function(E){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return v(P),E.x>=0&&E.y>=0&&E.x<this.size.x+2*P&&E.y<this.size.y+2*P}},{key:"subImageAsCopy",value:function(E,P){v(P.x),v(P.y);for(var S=E.size,w=S.x,T=S.y,V=0;V<w;V++)for(var B=0;B<T;B++)E.data[B*w+V]=this.data[(P.y+B)*this.size.x+P.x+V];return E}},{key:"get",value:function(E,P){return this.data[P*this.size.x+E]}},{key:"getSafe",value:function(E,P){if(!this.indexMapping){this.indexMapping={x:[],y:[]};for(var S=0;S<this.size.x;S++)this.indexMapping.x[S]=S,this.indexMapping.x[S+this.size.x]=S;for(var w=0;w<this.size.y;w++)this.indexMapping.y[w]=w,this.indexMapping.y[w+this.size.y]=w}return this.data[this.indexMapping.y[P+this.size.y]*this.size.x+this.indexMapping.x[E+this.size.x]]}},{key:"set",value:function(E,P,S){return this.data[P*this.size.x+E]=S,delete this.indexMapping,this}},{key:"zeroBorder",value:function(){for(var E=this.size,P=E.x,S=E.y,w=0;w<P;w++)this.data[w]=this.data[(S-1)*P+w]=0;for(var T=1;T<S-1;T++)this.data[T*P]=this.data[T*P+(P-1)]=0;return delete this.indexMapping,this}},{key:"moments",value:function(E){var P,S,w,T,V,B,W,M,q,U,ee=this.data,ie=this.size.y,re=this.size.x,ae=[],he=[],Z=Math.PI,ne=Z/4;if(E<=0)return he;for(V=0;V<E;V++)ae[V]={m00:0,m01:0,m10:0,m11:0,m02:0,m20:0,theta:0,rad:0};for(S=0;S<ie;S++)for(T=S*S,P=0;P<re;P++)(w=ee[S*re+P])>0&&((B=ae[w-1]).m00+=1,B.m01+=S,B.m10+=P,B.m11+=P*S,B.m02+=T,B.m20+=P*P);for(V=0;V<E;V++)B=ae[V],isNaN(B.m00)||B.m00===0||(M=B.m10/B.m00,q=B.m01/B.m00,W=B.m11/B.m00-M*q,U=(B.m02/B.m00-q*q-(B.m20/B.m00-M*M))/(2*W),U=.5*Math.atan(U)+(W>=0?ne:-ne)+Z,B.theta=(180*U/Z+90)%180-90,B.theta<0&&(B.theta+=180),B.rad=U>Z?U-Z:U,B.vec=u.c.clone([Math.cos(U),Math.sin(U)]),he.push(B));return he}},{key:"getAsRGBA",value:function(){for(var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,P=new Uint8ClampedArray(4*this.size.x*this.size.y),S=0;S<this.size.y;S++)for(var w=0;w<this.size.x;w++){var T=S*this.size.x+w,V=this.get(w,S)*E;P[4*T+0]=V,P[4*T+1]=V,P[4*T+2]=V,P[4*T+3]=255}return P}},{key:"show",value:function(E){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;console.warn("* imagewrapper show getcontext 2d");var S=E.getContext("2d");if(!S)throw new Error("Unable to get canvas context");var w=S.getImageData(0,0,E.width,E.height),T=this.getAsRGBA(P);E.width=this.size.x,E.height=this.size.y;var V=new ImageData(T,w.width,w.height);S.putImageData(V,0,0)}},{key:"overlay",value:function(E,P,S){var w=P<0||P>360?360:P,T=[0,1,1],V=[0,0,0],B=[255,255,255],W=[0,0,0];console.warn("* imagewrapper overlay getcontext 2d");var M=E.getContext("2d");if(!M)throw new Error("Unable to get canvas context");for(var q=M.getImageData(S.x,S.y,this.size.x,this.size.y),U=q.data,ee=this.data.length;ee--;){T[0]=this.data[ee]*w;var ie=4*ee,re=T[0]<=0?B:T[0]>=360?W:Object(g.g)(T,V),ae=i()(re,3);U[ie]=ae[0],U[ie+1]=ae[1],U[ie+2]=ae[2],U[ie+3]=255}M.putImageData(q,S.x,S.y)}}]),L}();e.a=x},function(r,e){function t(n,i,o,s,a,l,c){try{var d=n[l](c),u=d.value}catch(h){return void o(h)}d.done?i(u):Promise.resolve(u).then(s,a)}r.exports=function(n){return function(){var i=this,o=arguments;return new Promise(function(s,a){var l=n.apply(i,o);function c(u){t(l,s,a,c,d,"next",u)}function d(u){t(l,s,a,c,d,"throw",u)}c(void 0)})}},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){function t(n){return r.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},r.exports.__esModule=!0,r.exports.default=r.exports,t(n)}r.exports=t,r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(142);function i(){return typeof Reflect<"u"&&Reflect.get?(r.exports=i=Reflect.get.bind(),r.exports.__esModule=!0,r.exports.default=r.exports):(r.exports=i=function(o,s,a){var l=n(o,s);if(l){var c=Object.getOwnPropertyDescriptor(l,s);return c.get?c.get.call(arguments.length<3?o:a):c.value}},r.exports.__esModule=!0,r.exports.default=r.exports),i.apply(this,arguments)}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}},function(r,e){var t=Array.isArray;r.exports=t},function(r,e,t){"use strict";e.a={drawRect:function(n,i,o,s){o.strokeStyle=s.color,o.fillStyle=s.color,o.lineWidth=s.lineWidth||1,o.beginPath(),o.strokeRect(n.x,n.y,i.x,i.y)},drawPath:function(n,i,o,s){o.strokeStyle=s.color,o.fillStyle=s.color,o.lineWidth=s.lineWidth,o.beginPath(),o.moveTo(n[0][i.x],n[0][i.y]);for(var a=1;a<n.length;a++)o.lineTo(n[a][i.x],n[a][i.y]);o.closePath(),o.stroke()},drawImage:function(n,i,o){var s=o.getImageData(0,0,i.x,i.y),a=s.data,l=a.length,c=n.length;if(l/c!=4)return!1;for(;c--;){var d=n[c];a[--l]=255,a[--l]=d,a[--l]=d,a[--l]=d}return o.putImageData(s,0,0),!0}}},function(r,e,t){var n=t(74),i=t(129)(function(o,s,a){n(o,s,a)});r.exports=i},function(r,e,t){var n=t(44),i=typeof self=="object"&&self&&self.Object===Object&&self,o=n||i||Function("return this")();r.exports=o},function(r,e){r.exports=function(t){return t!=null&&typeof t=="object"}},function(r,e,t){"use strict";e.a={searchDirections:[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],create:function(n,i){var o,s=n.data,a=i.data,l=this.searchDirections,c=n.size.x;function d(h,g,v,x){var L,E,P;for(L=0;L<l.length;L++){if(E=h.cy+l[h.dir][0],P=h.cx+l[h.dir][1],s[o=E*c+P]===g&&(a[o]===0||a[o]===v))return a[o]=v,h.cy=E,h.cx=P,!0;a[o]===0&&(a[o]=x),h.dir=(h.dir+1)%8}return!1}function u(h,g,v){return{dir:v,x:h,y:g,next:null,prev:null}}return{trace:function(h,g,v,x){return d(h,g,v,x)},contourTracing:function(h,g,v,x,L){return function(E,P,S,w,T){var V,B,W,M=null,q={cx:P,cy:E,dir:0};if(d(q,w,S,T)){V=M=u(P,E,q.dir),W=q.dir,(B=u(q.cx,q.cy,0)).prev=V,V.next=B,B.next=null,V=B;var U=n.size.x*n.size.y,ee=0;do q.dir=(q.dir+6)%8,d(q,w,S,T),W!==q.dir?(V.dir=q.dir,(B=u(q.cx,q.cy,0)).prev=V,V.next=B,B.next=null,V=B):(V.dir=W,V.x=q.cx,V.y=q.cy),W=q.dir;while((q.cx!==P||q.cy!==E)&&++ee<U);M.prev=V.prev,V.prev.next=M}return M}(h,g,v,x,L)}}}}},function(r,e,t){var n=t(27),i=t(87),o=t(88),s=n?n.toStringTag:void 0;r.exports=function(a){return a==null?a===void 0?"[object Undefined]":"[object Null]":s&&s in Object(a)?i(a):o(a)}},function(r,e,t){"use strict";(function(n){var i,o,s,a,l,c,d,u,h,g,v=t(5),x=t(11),L=t(10),E=t(9),P=(t(17),t(65)),S=t(21),w=t(66);v.a.setMatrixArrayType(Array);var T,V,B={ctx:{binary:null},dom:{binary:null}},W={x:0,y:0};function M(ee){var ie,re,ae,he,Z,ne,Oe,Y=h.size.x,K=h.size.y,te=-h.size.x,xe=-h.size.y;for(ie=0,re=0;re<ee.length;re++)ie+=(he=ee[re]).rad;for((ie=(180*(ie/=ee.length)/Math.PI+90)%180-90)<0&&(ie+=180),ie=(180-ie)*Math.PI/180,Z=v.b.copy(v.b.create(),[Math.cos(ie),Math.sin(ie),-Math.sin(ie),Math.cos(ie)]),re=0;re<ee.length;re++)for(he=ee[re],ae=0;ae<4;ae++)v.c.transformMat2(he.box[ae],he.box[ae],Z);for(re=0;re<ee.length;re++)for(he=ee[re],ae=0;ae<4;ae++)he.box[ae][0]<Y&&(Y=he.box[ae][0]),he.box[ae][0]>te&&(te=he.box[ae][0]),he.box[ae][1]<K&&(K=he.box[ae][1]),he.box[ae][1]>xe&&(xe=he.box[ae][1]);for(ne=[[Y,K],[te,K],[te,xe],[Y,xe]],Oe=i.halfSample?2:1,Z=v.b.invert(Z,Z),ae=0;ae<4;ae++)v.c.transformMat2(ne[ae],ne[ae],Z);for(ae=0;ae<4;ae++)v.c.scale(ne[ae],ne[ae],Oe);return ne}function q(ee,ie){h.subImageAsCopy(a,Object(L.h)(ee,ie)),V.skeletonize()}function U(ee,ie,re,ae){var he,Z,ne,Oe,Y=[],K=[],te=Math.ceil(g.x/3);if(ee.length>=2){for(he=0;he<ee.length;he++)ee[he].m00>te&&Y.push(ee[he]);if(Y.length>=2){for(ne=function(Ne){var Re=Object(L.b)(Ne,.9),Ie=Object(L.j)(Re,1,function(Gt){return Gt.getPoints().length}),Qe=[],_t=[];if(Ie.length===1){Qe=Ie[0].item.getPoints();for(var jt=0;jt<Qe.length;jt++)_t.push(Qe[jt].point)}return _t}(Y),Z=0,he=0;he<ne.length;he++){var xe,Ce;Z+=(xe=(Ce=ne[he])===null||Ce===void 0?void 0:Ce.rad)!==null&&xe!==void 0?xe:0}ne.length>1&&ne.length>=Y.length/4*3&&ne.length>ee.length/4&&(Z/=ne.length,Oe={index:ie[1]*W.x+ie[0],pos:{x:re,y:ae},box:[v.c.clone([re,ae]),v.c.clone([re+a.size.x,ae]),v.c.clone([re+a.size.x,ae+a.size.y]),v.c.clone([re,ae+a.size.y])],moments:ne,rad:Z,vec:v.c.clone([Math.cos(Z),Math.sin(Z)])},K.push(Oe))}}return K}e.a={init:function(ee,ie){i=ie,T=ee,function(){o=i.halfSample?new x.a({x:T.size.x/2|0,y:T.size.y/2|0}):T,g=Object(L.a)(i.patchSize,o.size),W.x=o.size.x/g.x|0,W.y=o.size.y/g.y|0,h=new x.a(o.size,void 0,Uint8Array,!1),l=new x.a(g,void 0,Array,!0);var re=new ArrayBuffer(65536);a=new x.a(g,new Uint8Array(re,0,g.x*g.y)),s=new x.a(g,new Uint8Array(re,g.x*g.y*3,g.x*g.y),void 0,!0),V=Object(w.a)(typeof window<"u"?window:typeof self<"u"?self:n,{size:g.x},re),u=new x.a({x:o.size.x/a.size.x|0,y:o.size.y/a.size.y|0},void 0,Array,!0),c=new x.a(u.size,void 0,void 0,!0),d=new x.a(u.size,void 0,Int32Array,!0)}(),function(){if(!i.useWorker&&typeof document<"u"){B.dom.binary=document.createElement("canvas"),B.dom.binary.className="binaryBuffer";var re=!!i.willReadFrequently;console.warn("* initCanvas willReadFrequently",re,i),B.ctx.binary=B.dom.binary.getContext("2d",{willReadFrequently:re}),B.dom.binary.width=h.size.x,B.dom.binary.height=h.size.y}}()},locate:function(){i.halfSample&&Object(L.f)(T,o),Object(L.i)(o,h),h.zeroBorder();var ee=function(){var ae,he,Z,ne,Oe,Y,K=[];for(ae=0;ae<W.x;ae++)for(he=0;he<W.y;he++)q(Z=a.size.x*ae,ne=a.size.y*he),s.zeroBorder(),E.a.init(l.data,0),Y=P.a.create(s,l).rasterize(0),Oe=l.moments(Y.count),K=K.concat(U(Oe,[ae,he],Z,ne));return K}();if(ee.length<W.x*W.y*.05)return null;var ie=function(ae){var he,Z,ne=0,Oe=0;function Y(){var te;for(te=0;te<d.data.length;te++)if(d.data[te]===0&&c.data[te]===1)return te;return d.data.length}function K(te){var xe,Ce,Ne,Re,Ie,Qe=te%d.size.x,_t=te/d.size.x|0;if(te<d.data.length)for(Ne=u.data[te],d.data[te]=ne,Ie=0;Ie<S.a.searchDirections.length;Ie++)Ce=_t+S.a.searchDirections[Ie][0],xe=Qe+S.a.searchDirections[Ie][1],Re=Ce*d.size.x+xe,c.data[Re]!==0?d.data[Re]===0&&Math.abs(v.c.dot(u.data[Re].vec,Ne.vec))>.95&&K(Re):d.data[Re]=Number.MAX_VALUE}for(E.a.init(c.data,0),E.a.init(d.data,0),E.a.init(u.data,null),he=0;he<ae.length;he++)Z=ae[he],u.data[Z.index]=Z,c.data[Z.index]=1;for(c.zeroBorder();(Oe=Y())<d.data.length;)ne++,K(Oe);return ne}(ee);if(ie<1)return null;var re=function(ae){var he,Z,ne=[];for(he=0;he<ae;he++)ne.push(0);for(Z=d.data.length;Z--;)d.data[Z]>0&&ne[d.data[Z]-1]++;return(ne=ne.map(function(Oe,Y){return{val:Oe,label:Y+1}})).sort(function(Oe,Y){return Y.val-Oe.val}),ne.filter(function(Oe){return Oe.val>=5})}(ie);return re.length===0?null:function(ae,he){var Z,ne,Oe,Y,K=[],te=[];for(Z=0;Z<ae.length;Z++){for(ne=d.data.length,K.length=0;ne--;)d.data[ne]===ae[Z].label&&(Oe=u.data[ne],K.push(Oe));(Y=M(K))&&te.push(Y)}return te}(re)},checkImageConstraints:function(ee,ie){var re,ae,he=ee.getWidth(),Z=ee.getHeight(),ne=ie.halfSample?.5:1;ee.getConfig().area&&(ae=Object(L.d)(he,Z,ee.getConfig().area),ee.setTopRight({x:ae.sx,y:ae.sy}),ee.setCanvasSize({x:he,y:Z}),he=ae.sw,Z=ae.sh);var Oe={x:Math.floor(he*ne),y:Math.floor(Z*ne)};if(re=Object(L.a)(ie.patchSize,Oe),ee.setWidth(Math.max(Math.floor(Math.floor(Oe.x/re.x)*(1/ne)*re.x),re.x)),ee.setHeight(Math.max(Math.floor(Math.floor(Oe.y/re.y)*(1/ne)*re.y),re.y)),ee.getWidth()%re.x==0&&ee.getHeight()%re.y==0)return!0;throw new Error("Image dimensions do not comply with the current settings: Width (".concat(he," )and height (").concat(Z,") must a multiple of ").concat(re.x))}}}).call(this,t(45))},function(r,e,t){var n=t(76),i=t(77),o=t(78),s=t(79),a=t(80);function l(c){var d=-1,u=c==null?0:c.length;for(this.clear();++d<u;){var h=c[d];this.set(h[0],h[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=a,r.exports=l},function(r,e,t){var n=t(26);r.exports=function(i,o){for(var s=i.length;s--;)if(n(i[s][0],o))return s;return-1}},function(r,e){r.exports=function(t,n){return t===n||t!=t&&n!=n}},function(r,e,t){var n=t(19).Symbol;r.exports=n},function(r,e,t){var n=t(34)(Object,"create");r.exports=n},function(r,e,t){var n=t(101);r.exports=function(i,o){var s=i.__data__;return n(o)?s[typeof o=="string"?"string":"hash"]:s.map}},function(r,e,t){var n=t(116),i=t(20),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(c){return i(c)&&s.call(c,"callee")&&!a.call(c,"callee")};r.exports=l},function(r,e){var t=/^(?:0|[1-9]\d*)$/;r.exports=function(n,i){var o=typeof n;return!!(i=i??9007199254740991)&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}},function(r,e,t){var n=t(16),i=t(149),o=t(150),s=t(153);r.exports=function(a,l){return n(a)?a:i(a,l)?[a]:o(s(a))}},function(r,e,t){var n=t(143),i=t(144),o=t(59),s=t(145);r.exports=function(a){return n(a)||i(a)||o(a)||s()},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(86),i=t(92);r.exports=function(o,s){var a=i(o,s);return n(a)?a:void 0}},function(r,e,t){var n=t(22),i=t(15);r.exports=function(o){if(!i(o))return!1;var s=n(o);return s=="[object Function]"||s=="[object GeneratorFunction]"||s=="[object AsyncFunction]"||s=="[object Proxy]"}},function(r,e,t){var n=t(48);r.exports=function(i,o,s){o=="__proto__"&&n?n(i,o,{configurable:!0,enumerable:!0,value:s,writable:!0}):i[o]=s}},function(r,e){r.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(r,e,t){var n=t(35),i=t(39);r.exports=function(o){return o!=null&&i(o.length)&&!n(o)}},function(r,e){r.exports=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991}},function(r,e){function t(n,i){return r.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,s){return o.__proto__=s,o},r.exports.__esModule=!0,r.exports.default=r.exports,t(n,i)}r.exports=t,r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(22),i=t(20);r.exports=function(o){return typeof o=="symbol"||i(o)&&n(o)=="[object Symbol]"}},function(r,e,t){var n=t(41);r.exports=function(i){if(typeof i=="string"||n(i))return i;var o=i+"";return o=="0"&&1/i==-1/0?"-0":o}},function(r,e,t){var n=t(34)(t(19),"Map");r.exports=n},function(r,e,t){(function(n){var i=typeof n=="object"&&n&&n.Object===Object&&n;r.exports=i}).call(this,t(45))},function(r,e){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch{typeof window=="object"&&(t=window)}r.exports=t},function(r,e,t){var n=t(93),i=t(100),o=t(102),s=t(103),a=t(104);function l(c){var d=-1,u=c==null?0:c.length;for(this.clear();++d<u;){var h=c[d];this.set(h[0],h[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=a,r.exports=l},function(r,e,t){var n=t(36),i=t(26);r.exports=function(o,s,a){(a!==void 0&&!i(o[s],a)||a===void 0&&!(s in o))&&n(o,s,a)}},function(r,e,t){var n=t(34),i=function(){try{var o=n(Object,"defineProperty");return o({},"",{}),o}catch{}}();r.exports=i},function(r,e,t){var n=t(115)(Object.getPrototypeOf,Object);r.exports=n},function(r,e){var t=Object.prototype;r.exports=function(n){var i=n&&n.constructor;return n===(typeof i=="function"&&i.prototype||t)}},function(r,e,t){(function(n){var i=t(19),o=t(118),s=e&&!e.nodeType&&e,a=s&&typeof n=="object"&&n&&!n.nodeType&&n,l=a&&a.exports===s?i.Buffer:void 0,c=(l?l.isBuffer:void 0)||o;n.exports=c}).call(this,t(37)(r))},function(r,e,t){var n=t(120),i=t(121),o=t(122),s=o&&o.isTypedArray,a=s?i(s):n;r.exports=a},function(r,e){r.exports=function(t,n){if((n!=="constructor"||typeof t[n]!="function")&&n!="__proto__")return t[n]}},function(r,e,t){var n=t(36),i=t(26),o=Object.prototype.hasOwnProperty;r.exports=function(s,a,l){var c=s[a];o.call(s,a)&&i(c,l)&&(l!==void 0||a in s)||n(s,a,l)}},function(r,e,t){var n=t(125),i=t(127),o=t(38);r.exports=function(s){return o(s)?n(s,!0):i(s)}},function(r,e){r.exports=function(t){return t}},function(r,e,t){var n=t(131),i=Math.max;r.exports=function(o,s,a){return s=i(s===void 0?o.length-1:s,0),function(){for(var l=arguments,c=-1,d=i(l.length-s,0),u=Array(d);++c<d;)u[c]=l[s+c];c=-1;for(var h=Array(s+1);++c<s;)h[c]=l[c];return h[s]=a(u),n(o,this,h)}}},function(r,e,t){var n=t(132),i=t(134)(n);r.exports=i},function(r,e,t){var n=t(60);r.exports=function(i,o){if(i){if(typeof i=="string")return n(i,o);var s=Object.prototype.toString.call(i).slice(8,-1);return s==="Object"&&i.constructor&&(s=i.constructor.name),s==="Map"||s==="Set"?Array.from(i):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(i,o):void 0}},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(t,n){(n==null||n>t.length)&&(n=t.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=t[i];return o},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(13).default,i=t(140);r.exports=function(o){var s=i(o,"string");return n(s)==="symbol"?s:String(s)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(137),i=t(138),o=t(59),s=t(139);r.exports=function(a,l){return n(a)||i(a,l)||o(a,l)||s()},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(146),i=t(160)(function(o,s){return o==null?{}:n(o,s)});r.exports=i},function(r,e,t){var n=t(2),i=t(40),o=t(165),s=t(166);function a(l){var c=typeof Map=="function"?new Map:void 0;return r.exports=a=function(d){if(d===null||!o(d))return d;if(typeof d!="function")throw new TypeError("Super expression must either be null or a function");if(c!==void 0){if(c.has(d))return c.get(d);c.set(d,u)}function u(){return s(d,arguments,n(this).constructor)}return u.prototype=Object.create(d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),i(u,d)},r.exports.__esModule=!0,r.exports.default=r.exports,a(l)}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){"use strict";var n=t(21),i={createContour2D:function(){return{dir:null,index:null,firstVertex:null,insideContours:null,nextpeer:null,prevpeer:null}},CONTOUR_DIR:{CW_DIR:0,CCW_DIR:1,UNKNOWN_DIR:2},DIR:{OUTSIDE_EDGE:-32767,INSIDE_EDGE:-32766},create:function(o,s){var a=o.data,l=s.data,c=o.size.x,d=o.size.y,u=n.a.create(o,s);return{rasterize:function(h){var g,v,x,L,E,P,S,w,T,V,B,W,M=[],q=0;for(W=0;W<400;W++)M[W]=0;for(M[0]=a[0],T=null,P=1;P<d-1;P++)for(L=0,v=M[0],E=1;E<c-1;E++)if(l[B=P*c+E]===0)if((g=a[B])!==v){if(L===0)M[x=q+1]=g,v=g,(S=u.contourTracing(P,E,x,g,i.DIR.OUTSIDE_EDGE))!==null&&(q++,L=x,(w=i.createContour2D()).dir=i.CONTOUR_DIR.CW_DIR,w.index=L,w.firstVertex=S,w.nextpeer=T,w.insideContours=null,T!==null&&(T.prevpeer=w),T=w);else if((S=u.contourTracing(P,E,i.DIR.INSIDE_EDGE,g,L))!==null){for((w=i.createContour2D()).firstVertex=S,w.insideContours=null,w.dir=h===0?i.CONTOUR_DIR.CCW_DIR:i.CONTOUR_DIR.CW_DIR,w.index=h,V=T;V!==null&&V.index!==L;)V=V.nextpeer;V!==null&&(w.nextpeer=V.insideContours,V.insideContours!==null&&(V.insideContours.prevpeer=w),V.insideContours=w)}}else l[B]=L;else l[B]===i.DIR.OUTSIDE_EDGE||l[B]===i.DIR.INSIDE_EDGE?(L=0,v=l[B]===i.DIR.INSIDE_EDGE?a[B]:M[0]):v=M[L=l[B]];for(V=T;V!==null;)V.index=h,V=V.nextpeer;return{cc:T,count:q}},debug:{drawContour:function(h,g){var v,x,L,E=h.getContext("2d"),P=g;for(E.strokeStyle="red",E.fillStyle="red",E.lineWidth=1,v=P!==null?P.insideContours:null;P!==null;){switch(v!==null?(x=v,v=v.nextpeer):(x=P,v=(P=P.nextpeer)!==null?P.insideContours:null),x.dir){case i.CONTOUR_DIR.CW_DIR:E.strokeStyle="red";break;case i.CONTOUR_DIR.CCW_DIR:E.strokeStyle="blue";break;case i.CONTOUR_DIR.UNKNOWN_DIR:E.strokeStyle="green"}L=x.firstVertex,E.beginPath(),E.moveTo(L.x,L.y);do L=L.next,E.lineTo(L.x,L.y);while(L!==x.firstVertex);E.stroke()}}}}}};e.a=i},function(r,e,t){"use strict";e.a=function(n,i,o){var s=new n.Uint8Array(o),a=i.size|0,l=n.Math.imul;function c(P,S){P|=0,S|=0;var w=0,T=0,V=0,B=0,W=0,M=0,q=0,U=0;for(w=1;(w|0)<(a-1|0);w=w+1|0)for(U=U+a|0,T=1;(T|0)<(a-1|0);T=T+1|0)B=U-a|0,W=U+a|0,M=T-1|0,q=T+1|0,V=(s[P+B+M|0]|0)+(s[P+B+q|0]|0)+(s[P+U+T|0]|0)+(s[P+W+M|0]|0)+(s[P+W+q|0]|0)|0,(V|0)==5?s[S+U+T|0]=1:s[S+U+T|0]=0}function d(P,S,w){P|=0,S|=0,w|=0;var T=0;for(T=l(a,a)|0;(T|0)>0;)T=T-1|0,s[w+T|0]=(s[P+T|0]|0)-(s[S+T|0]|0)|0}function u(P,S,w){P|=0,S|=0,w|=0;var T=0;for(T=l(a,a)|0;(T|0)>0;)T=T-1|0,s[w+T|0]=s[P+T|0]|0|(s[S+T|0]|0)|0}function h(P){P|=0;var S=0,w=0;for(w=l(a,a)|0;(w|0)>0;)w=w-1|0,S=(S|0)+(s[P+w|0]|0)|0;return S|0}function g(P,S){P|=0,S|=0;var w=0;for(w=l(a,a)|0;(w|0)>0;)w=w-1|0,s[P+w|0]=S}function v(P,S){P|=0,S|=0;var w=0,T=0,V=0,B=0,W=0,M=0,q=0,U=0;for(w=1;(w|0)<(a-1|0);w=w+1|0)for(U=U+a|0,T=1;(T|0)<(a-1|0);T=T+1|0)B=U-a|0,W=U+a|0,M=T-1|0,q=T+1|0,V=(s[P+B+M|0]|0)+(s[P+B+q|0]|0)+(s[P+U+T|0]|0)+(s[P+W+M|0]|0)+(s[P+W+q|0]|0)|0,(V|0)>0?s[S+U+T|0]=1:s[S+U+T|0]=0}function x(P,S){P|=0,S|=0;var w=0;for(w=l(a,a)|0;(w|0)>0;)w=w-1|0,s[S+w|0]=s[P+w|0]|0}function L(P){P|=0;var S=0,w=0;for(S=0;(S|0)<(a-1|0);S=S+1|0)s[P+S|0]=0,s[P+w|0]=0,w=w+a-1|0,s[P+w|0]=0,w=w+1|0;for(S=0;(S|0)<(a|0);S=S+1|0)s[P+w|0]=0,w=w+1|0}function E(){var P=0,S=0,w=0,T=0,V=0,B=0;S=l(a,a)|0,w=S+S|0,T=w+S|0,g(T,0),L(P);do c(P,S),v(S,w),d(P,w,w),u(T,w,T),x(S,P),V=h(P)|0,B=(V|0)==0|0;while(!B)}return{skeletonize:E}}},,,,,,,function(r,e,t){r.exports=t(168)},function(r,e,t){var n=t(75),i=t(47),o=t(105),s=t(107),a=t(15),l=t(55),c=t(53);r.exports=function d(u,h,g,v,x){u!==h&&o(h,function(L,E){if(x||(x=new n),a(L))s(u,h,E,g,d,v,x);else{var P=v?v(c(u,E),L,E+"",u,h,x):void 0;P===void 0&&(P=L),i(u,E,P)}},l)}},function(r,e,t){var n=t(24),i=t(81),o=t(82),s=t(83),a=t(84),l=t(85);function c(d){var u=this.__data__=new n(d);this.size=u.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=l,r.exports=c},function(r,e){r.exports=function(){this.__data__=[],this.size=0}},function(r,e,t){var n=t(25),i=Array.prototype.splice;r.exports=function(o){var s=this.__data__,a=n(s,o);return!(a<0)&&(a==s.length-1?s.pop():i.call(s,a,1),--this.size,!0)}},function(r,e,t){var n=t(25);r.exports=function(i){var o=this.__data__,s=n(o,i);return s<0?void 0:o[s][1]}},function(r,e,t){var n=t(25);r.exports=function(i){return n(this.__data__,i)>-1}},function(r,e,t){var n=t(25);r.exports=function(i,o){var s=this.__data__,a=n(s,i);return a<0?(++this.size,s.push([i,o])):s[a][1]=o,this}},function(r,e,t){var n=t(24);r.exports=function(){this.__data__=new n,this.size=0}},function(r,e){r.exports=function(t){var n=this.__data__,i=n.delete(t);return this.size=n.size,i}},function(r,e){r.exports=function(t){return this.__data__.get(t)}},function(r,e){r.exports=function(t){return this.__data__.has(t)}},function(r,e,t){var n=t(24),i=t(43),o=t(46);r.exports=function(s,a){var l=this.__data__;if(l instanceof n){var c=l.__data__;if(!i||c.length<199)return c.push([s,a]),this.size=++l.size,this;l=this.__data__=new o(c)}return l.set(s,a),this.size=l.size,this}},function(r,e,t){var n=t(35),i=t(89),o=t(15),s=t(91),a=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,u=c.hasOwnProperty,h=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");r.exports=function(g){return!(!o(g)||i(g))&&(n(g)?h:a).test(s(g))}},function(r,e,t){var n=t(27),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=n?n.toStringTag:void 0;r.exports=function(l){var c=o.call(l,a),d=l[a];try{l[a]=void 0;var u=!0}catch{}var h=s.call(l);return u&&(c?l[a]=d:delete l[a]),h}},function(r,e){var t=Object.prototype.toString;r.exports=function(n){return t.call(n)}},function(r,e,t){var n,i=t(90),o=(n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";r.exports=function(s){return!!o&&o in s}},function(r,e,t){var n=t(19)["__core-js_shared__"];r.exports=n},function(r,e){var t=Function.prototype.toString;r.exports=function(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}},function(r,e){r.exports=function(t,n){return t?.[n]}},function(r,e,t){var n=t(94),i=t(24),o=t(43);r.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||i),string:new n}}},function(r,e,t){var n=t(95),i=t(96),o=t(97),s=t(98),a=t(99);function l(c){var d=-1,u=c==null?0:c.length;for(this.clear();++d<u;){var h=c[d];this.set(h[0],h[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=a,r.exports=l},function(r,e,t){var n=t(28);r.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(r,e){r.exports=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}},function(r,e,t){var n=t(28),i=Object.prototype.hasOwnProperty;r.exports=function(o){var s=this.__data__;if(n){var a=s[o];return a==="__lodash_hash_undefined__"?void 0:a}return i.call(s,o)?s[o]:void 0}},function(r,e,t){var n=t(28),i=Object.prototype.hasOwnProperty;r.exports=function(o){var s=this.__data__;return n?s[o]!==void 0:i.call(s,o)}},function(r,e,t){var n=t(28);r.exports=function(i,o){var s=this.__data__;return this.size+=this.has(i)?0:1,s[i]=n&&o===void 0?"__lodash_hash_undefined__":o,this}},function(r,e,t){var n=t(29);r.exports=function(i){var o=n(this,i).delete(i);return this.size-=o?1:0,o}},function(r,e){r.exports=function(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}},function(r,e,t){var n=t(29);r.exports=function(i){return n(this,i).get(i)}},function(r,e,t){var n=t(29);r.exports=function(i){return n(this,i).has(i)}},function(r,e,t){var n=t(29);r.exports=function(i,o){var s=n(this,i),a=s.size;return s.set(i,o),this.size+=s.size==a?0:1,this}},function(r,e,t){var n=t(106)();r.exports=n},function(r,e){r.exports=function(t){return function(n,i,o){for(var s=-1,a=Object(n),l=o(n),c=l.length;c--;){var d=l[t?c:++s];if(i(a[d],d,a)===!1)break}return n}}},function(r,e,t){var n=t(47),i=t(108),o=t(109),s=t(112),a=t(113),l=t(30),c=t(16),d=t(117),u=t(51),h=t(35),g=t(15),v=t(119),x=t(52),L=t(53),E=t(123);r.exports=function(P,S,w,T,V,B,W){var M=L(P,w),q=L(S,w),U=W.get(q);if(U)n(P,w,U);else{var ee=B?B(M,q,w+"",P,S,W):void 0,ie=ee===void 0;if(ie){var re=c(q),ae=!re&&u(q),he=!re&&!ae&&x(q);ee=q,re||ae||he?c(M)?ee=M:d(M)?ee=s(M):ae?(ie=!1,ee=i(q,!0)):he?(ie=!1,ee=o(q,!0)):ee=[]:v(q)||l(q)?(ee=M,l(M)?ee=E(M):g(M)&&!h(M)||(ee=a(q))):ie=!1}ie&&(W.set(q,ee),V(ee,q,T,B,W),W.delete(q)),n(P,w,ee)}}},function(r,e,t){(function(n){var i=t(19),o=e&&!e.nodeType&&e,s=o&&typeof n=="object"&&n&&!n.nodeType&&n,a=s&&s.exports===o?i.Buffer:void 0,l=a?a.allocUnsafe:void 0;n.exports=function(c,d){if(d)return c.slice();var u=c.length,h=l?l(u):new c.constructor(u);return c.copy(h),h}}).call(this,t(37)(r))},function(r,e,t){var n=t(110);r.exports=function(i,o){var s=o?n(i.buffer):i.buffer;return new i.constructor(s,i.byteOffset,i.length)}},function(r,e,t){var n=t(111);r.exports=function(i){var o=new i.constructor(i.byteLength);return new n(o).set(new n(i)),o}},function(r,e,t){var n=t(19).Uint8Array;r.exports=n},function(r,e){r.exports=function(t,n){var i=-1,o=t.length;for(n||(n=Array(o));++i<o;)n[i]=t[i];return n}},function(r,e,t){var n=t(114),i=t(49),o=t(50);r.exports=function(s){return typeof s.constructor!="function"||o(s)?{}:n(i(s))}},function(r,e,t){var n=t(15),i=Object.create,o=function(){function s(){}return function(a){if(!n(a))return{};if(i)return i(a);s.prototype=a;var l=new s;return s.prototype=void 0,l}}();r.exports=o},function(r,e){r.exports=function(t,n){return function(i){return t(n(i))}}},function(r,e,t){var n=t(22),i=t(20);r.exports=function(o){return i(o)&&n(o)=="[object Arguments]"}},function(r,e,t){var n=t(38),i=t(20);r.exports=function(o){return i(o)&&n(o)}},function(r,e){r.exports=function(){return!1}},function(r,e,t){var n=t(22),i=t(49),o=t(20),s=Function.prototype,a=Object.prototype,l=s.toString,c=a.hasOwnProperty,d=l.call(Object);r.exports=function(u){if(!o(u)||n(u)!="[object Object]")return!1;var h=i(u);if(h===null)return!0;var g=c.call(h,"constructor")&&h.constructor;return typeof g=="function"&&g instanceof g&&l.call(g)==d}},function(r,e,t){var n=t(22),i=t(39),o=t(20),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,r.exports=function(a){return o(a)&&i(a.length)&&!!s[n(a)]}},function(r,e){r.exports=function(t){return function(n){return t(n)}}},function(r,e,t){(function(n){var i=t(44),o=e&&!e.nodeType&&e,s=o&&typeof n=="object"&&n&&!n.nodeType&&n,a=s&&s.exports===o&&i.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();n.exports=l}).call(this,t(37)(r))},function(r,e,t){var n=t(124),i=t(55);r.exports=function(o){return n(o,i(o))}},function(r,e,t){var n=t(54),i=t(36);r.exports=function(o,s,a,l){var c=!a;a||(a={});for(var d=-1,u=s.length;++d<u;){var h=s[d],g=l?l(a[h],o[h],h,a,o):void 0;g===void 0&&(g=o[h]),c?i(a,h,g):n(a,h,g)}return a}},function(r,e,t){var n=t(126),i=t(30),o=t(16),s=t(51),a=t(31),l=t(52),c=Object.prototype.hasOwnProperty;r.exports=function(d,u){var h=o(d),g=!h&&i(d),v=!h&&!g&&s(d),x=!h&&!g&&!v&&l(d),L=h||g||v||x,E=L?n(d.length,String):[],P=E.length;for(var S in d)!u&&!c.call(d,S)||L&&(S=="length"||v&&(S=="offset"||S=="parent")||x&&(S=="buffer"||S=="byteLength"||S=="byteOffset")||a(S,P))||E.push(S);return E}},function(r,e){r.exports=function(t,n){for(var i=-1,o=Array(t);++i<t;)o[i]=n(i);return o}},function(r,e,t){var n=t(15),i=t(50),o=t(128),s=Object.prototype.hasOwnProperty;r.exports=function(a){if(!n(a))return o(a);var l=i(a),c=[];for(var d in a)(d!="constructor"||!l&&s.call(a,d))&&c.push(d);return c}},function(r,e){r.exports=function(t){var n=[];if(t!=null)for(var i in Object(t))n.push(i);return n}},function(r,e,t){var n=t(130),i=t(135);r.exports=function(o){return n(function(s,a){var l=-1,c=a.length,d=c>1?a[c-1]:void 0,u=c>2?a[2]:void 0;for(d=o.length>3&&typeof d=="function"?(c--,d):void 0,u&&i(a[0],a[1],u)&&(d=c<3?void 0:d,c=1),s=Object(s);++l<c;){var h=a[l];h&&o(s,h,l,d)}return s})}},function(r,e,t){var n=t(56),i=t(57),o=t(58);r.exports=function(s,a){return o(i(s,a,n),s+"")}},function(r,e){r.exports=function(t,n,i){switch(i.length){case 0:return t.call(n);case 1:return t.call(n,i[0]);case 2:return t.call(n,i[0],i[1]);case 3:return t.call(n,i[0],i[1],i[2])}return t.apply(n,i)}},function(r,e,t){var n=t(133),i=t(48),o=t(56),s=i?function(a,l){return i(a,"toString",{configurable:!0,enumerable:!1,value:n(l),writable:!0})}:o;r.exports=s},function(r,e){r.exports=function(t){return function(){return t}}},function(r,e){var t=Date.now;r.exports=function(n){var i=0,o=0;return function(){var s=t(),a=16-(s-o);if(o=s,a>0){if(++i>=800)return arguments[0]}else i=0;return n.apply(void 0,arguments)}}},function(r,e,t){var n=t(26),i=t(38),o=t(31),s=t(15);r.exports=function(a,l,c){if(!s(c))return!1;var d=typeof l;return!!(d=="number"?i(c)&&o(l,c.length):d=="string"&&l in c)&&n(c[l],a)}},function(r,e){typeof window<"u"&&(window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)})),typeof Math.imul!="function"&&(Math.imul=function(t,n){var i=65535&t,o=65535&n;return i*o+((t>>>16&65535)*o+i*(n>>>16&65535)<<16>>>0)|0}),typeof Object.assign!="function"&&(Object.assign=function(t){"use strict";if(t===null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var o=arguments[i];if(o!==null)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])}return n})},function(r,e){r.exports=function(t){if(Array.isArray(t))return t},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(t,n){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var o,s,a,l,c=[],d=!0,u=!1;try{if(a=(i=i.call(t)).next,n===0){if(Object(i)!==i)return;d=!1}else for(;!(d=(o=a.call(i)).done)&&(c.push(o.value),c.length!==n);d=!0);}catch(h){u=!0,s=h}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw s}}return c}},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(13).default;r.exports=function(i,o){if(n(i)!=="object"||i===null)return i;var s=i[Symbol.toPrimitive];if(s!==void 0){var a=s.call(i,o||"default");if(n(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(13).default;function i(){"use strict";r.exports=i=function(){return s},r.exports.__esModule=!0,r.exports.default=r.exports;var o,s={},a=Object.prototype,l=a.hasOwnProperty,c=Object.defineProperty||function(Y,K,te){Y[K]=te.value},d=typeof Symbol=="function"?Symbol:{},u=d.iterator||"@@iterator",h=d.asyncIterator||"@@asyncIterator",g=d.toStringTag||"@@toStringTag";function v(Y,K,te){return Object.defineProperty(Y,K,{value:te,enumerable:!0,configurable:!0,writable:!0}),Y[K]}try{v({},"")}catch{v=function(K,te,xe){return K[te]=xe}}function x(Y,K,te,xe){var Ce=K&&K.prototype instanceof T?K:T,Ne=Object.create(Ce.prototype),Re=new ne(xe||[]);return c(Ne,"_invoke",{value:re(Y,te,Re)}),Ne}function L(Y,K,te){try{return{type:"normal",arg:Y.call(K,te)}}catch(xe){return{type:"throw",arg:xe}}}s.wrap=x;var E="suspendedStart",P="executing",S="completed",w={};function T(){}function V(){}function B(){}var W={};v(W,u,function(){return this});var M=Object.getPrototypeOf,q=M&&M(M(Oe([])));q&&q!==a&&l.call(q,u)&&(W=q);var U=B.prototype=T.prototype=Object.create(W);function ee(Y){["next","throw","return"].forEach(function(K){v(Y,K,function(te){return this._invoke(K,te)})})}function ie(Y,K){function te(Ce,Ne,Re,Ie){var Qe=L(Y[Ce],Y,Ne);if(Qe.type!=="throw"){var _t=Qe.arg,jt=_t.value;return jt&&n(jt)=="object"&&l.call(jt,"__await")?K.resolve(jt.__await).then(function(Gt){te("next",Gt,Re,Ie)},function(Gt){te("throw",Gt,Re,Ie)}):K.resolve(jt).then(function(Gt){_t.value=Gt,Re(_t)},function(Gt){return te("throw",Gt,Re,Ie)})}Ie(Qe.arg)}var xe;c(this,"_invoke",{value:function(Ce,Ne){function Re(){return new K(function(Ie,Qe){te(Ce,Ne,Ie,Qe)})}return xe=xe?xe.then(Re,Re):Re()}})}function re(Y,K,te){var xe=E;return function(Ce,Ne){if(xe===P)throw new Error("Generator is already running");if(xe===S){if(Ce==="throw")throw Ne;return{value:o,done:!0}}for(te.method=Ce,te.arg=Ne;;){var Re=te.delegate;if(Re){var Ie=ae(Re,te);if(Ie){if(Ie===w)continue;return Ie}}if(te.method==="next")te.sent=te._sent=te.arg;else if(te.method==="throw"){if(xe===E)throw xe=S,te.arg;te.dispatchException(te.arg)}else te.method==="return"&&te.abrupt("return",te.arg);xe=P;var Qe=L(Y,K,te);if(Qe.type==="normal"){if(xe=te.done?S:"suspendedYield",Qe.arg===w)continue;return{value:Qe.arg,done:te.done}}Qe.type==="throw"&&(xe=S,te.method="throw",te.arg=Qe.arg)}}}function ae(Y,K){var te=K.method,xe=Y.iterator[te];if(xe===o)return K.delegate=null,te==="throw"&&Y.iterator.return&&(K.method="return",K.arg=o,ae(Y,K),K.method==="throw")||te!=="return"&&(K.method="throw",K.arg=new TypeError("The iterator does not provide a '"+te+"' method")),w;var Ce=L(xe,Y.iterator,K.arg);if(Ce.type==="throw")return K.method="throw",K.arg=Ce.arg,K.delegate=null,w;var Ne=Ce.arg;return Ne?Ne.done?(K[Y.resultName]=Ne.value,K.next=Y.nextLoc,K.method!=="return"&&(K.method="next",K.arg=o),K.delegate=null,w):Ne:(K.method="throw",K.arg=new TypeError("iterator result is not an object"),K.delegate=null,w)}function he(Y){var K={tryLoc:Y[0]};1 in Y&&(K.catchLoc=Y[1]),2 in Y&&(K.finallyLoc=Y[2],K.afterLoc=Y[3]),this.tryEntries.push(K)}function Z(Y){var K=Y.completion||{};K.type="normal",delete K.arg,Y.completion=K}function ne(Y){this.tryEntries=[{tryLoc:"root"}],Y.forEach(he,this),this.reset(!0)}function Oe(Y){if(Y||Y===""){var K=Y[u];if(K)return K.call(Y);if(typeof Y.next=="function")return Y;if(!isNaN(Y.length)){var te=-1,xe=function Ce(){for(;++te<Y.length;)if(l.call(Y,te))return Ce.value=Y[te],Ce.done=!1,Ce;return Ce.value=o,Ce.done=!0,Ce};return xe.next=xe}}throw new TypeError(n(Y)+" is not iterable")}return V.prototype=B,c(U,"constructor",{value:B,configurable:!0}),c(B,"constructor",{value:V,configurable:!0}),V.displayName=v(B,g,"GeneratorFunction"),s.isGeneratorFunction=function(Y){var K=typeof Y=="function"&&Y.constructor;return!!K&&(K===V||(K.displayName||K.name)==="GeneratorFunction")},s.mark=function(Y){return Object.setPrototypeOf?Object.setPrototypeOf(Y,B):(Y.__proto__=B,v(Y,g,"GeneratorFunction")),Y.prototype=Object.create(U),Y},s.awrap=function(Y){return{__await:Y}},ee(ie.prototype),v(ie.prototype,h,function(){return this}),s.AsyncIterator=ie,s.async=function(Y,K,te,xe,Ce){Ce===void 0&&(Ce=Promise);var Ne=new ie(x(Y,K,te,xe),Ce);return s.isGeneratorFunction(K)?Ne:Ne.next().then(function(Re){return Re.done?Re.value:Ne.next()})},ee(U),v(U,g,"Generator"),v(U,u,function(){return this}),v(U,"toString",function(){return"[object Generator]"}),s.keys=function(Y){var K=Object(Y),te=[];for(var xe in K)te.push(xe);return te.reverse(),function Ce(){for(;te.length;){var Ne=te.pop();if(Ne in K)return Ce.value=Ne,Ce.done=!1,Ce}return Ce.done=!0,Ce}},s.values=Oe,ne.prototype={constructor:ne,reset:function(Y){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(Z),!Y)for(var K in this)K.charAt(0)==="t"&&l.call(this,K)&&!isNaN(+K.slice(1))&&(this[K]=o)},stop:function(){this.done=!0;var Y=this.tryEntries[0].completion;if(Y.type==="throw")throw Y.arg;return this.rval},dispatchException:function(Y){if(this.done)throw Y;var K=this;function te(Qe,_t){return Ne.type="throw",Ne.arg=Y,K.next=Qe,_t&&(K.method="next",K.arg=o),!!_t}for(var xe=this.tryEntries.length-1;xe>=0;--xe){var Ce=this.tryEntries[xe],Ne=Ce.completion;if(Ce.tryLoc==="root")return te("end");if(Ce.tryLoc<=this.prev){var Re=l.call(Ce,"catchLoc"),Ie=l.call(Ce,"finallyLoc");if(Re&&Ie){if(this.prev<Ce.catchLoc)return te(Ce.catchLoc,!0);if(this.prev<Ce.finallyLoc)return te(Ce.finallyLoc)}else if(Re){if(this.prev<Ce.catchLoc)return te(Ce.catchLoc,!0)}else{if(!Ie)throw new Error("try statement without catch or finally");if(this.prev<Ce.finallyLoc)return te(Ce.finallyLoc)}}}},abrupt:function(Y,K){for(var te=this.tryEntries.length-1;te>=0;--te){var xe=this.tryEntries[te];if(xe.tryLoc<=this.prev&&l.call(xe,"finallyLoc")&&this.prev<xe.finallyLoc){var Ce=xe;break}}Ce&&(Y==="break"||Y==="continue")&&Ce.tryLoc<=K&&K<=Ce.finallyLoc&&(Ce=null);var Ne=Ce?Ce.completion:{};return Ne.type=Y,Ne.arg=K,Ce?(this.method="next",this.next=Ce.finallyLoc,w):this.complete(Ne)},complete:function(Y,K){if(Y.type==="throw")throw Y.arg;return Y.type==="break"||Y.type==="continue"?this.next=Y.arg:Y.type==="return"?(this.rval=this.arg=Y.arg,this.method="return",this.next="end"):Y.type==="normal"&&K&&(this.next=K),w},finish:function(Y){for(var K=this.tryEntries.length-1;K>=0;--K){var te=this.tryEntries[K];if(te.finallyLoc===Y)return this.complete(te.completion,te.afterLoc),Z(te),w}},catch:function(Y){for(var K=this.tryEntries.length-1;K>=0;--K){var te=this.tryEntries[K];if(te.tryLoc===Y){var xe=te.completion;if(xe.type==="throw"){var Ce=xe.arg;Z(te)}return Ce}}throw new Error("illegal catch attempt")},delegateYield:function(Y,K,te){return this.delegate={iterator:Oe(Y),resultName:K,nextLoc:te},this.method==="next"&&(this.arg=o),w}},s}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(2);r.exports=function(i,o){for(;!Object.prototype.hasOwnProperty.call(i,o)&&(i=n(i))!==null;);return i},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(60);r.exports=function(i){if(Array.isArray(i))return n(i)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(147),i=t(157);r.exports=function(o,s){return n(o,s,function(a,l){return i(o,l)})}},function(r,e,t){var n=t(148),i=t(156),o=t(32);r.exports=function(s,a,l){for(var c=-1,d=a.length,u={};++c<d;){var h=a[c],g=n(s,h);l(g,h)&&i(u,o(h,s),g)}return u}},function(r,e,t){var n=t(32),i=t(42);r.exports=function(o,s){for(var a=0,l=(s=n(s,o)).length;o!=null&&a<l;)o=o[i(s[a++])];return a&&a==l?o:void 0}},function(r,e,t){var n=t(16),i=t(41),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;r.exports=function(a,l){if(n(a))return!1;var c=typeof a;return!(c!="number"&&c!="symbol"&&c!="boolean"&&a!=null&&!i(a))||s.test(a)||!o.test(a)||l!=null&&a in Object(l)}},function(r,e,t){var n=t(151),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=n(function(a){var l=[];return a.charCodeAt(0)===46&&l.push(""),a.replace(i,function(c,d,u,h){l.push(u?h.replace(o,"$1"):d||c)}),l});r.exports=s},function(r,e,t){var n=t(152);r.exports=function(i){var o=n(i,function(a){return s.size===500&&s.clear(),a}),s=o.cache;return o}},function(r,e,t){var n=t(46);function i(o,s){if(typeof o!="function"||s!=null&&typeof s!="function")throw new TypeError("Expected a function");var a=function(){var l=arguments,c=s?s.apply(this,l):l[0],d=a.cache;if(d.has(c))return d.get(c);var u=o.apply(this,l);return a.cache=d.set(c,u)||d,u};return a.cache=new(i.Cache||n),a}i.Cache=n,r.exports=i},function(r,e,t){var n=t(154);r.exports=function(i){return i==null?"":n(i)}},function(r,e,t){var n=t(27),i=t(155),o=t(16),s=t(41),a=n?n.prototype:void 0,l=a?a.toString:void 0;r.exports=function c(d){if(typeof d=="string")return d;if(o(d))return i(d,c)+"";if(s(d))return l?l.call(d):"";var u=d+"";return u=="0"&&1/d==-1/0?"-0":u}},function(r,e){r.exports=function(t,n){for(var i=-1,o=t==null?0:t.length,s=Array(o);++i<o;)s[i]=n(t[i],i,t);return s}},function(r,e,t){var n=t(54),i=t(32),o=t(31),s=t(15),a=t(42);r.exports=function(l,c,d,u){if(!s(l))return l;for(var h=-1,g=(c=i(c,l)).length,v=g-1,x=l;x!=null&&++h<g;){var L=a(c[h]),E=d;if(L==="__proto__"||L==="constructor"||L==="prototype")return l;if(h!=v){var P=x[L];(E=u?u(P,L,x):void 0)===void 0&&(E=s(P)?P:o(c[h+1])?[]:{})}n(x,L,E),x=x[L]}return l}},function(r,e,t){var n=t(158),i=t(159);r.exports=function(o,s){return o!=null&&i(o,s,n)}},function(r,e){r.exports=function(t,n){return t!=null&&n in Object(t)}},function(r,e,t){var n=t(32),i=t(30),o=t(16),s=t(31),a=t(39),l=t(42);r.exports=function(c,d,u){for(var h=-1,g=(d=n(d,c)).length,v=!1;++h<g;){var x=l(d[h]);if(!(v=c!=null&&u(c,x)))break;c=c[x]}return v||++h!=g?v:!!(g=c==null?0:c.length)&&a(g)&&s(x,g)&&(o(c)||i(c))}},function(r,e,t){var n=t(161),i=t(57),o=t(58);r.exports=function(s){return o(i(s,void 0,n),s+"")}},function(r,e,t){var n=t(162);r.exports=function(i){return i!=null&&i.length?n(i,1):[]}},function(r,e,t){var n=t(163),i=t(164);r.exports=function o(s,a,l,c,d){var u=-1,h=s.length;for(l||(l=i),d||(d=[]);++u<h;){var g=s[u];a>0&&l(g)?a>1?o(g,a-1,l,c,d):n(d,g):c||(d[d.length]=g)}return d}},function(r,e){r.exports=function(t,n){for(var i=-1,o=n.length,s=t.length;++i<o;)t[s+i]=n[i];return t}},function(r,e,t){var n=t(27),i=t(30),o=t(16),s=n?n.isConcatSpreadable:void 0;r.exports=function(a){return o(a)||i(a)||!!(s&&a&&a[s])}},function(r,e){r.exports=function(t){try{return Function.toString.call(t).indexOf("[native code]")!==-1}catch{return typeof t=="function"}},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){var n=t(40),i=t(167);function o(s,a,l){return i()?(r.exports=o=Reflect.construct.bind(),r.exports.__esModule=!0,r.exports.default=r.exports):(r.exports=o=function(c,d,u){var h=[null];h.push.apply(h,d);var g=new(Function.bind.apply(c,h));return u&&n(g,u.prototype),g},r.exports.__esModule=!0,r.exports.default=r.exports),o.apply(null,arguments)}r.exports=o,r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e){r.exports=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}},r.exports.__esModule=!0,r.exports.default=r.exports},function(r,e,t){"use strict";t.r(e),t.d(e,"BarcodeDecoder",function(){return Hr}),t.d(e,"Readers",function(){return n}),t.d(e,"CameraAccess",function(){return Zi}),t.d(e,"ImageDebug",function(){return g.a}),t.d(e,"ImageWrapper",function(){return l.a}),t.d(e,"ResultCollector",function(){return xs});var n={};t.r(n),t.d(n,"BarcodeReader",function(){return re}),t.d(n,"TwoOfFiveReader",function(){return Y}),t.d(n,"NewCodabarReader",function(){return Ne}),t.d(n,"Code128Reader",function(){return Ie}),t.d(n,"Code32Reader",function(){return Qo}),t.d(n,"Code39Reader",function(){return Qi}),t.d(n,"Code39VINReader",function(){return Vr}),t.d(n,"Code93Reader",function(){return ns}),t.d(n,"EAN2Reader",function(){return as}),t.d(n,"EAN5Reader",function(){return ls}),t.d(n,"EAN8Reader",function(){return cs}),t.d(n,"EANReader",function(){return Pn}),t.d(n,"I2of5Reader",function(){return ds}),t.d(n,"UPCEReader",function(){return hs}),t.d(n,"UPCReader",function(){return fs});var i=t(13),o=t.n(i),s=t(18),a=t.n(s),l=(t(136),t(11)),c=t(12),d=t.n(c),u=t(8),h=t.n(u),g=t(17),v=t(3),x=t.n(v),L=t(4),E=t.n(L),P=t(1),S=t.n(P),w=t(7),T=t.n(w),V=t(6),B=t.n(V),W=t(2),M=t.n(W),q=t(0),U=t.n(q),ee=t(9),ie=function(A){return A[A.Forward=1]="Forward",A[A.Reverse=-1]="Reverse",A}({}),re=function(){function A(N,y){x()(this,A),U()(this,"_row",[]),U()(this,"config",{}),U()(this,"supplements",[]),U()(this,"SINGLE_CODE_ERROR",0),U()(this,"FORMAT","unknown"),U()(this,"CONFIG_KEYS",{}),this._row=[],this.config=N||{},y&&(this.supplements=y)}return E()(A,[{key:"_nextUnset",value:function(N){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=y;f<N.length;f++)if(!N[f])return f;return N.length}},{key:"_matchPattern",value:function(N,y){for(var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.SINGLE_CODE_ERROR||1,p=0,m=0,b=0,O=0,F=0,k=0,j=0,$=0;$<N.length;$++)b+=N[$],O+=y[$];if(b<O)return Number.MAX_VALUE;f*=F=b/O;for(var le=0;le<N.length;le++){if(k=N[le],j=y[le]*F,(m=Math.abs(k-j)/j)>f)return Number.MAX_VALUE;p+=m}return p/O}},{key:"_nextSet",value:function(N){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=y;f<N.length;f++)if(N[f])return f;return N.length}},{key:"_correctBars",value:function(N,y,f){for(var p=f.length,m=0;p--;)(m=N[f[p]]*(1-(1-y)/2))>1&&(N[f[p]]=m)}},{key:"decodePattern",value:function(N){this._row=N;var y=this.decode();return y===null?(this._row.reverse(),(y=this.decode())&&(y.direction=ie.Reverse,y.start=this._row.length-y.start,y.end=this._row.length-y.end)):y.direction=ie.Forward,y&&(y.format=this.FORMAT),y}},{key:"_matchRange",value:function(N,y,f){var p;for(p=N=N<0?0:N;p<y;p++)if(this._row[p]!==f)return!1;return!0}},{key:"_fillCounters",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._nextUnset(this._row),y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._row.length,f=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],p=[],m=0;p[m]=0;for(var b=N;b<y;b++)this._row[b]^(f?1:0)?p[m]++:(p[++m]=1,f=!f);return p}},{key:"_toCounters",value:function(N,y){var f=y.length,p=this._row.length,m=!this._row[N],b=0;ee.a.init(y,0);for(var O=N;O<p;O++)if(this._row[O]^(m?1:0))y[b]++;else{if(++b===f)break;y[b]=1,m=!m}return y}},{key:"decodeImage",value:function(N){return null}}],[{key:"Exception",get:function(){return{StartNotFoundException:"Start-Info was not found!",CodeNotFoundException:"Code could not be found!",PatternNotFoundException:"Pattern could not be found!"}}}]),A}();function ae(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var he=[3,1,3,1,1,1],Z=[3,1,1,1,3],ne=[[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]],Oe=he.reduce(function(A,N){return A+N},0),Y=function(A){T()(y,A);var N=ae(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"barSpaceRatio",[1,1]),U()(S()(f),"FORMAT","2of5"),U()(S()(f),"SINGLE_CODE_ERROR",.78),U()(S()(f),"AVG_CODE_ERROR",.3),f}return E()(y,[{key:"_findPattern",value:function(f,p){var m=arguments.length>2&&arguments[2]!==void 0&&arguments[2],b=arguments.length>3&&arguments[3]!==void 0&&arguments[3],O=[],F=0,k={error:Number.MAX_VALUE,code:-1,start:0,end:0},j=0,$=0,le=this.AVG_CODE_ERROR;p||(p=this._nextSet(this._row));for(var me=0;me<f.length;me++)O[me]=0;for(var ue=p;ue<this._row.length;ue++)if(this._row[ue]^(m?1:0))O[F]++;else{if(F===O.length-1){j=0;for(var be=0;be<O.length;be++)j+=O[be];if(($=this._matchPattern(O,f))<le)return k.error=$,k.start=ue-j,k.end=ue,k;if(!b)return null;for(var Le=0;Le<O.length-2;Le++)O[Le]=O[Le+2];O[O.length-2]=0,O[O.length-1]=0,F--}else F++;O[F]=1,m=!m}return null}},{key:"_findStart",value:function(){for(var f=null,p=this._nextSet(this._row),m=1,b=0;!f;){if(!(f=this._findPattern(he,p,!1,!0)))return null;if(m=Math.floor((f.end-f.start)/Oe),(b=f.start-5*m)>=0&&this._matchRange(b,f.start,0))return f;p=f.end,f=null}return f}},{key:"_verifyTrailingWhitespace",value:function(f){var p=f.end+(f.end-f.start)/2;return p<this._row.length&&this._matchRange(f.end,p,0)?f:null}},{key:"_findEnd",value:function(){this._row.reverse();var f=this._nextSet(this._row),p=this._findPattern(Z,f,!1,!0);if(this._row.reverse(),p===null)return null;var m=p.start;return p.start=this._row.length-p.end,p.end=this._row.length-m,p!==null?this._verifyTrailingWhitespace(p):null}},{key:"_verifyCounterLength",value:function(f){return f.length%10==0}},{key:"_decodeCode",value:function(f){for(var p=this.AVG_CODE_ERROR,m={error:Number.MAX_VALUE,code:-1,start:0,end:0},b=0;b<ne.length;b++){var O=this._matchPattern(f,ne[b]);O<m.error&&(m.code=b,m.error=O)}return m.error<p?m:null}},{key:"_decodePayload",value:function(f,p,m){for(var b=0,O=f.length,F=[0,0,0,0,0],k=null;b<O;){for(var j=0;j<5;j++)F[j]=f[b]*this.barSpaceRatio[0],b+=2;if(!(k=this._decodeCode(F)))return null;p.push("".concat(k.code)),m.push(k)}return k}},{key:"decode",value:function(f,p){var m=this._findStart();if(!m)return null;var b=this._findEnd();if(!b)return null;var O=this._fillCounters(m.end,b.start,!1);if(!this._verifyCounterLength(O))return null;var F=[];F.push(m);var k=[];return this._decodePayload(O,k,F)?k.length<5?null:(F.push(b),{code:k.join(""),start:m.start,end:b.end,startInfo:m,decodedCodes:F,format:this.FORMAT}):null}}]),y}(re);function K(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var te=[48,49,50,51,52,53,54,55,56,57,45,36,58,47,46,43,65,66,67,68],xe=[3,6,9,96,18,66,33,36,48,72,12,24,69,81,84,21,26,41,11,14],Ce=[26,41,11,14],Ne=function(A){T()(y,A);var N=K(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"_counters",[]),U()(S()(f),"FORMAT","codabar"),f}return E()(y,[{key:"_computeAlternatingThreshold",value:function(f,p){for(var m=Number.MAX_VALUE,b=0,O=0,F=f;F<p;F+=2)(O=this._counters[F])>b&&(b=O),O<m&&(m=O);return(m+b)/2|0}},{key:"_toPattern",value:function(f){var p=f+7;if(p>this._counters.length)return-1;for(var m=this._computeAlternatingThreshold(f,p),b=this._computeAlternatingThreshold(f+1,p),O=64,F=0,k=0,j=0;j<7;j++)F=1&j?b:m,this._counters[f+j]>F&&(k|=O),O>>=1;return k}},{key:"_isStartEnd",value:function(f){for(var p=0;p<Ce.length;p++)if(Ce[p]===f)return!0;return!1}},{key:"_sumCounters",value:function(f,p){for(var m=0,b=f;b<p;b++)m+=this._counters[b];return m}},{key:"_findStart",value:function(){for(var f=this._nextUnset(this._row),p=1;p<this._counters.length;p++){var m=this._toPattern(p);if(m!==-1&&this._isStartEnd(m))return{start:f+=this._sumCounters(0,p),end:f+this._sumCounters(p,p+8),startCounter:p,endCounter:p+8}}return null}},{key:"_patternToChar",value:function(f){for(var p=0;p<xe.length;p++)if(xe[p]===f)return String.fromCharCode(te[p]);return null}},{key:"_calculatePatternLength",value:function(f){for(var p=0,m=f;m<f+7;m++)p+=this._counters[m];return p}},{key:"_verifyWhitespace",value:function(f,p){return(f-1<=0||this._counters[f-1]>=this._calculatePatternLength(f)/2)&&(p+8>=this._counters.length||this._counters[p+7]>=this._calculatePatternLength(p)/2)}},{key:"_charToPattern",value:function(f){for(var p=f.charCodeAt(0),m=0;m<te.length;m++)if(te[m]===p)return xe[m];return 0}},{key:"_thresholdResultPattern",value:function(f,p){for(var m,b={space:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}},bar:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}}},O=p,F=0;F<f.length;F++){m=this._charToPattern(f[F]);for(var k=6;k>=0;k--){var j=(1&k)==2?b.bar:b.space,$=(1&m)==1?j.wide:j.narrow;$.size+=this._counters[O+k],$.counts++,m>>=1}O+=8}return["space","bar"].forEach(function(le){var me=b[le];me.wide.min=Math.floor((me.narrow.size/me.narrow.counts+me.wide.size/me.wide.counts)/2),me.narrow.max=Math.ceil(me.wide.min),me.wide.max=Math.ceil((2*me.wide.size+1.5)/me.wide.counts)}),b}},{key:"_validateResult",value:function(f,p){for(var m,b=this._thresholdResultPattern(f,p),O=p,F=0;F<f.length;F++){m=this._charToPattern(f[F]);for(var k=6;k>=0;k--){var j=1&k?b.space:b.bar,$=(1&m)==1?j.wide:j.narrow,le=this._counters[O+k];if(le<$.min||le>$.max)return!1;m>>=1}O+=8}return!0}},{key:"decode",value:function(f,p){if(this._counters=this._fillCounters(),!(p=this._findStart()))return null;var m,b=p.startCounter,O=[];do{if((m=this._toPattern(b))<0)return null;var F=this._patternToChar(m);if(F===null)return null;if(O.push(F),b+=8,O.length>1&&this._isStartEnd(m))break}while(b<this._counters.length);if(O.length-2<4||!this._isStartEnd(m)||!this._verifyWhitespace(p.startCounter,b-8)||!this._validateResult(O,p.startCounter))return null;b=b>this._counters.length?this._counters.length:b;var k=p.start+this._sumCounters(p.startCounter,b-8);return{code:O.join(""),start:p.start,end:k,startInfo:p,decodedCodes:O,format:this.FORMAT}}}]),y}(re);function Re(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var Ie=function(A){T()(y,A);var N=Re(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"CODE_SHIFT",98),U()(S()(f),"CODE_C",99),U()(S()(f),"CODE_B",100),U()(S()(f),"CODE_A",101),U()(S()(f),"START_CODE_A",103),U()(S()(f),"START_CODE_B",104),U()(S()(f),"START_CODE_C",105),U()(S()(f),"STOP_CODE",106),U()(S()(f),"CODE_PATTERN",[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]]),U()(S()(f),"SINGLE_CODE_ERROR",.64),U()(S()(f),"AVG_CODE_ERROR",.3),U()(S()(f),"FORMAT","code_128"),U()(S()(f),"MODULE_INDICES",{bar:[0,2,4],space:[1,3,5]}),f}return E()(y,[{key:"_decodeCode",value:function(f,p){for(var m={error:Number.MAX_VALUE,code:-1,start:f,end:f,correction:{bar:1,space:1}},b=[0,0,0,0,0,0],O=f,F=!this._row[O],k=0,j=O;j<this._row.length;j++)if(this._row[j]^(F?1:0))b[k]++;else{if(k===b.length-1){p&&this._correct(b,p);for(var $=0;$<this.CODE_PATTERN.length;$++){var le=this._matchPattern(b,this.CODE_PATTERN[$]);le<m.error&&(m.code=$,m.error=le)}return m.end=j,m.code===-1||m.error>this.AVG_CODE_ERROR?null:(this.CODE_PATTERN[m.code]&&(m.correction.bar=this.calculateCorrection(this.CODE_PATTERN[m.code],b,this.MODULE_INDICES.bar),m.correction.space=this.calculateCorrection(this.CODE_PATTERN[m.code],b,this.MODULE_INDICES.space)),m)}b[++k]=1,F=!F}return null}},{key:"_correct",value:function(f,p){this._correctBars(f,p.bar,this.MODULE_INDICES.bar),this._correctBars(f,p.space,this.MODULE_INDICES.space)}},{key:"_findStart",value:function(){for(var f=[0,0,0,0,0,0],p=this._nextSet(this._row),m={error:Number.MAX_VALUE,code:-1,start:0,end:0,correction:{bar:1,space:1}},b=!1,O=0,F=p;F<this._row.length;F++)if(this._row[F]^(b?1:0))f[O]++;else{if(O===f.length-1){for(var k=f.reduce(function(me,ue){return me+ue},0),j=this.START_CODE_A;j<=this.START_CODE_C;j++){var $=this._matchPattern(f,this.CODE_PATTERN[j]);$<m.error&&(m.code=j,m.error=$)}if(m.error<this.AVG_CODE_ERROR)return m.start=F-k,m.end=F,m.correction.bar=this.calculateCorrection(this.CODE_PATTERN[m.code],f,this.MODULE_INDICES.bar),m.correction.space=this.calculateCorrection(this.CODE_PATTERN[m.code],f,this.MODULE_INDICES.space),m;for(var le=0;le<4;le++)f[le]=f[le+2];f[4]=0,f[5]=0,O--}else O++;f[O]=1,b=!b}return null}},{key:"decode",value:function(f,p){var m=this,b=this._findStart();if(b===null)return null;var O={code:b.code,start:b.start,end:b.end,correction:{bar:b.correction.bar,space:b.correction.space}},F=[];F.push(O);for(var k=O.code,j=function(De){switch(De){case m.START_CODE_A:return m.CODE_A;case m.START_CODE_B:return m.CODE_B;case m.START_CODE_C:return m.CODE_C;default:return null}}(O.code),$=!1,le=!1,me=le,ue=!0,be=0,Le=[],Ge=[];!$;){if(me=le,le=!1,(O=this._decodeCode(O.end,O.correction))!==null)switch(O.code!==this.STOP_CODE&&(ue=!0),O.code!==this.STOP_CODE&&(Le.push(O.code),k+=++be*O.code),F.push(O),j){case this.CODE_A:if(O.code<64)Ge.push(String.fromCharCode(32+O.code));else if(O.code<96)Ge.push(String.fromCharCode(O.code-64));else switch(O.code!==this.STOP_CODE&&(ue=!1),O.code){case this.CODE_SHIFT:le=!0,j=this.CODE_B;break;case this.CODE_B:j=this.CODE_B;break;case this.CODE_C:j=this.CODE_C;break;case this.STOP_CODE:$=!0}break;case this.CODE_B:if(O.code<96)Ge.push(String.fromCharCode(32+O.code));else switch(O.code!==this.STOP_CODE&&(ue=!1),O.code){case this.CODE_SHIFT:le=!0,j=this.CODE_A;break;case this.CODE_A:j=this.CODE_A;break;case this.CODE_C:j=this.CODE_C;break;case this.STOP_CODE:$=!0}break;case this.CODE_C:if(O.code<100)Ge.push(O.code<10?"0"+O.code:O.code);else switch(O.code!==this.STOP_CODE&&(ue=!1),O.code){case this.CODE_A:j=this.CODE_A;break;case this.CODE_B:j=this.CODE_B;break;case this.STOP_CODE:$=!0}}else $=!0;me&&(j=j===this.CODE_A?this.CODE_B:this.CODE_A)}return O===null?null:(O.end=this._nextUnset(this._row,O.end),this._verifyTrailingWhitespace(O)?(k-=be*Le[Le.length-1])%103!==Le[Le.length-1]?null:Ge.length?(ue&&Ge.splice(Ge.length-1,1),{code:Ge.join(""),start:b.start,end:O.end,codeset:j,startInfo:b,decodedCodes:F,endInfo:O,format:this.FORMAT}):null:null)}},{key:"_verifyTrailingWhitespace",value:function(f){var p;return(p=f.end+(f.end-f.start)/2)<this._row.length&&this._matchRange(f.end,p,0)?f:null}},{key:"calculateCorrection",value:function(f,p,m){for(var b=m.length,O=0,F=0;b--;)F+=f[m[b]],O+=p[m[b]];return F/O}}]),y}(re),Qe=t(14),_t=t.n(Qe),jt=t(33),Gt=t.n(jt);function Ko(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var Gl=new Uint16Array(Gt()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. *$/+%").map(function(A){return A.charCodeAt(0)})),Yo=new Uint16Array([52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,148,168,162,138,42]),Qi=function(A){T()(y,A);var N=Ko(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","code_39"),f}return E()(y,[{key:"_findStart",value:function(){for(var f=this._nextSet(this._row),p=f,m=new Uint16Array([0,0,0,0,0,0,0,0,0]),b=0,O=!1,F=f;F<this._row.length;F++)if(this._row[F]^(O?1:0))m[b]++;else{if(b===m.length-1){if(this._toPattern(m)===148){var k=Math.floor(Math.max(0,p-(F-p)/4));if(this._matchRange(k,p,0))return{start:p,end:F}}p+=m[0]+m[1];for(var j=0;j<7;j++)m[j]=m[j+2];m[7]=0,m[8]=0,b--}else b++;m[b]=1,O=!O}return null}},{key:"_toPattern",value:function(f){for(var p=f.length,m=0,b=p,O=0;b>3;){m=this._findNextWidth(f,m),b=0;for(var F=0,k=0;k<p;k++)f[k]>m&&(F|=1<<p-1-k,b++,O+=f[k]);if(b===3){for(var j=0;j<p&&b>0;j++)if(f[j]>m&&(b--,2*f[j]>=O))return-1;return F}}return-1}},{key:"_findNextWidth",value:function(f,p){for(var m=Number.MAX_VALUE,b=0;b<f.length;b++)f[b]<m&&f[b]>p&&(m=f[b]);return m}},{key:"_patternToChar",value:function(f){for(var p=0;p<Yo.length;p++)if(Yo[p]===f)return String.fromCharCode(Gl[p]);return null}},{key:"_verifyTrailingWhitespace",value:function(f,p,m){var b=ee.a.sum(m);return 3*(p-f-b)>=b}},{key:"decode",value:function(){var f=new Uint16Array([0,0,0,0,0,0,0,0,0]),p=[],m=this._findStart();if(!m)return null;var b,O,F=this._nextSet(this._row,m.end);do{f=this._toCounters(F,f);var k=this._toPattern(f);if(k<0||(b=this._patternToChar(k))===null)return null;p.push(b),O=F,F+=ee.a.sum(f),F=this._nextSet(this._row,F)}while(b!=="*");return p.pop(),p.length&&this._verifyTrailingWhitespace(O,F,f)?{code:p.join(""),start:m.start,end:F,startInfo:m,decodedCodes:p,format:this.FORMAT}:null}}]),y}(re);function $l(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var Xl=/[AEIO]/g,Qo=function(A){T()(y,A);var N=$l(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","code_32_reader"),f}return E()(y,[{key:"_decodeCode32",value:function(f){if(/[^0-9BCDFGHJKLMNPQRSTUVWXYZ]/.test(f))return null;for(var p=0,m=0;m<f.length;m++)p=32*p+"0123456789BCDFGHJKLMNPQRSTUVWXYZ".indexOf(f[m]);var b="".concat(p);return b.length<9&&(b=("000000000"+b).slice(-9)),"A"+b}},{key:"_checkChecksum",value:function(f){return!!f}},{key:"decode",value:function(){var f=_t()(M()(y.prototype),"decode",this).call(this);if(!f)return null;var p=f.code;if(!p||(p=p.replace(Xl,""),!this._checkChecksum(p)))return null;var m=this._decodeCode32(p);return m?(f.code=m,f):null}}]),y}(Qi);function Kl(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var Jo=/[IOQ]/g,Zo=/[A-Z0-9]{17}/,Vr=function(A){T()(y,A);var N=Kl(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","code_39_vin"),f}return E()(y,[{key:"_checkChecksum",value:function(f){return!!f}},{key:"decode",value:function(){var f=_t()(M()(y.prototype),"decode",this).call(this);if(!f)return null;var p=f.code;return p&&(p=p.replace(Jo,"")).match(Zo)&&this._checkChecksum(p)?(f.code=p,f):null}}]),y}(Qi);function es(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var Ur=new Uint16Array(Gt()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*").map(function(A){return A.charCodeAt(0)})),ts=new Uint16Array([276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350]),ns=function(A){T()(y,A);var N=es(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","code_93"),f}return E()(y,[{key:"_patternToChar",value:function(f){for(var p=0;p<ts.length;p++)if(ts[p]===f)return String.fromCharCode(Ur[p]);return null}},{key:"_toPattern",value:function(f){for(var p=f.length,m=f.reduce(function(j,$){return j+$},0),b=0,O=0;O<p;O++){var F=Math.round(9*f[O]/m);if(F<1||F>4)return-1;if(1&O)b<<=F;else for(var k=0;k<F;k++)b=b<<1|1}return b}},{key:"_findStart",value:function(){for(var f=this._nextSet(this._row),p=f,m=new Uint16Array([0,0,0,0,0,0]),b=0,O=!1,F=f;F<this._row.length;F++)if(this._row[F]^(O?1:0))m[b]++;else{if(b===m.length-1){if(this._toPattern(m)===350){var k=Math.floor(Math.max(0,p-(F-p)/4));if(this._matchRange(k,p,0))return{start:p,end:F}}p+=m[0]+m[1];for(var j=0;j<4;j++)m[j]=m[j+2];m[4]=0,m[5]=0,b--}else b++;m[b]=1,O=!O}return null}},{key:"_verifyEnd",value:function(f,p){return!(f===p||!this._row[p])}},{key:"_decodeExtended",value:function(f){for(var p=f.length,m=[],b=0;b<p;b++){var O=f[b];if(O>="a"&&O<="d"){if(b>p-2)return null;var F=f[++b],k=F.charCodeAt(0),j=void 0;switch(O){case"a":if(!(F>="A"&&F<="Z"))return null;j=String.fromCharCode(k-64);break;case"b":if(F>="A"&&F<="E")j=String.fromCharCode(k-38);else if(F>="F"&&F<="J")j=String.fromCharCode(k-11);else if(F>="K"&&F<="O")j=String.fromCharCode(k+16);else if(F>="P"&&F<="S")j=String.fromCharCode(k+43);else{if(!(F>="T"&&F<="Z"))return null;j="\x7F"}break;case"c":if(F>="A"&&F<="O")j=String.fromCharCode(k-32);else{if(F!=="Z")return null;j=":"}break;case"d":if(!(F>="A"&&F<="Z"))return null;j=String.fromCharCode(k+32);break;default:return console.warn("* code_93_reader _decodeExtended hit default case, this may be an error",j),null}m.push(j)}else m.push(O)}return m}},{key:"_matchCheckChar",value:function(f,p,m){var b=f.slice(0,p),O=b.length,F=b.reduce(function(k,j,$){return k+((-1*$+(O-1))%m+1)*Ur.indexOf(j.charCodeAt(0))},0);return Ur[F%47]===f[p].charCodeAt(0)}},{key:"_verifyChecksums",value:function(f){return this._matchCheckChar(f,f.length-2,20)&&this._matchCheckChar(f,f.length-1,15)}},{key:"decode",value:function(f,p){if(!(p=this._findStart()))return null;var m,b,O=new Uint16Array([0,0,0,0,0,0]),F=[],k=this._nextSet(this._row,p.end);do{O=this._toCounters(k,O);var j=this._toPattern(O);if(j<0||(b=this._patternToChar(j))===null)return null;F.push(b),m=k,k+=ee.a.sum(O),k=this._nextSet(this._row,k)}while(b!=="*");return F.pop(),F.length&&this._verifyEnd(m,k)&&this._verifyChecksums(F)?(F=F.slice(0,F.length-2),(F=this._decodeExtended(F))===null?null:{code:F.join(""),start:p.start,end:k,startInfo:p,decodedCodes:F,format:this.FORMAT}):null}}]),y}(re);function is(A,N){var y=Object.keys(A);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(A);N&&(f=f.filter(function(p){return Object.getOwnPropertyDescriptor(A,p).enumerable})),y.push.apply(y,f)}return y}function zr(A){for(var N=1;N<arguments.length;N++){var y=arguments[N]!=null?arguments[N]:{};N%2?is(Object(y),!0).forEach(function(f){U()(A,f,y[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(y)):is(Object(y)).forEach(function(f){Object.defineProperty(A,f,Object.getOwnPropertyDescriptor(y,f))})}return A}function Yl(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var Ql=[1,1,1],rs=[1,1,1,1,1],Jl=[1,1,2],os=[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2],[1,1,2,3],[1,2,2,2],[2,2,1,2],[1,1,4,1],[2,3,1,1],[1,3,2,1],[4,1,1,1],[2,1,3,1],[3,1,2,1],[2,1,1,3]],ss=[0,11,13,14,19,25,28,21,22,26],Pn=function(A){T()(y,A);var N=Yl(y);function y(f,p){var m;return x()(this,y),m=N.call(this,a()({supplements:[]},f),p),U()(S()(m),"FORMAT","ean_13"),U()(S()(m),"SINGLE_CODE_ERROR",.7),U()(S()(m),"STOP_PATTERN",[1,1,1]),m}return E()(y,[{key:"_findPattern",value:function(f,p,m,b){var O=new Array(f.length).fill(0),F={error:Number.MAX_VALUE,start:0,end:0},k=0;p||(p=this._nextSet(this._row));for(var j=!1,$=p;$<this._row.length;$++)if(this._row[$]^(m?1:0))O[k]+=1;else{if(k===O.length-1){var le=this._matchPattern(O,f);if(le<.48&&F.error&&le<F.error)return j=!0,F.error=le,F.start=$-O.reduce(function(ue,be){return ue+be},0),F.end=$,F;if(b){for(var me=0;me<O.length-2;me++)O[me]=O[me+2];O[O.length-2]=0,O[O.length-1]=0,k--}}else k++;O[k]=1,m=!m}return j?F:null}},{key:"_decodeCode",value:function(f,p){var m=[0,0,0,0],b=f,O={error:Number.MAX_VALUE,code:-1,start:f,end:f},F=!this._row[b],k=0;p||(p=os.length);for(var j=b;j<this._row.length;j++)if(this._row[j]^(F?1:0))m[k]++;else{if(k===m.length-1){for(var $=0;$<p;$++){var le=this._matchPattern(m,os[$]);O.end=j,le<O.error&&(O.code=$,O.error=le)}return O.error>.48?null:O}m[++k]=1,F=!F}return null}},{key:"_findStart",value:function(){for(var f=this._nextSet(this._row),p=null;!p;){if(!(p=this._findPattern(Ql,f,!1,!0)))return null;var m=p.start-(p.end-p.start);if(m>=0&&this._matchRange(m,p.start,0))return p;f=p.end,p=null}return null}},{key:"_calculateFirstDigit",value:function(f){for(var p=0;p<ss.length;p++)if(f===ss[p])return p;return null}},{key:"_decodePayload",value:function(f,p,m){for(var b=zr({},f),O=0,F=0;F<6;F++){if(!(b=this._decodeCode(b.end)))return null;b.code>=10?(b.code-=10,O|=1<<5-F):O|=0<<5-F,p.push(b.code),m.push(b)}var k=this._calculateFirstDigit(O);if(k===null)return null;p.unshift(k);var j=this._findPattern(rs,b.end,!0,!1);if(j===null||!j.end)return null;m.push(j);for(var $=0;$<6;$++){if(!(j=this._decodeCode(j.end,10)))return null;m.push(j),p.push(j.code)}return j}},{key:"_verifyTrailingWhitespace",value:function(f){var p=f.end+(f.end-f.start);return p<this._row.length&&this._matchRange(f.end,p,0)?f:null}},{key:"_findEnd",value:function(f,p){var m=this._findPattern(this.STOP_PATTERN,f,p,!1);return m!==null?this._verifyTrailingWhitespace(m):null}},{key:"_checksum",value:function(f){for(var p=0,m=f.length-2;m>=0;m-=2)p+=f[m];p*=3;for(var b=f.length-1;b>=0;b-=2)p+=f[b];return p%10==0}},{key:"_decodeExtensions",value:function(f){var p=this._nextSet(this._row,f),m=this._findPattern(Jl,p,!1,!1);if(m===null)return null;for(var b=0;b<this.supplements.length;b++)try{var O=this.supplements[b].decode(this._row,m.end);if(O!==null)return{code:O.code,start:p,startInfo:m,end:O.end,decodedCodes:O.decodedCodes,format:this.supplements[b].FORMAT}}catch(F){console.error("* decodeExtensions error in ",this.supplements[b],": ",F)}return null}},{key:"decode",value:function(f,p){var m=new Array,b=new Array,O={},F=this._findStart();if(!F)return null;var k={start:F.start,end:F.end};if(b.push(k),!(k=this._decodePayload(k,m,b))||!(k=this._findEnd(k.end,!1))||(b.push(k),!this._checksum(m)))return null;if(this.supplements.length>0){var j=this._decodeExtensions(k.end);if(!j||!j.decodedCodes)return null;var $=j.decodedCodes[j.decodedCodes.length-1],le={start:$.start+(($.end-$.start)/2|0),end:$.end};if(!this._verifyTrailingWhitespace(le))return null;O={supplement:j,code:m.join("")+j.code}}return zr(zr({code:m.join(""),start:F.start,end:k.end,startInfo:F,decodedCodes:b},O),{},{format:this.FORMAT})}}]),y}(re);function Zl(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var as=function(A){T()(y,A);var N=Zl(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","ean_2"),f}return E()(y,[{key:"decode",value:function(f,p){f&&(this._row=f);var m=0,b=p,O=this._row.length,F=[],k=[],j=null;if(b===void 0)return null;for(var $=0;$<2&&b<O;$++){if(!(j=this._decodeCode(b)))return null;k.push(j),F.push(j.code%10),j.code>=10&&(m|=1<<1-$),$!==1&&(b=this._nextSet(this._row,j.end),b=this._nextUnset(this._row,b))}if(F.length!==2||parseInt(F.join(""))%4!==m)return null;var le=this._findStart();return{code:F.join(""),decodedCodes:k,end:j.end,format:this.FORMAT,startInfo:le,start:le.start}}}]),y}(Pn);function ec(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var tc=[24,20,18,17,12,6,3,10,9,5],ls=function(A){T()(y,A);var N=ec(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","ean_5"),f}return E()(y,[{key:"decode",value:function(f,p){if(p===void 0)return null;f&&(this._row=f);for(var m=0,b=p,O=this._row.length,F=null,k=[],j=[],$=0;$<5&&b<O;$++){if(!(F=this._decodeCode(b)))return null;j.push(F),k.push(F.code%10),F.code>=10&&(m|=1<<4-$),$!==4&&(b=this._nextSet(this._row,F.end),b=this._nextUnset(this._row,b))}if(k.length!==5||function(me){for(var ue=me.length,be=0,Le=ue-2;Le>=0;Le-=2)be+=me[Le];be*=3;for(var Ge=ue-1;Ge>=0;Ge-=2)be+=me[Ge];return(be*=3)%10}(k)!==function(me){for(var ue=0;ue<10;ue++)if(me===tc[ue])return ue;return null}(m))return null;var le=this._findStart();return{code:k.join(""),decodedCodes:j,end:F.end,format:this.FORMAT,startInfo:le,start:le.start}}}]),y}(Pn);function zn(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var cs=function(A){T()(y,A);var N=zn(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","ean_8"),f}return E()(y,[{key:"_decodePayload",value:function(f,p,m){for(var b=f,O=0;O<4;O++){if(!(b=this._decodeCode(b.end,10)))return null;p.push(b.code),m.push(b)}if((b=this._findPattern(rs,b.end,!0,!1))===null)return null;m.push(b);for(var F=0;F<4;F++){if(!(b=this._decodeCode(b.end,10)))return null;m.push(b),p.push(b.code)}return b}}]),y}(Pn);function nc(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var ds=function(A){T()(y,A);var N=nc(y);function y(f){var p;return x()(this,y),p=N.call(this,a()({normalizeBarSpaceWidth:!1},f)),U()(S()(p),"barSpaceRatio",[1,1]),U()(S()(p),"SINGLE_CODE_ERROR",.78),U()(S()(p),"AVG_CODE_ERROR",.38),U()(S()(p),"START_PATTERN",[1,1,1,1]),U()(S()(p),"STOP_PATTERN",[1,1,3]),U()(S()(p),"CODE_PATTERN",[[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]]),U()(S()(p),"MAX_CORRECTION_FACTOR",5),U()(S()(p),"FORMAT","i2of5"),f.normalizeBarSpaceWidth&&(p.SINGLE_CODE_ERROR=.38,p.AVG_CODE_ERROR=.09),p.config=f,B()(p,S()(p))}return E()(y,[{key:"_matchPattern",value:function(f,p){if(this.config.normalizeBarSpaceWidth){for(var m=[0,0],b=[0,0],O=[0,0],F=this.MAX_CORRECTION_FACTOR,k=1/F,j=0;j<f.length;j++)m[j%2]+=f[j],b[j%2]+=p[j];O[0]=b[0]/m[0],O[1]=b[1]/m[1],O[0]=Math.max(Math.min(O[0],F),k),O[1]=Math.max(Math.min(O[1],F),k),this.barSpaceRatio=O;for(var $=0;$<f.length;$++)f[$]*=this.barSpaceRatio[$%2]}return _t()(M()(y.prototype),"_matchPattern",this).call(this,f,p)}},{key:"_findPattern",value:function(f,p){var m=arguments.length>2&&arguments[2]!==void 0&&arguments[2],b=arguments.length>3&&arguments[3]!==void 0&&arguments[3],O=new Array(f.length).fill(0),F=0,k={error:Number.MAX_VALUE,start:0,end:0},j=this.AVG_CODE_ERROR;m=m||!1,b=b||!1,p||(p=this._nextSet(this._row));for(var $=p;$<this._row.length;$++)if(this._row[$]^(m?1:0))O[F]++;else{if(F===O.length-1){var le=O.reduce(function(be,Le){return be+Le},0),me=this._matchPattern(O,f);if(me<j)return k.error=me,k.start=$-le,k.end=$,k;if(!b)return null;for(var ue=0;ue<O.length-2;ue++)O[ue]=O[ue+2];O[O.length-2]=0,O[O.length-1]=0,F--}else F++;O[F]=1,m=!m}return null}},{key:"_findStart",value:function(){for(var f=0,p=this._nextSet(this._row),m=null,b=1;!m;){if(!(m=this._findPattern(this.START_PATTERN,p,!1,!0)))return null;if(b=Math.floor((m.end-m.start)/4),(f=m.start-10*b)>=0&&this._matchRange(f,m.start,0))return m;p=m.end,m=null}return null}},{key:"_verifyTrailingWhitespace",value:function(f){var p=f.end+(f.end-f.start)/2;return p<this._row.length&&this._matchRange(f.end,p,0)?f:null}},{key:"_findEnd",value:function(){this._row.reverse();var f=this._findPattern(this.STOP_PATTERN);if(this._row.reverse(),f===null)return null;var p=f.start;return f.start=this._row.length-f.end,f.end=this._row.length-p,f!==null?this._verifyTrailingWhitespace(f):null}},{key:"_decodePair",value:function(f){for(var p=[],m=0;m<f.length;m++){var b=this._decodeCode(f[m]);if(!b)return null;p.push(b)}return p}},{key:"_decodeCode",value:function(f){for(var p=this.AVG_CODE_ERROR,m={error:Number.MAX_VALUE,code:-1,start:0,end:0},b=0;b<this.CODE_PATTERN.length;b++){var O=this._matchPattern(f,this.CODE_PATTERN[b]);O<m.error&&(m.code=b,m.error=O)}return m.error<p?m:null}},{key:"_decodePayload",value:function(f,p,m){for(var b=0,O=f.length,F=[[0,0,0,0,0],[0,0,0,0,0]],k=null;b<O;){for(var j=0;j<5;j++)F[0][j]=f[b]*this.barSpaceRatio[0],F[1][j]=f[b+1]*this.barSpaceRatio[1],b+=2;if(!(k=this._decodePair(F)))return null;for(var $=0;$<k.length;$++)p.push(k[$].code+""),m.push(k[$])}return k}},{key:"_verifyCounterLength",value:function(f){return f.length%10==0}},{key:"decode",value:function(f,p){var m=new Array,b=new Array,O=this._findStart();if(!O)return null;b.push(O);var F=this._findEnd();if(!F)return null;var k=this._fillCounters(O.end,F.start,!1);return this._verifyCounterLength(k)&&this._decodePayload(k,m,b)?m.length%2!=0||m.length<6?null:(b.push(F),{code:m.join(""),start:O.start,end:F.end,startInfo:O,decodedCodes:b,format:this.FORMAT}):null}}]),y}(re);function us(A,N){var y=Object.keys(A);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(A);N&&(f=f.filter(function(p){return Object.getOwnPropertyDescriptor(A,p).enumerable})),y.push.apply(y,f)}return y}function ic(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var hs=function(A){T()(y,A);var N=ic(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"CODE_FREQUENCY",[[56,52,50,49,44,38,35,42,41,37],[7,11,13,14,19,25,28,21,22,26]]),U()(S()(f),"STOP_PATTERN",[1/6*7,1/6*7,1/6*7,1/6*7,1/6*7,1/6*7]),U()(S()(f),"FORMAT","upc_e"),f}return E()(y,[{key:"_decodePayload",value:function(f,p,m){for(var b=function(k){for(var j=1;j<arguments.length;j++){var $=arguments[j]!=null?arguments[j]:{};j%2?us(Object($),!0).forEach(function(le){U()(k,le,$[le])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors($)):us(Object($)).forEach(function(le){Object.defineProperty(k,le,Object.getOwnPropertyDescriptor($,le))})}return k}({},f),O=0,F=0;F<6;F++){if(!(b=this._decodeCode(b.end)))return null;b.code>=10&&(b.code=b.code-10,O|=1<<5-F),p.push(b.code),m.push(b)}return this._determineParity(O,p)?b:null}},{key:"_determineParity",value:function(f,p){for(var m=0;m<this.CODE_FREQUENCY.length;m++)for(var b=0;b<this.CODE_FREQUENCY[m].length;b++)if(f===this.CODE_FREQUENCY[m][b])return p.unshift(m),p.push(b),!0;return!1}},{key:"_convertToUPCA",value:function(f){var p=[f[0]],m=f[f.length-2];return(p=m<=2?p.concat(f.slice(1,3)).concat([m,0,0,0,0]).concat(f.slice(3,6)):m===3?p.concat(f.slice(1,4)).concat([0,0,0,0,0]).concat(f.slice(4,6)):m===4?p.concat(f.slice(1,5)).concat([0,0,0,0,0,f[5]]):p.concat(f.slice(1,6)).concat([0,0,0,0,m])).push(f[f.length-1]),p}},{key:"_checksum",value:function(f){return _t()(M()(y.prototype),"_checksum",this).call(this,this._convertToUPCA(f))}},{key:"_findEnd",value:function(f,p){return _t()(M()(y.prototype),"_findEnd",this).call(this,f,!0)}},{key:"_verifyTrailingWhitespace",value:function(f){var p=f.end+(f.end-f.start)/2;return p<this._row.length&&this._matchRange(f.end,p,0)?f:null}}]),y}(Pn);function rc(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var fs=function(A){T()(y,A);var N=rc(y);function y(){var f;x()(this,y);for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return f=N.call.apply(N,[this].concat(m)),U()(S()(f),"FORMAT","upc_a"),f}return E()(y,[{key:"decode",value:function(f,p){var m=Pn.prototype.decode.call(this);return m&&m.code&&m.code.length===13&&m.code.charAt(0)==="0"?(m.code=m.code.substring(1),m):null}}]),y}(Pn),Pi={},Ji={UP:1,DOWN:-1};Pi.getBarcodeLine=function(A,N,y){var f,p,m,b,O,F=0|N.x,k=0|N.y,j=0|y.x,$=0|y.y,le=Math.abs($-k)>Math.abs(j-F),me=[],ue=A.data,be=A.size.x,Le=255,Ge=0;function De(ki,Ec){O=ue[Ec*be+ki],Le=O<Le?O:Le,Ge=O>Ge?O:Ge,me.push(O)}le&&(m=F,F=k,k=m,m=j,j=$,$=m),F>j&&(m=F,F=j,j=m,m=k,k=$,$=m);var at=j-F,yt=Math.abs($-k);f=at/2|0,p=k;var Yt=k<$?1:-1;for(b=F;b<j;b++)le?De(p,b):De(b,p),(f-=yt)<0&&(p+=Yt,f+=at);return{line:me,min:Le,max:Ge}},Pi.toBinaryLine=function(A){var N,y,f,p,m,b,O=A.min,F=A.max,k=A.line,j=O+(F-O)/2,$=[],le=(F-O)/12,me=-le;for(f=k[0]>j?Ji.UP:Ji.DOWN,$.push({pos:0,val:k[0]}),m=0;m<k.length-2;m++)f!==(p=(N=k[m+1]-k[m])+(y=k[m+2]-k[m+1])<me&&k[m+1]<1.5*j?Ji.DOWN:N+y>le&&k[m+1]>.5*j?Ji.UP:f)&&($.push({pos:m,val:k[m]}),f=p);for($.push({pos:k.length,val:k[k.length-1]}),b=$[0].pos;b<$[1].pos;b++)k[b]=k[b]>j?0:1;for(m=1;m<$.length-1;m++)for(le=$[m+1].val>$[m].val?$[m].val+($[m+1].val-$[m].val)/3*2|0:$[m+1].val+($[m].val-$[m+1].val)/3|0,b=$[m].pos;b<$[m+1].pos;b++)k[b]=k[b]>le?0:1;return{line:k,threshold:le}},Pi.debug={printFrequency:function(A,N){var y,f=N.getContext("2d");for(N.width=A.length,N.height=256,f.beginPath(),f.strokeStyle="blue",y=0;y<A.length;y++)f.moveTo(y,255),f.lineTo(y,255-A[y]);f.stroke(),f.closePath()},printPattern:function(A,N){var y,f=N.getContext("2d");for(N.width=A.length,f.fillColor="black",y=0;y<A.length;y++)A[y]===1&&f.fillRect(y,0,1,100)}};var qr=Pi;function oc(A,N){var y=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!y){if(Array.isArray(A)||(y=function(F,k){if(F){if(typeof F=="string")return ps(F,k);var j=Object.prototype.toString.call(F).slice(8,-1);if(j==="Object"&&F.constructor&&(j=F.constructor.name),j==="Map"||j==="Set")return Array.from(F);if(j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j))return ps(F,k)}}(A))||N&&A&&typeof A.length=="number"){y&&(A=y);var f=0,p=function(){};return{s:p,n:function(){return f>=A.length?{done:!0}:{done:!1,value:A[f++]}},e:function(F){throw F},f:p}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m,b=!0,O=!1;return{s:function(){y=y.call(A)},n:function(){var F=y.next();return b=F.done,F},e:function(F){O=!0,m=F},f:function(){try{b||y.return==null||y.return()}finally{if(O)throw m}}}}function ps(A,N){(N==null||N>A.length)&&(N=A.length);for(var y=0,f=new Array(N);y<N;y++)f[y]=A[y];return f}var Oi={code_128_reader:Ie,ean_reader:Pn,ean_5_reader:ls,ean_2_reader:as,ean_8_reader:cs,code_39_reader:Qi,code_39_vin_reader:Vr,codabar_reader:Ne,upc_reader:fs,upc_e_reader:hs,i2of5_reader:ds,"2of5_reader":Y,code_93_reader:ns,code_32_reader:Qo},Hr={registerReader:function(A,N){Oi[A]=N},create:function(A,N){var y={frequency:null,pattern:null,overlay:null},f=[];function p(){A.readers.forEach(function(k){var j,$={},le=[];o()(k)==="object"?(j=k.format,$=k.config):typeof k=="string"&&(j=k),$.supplements&&(le=$.supplements.map(function(ue){return new Oi[ue]}));try{var me=new Oi[j]($,le);f.push(me)}catch(ue){throw console.error("* Error constructing reader ",j,ue),ue}})}function m(k){var j,$=null,le=qr.getBarcodeLine(N,k[0],k[1]);for(qr.toBinaryLine(le),j=0;j<f.length&&$===null;j++)$=f[j].decodePattern(le.line);return $===null?null:{codeResult:$,barcodeLine:le}}function b(k){return O.apply(this,arguments)}function O(){return(O=d()(h.a.mark(function k(j){var $,le,me,ue;return h.a.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:$=null,le=oc(f),be.prev=2,le.s();case 4:if((me=le.n()).done){be.next=14;break}if(!(ue=me.value).decodeImage){be.next=12;break}return be.next=9,ue.decodeImage(j);case 9:if(!($=be.sent)){be.next=12;break}return be.abrupt("break",14);case 12:be.next=4;break;case 14:be.next=19;break;case 16:be.prev=16,be.t0=be.catch(2),le.e(be.t0);case 19:return be.prev=19,le.f(),be.finish(19);case 22:return be.abrupt("return",$);case 23:case"end":return be.stop()}},k,null,[[2,16,19,22]])}))).apply(this,arguments)}function F(k){var j,$;y.overlay;var le=function(ue){return Math.sqrt(Math.pow(Math.abs(ue[1].y-ue[0].y),2)+Math.pow(Math.abs(ue[1].x-ue[0].x),2))}(j=function(ue){return[{x:(ue[1][0]-ue[0][0])/2+ue[0][0],y:(ue[1][1]-ue[0][1])/2+ue[0][1]},{x:(ue[3][0]-ue[2][0])/2+ue[2][0],y:(ue[3][1]-ue[2][1])/2+ue[2][1]}]}(k)),me=Math.atan2(j[1].y-j[0].y,j[1].x-j[0].x);return(j=function(ue,be,Le){function Ge(De){var at=De*Math.sin(be),yt=De*Math.cos(be);ue[0].y-=at,ue[0].x-=yt,ue[1].y+=at,ue[1].x+=yt}for(Ge(Le);Le>1&&(!N.inImageWithBorder(ue[0])||!N.inImageWithBorder(ue[1]));)Ge(-(Le-=Math.ceil(Le/2)));return ue}(j,me,Math.floor(.1*le)))===null?null:(($=m(j))===null&&($=function(ue,be,Le){var Ge,De,at,yt=Math.sqrt(Math.pow(ue[1][0]-ue[0][0],2)+Math.pow(ue[1][1]-ue[0][1],2)),Yt=null,ki=Math.sin(Le),Ec=Math.cos(Le);for(Ge=1;Ge<16&&Yt===null;Ge++)at={y:(De=yt/16*Ge*(Ge%2==0?-1:1))*ki,x:De*Ec},be[0].y+=at.x,be[0].x-=at.y,be[1].y+=at.x,be[1].x-=at.y,Yt=m(be);return Yt}(k,j,me)),$===null?null:{codeResult:$.codeResult,line:j,angle:me,pattern:$.barcodeLine.line,threshold:$.barcodeLine.threshold})}return p(),{decodeFromBoundingBox:function(k){return F(k)},decodeFromBoundingBoxes:function(k){var j,$,le=[],me=A.multiple;for(j=0;j<k.length;j++){var ue=k[j];if(($=F(ue)||{}).box=ue,me)le.push($);else if($.codeResult)return $}return{barcodes:le}},decodeFromImage:function(k){return d()(h.a.mark(function j(){var $;return h.a.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.next=2,b(k);case 2:return $=le.sent,le.abrupt("return",$);case 4:case"end":return le.stop()}},j)}))()},registerReader:function(k,j){if(Oi[k])throw new Error("cannot register existing reader",k);Oi[k]=j},setReaders:function(k){A.readers=k,f.length=0,p()}}}},On=function(){var A={};function N(p){return A[p]||(A[p]={subscribers:[]}),A[p]}function y(p,m){p.async?setTimeout(function(){p.callback(m)},4):p.callback(m)}function f(p,m,b){var O;if(typeof m=="function")O={callback:m,async:b};else if(!(O=m).callback)throw new Error("Callback was not specified on options");N(p).subscribers.push(O)}return{subscribe:function(p,m,b){return f(p,m,b)},publish:function(p,m){var b=N(p),O=b.subscribers;O.filter(function(F){return!!F.once}).forEach(function(F){y(F,m)}),b.subscribers=O.filter(function(F){return!F.once}),b.subscribers.forEach(function(F){y(F,m)})},once:function(p,m){var b=arguments.length>2&&arguments[2]!==void 0&&arguments[2];f(p,{callback:m,async:b,once:!0})},unsubscribe:function(p,m){if(p){var b=N(p);b.subscribers=b&&m?b.subscribers.filter(function(O){return O.callback!==m}):[]}else A={}}}}(),gs=t(63),ms=t.n(gs),sc=t(64);function ac(A){var N=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,f=M()(A);if(N){var p=M()(this).constructor;y=Reflect.construct(f,arguments,p)}else y=f.apply(this,arguments);return B()(this,y)}}var si,Wr=function(A){T()(y,A);var N=ac(y);function y(f,p){var m;return x()(this,y),m=N.call(this,f),U()(S()(m),"code",void 0),m.code=p,Object.setPrototypeOf(S()(m),y.prototype),m}return E()(y)}(t.n(sc)()(Error)),_s="This may mean that the user has declined camera access, or the browser does not support media APIs. If you are running in iOS, you must use Safari.";function lc(){try{return navigator.mediaDevices.enumerateDevices()}catch{var A=new Wr("enumerateDevices is not defined. ".concat(_s),-1);return Promise.reject(A)}}function cc(A){try{return navigator.mediaDevices.getUserMedia(A)}catch{var N=new Wr("getUserMedia is not defined. ".concat(_s),-1);return Promise.reject(N)}}function vs(A){return new Promise(function(N,y){var f=10;(function p(){f>0?A.videoWidth>10&&A.videoHeight>10?N():window.setTimeout(p,500):y(new Wr("Unable to play video stream. Is webcam working?",-1)),f--})()})}function bs(A,N){return Gr.apply(this,arguments)}function Gr(){return(Gr=d()(h.a.mark(function A(N,y){var f;return h.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,cc(y);case 2:if(f=p.sent,si=f,!N){p.next=11;break}return N.setAttribute("autoplay","true"),N.setAttribute("muted","true"),N.setAttribute("playsinline","true"),N.srcObject=f,N.addEventListener("loadedmetadata",function(){N.play().catch(function(m){console.warn("* Error while trying to play video stream:",m)})}),p.abrupt("return",vs(N));case 11:return p.abrupt("return",Promise.resolve());case 12:case"end":return p.stop()}},A)}))).apply(this,arguments)}function dc(A){var N=ms()(A,["width","height","facingMode","aspectRatio","deviceId"]);return A.minAspectRatio!==void 0&&A.minAspectRatio>0&&(N.aspectRatio=A.minAspectRatio,console.log("WARNING: Constraint 'minAspectRatio' is deprecated; Use 'aspectRatio' instead")),A.facing!==void 0&&(N.facingMode=A.facing,console.log("WARNING: Constraint 'facing' is deprecated. Use 'facingMode' instead'")),N}function uc(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=dc(A);return N&&N.deviceId&&N.facingMode&&delete N.facingMode,Promise.resolve({audio:!1,video:N})}function ys(){return(ys=d()(h.a.mark(function A(){var N;return h.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,lc();case 2:return N=y.sent,y.abrupt("return",N.filter(function(f){return f.kind==="videoinput"}));case 4:case"end":return y.stop()}},A)}))).apply(this,arguments)}function Ti(){if(!si)return null;var A=si.getVideoTracks();return A&&A!=null&&A.length?A[0]:null}var Ii={requestedVideoElement:null,request:function(A,N){return d()(h.a.mark(function y(){var f;return h.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return Ii.requestedVideoElement=A,p.next=3,uc(N);case 3:return f=p.sent,p.abrupt("return",bs(A,f));case 5:case"end":return p.stop()}},y)}))()},release:function(){var A=si&&si.getVideoTracks();return Ii.requestedVideoElement!==null&&Ii.requestedVideoElement.pause(),new Promise(function(N){setTimeout(function(){A&&A.length&&A.forEach(function(y){return y.stop()}),si=null,Ii.requestedVideoElement=null,N()},0)})},enumerateVideoDevices:function(){return ys.apply(this,arguments)},getActiveStreamLabel:function(){var A=Ti();return A?A.label:""},getActiveTrack:Ti,disableTorch:function(){return d()(h.a.mark(function A(){var N;return h.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(N=Ti())){y.next=11;break}return y.prev=2,y.next=5,N.applyConstraints({advanced:[{torch:!1}]});case 5:y.next=11;break;case 7:throw y.prev=7,y.t0=y.catch(2),y.t0 instanceof OverconstrainedError&&console.warn("quagga2/CameraAccess: Torch not supported on this device"),y.t0;case 11:case"end":return y.stop()}},A,null,[[2,7]])}))()},enableTorch:function(){return d()(h.a.mark(function A(){var N;return h.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(N=Ti())){y.next=11;break}return y.prev=2,y.next=5,N.applyConstraints({advanced:[{torch:!0}]});case 5:y.next=11;break;case 7:throw y.prev=7,y.t0=y.catch(2),y.t0 instanceof OverconstrainedError&&console.warn("quagga2/CameraAccess: Torch not supported on this device"),y.t0;case 11:case"end":return y.stop()}},A,null,[[2,7]])}))()}},Zi=Ii,xs={create:function(A){var N,y=document.createElement("canvas"),f=y.getContext("2d",{willReadFrequently:!!A.willReadFrequently}),p=[],m=(N=A.capacity)!==null&&N!==void 0?N:20,b=A.capture===!0;function O(F){return!!m&&F&&!function(k,j){return j&&j.some(function($){return Object.keys($).every(function(le){return $[le]===k[le]})})}(F,A.blacklist)&&function(k,j){return typeof j!="function"||j(k)}(F,A.filter)}return{addResult:function(F,k,j){var $={};O(j)&&(m--,$.codeResult=j,b&&(y.width=k.x,y.height=k.y,g.a.drawImage(F,k,f),$.frame=y.toDataURL()),p.push($))},getResults:function(){return p}}}},hc={inputStream:{name:"Live",type:"LiveStream",constraints:{width:640,height:480,facingMode:"environment"},area:{top:"0%",right:"0%",left:"0%",bottom:"0%"},singleChannel:!1},locate:!0,numOfWorkers:4,decoder:{readers:["code_128_reader"]},locator:{halfSample:!0,patchSize:"medium"}},un=t(5),er=t(10),ws=Math.PI/180,fc={create:function(A,N){var y,f={},p=A.getConfig(),m=(Object(er.h)(A.getRealWidth(),A.getRealHeight()),A.getCanvasSize()),b=Object(er.h)(A.getWidth(),A.getHeight()),O=A.getTopRight(),F=O.x,k=O.y,j=null,$=null,le=p.willReadFrequently;return(y=N||document.createElement("canvas")).width=m.x,y.height=m.y,console.warn("*** frame_grabber_browser: willReadFrequently=",le,"canvas=",y),j=y.getContext("2d",{willReadFrequently:!!le}),$=new Uint8Array(b.x*b.y),f.attachData=function(me){$=me},f.getData=function(){return $},f.grab=function(){var me,ue=p.halfSample,be=A.getFrame(),Le=be,Ge=0;if(Le){if(function(De,at){De.width!==at.x&&(De.width=at.x),De.height!==at.y&&(De.height=at.y)}(y,m),p.type==="ImageStream"&&(Le=be.img,be.tags&&be.tags.orientation))switch(be.tags.orientation){case 6:Ge=90*ws;break;case 8:Ge=-90*ws}return Ge!==0?(j.translate(m.x/2,m.y/2),j.rotate(Ge),j.drawImage(Le,-m.y/2,-m.x/2,m.y,m.x),j.rotate(-Ge),j.translate(-m.x/2,-m.y/2)):j.drawImage(Le,0,0,m.x,m.y),me=j.getImageData(F,k,b.x,b.y).data,ue?Object(er.e)(me,b,$):Object(er.c)(me,$,p),!0}return!1},f.getSize=function(){return b},f}},pc=fc,tr={274:"orientation"},Cs=Object.keys(tr).map(function(A){return tr[A]});function gc(A){return new Promise(function(N){var y=new FileReader;y.onload=function(f){return N(f.target.result)},y.readAsArrayBuffer(A)})}function mc(A){return new Promise(function(N,y){var f=new XMLHttpRequest;f.open("GET",A,!0),f.responseType="blob",f.onreadystatechange=function(){f.readyState!==XMLHttpRequest.DONE||f.status!==200&&f.status!==0||N(this.response)},f.onerror=y,f.send()})}function _c(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs,y=new DataView(A),f=A.byteLength,p=N.reduce(function(b,O){var F=Object.keys(tr).filter(function(k){return tr[k]===O})[0];return F&&(b[F]=O),b},{}),m=2;if(y.getUint8(0)!==255||y.getUint8(1)!==216)return!1;for(;m<f;){if(y.getUint8(m)!==255)return!1;if(y.getUint8(m+1)===225)return vc(y,m+4,p);m+=2+y.getUint16(m+2)}return!1}function vc(A,N,y){if(function(b,O,F){for(var k="",j=O;j<O+F;j++)k+=String.fromCharCode(b.getUint8(j));return k}(A,N,4)!=="Exif")return!1;var f,p=N+6;if(A.getUint16(p)===18761)f=!1;else{if(A.getUint16(p)!==19789)return!1;f=!0}if(A.getUint16(p+2,!f)!==42)return!1;var m=A.getUint32(p+4,!f);return!(m<8)&&function(b,O,F,k,j){for(var $=b.getUint16(F,!j),le={},me=0;me<$;me++){var ue=F+12*me+2,be=k[b.getUint16(ue,!j)];be&&(le[be]=bc(b,ue,O,F,j))}return le}(A,p,p+m,y,f)}function bc(A,N,y,f,p){var m=A.getUint16(N+2,!p),b=A.getUint32(N+4,!p);switch(m){case 3:if(b===1)return A.getUint16(N+8,!p)}return null}var Es={};function yc(A,N){A.onload=function(){N.loaded(this)}}Es.load=function(A,N,y,f,p){var m,b,O,F=new Array(f),k=new Array(F.length);if(p===!1)F[0]=A;else for(m=0;m<F.length;m++)O=y+m,F[m]="".concat(A,"image-").concat("00".concat(O).slice(-3),".jpg");for(k.notLoaded=[],k.addImage=function(j){k.notLoaded.push(j)},k.loaded=function(j){for(var $=k.notLoaded,le=0;le<$.length;le++)if($[le]===j){$.splice(le,1);for(var me=0;me<F.length;me++){var ue=F[me].substr(F[me].lastIndexOf("/"));if(j.src.lastIndexOf(ue)!==-1){k[me]={img:j};break}}break}$.length===0&&(p===!1?function(be){var Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs;return/^blob:/i.test(be)?mc(be).then(gc).then(function(Ge){return _c(Ge,Le)}):Promise.resolve(null)}(A,["orientation"]).then(function(be){k[0].tags=be,N(k)}).catch(function(be){console.log(be),N(k)}):N(k))},m=0;m<F.length;m++)b=new Image,k.addImage(b),yc(b,k),b.src=F[m]};var xc=Es,Ss={createVideoStream:function(A){console.warn("**** InputStreamBrowser createVideoStream");var N,y,f=null,p=["canrecord","ended"],m={},b={x:0,y:0,type:"Point"},O={x:0,y:0,type:"XYSize"},F={getRealWidth:function(){return A.videoWidth},getRealHeight:function(){return A.videoHeight},getWidth:function(){return N},getHeight:function(){return y},setWidth:function(k){N=k},setHeight:function(k){y=k},setInputStream:function(k){f=k,this.setAttribute("src",k.src!==void 0?k.src:"")},ended:function(){return A.ended},getConfig:function(){return f},setAttribute:function(k,j){A&&A.setAttribute(k,j)},pause:function(){A.pause()},play:function(){A.play()},setCurrentTime:function(k){var j;((j=f)===null||j===void 0?void 0:j.type)!=="LiveStream"&&this.setAttribute("currentTime",k.toString())},addEventListener:function(k,j,$){p.indexOf(k)!==-1?(m[k]||(m[k]=[]),m[k].push(j)):A.addEventListener(k,j,$)},clearEventHandlers:function(){p.forEach(function(k){var j=m[k];j&&j.length>0&&j.forEach(function($){A.removeEventListener(k,$)})})},trigger:function(k,j){var $,le,me,ue,be,Le=m[k];if(k==="canrecord"&&(ue=A.videoWidth,be=A.videoHeight,N=(le=f)!==null&&le!==void 0&&le.size?ue/be>1?f.size:Math.floor(ue/be*f.size):ue,y=(me=f)!==null&&me!==void 0&&me.size?ue/be>1?Math.floor(be/ue*f.size):f.size:be,O.x=N,O.y=y),Le&&Le.length>0)for($=0;$<Le.length;$++)Le[$].apply(F,j)},setTopRight:function(k){b.x=k.x,b.y=k.y},getTopRight:function(){return b},setCanvasSize:function(k){O.x=k.x,O.y=k.y},getCanvasSize:function(){return O},getFrame:function(){return A}};return F},createLiveStream:function(A){console.warn("**** InputStreamBrowser createLiveStream"),A&&A.setAttribute("autoplay","true");var N=Ss.createVideoStream(A);return N.ended=function(){return!1},N},createImageStream:function(){var A,N,y=null,f=0,p=0,m=0,b=!0,O=!1,F=null,k=0,j=null,$=!1,le=["canrecord","ended"],me={},ue={x:0,y:0,type:"Point"},be={x:0,y:0,type:"XYSize"};function Le(De,at){var yt,Yt=me[De];if(Yt&&Yt.length>0)for(yt=0;yt<Yt.length;yt++)Yt[yt].apply(Ge,at)}var Ge={trigger:Le,getWidth:function(){return A},getHeight:function(){return N},setWidth:function(De){A=De},setHeight:function(De){N=De},getRealWidth:function(){return f},getRealHeight:function(){return p},setInputStream:function(De){var at;y=De,De.sequence===!1?(j=De.src,k=1):(j=De.src,k=De.length),O=!1,xc.load(j,function(yt){var Yt,ki;if(F=yt,yt[0].tags&&yt[0].tags.orientation)switch(yt[0].tags.orientation){case 6:case 8:f=yt[0].img.height,p=yt[0].img.width;break;default:f=yt[0].img.width,p=yt[0].img.height}else f=yt[0].img.width,p=yt[0].img.height;A=(Yt=y)!==null&&Yt!==void 0&&Yt.size?f/p>1?y.size:Math.floor(f/p*y.size):f,N=(ki=y)!==null&&ki!==void 0&&ki.size?f/p>1?Math.floor(p/f*y.size):y.size:p,be.x=A,be.y=N,O=!0,m=0,setTimeout(function(){Le("canrecord",[])},0)},1,k,(at=y)===null||at===void 0?void 0:at.sequence)},ended:function(){return $},setAttribute:function(){},getConfig:function(){return y},pause:function(){b=!0},play:function(){b=!1},setCurrentTime:function(De){m=De},addEventListener:function(De,at){le.indexOf(De)!==-1&&(me[De]||(me[De]=[]),me[De].push(at))},clearEventHandlers:function(){Object.keys(me).forEach(function(De){return delete me[De]})},setTopRight:function(De){ue.x=De.x,ue.y=De.y},getTopRight:function(){return ue},setCanvasSize:function(De){be.x=De.x,be.y=De.y},getCanvasSize:function(){return be},getFrame:function(){var De,at;return O?(b||(De=(at=F)===null||at===void 0?void 0:at[m],m<k-1?m++:setTimeout(function(){$=!0,Le("ended",[])},0)),De):null}};return Ge}},wc=Ss,$r=t(23),Cc=E()(function A(){x()(this,A),U()(this,"config",void 0),U()(this,"inputStream",void 0),U()(this,"framegrabber",void 0),U()(this,"inputImageWrapper",void 0),U()(this,"stopped",!1),U()(this,"boxSize",void 0),U()(this,"resultCollector",void 0),U()(this,"decoder",void 0),U()(this,"workerPool",[]),U()(this,"onUIThread",!0),U()(this,"canvasContainer",new _)}),As=E()(function A(){x()(this,A),U()(this,"image",void 0),U()(this,"overlay",void 0)}),_=E()(function A(){x()(this,A),U()(this,"ctx",void 0),U()(this,"dom",void 0),this.ctx=new As,this.dom=new As});function C(A){if(typeof document>"u")return null;if(A instanceof HTMLElement&&A.nodeName&&A.nodeType===1)return A;var N=typeof A=="string"?A:"#interactive.viewport";return document.querySelector(N)}function R(A,N,y){var f=function(m,b){var O=document.querySelector(m);return O||((O=document.createElement("canvas")).className=b),O}(A,N);console.warn("* initCanvas getCanvasAndContext");var p=f.getContext("2d",{willReadFrequently:y.willReadFrequently});return{canvas:f,context:p}}function X(A){var N,y,f,p,m,b,O=C(A==null||(N=A.config)===null||N===void 0||(y=N.inputStream)===null||y===void 0?void 0:y.target),F=A==null||(f=A.config)===null||f===void 0||(p=f.inputStream)===null||p===void 0?void 0:p.type;if(!F)return null;var k=function($,le){var me=le.willReadFrequently;if(typeof document<"u"){var ue=R("canvas.imgBuffer","imgBuffer",{willReadFrequently:me}),be=R("canvas.drawingBuffer","drawingBuffer",{willReadFrequently:me});return ue.canvas.width=be.canvas.width=$.x,ue.canvas.height=be.canvas.height=$.y,{dom:{image:ue.canvas,overlay:be.canvas},ctx:{image:ue.context,overlay:be.context}}}return null}(A.inputStream.getCanvasSize(),{willReadFrequently:!(A==null||(m=A.config)===null||m===void 0||(b=m.inputStream)===null||b===void 0||!b.willReadFrequently)});if(!k)return{dom:{image:null,overlay:null},ctx:{image:null,overlay:null}};var j=k.dom;return typeof document<"u"&&O&&(F!=="ImageStream"||O.contains(j.image)||O.appendChild(j.image),O.contains(j.overlay)||O.appendChild(j.overlay)),k}function J(A,N){var y=Object.keys(A);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(A);N&&(f=f.filter(function(p){return Object.getOwnPropertyDescriptor(A,p).enumerable})),y.push.apply(y,f)}return y}function de(A){for(var N=1;N<arguments.length;N++){var y=arguments[N]!=null?arguments[N]:{};N%2?J(Object(y),!0).forEach(function(f){U()(A,f,y[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(y)):J(Object(y)).forEach(function(f){Object.defineProperty(A,f,Object.getOwnPropertyDescriptor(y,f))})}return A}un.a.setMatrixArrayType(Array);var we=[];function Te(A){return de(de({},A),{},{inputStream:de(de({},A.inputStream),{},{target:null})})}function $e(A){if(A){var N=A().default;if(!N)return void self.postMessage({event:"error",message:"Quagga could not be created"})}var y;function f(m){self.postMessage({event:"processed",imageData:y.data,result:m},[y.data.buffer])}function p(){self.postMessage({event:"initialized",imageData:y.data},[y.data.buffer])}self.onmessage=function(m){if(m.data.cmd==="init"){var b=m.data.config;b.numOfWorkers=0,y=new N.ImageWrapper({x:m.data.size.x,y:m.data.size.y},new Uint8Array(m.data.imageData)),N.init(b,p,y),N.onProcessed(f)}else m.data.cmd==="process"?(y.data=new Uint8Array(m.data.imageData),N.start()):m.data.cmd==="setReaders"?N.setReaders(m.data.readers):m.data.cmd==="registerReader"&&N.registerReader(m.data.name,m.data.reader)}}function Et(A,N,y){var f,p,m=(typeof __factorySource__<"u"&&(p=__factorySource__),f=new Blob(["("+$e.toString()+")("+p+");"],{type:"text/javascript"}),window.URL.createObjectURL(f)),b={worker:new Worker(m),imageData:new Uint8Array(N.getWidth()*N.getHeight()),busy:!0};b.worker.onmessage=function(O){O.data.event==="initialized"?(URL.revokeObjectURL(m),b.busy=!1,b.imageData=new Uint8Array(O.data.imageData),y(b)):O.data.event==="processed"?(b.imageData=new Uint8Array(O.data.imageData),b.busy=!1,typeof publishResult<"u"&&publishResult(O.data.result,b.imageData)):O.data.event},b.worker.postMessage({cmd:"init",size:{x:N.getWidth(),y:N.getHeight()},imageData:b.imageData,config:Te(A)},[b.imageData.buffer])}function Dt(A,N,y,f){var p=A-we.length;if(p===0&&f)f();else if(p<0)we.slice(p).forEach(function(O){O.worker.terminate()}),we=we.slice(0,p),f&&f();else{var m=function(O){we.push(O),we.length>=A&&f&&f()};if(N)for(var b=0;b<p;b++)Et(N,y,m)}}function bn(A,N,y){for(var f=A.length;f--;)A[f][0]+=N,A[f][1]+=y}un.a.setMatrixArrayType(Array);var yn=function(){function A(){var f=this;x()(this,A),U()(this,"context",new Cc),U()(this,"canRecord",function(p){var m;f.context.config&&($r.a.checkImageConstraints(f.context.inputStream,(m=f.context.config)===null||m===void 0?void 0:m.locator),f.initCanvas(),f.context.framegrabber=pc.create(f.context.inputStream,f.context.canvasContainer.dom.image),f.context.config.numOfWorkers===void 0&&(f.context.config.numOfWorkers=0),Dt(f.context.config.numOfWorkers,f.context.config,f.context.inputStream,function(){var b;((b=f.context.config)===null||b===void 0?void 0:b.numOfWorkers)===0&&f.initializeData(),f.ready(p)}))}),U()(this,"update",function(){if(f.context.onUIThread){var p,m=(O=f.context.framegrabber,we.length?!!(F=we.filter(function(k){return!k.busy})[0])&&(O.attachData(F.imageData),O.grab()&&(F.busy=!0,F.worker.postMessage({cmd:"process",imageData:F.imageData},[F.imageData.buffer])),!0):null);m||(f.context.framegrabber.attachData((p=f.context.inputImageWrapper)===null||p===void 0?void 0:p.data),f.context.framegrabber.grab()&&(m||f.locateAndDecode()))}else{var b;f.context.framegrabber.attachData((b=f.context.inputImageWrapper)===null||b===void 0?void 0:b.data),f.context.framegrabber.grab(),f.locateAndDecode()}var O,F})}var N,y;return E()(A,[{key:"initBuffers",value:function(f){if(this.context.config){var p=function(O,F,k){var j=F||new l.a({x:O.getWidth(),y:O.getHeight(),type:"XYSize"}),$=[un.c.clone([0,0]),un.c.clone([0,j.size.y]),un.c.clone([j.size.x,j.size.y]),un.c.clone([j.size.x,0])];return $r.a.init(j,k),{inputImageWrapper:j,boxSize:$}}(this.context.inputStream,f,this.context.config.locator),m=p.inputImageWrapper,b=p.boxSize;this.context.inputImageWrapper=m,this.context.boxSize=b}}},{key:"initializeData",value:function(f){this.context.config&&(this.initBuffers(f),this.context.decoder=Hr.create(this.context.config.decoder,this.context.inputImageWrapper))}},{key:"getViewPort",value:function(){return this.context.config&&this.context.config.inputStream?C(this.context.config.inputStream.target):null}},{key:"ready",value:function(f){this.context.inputStream.play(),f()}},{key:"initCanvas",value:function(){var f=X(this.context);if(f){var p=f.ctx,m=f.dom;this.context.canvasContainer.dom.image=m.image,this.context.canvasContainer.dom.overlay=m.overlay,this.context.canvasContainer.ctx.image=p.image,this.context.canvasContainer.ctx.overlay=p.overlay}}},{key:"initInputStream",value:function(f){if(this.context.config&&this.context.config.inputStream){var p=this.context.config.inputStream,m=p.type,b=p.constraints,O=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"LiveStream",$=arguments.length>1?arguments[1]:void 0,le=arguments.length>2?arguments[2]:void 0;switch(j){case"VideoStream":var me=document.createElement("video");return{video:me,inputStream:le.createVideoStream(me)};case"ImageStream":return{inputStream:le.createImageStream()};case"LiveStream":var ue=null;return $&&((ue=$.querySelector("video"))||(ue=document.createElement("video"),$.appendChild(ue))),{video:ue,inputStream:le.createLiveStream(ue)};default:return console.error("* setupInputStream invalid type ".concat(j)),{video:null,inputStream:null}}}(m,this.getViewPort(),wc),F=O.video,k=O.inputStream;m==="LiveStream"&&F&&Zi.request(F,b).then(function(){return k.trigger("canrecord")}).catch(function(j){return f(j)}),k&&(k.setAttribute("preload","auto"),k.setInputStream(this.context.config.inputStream),k.addEventListener("canrecord",this.canRecord.bind(void 0,f))),this.context.inputStream=k}}},{key:"getBoundingBoxes",value:function(){var f;return(f=this.context.config)!==null&&f!==void 0&&f.locate?$r.a.locate():[[un.c.clone(this.context.boxSize[0]),un.c.clone(this.context.boxSize[1]),un.c.clone(this.context.boxSize[2]),un.c.clone(this.context.boxSize[3])]]}},{key:"transformResult",value:function(f){var p=this,m=this.context.inputStream.getTopRight(),b=m.x,O=m.y;if((b!==0||O!==0)&&(f.barcodes&&f.barcodes.forEach(function(k){return p.transformResult(k)}),f.line&&f.line.length===2&&function(k,j,$){k[0].x+=j,k[0].y+=$,k[1].x+=j,k[1].y+=$}(f.line,b,O),f.box&&bn(f.box,b,O),f.boxes&&f.boxes.length>0))for(var F=0;F<f.boxes.length;F++)bn(f.boxes[F],b,O)}},{key:"addResult",value:function(f,p){var m=this;p&&this.context.resultCollector&&(f.barcodes?f.barcodes.filter(function(b){return b.codeResult}).forEach(function(b){return m.addResult(b,p)}):f.codeResult&&this.context.resultCollector.addResult(p,this.context.inputStream.getCanvasSize(),f.codeResult))}},{key:"hasCodeResult",value:function(f){return!(!f||!(f.barcodes?f.barcodes.some(function(p){return p.codeResult}):f.codeResult))}},{key:"publishResult",value:function(){var f,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,m=arguments.length>1?arguments[1]:void 0,b=p;p&&this.context.onUIThread&&(this.transformResult(p),this.addResult(p,m),b=(p==null||(f=p.barcodes)===null||f===void 0?void 0:f.length)>0?p.barcodes:p),On.publish("processed",b),this.hasCodeResult(p)&&On.publish("detected",b)}},{key:"locateAndDecode",value:(y=d()(h.a.mark(function f(){var p,m,b,O,F;return h.a.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!(p=this.getBoundingBoxes())){k.next=12;break}return k.next=4,this.context.decoder.decodeFromBoundingBoxes(p);case 4:if(k.t0=k.sent,k.t0){k.next=7;break}k.t0={};case 7:(b=k.t0).boxes=p,this.publishResult(b,(m=this.context.inputImageWrapper)===null||m===void 0?void 0:m.data),k.next=16;break;case 12:return k.next=14,this.context.decoder.decodeFromImage(this.context.inputImageWrapper);case 14:(O=k.sent)?this.publishResult(O,(F=this.context.inputImageWrapper)===null||F===void 0?void 0:F.data):this.publishResult();case 16:case"end":return k.stop()}},f,this)})),function(){return y.apply(this,arguments)})},{key:"startContinuousUpdate",value:function(){var f,p=this,m=null,b=1e3/(((f=this.context.config)===null||f===void 0?void 0:f.frequency)||60);this.context.stopped=!1;var O=this.context;(function F(k){m=m||k,O.stopped||(k>=m&&(m+=b,p.update()),window.requestAnimationFrame(F))})(performance.now())}},{key:"start",value:function(){var f,p;this.context.onUIThread&&((f=this.context.config)===null||f===void 0||(p=f.inputStream)===null||p===void 0?void 0:p.type)==="LiveStream"?this.startContinuousUpdate():this.update()}},{key:"stop",value:(N=d()(h.a.mark(function f(){var p;return h.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this.context.stopped=!0,Dt(0),(p=this.context.config)===null||p===void 0||!p.inputStream||this.context.config.inputStream.type!=="LiveStream"){m.next=6;break}return m.next=5,Zi.release();case 5:this.context.inputStream.clearEventHandlers();case 6:case"end":return m.stop()}},f,this)})),function(){return N.apply(this,arguments)})},{key:"setReaders",value:function(f){this.context.decoder&&this.context.decoder.setReaders(f),function(p){we.forEach(function(m){return m.worker.postMessage({cmd:"setReaders",readers:p})})}(f)}},{key:"registerReader",value:function(f,p){Hr.registerReader(f,p),this.context.decoder&&this.context.decoder.registerReader(f,p),function(m,b){we.forEach(function(O){return O.worker.postMessage({cmd:"registerReader",name:m,reader:b})})}(f,p)}}]),A}(),qn=new yn,nr=qn.context,Xr={init:function(A,N,y){var f,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:qn;return N||(f=new Promise(function(m,b){N=function(O){O?b(O):m()}})),p.context.config=a()({},hc,A),p.context.config.numOfWorkers>0&&(p.context.config.numOfWorkers=0),y?(p.context.onUIThread=!1,p.initializeData(y),N&&N()):p.initInputStream(N),f},start:function(){return qn.start()},stop:function(){return qn.stop()},pause:function(){nr.stopped=!0},onDetected:function(A){A&&(typeof A=="function"||o()(A)==="object"&&A.callback)?On.subscribe("detected",A):console.trace("* warning: Quagga.onDetected called with invalid callback, ignoring")},offDetected:function(A){On.unsubscribe("detected",A)},onProcessed:function(A){A&&(typeof A=="function"||o()(A)==="object"&&A.callback)?On.subscribe("processed",A):console.trace("* warning: Quagga.onProcessed called with invalid callback, ignoring")},offProcessed:function(A){On.unsubscribe("processed",A)},setReaders:function(A){A?qn.setReaders(A):console.trace("* warning: Quagga.setReaders called with no readers, ignoring")},registerReader:function(A,N){A?N?qn.registerReader(A,N):console.trace("* warning: Quagga.registerReader called with no reader, ignoring"):console.trace("* warning: Quagga.registerReader called with no name, ignoring")},registerResultCollector:function(A){A&&typeof A.addResult=="function"&&(nr.resultCollector=A)},get canvas(){return nr.canvasContainer},decodeSingle:function(A,N){var y=this,f=new yn;return(A=a()({inputStream:{type:"ImageStream",sequence:!1,size:800,src:A.src},numOfWorkers:1,locator:{halfSample:!1}},A)).numOfWorkers>0&&(A.numOfWorkers=0),A.numOfWorkers>0&&(typeof Blob>"u"||typeof Worker>"u")&&(console.warn("* no Worker and/or Blob support - forcing numOfWorkers to 0"),A.numOfWorkers=0),new Promise(function(p,m){try{y.init(A,function(){On.once("processed",function(b){f.stop(),N&&N.call(null,b),p(b)},!0),f.start()},null,f)}catch(b){m(b)}})},get default(){return Xr},Readers:n,CameraAccess:Zi,ImageDebug:g.a,ImageWrapper:l.a,ResultCollector:xs};e.default=Xr}]).default})});var lm=_e((so,vr)=>{"use strict";var mb=200,Ug="__lodash_hash_undefined__",_b=800,vb=16,zg=9007199254740991,qg="[object Arguments]",bb="[object Array]",yb="[object AsyncFunction]",xb="[object Boolean]",wb="[object Date]",Cb="[object Error]",Hg="[object Function]",Eb="[object GeneratorFunction]",Sb="[object Map]",Ab="[object Number]",Mb="[object Null]",Wg="[object Object]",Pb="[object Proxy]",Ob="[object RegExp]",Tb="[object Set]",Ib="[object String]",kb="[object Undefined]",Rb="[object WeakMap]",Lb="[object ArrayBuffer]",Db="[object DataView]",Fb="[object Float32Array]",Nb="[object Float64Array]",Bb="[object Int8Array]",jb="[object Int16Array]",Vb="[object Int32Array]",Ub="[object Uint8Array]",zb="[object Uint8ClampedArray]",qb="[object Uint16Array]",Hb="[object Uint32Array]",Wb=/[\\^$.*+?()[\]{}|]/g,Gb=/^\[object .+?Constructor\]$/,$b=/^(?:0|[1-9]\d*)$/,ht={};ht[Fb]=ht[Nb]=ht[Bb]=ht[jb]=ht[Vb]=ht[Ub]=ht[zb]=ht[qb]=ht[Hb]=!0;ht[qg]=ht[bb]=ht[Lb]=ht[xb]=ht[Db]=ht[wb]=ht[Cb]=ht[Hg]=ht[Sb]=ht[Ab]=ht[Wg]=ht[Ob]=ht[Tb]=ht[Ib]=ht[Rb]=!1;var Gg=typeof global=="object"&&global&&global.Object===Object&&global,Xb=typeof self=="object"&&self&&self.Object===Object&&self,co=Gg||Xb||Function("return this")(),$g=typeof so=="object"&&so&&!so.nodeType&&so,ao=$g&&typeof vr=="object"&&vr&&!vr.nodeType&&vr,Xg=ao&&ao.exports===$g,ld=Xg&&Gg.process,kg=function(){try{var r=ao&&ao.require&&ao.require("util").types;return r||ld&&ld.binding&&ld.binding("util")}catch{}}(),Rg=kg&&kg.isTypedArray;function Kg(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}function Kb(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function Yb(r){return function(e){return r(e)}}function Qb(r,e){return r?.[e]}function Jb(r,e){return function(t){return r(e(t))}}var Zb=Array.prototype,ey=Function.prototype,ra=Object.prototype,cd=co["__core-js_shared__"],oa=ey.toString,Xn=ra.hasOwnProperty,Lg=function(){var r=/[^.]+$/.exec(cd&&cd.keys&&cd.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Yg=ra.toString,ty=oa.call(Object),ny=RegExp("^"+oa.call(Xn).replace(Wb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),na=Xg?co.Buffer:void 0,Dg=co.Symbol,Fg=co.Uint8Array,Ng=na?na.allocUnsafe:void 0,Qg=Jb(Object.getPrototypeOf,Object),Bg=Object.create,iy=ra.propertyIsEnumerable,ry=Zb.splice,Bi=Dg?Dg.toStringTag:void 0,ia=function(){try{var r=md(Object,"defineProperty");return r({},"",{}),r}catch{}}(),oy=na?na.isBuffer:void 0,jg=Math.max,sy=Date.now,Jg=md(co,"Map"),lo=md(Object,"create"),ay=function(){function r(){}return function(e){if(!$n(e))return{};if(Bg)return Bg(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}();function ji(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}function ly(){this.__data__=lo?lo(null):{},this.size=0}function cy(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}function dy(r){var e=this.__data__;if(lo){var t=e[r];return t===Ug?void 0:t}return Xn.call(e,r)?e[r]:void 0}function uy(r){var e=this.__data__;return lo?e[r]!==void 0:Xn.call(e,r)}function hy(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=lo&&e===void 0?Ug:e,this}ji.prototype.clear=ly;ji.prototype.delete=cy;ji.prototype.get=dy;ji.prototype.has=uy;ji.prototype.set=hy;function Kn(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}function fy(){this.__data__=[],this.size=0}function py(r){var e=this.__data__,t=sa(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():ry.call(e,t,1),--this.size,!0}function gy(r){var e=this.__data__,t=sa(e,r);return t<0?void 0:e[t][1]}function my(r){return sa(this.__data__,r)>-1}function _y(r,e){var t=this.__data__,n=sa(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}Kn.prototype.clear=fy;Kn.prototype.delete=py;Kn.prototype.get=gy;Kn.prototype.has=my;Kn.prototype.set=_y;function br(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}function vy(){this.size=0,this.__data__={hash:new ji,map:new(Jg||Kn),string:new ji}}function by(r){var e=la(this,r).delete(r);return this.size-=e?1:0,e}function yy(r){return la(this,r).get(r)}function xy(r){return la(this,r).has(r)}function wy(r,e){var t=la(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}br.prototype.clear=vy;br.prototype.delete=by;br.prototype.get=yy;br.prototype.has=xy;br.prototype.set=wy;function yr(r){var e=this.__data__=new Kn(r);this.size=e.size}function Cy(){this.__data__=new Kn,this.size=0}function Ey(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}function Sy(r){return this.__data__.get(r)}function Ay(r){return this.__data__.has(r)}function My(r,e){var t=this.__data__;if(t instanceof Kn){var n=t.__data__;if(!Jg||n.length<mb-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new br(n)}return t.set(r,e),this.size=t.size,this}yr.prototype.clear=Cy;yr.prototype.delete=Ey;yr.prototype.get=Sy;yr.prototype.has=Ay;yr.prototype.set=My;function Py(r,e){var t=fd(r),n=!t&&hd(r),i=!t&&!n&&im(r),o=!t&&!n&&!i&&om(r),s=t||n||i||o,a=s?Kb(r.length,String):[],l=a.length;for(var c in r)(e||Xn.call(r,c))&&!(s&&(c=="length"||i&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||tm(c,l)))&&a.push(c);return a}function dd(r,e,t){(t!==void 0&&!ca(r[e],t)||t===void 0&&!(e in r))&&pd(r,e,t)}function Oy(r,e,t){var n=r[e];(!(Xn.call(r,e)&&ca(n,t))||t===void 0&&!(e in r))&&pd(r,e,t)}function sa(r,e){for(var t=r.length;t--;)if(ca(r[t][0],e))return t;return-1}function pd(r,e,t){e=="__proto__"&&ia?ia(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var Ty=zy();function aa(r){return r==null?r===void 0?kb:Mb:Bi&&Bi in Object(r)?qy(r):Ky(r)}function Vg(r){return uo(r)&&aa(r)==qg}function Iy(r){if(!$n(r)||$y(r))return!1;var e=vd(r)?ny:Gb;return e.test(Zy(r))}function ky(r){return uo(r)&&rm(r.length)&&!!ht[aa(r)]}function Ry(r){if(!$n(r))return Xy(r);var e=nm(r),t=[];for(var n in r)n=="constructor"&&(e||!Xn.call(r,n))||t.push(n);return t}function gd(r,e,t,n,i){r!==e&&Ty(e,function(o,s){if(i||(i=new yr),$n(o))Ly(r,e,s,t,gd,n,i);else{var a=n?n(ud(r,s),o,s+"",r,e,i):void 0;a===void 0&&(a=o),dd(r,s,a)}},sm)}function Ly(r,e,t,n,i,o,s){var a=ud(r,t),l=ud(e,t),c=s.get(l);if(c){dd(r,t,c);return}var d=o?o(a,l,t+"",r,e,s):void 0,u=d===void 0;if(u){var h=fd(l),g=!h&&im(l),v=!h&&!g&&om(l);d=l,h||g||v?fd(a)?d=a:ex(a)?d=jy(a):g?(u=!1,d=Fy(l,!0)):v?(u=!1,d=By(l,!0)):d=[]:tx(l)||hd(l)?(d=a,hd(a)?d=nx(a):(!$n(a)||vd(a))&&(d=Hy(l))):u=!1}u&&(s.set(l,d),i(d,l,n,o,s),s.delete(l)),dd(r,t,d)}function Zg(r,e){return Qy(Yy(r,e,am),r+"")}var Dy=ia?function(r,e){return ia(r,"toString",{configurable:!0,enumerable:!1,value:ox(e),writable:!0})}:am;function Fy(r,e){if(e)return r.slice();var t=r.length,n=Ng?Ng(t):new r.constructor(t);return r.copy(n),n}function Ny(r){var e=new r.constructor(r.byteLength);return new Fg(e).set(new Fg(r)),e}function By(r,e){var t=e?Ny(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}function jy(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}function Vy(r,e,t,n){var i=!t;t||(t={});for(var o=-1,s=e.length;++o<s;){var a=e[o],l=n?n(t[a],r[a],a,t,r):void 0;l===void 0&&(l=r[a]),i?pd(t,a,l):Oy(t,a,l)}return t}function Uy(r){return Zg(function(e,t){var n=-1,i=t.length,o=i>1?t[i-1]:void 0,s=i>2?t[2]:void 0;for(o=r.length>3&&typeof o=="function"?(i--,o):void 0,s&&Wy(t[0],t[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var a=t[n];a&&r(e,a,n,o)}return e})}function zy(r){return function(e,t,n){for(var i=-1,o=Object(e),s=n(e),a=s.length;a--;){var l=s[r?a:++i];if(t(o[l],l,o)===!1)break}return e}}function em(r,e,t,n,i,o){return $n(r)&&$n(e)&&(o.set(e,r),gd(r,e,void 0,em,o),o.delete(e)),r}function la(r,e){var t=r.__data__;return Gy(e)?t[typeof e=="string"?"string":"hash"]:t.map}function md(r,e){var t=Qb(r,e);return Iy(t)?t:void 0}function qy(r){var e=Xn.call(r,Bi),t=r[Bi];try{r[Bi]=void 0;var n=!0}catch{}var i=Yg.call(r);return n&&(e?r[Bi]=t:delete r[Bi]),i}function Hy(r){return typeof r.constructor=="function"&&!nm(r)?ay(Qg(r)):{}}function tm(r,e){var t=typeof r;return e=e??zg,!!e&&(t=="number"||t!="symbol"&&$b.test(r))&&r>-1&&r%1==0&&r<e}function Wy(r,e,t){if(!$n(t))return!1;var n=typeof e;return(n=="number"?_d(t)&&tm(e,t.length):n=="string"&&e in t)?ca(t[e],r):!1}function Gy(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function $y(r){return!!Lg&&Lg in r}function nm(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||ra;return r===t}function Xy(r){var e=[];if(r!=null)for(var t in Object(r))e.push(t);return e}function Ky(r){return Yg.call(r)}function Yy(r,e,t){return e=jg(e===void 0?r.length-1:e,0),function(){for(var n=arguments,i=-1,o=jg(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=t(s),Kg(r,this,a)}}function ud(r,e){if(!(e==="constructor"&&typeof r[e]=="function")&&e!="__proto__")return r[e]}var Qy=Jy(Dy);function Jy(r){var e=0,t=0;return function(){var n=sy(),i=vb-(n-t);if(t=n,i>0){if(++e>=_b)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}function Zy(r){if(r!=null){try{return oa.call(r)}catch{}try{return r+""}catch{}}return""}function ca(r,e){return r===e||r!==r&&e!==e}var hd=Vg(function(){return arguments}())?Vg:function(r){return uo(r)&&Xn.call(r,"callee")&&!iy.call(r,"callee")},fd=Array.isArray;function _d(r){return r!=null&&rm(r.length)&&!vd(r)}function ex(r){return uo(r)&&_d(r)}var im=oy||sx;function vd(r){if(!$n(r))return!1;var e=aa(r);return e==Hg||e==Eb||e==yb||e==Pb}function rm(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=zg}function $n(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}function uo(r){return r!=null&&typeof r=="object"}function tx(r){if(!uo(r)||aa(r)!=Wg)return!1;var e=Qg(r);if(e===null)return!0;var t=Xn.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&oa.call(t)==ty}var om=Rg?Yb(Rg):ky;function nx(r){return Vy(r,sm(r))}var ix=Zg(function(r){return r.push(void 0,em),Kg(rx,void 0,r)});function sm(r){return _d(r)?Py(r,!0):Ry(r)}var rx=Uy(function(r,e,t,n){gd(r,e,t,n)});function ox(r){return function(){return r}}function am(r){return r}function sx(){return!1}vr.exports=ix});var on=_e(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});function hx(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var fx=function r(e,t){hx(this,r),this.data=e,this.text=t.text||e,this.options=t};bd.default=fx});var gm=_e(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.CODE39=void 0;var px=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),gx=on(),mx=_x(gx);function _x(r){return r&&r.__esModule?r:{default:r}}function vx(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function bx(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function yx(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var xx=function(r){yx(e,r);function e(t,n){return vx(this,e),t=t.toUpperCase(),n.mod43&&(t+=Ex(Sx(t))),bx(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return px(e,[{key:"encode",value:function(){for(var n=yd("*"),i=0;i<this.data.length;i++)n+=yd(this.data[i])+"0";return n+=yd("*"),{data:n,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),e}(mx.default),fm=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],wx=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function yd(r){return Cx(pm(r))}function Cx(r){return wx[r].toString(2)}function Ex(r){return fm[r]}function pm(r){return fm.indexOf(r)}function Sx(r){for(var e=0,t=0;t<r.length;t++)e+=pm(r[t]);return e=e%43,e}ua.CODE39=xx});var xr=_e(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});var ho;function xd(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var mm=St.SET_A=0,_m=St.SET_B=1,vm=St.SET_C=2,nL=St.SHIFT=98,Ax=St.START_A=103,Mx=St.START_B=104,Px=St.START_C=105,iL=St.MODULO=103,rL=St.STOP=106,oL=St.FNC1=207,sL=St.SET_BY_CODE=(ho={},xd(ho,Ax,mm),xd(ho,Mx,_m),xd(ho,Px,vm),ho),aL=St.SWAP={101:mm,100:_m,99:vm},lL=St.A_START_CHAR="\xD0",cL=St.B_START_CHAR="\xD1",dL=St.C_START_CHAR="\xD2",uL=St.A_CHARS="[\0-_\xC8-\xCF]",hL=St.B_CHARS="[ -\x7F\xC8-\xCF]",fL=St.C_CHARS="(\xCF*[0-9]{2}\xCF*)",pL=St.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]});var fo=_e(wd=>{"use strict";Object.defineProperty(wd,"__esModule",{value:!0});var Ox=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Tx=on(),Ix=kx(Tx),sn=xr();function kx(r){return r&&r.__esModule?r:{default:r}}function Rx(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Lx(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function Dx(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var Fx=function(r){Dx(e,r);function e(t,n){Rx(this,e);var i=Lx(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.substring(1),n));return i.bytes=t.split("").map(function(o){return o.charCodeAt(0)}),i}return Ox(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var n=this.bytes,i=n.shift()-105,o=sn.SET_BY_CODE[i];if(o===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&n.unshift(sn.FNC1);var s=e.next(n,1,o);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(i)+s.result+e.getBar((s.checksum+i)%sn.MODULO)+e.getBar(sn.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var n=this.options.ean128||!1;return typeof n=="string"&&(n=n.toLowerCase()==="true"),n}}],[{key:"getBar",value:function(n){return sn.BARS[n]?sn.BARS[n].toString():""}},{key:"correctIndex",value:function(n,i){if(i===sn.SET_A){var o=n.shift();return o<32?o+64:o-32}else return i===sn.SET_B?n.shift()-32:(n.shift()-48)*10+n.shift()-48}},{key:"next",value:function(n,i,o){if(!n.length)return{result:"",checksum:0};var s=void 0,a=void 0;if(n[0]>=200){a=n.shift()-105;var l=sn.SWAP[a];l!==void 0?s=e.next(n,i+1,l):((o===sn.SET_A||o===sn.SET_B)&&a===sn.SHIFT&&(n[0]=o===sn.SET_A?n[0]>95?n[0]-96:n[0]:n[0]<32?n[0]+96:n[0]),s=e.next(n,i+1,o))}else a=e.correctIndex(n,o),s=e.next(n,i+1,o);var c=e.getBar(a),d=a*i;return{result:c+s.result,checksum:d+s.checksum}}}]),e}(Ix.default);wd.default=Fx});var Cm=_e(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});var yi=xr(),bm=function(e){return e.match(new RegExp("^"+yi.A_CHARS+"*"))[0].length},ym=function(e){return e.match(new RegExp("^"+yi.B_CHARS+"*"))[0].length},xm=function(e){return e.match(new RegExp("^"+yi.C_CHARS+"*"))[0]};function Cd(r,e){var t=e?yi.A_CHARS:yi.B_CHARS,n=r.match(new RegExp("^("+t+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(n)return n[1]+"\xCC"+wm(r.substring(n[1].length));var i=r.match(new RegExp("^"+t+"+"))[0];return i.length===r.length?r:i+String.fromCharCode(e?205:206)+Cd(r.substring(i.length),!e)}function wm(r){var e=xm(r),t=e.length;if(t===r.length)return r;r=r.substring(t);var n=bm(r)>=ym(r);return e+String.fromCharCode(n?206:205)+Cd(r,n)}Ed.default=function(r){var e=void 0,t=xm(r).length;if(t>=2)e=yi.C_START_CHAR+wm(r);else{var n=bm(r)>ym(r);e=(n?yi.A_START_CHAR:yi.B_START_CHAR)+Cd(r,n)}return e.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(i,o){return"\xCB"+o})}});var Sm=_e(Ad=>{"use strict";Object.defineProperty(Ad,"__esModule",{value:!0});var Nx=fo(),Bx=Em(Nx),jx=Cm(),Vx=Em(jx);function Em(r){return r&&r.__esModule?r:{default:r}}function Ux(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Sd(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function zx(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var qx=function(r){zx(e,r);function e(t,n){if(Ux(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var i=Sd(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,Vx.default)(t),n));else var i=Sd(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return Sd(i)}return e}(Bx.default);Ad.default=qx});var Mm=_e(Md=>{"use strict";Object.defineProperty(Md,"__esModule",{value:!0});var Hx=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Wx=fo(),Gx=$x(Wx),Am=xr();function $x(r){return r&&r.__esModule?r:{default:r}}function Xx(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Kx(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function Yx(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var Qx=function(r){Yx(e,r);function e(t,n){return Xx(this,e),Kx(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,Am.A_START_CHAR+t,n))}return Hx(e,[{key:"valid",value:function(){return new RegExp("^"+Am.A_CHARS+"+$").test(this.data)}}]),e}(Gx.default);Md.default=Qx});var Om=_e(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});var Jx=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Zx=fo(),ew=tw(Zx),Pm=xr();function tw(r){return r&&r.__esModule?r:{default:r}}function nw(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function iw(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function rw(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var ow=function(r){rw(e,r);function e(t,n){return nw(this,e),iw(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,Pm.B_START_CHAR+t,n))}return Jx(e,[{key:"valid",value:function(){return new RegExp("^"+Pm.B_CHARS+"+$").test(this.data)}}]),e}(ew.default);Pd.default=ow});var Im=_e(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});var sw=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),aw=fo(),lw=cw(aw),Tm=xr();function cw(r){return r&&r.__esModule?r:{default:r}}function dw(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function uw(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function hw(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var fw=function(r){hw(e,r);function e(t,n){return dw(this,e),uw(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,Tm.C_START_CHAR+t,n))}return sw(e,[{key:"valid",value:function(){return new RegExp("^"+Tm.C_CHARS+"+$").test(this.data)}}]),e}(lw.default);Od.default=fw});var km=_e(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.CODE128C=Dn.CODE128B=Dn.CODE128A=Dn.CODE128=void 0;var pw=Sm(),gw=ha(pw),mw=Mm(),_w=ha(mw),vw=Om(),bw=ha(vw),yw=Im(),xw=ha(yw);function ha(r){return r&&r.__esModule?r:{default:r}}Dn.CODE128=gw.default;Dn.CODE128A=_w.default;Dn.CODE128B=bw.default;Dn.CODE128C=xw.default});var wr=_e(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});var CL=xi.SIDE_BIN="101",EL=xi.MIDDLE_BIN="01010",SL=xi.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},AL=xi.EAN2_STRUCTURE=["LL","LG","GL","GG"],ML=xi.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],PL=xi.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]});var Cr=_e(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});var ww=wr(),Cw=function(e,t,n){var i=e.split("").map(function(s,a){return ww.BINARIES[t[a]]}).map(function(s,a){return s?s[e[a]]:""});if(n){var o=e.length-1;i=i.map(function(s,a){return a<o?s+n:s})}return i.join("")};Td.default=Cw});var kd=_e(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});var Ew=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Er=wr(),Sw=Cr(),Rm=Lm(Sw),Aw=on(),Mw=Lm(Aw);function Lm(r){return r&&r.__esModule?r:{default:r}}function Pw(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Ow(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function Tw(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var Iw=function(r){Tw(e,r);function e(t,n){Pw(this,e);var i=Ow(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.fontSize=!n.flat&&n.fontSize>n.width*10?n.width*10:n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return Ew(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(n,i){return this.text.substr(n,i)}},{key:"leftEncode",value:function(n,i){return(0,Rm.default)(n,i)}},{key:"rightText",value:function(n,i){return this.text.substr(n,i)}},{key:"rightEncode",value:function(n,i){return(0,Rm.default)(n,i)}},{key:"encodeGuarded",value:function(){var n={fontSize:this.fontSize},i={height:this.guardHeight};return[{data:Er.SIDE_BIN,options:i},{data:this.leftEncode(),text:this.leftText(),options:n},{data:Er.MIDDLE_BIN,options:i},{data:this.rightEncode(),text:this.rightText(),options:n},{data:Er.SIDE_BIN,options:i}]}},{key:"encodeFlat",value:function(){var n=[Er.SIDE_BIN,this.leftEncode(),Er.MIDDLE_BIN,this.rightEncode(),Er.SIDE_BIN];return{data:n.join(""),text:this.text}}}]),e}(Mw.default);Id.default=Iw});var Fm=_e(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});var kw=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),po=function r(e,t,n){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:r(o,t,n)}else{if("value"in i)return i.value;var s=i.get;return s===void 0?void 0:s.call(n)}},Rw=wr(),Lw=kd(),Dw=Fw(Lw);function Fw(r){return r&&r.__esModule?r:{default:r}}function Nw(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Bw(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function jw(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var Dm=function(e){var t=e.substr(0,12).split("").map(function(n){return+n}).reduce(function(n,i,o){return o%2?n+i*3:n+i},0);return(10-t%10)%10},Vw=function(r){jw(e,r);function e(t,n){Nw(this,e),t.search(/^[0-9]{12}$/)!==-1&&(t+=Dm(t));var i=Bw(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.lastChar=n.lastChar,i}return kw(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===Dm(this.data)}},{key:"leftText",value:function(){return po(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var n=this.data.substr(1,6),i=Rw.EAN13_STRUCTURE[this.data[0]];return po(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,n,i)}},{key:"rightText",value:function(){return po(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var n=this.data.substr(7,6);return po(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,n,"RRRRRR")}},{key:"encodeGuarded",value:function(){var n=po(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(n.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(n.push({data:"00"}),n.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),n}}]),e}(Dw.default);Rd.default=Vw});var Bm=_e(Ld=>{"use strict";Object.defineProperty(Ld,"__esModule",{value:!0});var Uw=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),fa=function r(e,t,n){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:r(o,t,n)}else{if("value"in i)return i.value;var s=i.get;return s===void 0?void 0:s.call(n)}},zw=kd(),qw=Hw(zw);function Hw(r){return r&&r.__esModule?r:{default:r}}function Ww(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Gw(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function $w(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var Nm=function(e){var t=e.substr(0,7).split("").map(function(n){return+n}).reduce(function(n,i,o){return o%2?n+i:n+i*3},0);return(10-t%10)%10},Xw=function(r){$w(e,r);function e(t,n){return Ww(this,e),t.search(/^[0-9]{7}$/)!==-1&&(t+=Nm(t)),Gw(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return Uw(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===Nm(this.data)}},{key:"leftText",value:function(){return fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var n=this.data.substr(0,4);return fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,n,"LLLL")}},{key:"rightText",value:function(){return fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var n=this.data.substr(4,4);return fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,n,"RRRR")}}]),e}(qw.default);Ld.default=Xw});var Vm=_e(Dd=>{"use strict";Object.defineProperty(Dd,"__esModule",{value:!0});var Kw=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Yw=wr(),Qw=Cr(),Jw=jm(Qw),Zw=on(),eC=jm(Zw);function jm(r){return r&&r.__esModule?r:{default:r}}function tC(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function nC(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function iC(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var rC=function(e){var t=e.split("").map(function(n){return+n}).reduce(function(n,i,o){return o%2?n+i*9:n+i*3},0);return t%10},oC=function(r){iC(e,r);function e(t,n){return tC(this,e),nC(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return Kw(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var n=Yw.EAN5_STRUCTURE[rC(this.data)];return{data:"1011"+(0,Jw.default)(this.data,n,"01"),text:this.text}}}]),e}(eC.default);Dd.default=oC});var zm=_e(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});var sC=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),aC=wr(),lC=Cr(),cC=Um(lC),dC=on(),uC=Um(dC);function Um(r){return r&&r.__esModule?r:{default:r}}function hC(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function fC(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function pC(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var gC=function(r){pC(e,r);function e(t,n){return hC(this,e),fC(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return sC(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var n=aC.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,cC.default)(this.data,n,"01"),text:this.text}}}]),e}(uC.default);Fd.default=gC});var Bd=_e(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});var mC=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();pa.checksum=Nd;var _C=Cr(),Sr=qm(_C),vC=on(),bC=qm(vC);function qm(r){return r&&r.__esModule?r:{default:r}}function yC(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function xC(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function wC(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var CC=function(r){wC(e,r);function e(t,n){yC(this,e),t.search(/^[0-9]{11}$/)!==-1&&(t+=Nd(t));var i=xC(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.displayValue=n.displayValue,n.fontSize>n.width*10?i.fontSize=n.width*10:i.fontSize=n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return mC(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==Nd(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var n="";return n+="101",n+=(0,Sr.default)(this.data.substr(0,6),"LLLLLL"),n+="01010",n+=(0,Sr.default)(this.data.substr(6,6),"RRRRRR"),n+="101",{data:n,text:this.text}}},{key:"guardedEncoding",value:function(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101"+(0,Sr.default)(this.data[0],"L"),options:{height:this.guardHeight}}),n.push({data:(0,Sr.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),n.push({data:"01010",options:{height:this.guardHeight}}),n.push({data:(0,Sr.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),n.push({data:(0,Sr.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),n}}]),e}(bC.default);function Nd(r){var e=0,t;for(t=1;t<11;t+=2)e+=parseInt(r[t]);for(t=0;t<11;t+=2)e+=parseInt(r[t])*3;return(10-e%10)%10}pa.default=CC});var Gm=_e(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});var EC=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),SC=Cr(),AC=Wm(SC),MC=on(),PC=Wm(MC),OC=Bd();function Wm(r){return r&&r.__esModule?r:{default:r}}function TC(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function jd(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function IC(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var kC=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],RC=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],LC=function(r){IC(e,r);function e(t,n){TC(this,e);var i=jd(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));if(i.isValid=!1,t.search(/^[0-9]{6}$/)!==-1)i.middleDigits=t,i.upcA=Hm(t,"0"),i.text=n.text||""+i.upcA[0]+t+i.upcA[i.upcA.length-1],i.isValid=!0;else if(t.search(/^[01][0-9]{7}$/)!==-1)if(i.middleDigits=t.substring(1,t.length-1),i.upcA=Hm(i.middleDigits,t[0]),i.upcA[i.upcA.length-1]===t[t.length-1])i.isValid=!0;else return jd(i);else return jd(i);return i.displayValue=n.displayValue,n.fontSize>n.width*10?i.fontSize=n.width*10:i.fontSize=n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return EC(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var n="";return n+="101",n+=this.encodeMiddleDigits(),n+="010101",{data:n,text:this.text}}},{key:"guardedEncoding",value:function(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101",options:{height:this.guardHeight}}),n.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),n.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),n}},{key:"encodeMiddleDigits",value:function(){var n=this.upcA[0],i=this.upcA[this.upcA.length-1],o=RC[parseInt(i)][parseInt(n)];return(0,AC.default)(this.middleDigits,o)}}]),e}(PC.default);function Hm(r,e){for(var t=parseInt(r[r.length-1]),n=kC[t],i="",o=0,s=0;s<n.length;s++){var a=n[s];a==="X"?i+=r[o++]:i+=a}return i=""+e+i,""+i+(0,OC.checksum)(i)}Vd.default=LC});var $m=_e(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.UPCE=en.UPC=en.EAN2=en.EAN5=en.EAN8=en.EAN13=void 0;var DC=Fm(),FC=Ar(DC),NC=Bm(),BC=Ar(NC),jC=Vm(),VC=Ar(jC),UC=zm(),zC=Ar(UC),qC=Bd(),HC=Ar(qC),WC=Gm(),GC=Ar(WC);function Ar(r){return r&&r.__esModule?r:{default:r}}en.EAN13=FC.default;en.EAN8=BC.default;en.EAN5=VC.default;en.EAN2=zC.default;en.UPC=HC.default;en.UPCE=GC.default});var Xm=_e(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});var jL=go.START_BIN="1010",VL=go.END_BIN="11101",UL=go.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]});var zd=_e(Ud=>{"use strict";Object.defineProperty(Ud,"__esModule",{value:!0});var $C=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),ga=Xm(),XC=on(),KC=YC(XC);function YC(r){return r&&r.__esModule?r:{default:r}}function QC(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function JC(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function ZC(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var eE=function(r){ZC(e,r);function e(){return QC(this,e),JC(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return $C(e,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var n=this,i=this.data.match(/.{2}/g).map(function(o){return n.encodePair(o)}).join("");return{data:ga.START_BIN+i+ga.END_BIN,text:this.text}}},{key:"encodePair",value:function(n){var i=ga.BINARIES[n[1]];return ga.BINARIES[n[0]].split("").map(function(o,s){return(o==="1"?"111":"1")+(i[s]==="1"?"000":"0")}).join("")}}]),e}(KC.default);Ud.default=eE});var Ym=_e(qd=>{"use strict";Object.defineProperty(qd,"__esModule",{value:!0});var tE=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),nE=zd(),iE=rE(nE);function rE(r){return r&&r.__esModule?r:{default:r}}function oE(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function sE(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function aE(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var Km=function(e){var t=e.substr(0,13).split("").map(function(n){return parseInt(n,10)}).reduce(function(n,i,o){return n+i*(3-o%2*2)},0);return Math.ceil(t/10)*10-t},lE=function(r){aE(e,r);function e(t,n){return oE(this,e),t.search(/^[0-9]{13}$/)!==-1&&(t+=Km(t)),sE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return tE(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===Km(this.data)}}]),e}(iE.default);qd.default=lE});var Jm=_e(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.ITF14=Mr.ITF=void 0;var cE=zd(),dE=Qm(cE),uE=Ym(),hE=Qm(uE);function Qm(r){return r&&r.__esModule?r:{default:r}}Mr.ITF=dE.default;Mr.ITF14=hE.default});var Pr=_e(Hd=>{"use strict";Object.defineProperty(Hd,"__esModule",{value:!0});var fE=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),pE=on(),gE=mE(pE);function mE(r){return r&&r.__esModule?r:{default:r}}function _E(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function vE(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function bE(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var yE=function(r){bE(e,r);function e(t,n){return _E(this,e),vE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return fE(e,[{key:"encode",value:function(){for(var n="110",i=0;i<this.data.length;i++){var o=parseInt(this.data[i]),s=o.toString(2);s=xE(s,4-s.length);for(var a=0;a<s.length;a++)n+=s[a]=="0"?"100":"110"}return n+="1001",{data:n,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),e}(gE.default);function xE(r,e){for(var t=0;t<e;t++)r="0"+r;return r}Hd.default=yE});var mo=_e(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.mod10=wE;ma.mod11=CE;function wE(r){for(var e=0,t=0;t<r.length;t++){var n=parseInt(r[t]);(t+r.length)%2===0?e+=n:e+=n*2%10+Math.floor(n*2/10)}return(10-e%10)%10}function CE(r){for(var e=0,t=[2,3,4,5,6,7],n=0;n<r.length;n++){var i=parseInt(r[r.length-1-n]);e+=t[n%t.length]*i}return(11-e%11)%11}});var Zm=_e(Wd=>{"use strict";Object.defineProperty(Wd,"__esModule",{value:!0});var EE=Pr(),SE=ME(EE),AE=mo();function ME(r){return r&&r.__esModule?r:{default:r}}function PE(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function OE(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function TE(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var IE=function(r){TE(e,r);function e(t,n){return PE(this,e),OE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,AE.mod10)(t),n))}return e}(SE.default);Wd.default=IE});var e0=_e(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});var kE=Pr(),RE=DE(kE),LE=mo();function DE(r){return r&&r.__esModule?r:{default:r}}function FE(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function NE(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function BE(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var jE=function(r){BE(e,r);function e(t,n){return FE(this,e),NE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,LE.mod11)(t),n))}return e}(RE.default);Gd.default=jE});var n0=_e($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});var VE=Pr(),UE=zE(VE),t0=mo();function zE(r){return r&&r.__esModule?r:{default:r}}function qE(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function HE(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function WE(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var GE=function(r){WE(e,r);function e(t,n){return qE(this,e),t+=(0,t0.mod10)(t),t+=(0,t0.mod10)(t),HE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return e}(UE.default);$d.default=GE});var r0=_e(Xd=>{"use strict";Object.defineProperty(Xd,"__esModule",{value:!0});var $E=Pr(),XE=KE($E),i0=mo();function KE(r){return r&&r.__esModule?r:{default:r}}function YE(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function QE(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function JE(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var ZE=function(r){JE(e,r);function e(t,n){return YE(this,e),t+=(0,i0.mod11)(t),t+=(0,i0.mod10)(t),QE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return e}(XE.default);Xd.default=ZE});var o0=_e(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.MSI1110=gn.MSI1010=gn.MSI11=gn.MSI10=gn.MSI=void 0;var eS=Pr(),tS=_o(eS),nS=Zm(),iS=_o(nS),rS=e0(),oS=_o(rS),sS=n0(),aS=_o(sS),lS=r0(),cS=_o(lS);function _o(r){return r&&r.__esModule?r:{default:r}}gn.MSI=tS.default;gn.MSI10=iS.default;gn.MSI11=oS.default;gn.MSI1010=aS.default;gn.MSI1110=cS.default});var s0=_e(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.pharmacode=void 0;var dS=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),uS=on(),hS=fS(uS);function fS(r){return r&&r.__esModule?r:{default:r}}function pS(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function gS(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function mS(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var _S=function(r){mS(e,r);function e(t,n){pS(this,e);var i=gS(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.number=parseInt(t,10),i}return dS(e,[{key:"encode",value:function(){for(var n=this.number,i="";!isNaN(n)&&n!=0;)n%2===0?(i="11100"+i,n=(n-2)/2):(i="100"+i,n=(n-1)/2);return i=i.slice(0,-2),{data:i,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}(hS.default);_a.pharmacode=_S});var a0=_e(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.codabar=void 0;var vS=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),bS=on(),yS=xS(bS);function xS(r){return r&&r.__esModule?r:{default:r}}function wS(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function CS(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function ES(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var SS=function(r){ES(e,r);function e(t,n){wS(this,e),t.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(t="A"+t+"A");var i=CS(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.toUpperCase(),n));return i.text=i.options.text||i.text.replace(/[A-D]/g,""),i}return vS(e,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var n=[],i=this.getEncodings(),o=0;o<this.data.length;o++)n.push(i[this.data.charAt(o)]),o!==this.data.length-1&&n.push("0");return{text:this.text,data:n.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}(yS.default);va.codabar=SS});var l0=_e(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.GenericBarcode=void 0;var AS=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),MS=on(),PS=OS(MS);function OS(r){return r&&r.__esModule?r:{default:r}}function TS(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function IS(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function kS(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var RS=function(r){kS(e,r);function e(t,n){return TS(this,e),IS(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return AS(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}(PS.default);ba.GenericBarcode=RS});var d0=_e(Kd=>{"use strict";Object.defineProperty(Kd,"__esModule",{value:!0});var LS=gm(),ya=km(),Or=$m(),c0=Jm(),vo=o0(),DS=s0(),FS=a0(),NS=l0();Kd.default={CODE39:LS.CODE39,CODE128:ya.CODE128,CODE128A:ya.CODE128A,CODE128B:ya.CODE128B,CODE128C:ya.CODE128C,EAN13:Or.EAN13,EAN8:Or.EAN8,EAN5:Or.EAN5,EAN2:Or.EAN2,UPC:Or.UPC,UPCE:Or.UPCE,ITF14:c0.ITF14,ITF:c0.ITF,MSI:vo.MSI,MSI10:vo.MSI10,MSI11:vo.MSI11,MSI1010:vo.MSI1010,MSI1110:vo.MSI1110,pharmacode:DS.pharmacode,codabar:FS.codabar,GenericBarcode:NS.GenericBarcode}});var bo=_e(Yd=>{"use strict";Object.defineProperty(Yd,"__esModule",{value:!0});var BS=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r};Yd.default=function(r,e){return BS({},r,e)}});var u0=_e(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.default=jS;function jS(r){var e=[];function t(n){if(Array.isArray(n))for(var i=0;i<n.length;i++)t(n[i]);else n.text=n.text||"",n.data=n.data||"",e.push(n)}return t(r),e}});var h0=_e(Jd=>{"use strict";Object.defineProperty(Jd,"__esModule",{value:!0});Jd.default=VS;function VS(r){return r.marginTop=r.marginTop||r.margin,r.marginBottom=r.marginBottom||r.margin,r.marginRight=r.marginRight||r.margin,r.marginLeft=r.marginLeft||r.margin,r}});var eu=_e(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.default=US;function US(r){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var t in e)e.hasOwnProperty(t)&&(t=e[t],typeof r[t]=="string"&&(r[t]=parseInt(r[t],10)));return typeof r.displayValue=="string"&&(r.displayValue=r.displayValue!="false"),r}});var nu=_e(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});var zS={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};tu.default=zS});var g0=_e(iu=>{"use strict";Object.defineProperty(iu,"__esModule",{value:!0});var qS=eu(),HS=p0(qS),WS=nu(),f0=p0(WS);function p0(r){return r&&r.__esModule?r:{default:r}}function GS(r){var e={};for(var t in f0.default)f0.default.hasOwnProperty(t)&&(r.hasAttribute("jsbarcode-"+t.toLowerCase())&&(e[t]=r.getAttribute("jsbarcode-"+t.toLowerCase())),r.hasAttribute("data-"+t.toLowerCase())&&(e[t]=r.getAttribute("data-"+t.toLowerCase())));return e.value=r.getAttribute("jsbarcode-value")||r.getAttribute("data-value"),e=(0,HS.default)(e),e}iu.default=GS});var ru=_e(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.getTotalWidthOfEncodings=mn.calculateEncodingAttributes=mn.getBarcodePadding=mn.getEncodingHeight=mn.getMaximumHeightOfEncodings=void 0;var $S=bo(),XS=KS($S);function KS(r){return r&&r.__esModule?r:{default:r}}function m0(r,e){return e.height+(e.displayValue&&r.text.length>0?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function _0(r,e,t){if(t.displayValue&&e<r){if(t.textAlign=="center")return Math.floor((r-e)/2);if(t.textAlign=="left")return 0;if(t.textAlign=="right")return Math.floor(r-e)}return 0}function YS(r,e,t){for(var n=0;n<r.length;n++){var i=r[n],o=(0,XS.default)(e,i.options),s;o.displayValue?s=ZS(i.text,o,t):s=0;var a=i.data.length*o.width;i.width=Math.ceil(Math.max(s,a)),i.height=m0(i,o),i.barcodePadding=_0(s,a,o)}}function QS(r){for(var e=0,t=0;t<r.length;t++)e+=r[t].width;return e}function JS(r){for(var e=0,t=0;t<r.length;t++)r[t].height>e&&(e=r[t].height);return e}function ZS(r,e,t){var n;if(t)n=t;else if(typeof document<"u")n=document.createElement("canvas").getContext("2d");else return 0;n.font=e.fontOptions+" "+e.fontSize+"px "+e.font;var i=n.measureText(r);if(!i)return 0;var o=i.width;return o}mn.getMaximumHeightOfEncodings=JS;mn.getEncodingHeight=m0;mn.getBarcodePadding=_0;mn.calculateEncodingAttributes=YS;mn.getTotalWidthOfEncodings=QS});var v0=_e(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});var eA=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),tA=bo(),nA=iA(tA),ou=ru();function iA(r){return r&&r.__esModule?r:{default:r}}function rA(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var oA=function(){function r(e,t,n){rA(this,r),this.canvas=e,this.encodings=t,this.options=n}return eA(r,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var n=(0,nA.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(n,this.encodings[t]),this.drawCanvasText(n,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,ou.calculateEncodingAttributes)(this.encodings,this.options,t);var n=(0,ou.getTotalWidthOfEncodings)(this.encodings),i=(0,ou.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=n+this.options.marginLeft+this.options.marginRight,this.canvas.height=i,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,n){var i=this.canvas.getContext("2d"),o=n.data,s;t.textPosition=="top"?s=t.marginTop+t.fontSize+t.textMargin:s=t.marginTop,i.fillStyle=t.lineColor;for(var a=0;a<o.length;a++){var l=a*t.width+n.barcodePadding;o[a]==="1"?i.fillRect(l,s,t.width,t.height):o[a]&&i.fillRect(l,s,t.width,t.height*o[a])}}},{key:"drawCanvasText",value:function(t,n){var i=this.canvas.getContext("2d"),o=t.fontOptions+" "+t.fontSize+"px "+t.font;if(t.displayValue){var s,a;t.textPosition=="top"?a=t.marginTop+t.fontSize-t.textMargin:a=t.height+t.textMargin+t.marginTop+t.fontSize,i.font=o,t.textAlign=="left"||n.barcodePadding>0?(s=0,i.textAlign="left"):t.textAlign=="right"?(s=n.width-1,i.textAlign="right"):(s=n.width/2,i.textAlign="center"),i.fillText(n.text,s,a)}}},{key:"moveCanvasDrawing",value:function(t){var n=this.canvas.getContext("2d");n.translate(t.width,0)}},{key:"restoreCanvas",value:function(){var t=this.canvas.getContext("2d");t.restore()}}]),r}();su.default=oA});var b0=_e(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});var sA=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),aA=bo(),lA=cA(aA),au=ru();function cA(r){return r&&r.__esModule?r:{default:r}}function dA(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var xa="http://www.w3.org/2000/svg",uA=function(){function r(e,t,n){dA(this,r),this.svg=e,this.encodings=t,this.options=n,this.document=n.xmlDocument||document}return sA(r,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var n=0;n<this.encodings.length;n++){var i=this.encodings[n],o=(0,lA.default)(this.options,i.options),s=this.createGroup(t,o.marginTop,this.svg);this.setGroupOptions(s,o),this.drawSvgBarcode(s,o,i),this.drawSVGText(s,o,i),t+=i.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,au.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,au.getTotalWidthOfEncodings)(this.encodings),n=(0,au.getMaximumHeightOfEncodings)(this.encodings),i=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(i,n),this.options.background&&this.drawRect(0,0,i,n,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,n,i){var o=i.data,s;n.textPosition=="top"?s=n.fontSize+n.textMargin:s=0;for(var a=0,l=0,c=0;c<o.length;c++)l=c*n.width+i.barcodePadding,o[c]==="1"?a++:a>0&&(this.drawRect(l-n.width*a,s,n.width*a,n.height,t),a=0);a>0&&this.drawRect(l-n.width*(a-1),s,n.width*a,n.height,t)}},{key:"drawSVGText",value:function(t,n,i){var o=this.document.createElementNS(xa,"text");if(n.displayValue){var s,a;o.setAttribute("style","font:"+n.fontOptions+" "+n.fontSize+"px "+n.font),n.textPosition=="top"?a=n.fontSize-n.textMargin:a=n.height+n.textMargin+n.fontSize,n.textAlign=="left"||i.barcodePadding>0?(s=0,o.setAttribute("text-anchor","start")):n.textAlign=="right"?(s=i.width-1,o.setAttribute("text-anchor","end")):(s=i.width/2,o.setAttribute("text-anchor","middle")),o.setAttribute("x",s),o.setAttribute("y",a),o.appendChild(this.document.createTextNode(i.text)),t.appendChild(o)}}},{key:"setSvgAttributes",value:function(t,n){var i=this.svg;i.setAttribute("width",t+"px"),i.setAttribute("height",n+"px"),i.setAttribute("x","0px"),i.setAttribute("y","0px"),i.setAttribute("viewBox","0 0 "+t+" "+n),i.setAttribute("xmlns",xa),i.setAttribute("version","1.1"),i.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,n,i){var o=this.document.createElementNS(xa,"g");return o.setAttribute("transform","translate("+t+", "+n+")"),i.appendChild(o),o}},{key:"setGroupOptions",value:function(t,n){t.setAttribute("style","fill:"+n.lineColor+";")}},{key:"drawRect",value:function(t,n,i,o,s){var a=this.document.createElementNS(xa,"rect");return a.setAttribute("x",t),a.setAttribute("y",n),a.setAttribute("width",i),a.setAttribute("height",o),s.appendChild(a),a}}]),r}();lu.default=uA});var y0=_e(cu=>{"use strict";Object.defineProperty(cu,"__esModule",{value:!0});var hA=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function fA(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var pA=function(){function r(e,t,n){fA(this,r),this.object=e,this.encodings=t,this.options=n}return hA(r,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),r}();cu.default=pA});var x0=_e(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});var gA=v0(),mA=du(gA),_A=b0(),vA=du(_A),bA=y0(),yA=du(bA);function du(r){return r&&r.__esModule?r:{default:r}}uu.default={CanvasRenderer:mA.default,SVGRenderer:vA.default,ObjectRenderer:yA.default}});var gu=_e(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});function hu(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function fu(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function pu(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var xA=function(r){pu(e,r);function e(t,n){hu(this,e);var i=fu(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.name="InvalidInputException",i.symbology=t,i.input=n,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return e}(Error),wA=function(r){pu(e,r);function e(){hu(this,e);var t=fu(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return e}(Error),CA=function(r){pu(e,r);function e(){hu(this,e);var t=fu(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return e}(Error);yo.InvalidInputException=xA;yo.InvalidElementException=wA;yo.NoElementException=CA});var C0=_e(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});var EA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},SA=g0(),mu=w0(SA),AA=x0(),xo=w0(AA),MA=gu();function w0(r){return r&&r.__esModule?r:{default:r}}function _u(r){if(typeof r=="string")return PA(r);if(Array.isArray(r)){for(var e=[],t=0;t<r.length;t++)e.push(_u(r[t]));return e}else{if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLImageElement)return OA(r);if(r&&r.nodeName&&r.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&r instanceof SVGElement)return{element:r,options:(0,mu.default)(r),renderer:xo.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement)return{element:r,options:(0,mu.default)(r),renderer:xo.default.CanvasRenderer};if(r&&r.getContext)return{element:r,renderer:xo.default.CanvasRenderer};if(r&&(typeof r>"u"?"undefined":EA(r))==="object"&&!r.nodeName)return{element:r,renderer:xo.default.ObjectRenderer};throw new MA.InvalidElementException}}function PA(r){var e=document.querySelectorAll(r);if(e.length!==0){for(var t=[],n=0;n<e.length;n++)t.push(_u(e[n]));return t}}function OA(r){var e=document.createElement("canvas");return{element:e,options:(0,mu.default)(r),renderer:xo.default.CanvasRenderer,afterRender:function(){r.setAttribute("src",e.toDataURL())}}}vu.default=_u});var E0=_e(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});var TA=function(){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function IA(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var kA=function(){function r(e){IA(this,r),this.api=e}return TA(r,[{key:"handleCatch",value:function(t){if(t.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw t.message;else throw t;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var n=t.apply(void 0,arguments);return this.api._options.valid(!0),n}catch(i){return this.handleCatch(i),this.api}}}]),r}();bu.default=kA});var k0=_e((_D,I0)=>{"use strict";var RA=d0(),Vi=wi(RA),LA=bo(),wo=wi(LA),DA=u0(),A0=wi(DA),FA=h0(),S0=wi(FA),NA=C0(),BA=wi(NA),jA=eu(),VA=wi(jA),UA=E0(),zA=wi(UA),M0=gu(),qA=nu(),P0=wi(qA);function wi(r){return r&&r.__esModule?r:{default:r}}var Yn=function(){},wa=function(e,t,n){var i=new Yn;if(typeof e>"u")throw Error("No element to render on was provided.");return i._renderProperties=(0,BA.default)(e),i._encodings=[],i._options=P0.default,i._errorHandler=new zA.default(i),typeof t<"u"&&(n=n||{},n.format||(n.format=T0()),i.options(n)[n.format](t,n).render()),i};wa.getModule=function(r){return Vi.default[r]};for(yu in Vi.default)Vi.default.hasOwnProperty(yu)&&HA(Vi.default,yu);var yu;function HA(r,e){Yn.prototype[e]=Yn.prototype[e.toUpperCase()]=Yn.prototype[e.toLowerCase()]=function(t,n){var i=this;return i._errorHandler.wrapBarcodeCall(function(){n.text=typeof n.text>"u"?void 0:""+n.text;var o=(0,wo.default)(i._options,n);o=(0,VA.default)(o);var s=r[e],a=O0(t,s,o);return i._encodings.push(a),i})}}function O0(r,e,t){r=""+r;var n=new e(r,t);if(!n.valid())throw new M0.InvalidInputException(n.constructor.name,r);var i=n.encode();i=(0,A0.default)(i);for(var o=0;o<i.length;o++)i[o].options=(0,wo.default)(t,i[o].options);return i}function T0(){return Vi.default.CODE128?"CODE128":Object.keys(Vi.default)[0]}Yn.prototype.options=function(r){return this._options=(0,wo.default)(this._options,r),this};Yn.prototype.blank=function(r){var e=new Array(r+1).join("0");return this._encodings.push({data:e}),this};Yn.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var r;for(var e in this._renderProperties){r=this._renderProperties[e];var t=(0,wo.default)(this._options,r.options);t.format=="auto"&&(t.format=T0()),this._errorHandler.wrapBarcodeCall(function(){var n=t.value,i=Vi.default[t.format.toUpperCase()],o=O0(n,i,t);xu(r,o,t)})}}};Yn.prototype.render=function(){if(!this._renderProperties)throw new M0.NoElementException;if(Array.isArray(this._renderProperties))for(var r=0;r<this._renderProperties.length;r++)xu(this._renderProperties[r],this._encodings,this._options);else xu(this._renderProperties,this._encodings,this._options);return this};Yn.prototype._defaults=P0.default;function xu(r,e,t){e=(0,A0.default)(e);for(var n=0;n<e.length;n++)e[n].options=(0,wo.default)(t,e[n].options),(0,S0.default)(e[n].options);(0,S0.default)(t);var i=r.renderer,o=new i(r.element,e,t);o.render(),r.afterRender&&r.afterRender()}typeof window<"u"&&(window.JsBarcode=wa);typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(r,e){var t=[];return jQuery(this).each(function(){t.push(this)}),wa(t,r,e)});I0.exports=wa});var xp=(()=>{let e=class e{constructor(){this.product={},this.remove=new xt}onRemove(n){this.remove.emit(n)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ke({type:e,selectors:[["app-product-card"]],inputs:{product:"product"},outputs:{remove:"remove"},standalone:!0,features:[Be],decls:15,vars:6,consts:[[1,"product-card"],[1,"product-card-header"],[1,"product-card-body"],[1,"product-card-content"],["alt","product-img",3,"src"],[1,"product-description"],[1,"offer-label"],[1,"product-card-clear","clickable",3,"click"]],template:function(i,o){i&1&&(I(0,"div",0)(1,"div",1)(2,"p"),oe(3),D()(),I(4,"div",2)(5,"div",3),ge(6,"img",4),I(7,"div",5)(8,"span"),oe(9),D(),I(10,"div",6),oe(11),ot(12,"number"),D()()()(),I(13,"span",7),ce("click",function(){return o.onRemove(o.product)}),oe(14,"x"),D()()),i&2&&(H(3),lt(o.product.brandName),H(3),pt("src",o.product.imagesUrls[0],Qt),H(3),lt(o.product.productName),H(2),Xe("",gt(12,4,o.product.price)," DA"))},dependencies:[Ls],styles:['@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--bg-color: #ffffff;--font-color: #000000;--hover-font-color: #000000;--input-border-color: rgba(128, 128, 128, .44);--main-bg-color: #f2f2f2;--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: #E8476057;--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(27, 31, 35, .15);--footer-color:#000;--box-shadow: $box-shadow}[data-theme=dark][_ngcontent-%COMP%]{--bg-color: #161625;--font-color: #ffffff;--hover-font-color: #000000;--input-border-color: #E8476057;--main-bg-color: rgb(14, 14, 27);--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: rgba(255, 255, 255, .16);--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(60, 64, 68, .78);--footer-color:#fff;--box-shadow: $box-shadow}[_ngcontent-%COMP%]:dir(ltr){font-family:Ubuntu,sans-serif;--small-font-size: 11px;--normal-font-size: 14px;--medium-font-size: 18px;--big-font-size: 21px}[_ngcontent-%COMP%]:dir(rtl){font-family:Ubuntu,sans-serif;--small-font-size: 13px;--normal-font-size: 16px;--medium-font-size: 20px;--big-font-size: 23px}.excel-color[_ngcontent-%COMP%]{color:green!important}.pdf-color[_ngcontent-%COMP%]{color:#ff4500!important}.focus-color[_ngcontent-%COMP%]{border-color:var(--main-secoundary-color);outline:0;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31);box-shadow:0 0 0 .1rem #c7253e4f}.product-card[_ngcontent-%COMP%]{border:.1em solid var(--main-bg-color);border-radius:1em;background-color:var(--main-bg-color);box-shadow:0 2px 4px #00000014;padding:10px 20px;margin-bottom:20px;position:relative}.product-card-clear[_ngcontent-%COMP%]{position:absolute;color:#fff;background-color:red;padding:.2em;border-radius:50%;height:20px;width:20px;display:flex;align-items:center;justify-content:center;font-size:14px;top:-.4rem;right:-.2rem;cursor:pointer}.product-card[_ngcontent-%COMP%]   .product-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.product-card[_ngcontent-%COMP%]   .product-card-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--normal-font-size);font-weight:700}.product-card[_ngcontent-%COMP%]   .product-card-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--main-primary-color);cursor:pointer}.product-card[_ngcontent-%COMP%]   .product-card-body[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.product-card[_ngcontent-%COMP%]   .product-card-body[_ngcontent-%COMP%]   .product-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:3px 0}.product-card[_ngcontent-%COMP%]   .product-card-body[_ngcontent-%COMP%]   .product-card-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60px;width:60px;border-radius:50%;margin-right:10px}.product-card[_ngcontent-%COMP%]   .product-card-body[_ngcontent-%COMP%]   .product-card-content[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-direction:column}.product-card[_ngcontent-%COMP%]   .product-card-body[_ngcontent-%COMP%]   .product-card-content[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color);font-size:var(--normal-font-size);font-weight:700;margin:5px 0}.product-card[_ngcontent-%COMP%]   .product-card-body[_ngcontent-%COMP%]   .product-card-content[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]   .offer-label[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:center;background-color:var(--main-secoundary-color);color:var(--main-primary-color);padding:.3em;font-size:var(--small-font-size);border-radius:.5em}.product-card[_ngcontent-%COMP%]   .product-card-body[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--main-primary-color);cursor:pointer}.product-card[_ngcontent-%COMP%]:hover{cursor:pointer}@media (max-width: 767px){a[_ngcontent-%COMP%], p[_ngcontent-%COMP%], span[_ngcontent-%COMP%], i[_ngcontent-%COMP%]{font-size:var(--small-font-size)!important}*[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none}*[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}}@media (min-width: 768px) and (max-width: 991px){a[_ngcontent-%COMP%], p[_ngcontent-%COMP%], span[_ngcontent-%COMP%], i[_ngcontent-%COMP%]{font-size:var(--small-font-size)!important}*[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none}*[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}}']});let r=e;return r})();var R1=["chart"],wp=(()=>{let e=class e{constructor(){this.autoUpdateSeries=!0,this.chartReady=new xt,this.chartInstance=np(null),this.ngZone=Oc(Tc),this.isBrowser=dp(Oc(tp))}ngOnChanges(n){this.isBrowser&&this.ngZone.runOutsideAngular(()=>{$f.schedule(()=>this.hydrate(n))})}ngOnDestroy(){this.destroy()}hydrate(n){if(this.autoUpdateSeries&&Object.keys(n).filter(o=>o!=="series").length===0){this.updateSeries(this.series,!0);return}this.createElement()}createElement(){return G(this,null,function*(){let{default:n}=yield import("./chunk-AVWODULZ.js");window.ApexCharts||=n;let i={};this.annotations&&(i.annotations=this.annotations),this.chart&&(i.chart=this.chart),this.colors&&(i.colors=this.colors),this.dataLabels&&(i.dataLabels=this.dataLabels),this.series&&(i.series=this.series),this.stroke&&(i.stroke=this.stroke),this.labels&&(i.labels=this.labels),this.legend&&(i.legend=this.legend),this.fill&&(i.fill=this.fill),this.tooltip&&(i.tooltip=this.tooltip),this.plotOptions&&(i.plotOptions=this.plotOptions),this.responsive&&(i.responsive=this.responsive),this.markers&&(i.markers=this.markers),this.noData&&(i.noData=this.noData),this.xaxis&&(i.xaxis=this.xaxis),this.yaxis&&(i.yaxis=this.yaxis),this.forecastDataPoints&&(i.forecastDataPoints=this.forecastDataPoints),this.grid&&(i.grid=this.grid),this.states&&(i.states=this.states),this.title&&(i.title=this.title),this.subtitle&&(i.subtitle=this.subtitle),this.theme&&(i.theme=this.theme),this.destroy();let o=this.ngZone.runOutsideAngular(()=>new n(this.chartElement.nativeElement,i));this.chartInstance.set(o),this.render(),this.chartReady.emit({chartObj:o})})}render(){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.render())}updateOptions(n,i,o,s){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.updateOptions(n,i,o,s))}updateSeries(n,i){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.updateSeries(n,i))}appendSeries(n,i){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.appendSeries(n,i))}appendData(n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.appendData(n))}highlightSeries(n){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.highlightSeries(n))}toggleSeries(n){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.toggleSeries(n))}showSeries(n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.showSeries(n))}hideSeries(n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.hideSeries(n))}resetSeries(){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.resetSeries())}zoomX(n,i){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.zoomX(n,i))}toggleDataPointSelection(n,i){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.toggleDataPointSelection(n,i))}destroy(){this.chartInstance()?.destroy(),this.chartInstance.set(null)}setLocale(n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.setLocale(n))}paper(){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.paper())}addXaxisAnnotation(n,i,o){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addXaxisAnnotation(n,i,o))}addYaxisAnnotation(n,i,o){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addYaxisAnnotation(n,i,o))}addPointAnnotation(n,i,o){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addPointAnnotation(n,i,o))}removeAnnotation(n,i){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.removeAnnotation(n,i))}clearAnnotations(n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.clearAnnotations(n))}dataURI(n){return this.chartInstance()?.dataURI(n)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ke({type:e,selectors:[["apx-chart"]],viewQuery:function(i,o){if(i&1&&Ve(R1,7),i&2){let s;Ue(s=ze())&&(o.chartElement=s.first)}},inputs:{chart:"chart",annotations:"annotations",colors:"colors",dataLabels:"dataLabels",series:"series",stroke:"stroke",labels:"labels",legend:"legend",markers:"markers",noData:"noData",fill:"fill",tooltip:"tooltip",plotOptions:"plotOptions",responsive:"responsive",xaxis:"xaxis",yaxis:"yaxis",forecastDataPoints:"forecastDataPoints",grid:"grid",states:"states",title:"title",subtitle:"subtitle",theme:"theme",autoUpdateSeries:"autoUpdateSeries"},outputs:{chartReady:"chartReady"},standalone:!0,features:[Tn,Be],decls:2,vars:0,consts:[["chart",""]],template:function(i,o){i&1&&ge(0,"div",null,0)},encapsulation:2,changeDetection:0});let r=e;return r})();var L1=()=>["var(--main-primary-color)"];function D1(r,e){if(r&1&&(I(0,"div"),ge(1,"apx-chart",0),D()),r&2){let t=z();H(),Q("colors",Pe(15,L1))("series",t.chartOptions.series)("chart",t.chartOptions.chart)("xaxis",t.chartOptions.xaxis)("yaxis",t.chartOptions.yaxis)("title",t.chartOptions.title)("dataLabels",t.chartOptions.dataLabels)("stroke",t.chartOptions.stroke)("markers",t.chartOptions.markers)("tooltip",t.chartOptions.tooltip)("legend",t.chartOptions.legend)("responsive",t.chartOptions.responsive)("fill",t.chartOptions.fill)("plotOptions",t.chartOptions.plotOptions)("grid",t.chartOptions.grid)}}var Dc=(()=>{let e=class e{constructor(){this.chartOptions={}}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ke({type:e,selectors:[["app-generic-chart"]],inputs:{chartOptions:"chartOptions"},standalone:!0,features:[Be],decls:1,vars:1,consts:[[3,"colors","series","chart","xaxis","yaxis","title","dataLabels","stroke","markers","tooltip","legend","responsive","fill","plotOptions","grid"]],template:function(i,o){i&1&&ye(0,D1,2,16,"div"),i&2&&Ee(o.chartOptions?0:-1)},dependencies:[wp]});let r=e;return r})();var Cp={series:[{name:"Ventes",data:[]}],chart:{type:"line",height:300},title:{text:"Tendances des produits par mois (6 derniers mois)",align:"left"},xaxis:{categories:[]}},Ep={series:[150,200,100,80],chart:{type:"pie",height:350},title:{text:"Nombre de commandes par client",align:"left"},tooltip:{enabled:!0,y:{formatter:r=>`${r} Commandes`}},responsive:[{breakpoint:480,options:{chart:{width:250},legend:{position:"bottom"}}}]},Sp={series:[{name:"Ventes",data:[]}],chart:{type:"bar",height:350},title:{text:"Ventes des 5 meilleurs produits",align:"left"},xaxis:{categories:[]}};var N1=()=>[Cn,import("./chunk-BQIOBFCO.js").then(r=>r.DropDownComponent)],Fc=()=>[Ut,import("./chunk-ZJLDPCML.js").then(r=>r.RouterLink)],B1=()=>[Cn,import("./chunk-DDMQRDRU.js").then(r=>r.StatCardComponent)],j1=()=>[Dc,import("./chunk-JF5QGPHL.js").then(r=>r.GenericDropDownComponent)],V1=()=>[Dc],U1=()=>[Cn],Ap=()=>[];function z1(r,e){if(r&1&&(oe(0),ot(1,"async"),ot(2,"async")),r&2){let t,n=z(2);Xe(" ",((t=gt(1,1,n.authFirebaseService.$user))==null?null:t.lastName)+" "+((t=gt(2,3,n.authFirebaseService.$user))==null?null:t.firstName)," ")}}function q1(r,e){}function H1(r,e){if(r&1){let t=Ae();I(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15),ot(5,"async"),I(6,"span"),oe(7),ot(8,"async"),D()(),I(9,"div",16)(10,"h1",17),oe(11,"Bonjour"),D(),I(12,"h4",18),ye(13,z1,3,5)(14,q1,0,0),Ot(15,13,U1,null,14),ot(17,"async"),D()()()(),I(18,"div",19)(19,"div",20)(20,"app-drop-down",21),ce("selectOption",function(i){fe(t);let o=z();return pe(o.onSelectDate(i))}),D(),I(21,"span"),oe(22,"vous avez :"),D(),I(23,"span"),oe(24),D()(),I(25,"div",22)(26,"span")(27,"span",23),oe(28),D(),oe(29,"nouvelles commandes"),D(),I(30,"span"),oe(31,"|"),D(),I(32,"span")(33,"span",24),oe(34),D(),oe(35,"avis sur les produits"),D(),I(36,"span"),oe(37,"|"),D(),I(38,"span")(39,"span",25),oe(40),D(),oe(41,"nouveaux visiteurs"),D()()()()()}if(r&2){let t,n,i=z();H(4),Nt("height",80,"px")("width",80,"px")("background-color",(t=gt(5,14,i.authFirebaseService.$user))==null?null:t.profileColor),H(3),lt((n=gt(8,16,i.authFirebaseService.$user))==null||n.lastName==null||(n=n.lastName.substring(0,1))==null?null:n.toUpperCase()),H(8),$t(gt(17,18,i.authFirebaseService.$user)),H(5),Q("options",i.weeksDropdownOptions)("selectedOption",i.weeksDropdownOptions[0]),H(4),Xe(" ",i.ordersCount+i.reviewsCount," nouvelles mises \xE0 jour "),H(4),Xe(" ",i.ordersCount," "),H(6),Xe(" ",i.reviewsCount," "),H(6),Xe(" ",i.visitorsCount,"")}}function W1(r,e){r&1&&ge(0,"app-skelton",26),r&2&&Q("height",130)("maxHeight",130)("shape","welcome")}function G1(r,e){if(r&1&&(I(0,"div",27)(1,"div",28)(2,"div",29),ge(3,"i",30),I(4,"h1",31),oe(5),D()(),I(6,"div",14),ge(7,"i"),I(8,"span",31),oe(9),D()()(),I(10,"div",32)(11,"div",33)(12,"span",34),oe(13,"total des avis"),D()(),I(14,"div",35),ge(15,"app-button",36),D()()()),r&2){let t=z();H(5),lt(t.reviewsCount),H(2),sr("",t.reviewsChangesIconClass,"  mr-5"),H(2),Xe("",t.reviewsPercentageAccordingToLastWeek,"% par rapport au dernier jour")}}function $1(r,e){r&1&&ge(0,"app-skelton",37),r&2&&Q("height",155)("maxHeight",155)}function X1(r,e){if(r&1&&(I(0,"div",38)(1,"div",28)(2,"div",29),ge(3,"i",39),I(4,"h1",31),oe(5),D()(),I(6,"div",14),ge(7,"i"),I(8,"span",31),oe(9),D()()(),I(10,"div",32)(11,"div",33)(12,"span",34),oe(13," total des visiteurs"),D()(),I(14,"div",35),ge(15,"app-button",40),D()()()),r&2){let t=z();H(5),lt(t.visitorsCount),H(2),sr("",t.visitorsChangesIconClass," red-text mr-5"),H(2),Xe("",t.visitorsPercentageAccordingToLastWeek,"% par rapport au dernier jour")}}function K1(r,e){r&1&&ge(0,"app-skelton",37),r&2&&Q("height",151)("maxHeight",151)}function Y1(r,e){if(r&1&&(I(0,"div",41)(1,"div",28)(2,"div",29),ge(3,"i",42),I(4,"h1",31),oe(5),D()(),I(6,"div",14),ge(7,"i"),I(8,"span",31),oe(9),D()()(),I(10,"div",32)(11,"div",33)(12,"span",34),oe(13," total des commandes "),D()(),I(14,"div",35),ge(15,"app-button",43),D()()()),r&2){let t=z();H(5),lt(t.ordersCount),H(2),sr("",t.orderChangesIconClass," green-text mr-5 "),H(2),Xe("",t.ordersPercentageAccordingToLastWeek,"% par rapport au dernier jour")}}function Q1(r,e){r&1&&ge(0,"app-skelton",37),r&2&&Q("height",151)("maxHeight",151)}function J1(r,e){if(r&1){let t=Ae();I(0,"app-stat-card",45),ot(1,"async"),ce("consultCard",function(i){fe(t);let o=z(2);return pe(o.onConsultCard(i))}),D()}if(r&2){let t,n=e.$implicit,i=z(2);Q("disabledBtn",!(!((t=gt(1,2,i.authFirebaseService.$userRole))==null||t.permissions==null)&&t.permissions.includes("write"))||!1)("statData",n)}}function Z1(r,e){if(r&1&&Je(0,J1,2,4,"app-stat-card",44,et),r&2){let t=z();Ze(t.statsData)}}function ev(r,e){r&1&&ge(0,"app-skelton",26),r&2&&Q("height",130)("maxHeight",130)("shape","notification-card")}function tv(r,e){r&1&&Je(0,ev,1,3,"app-skelton",26,et),r&2&&Ze(Pe(0,Ap).constructor(2))}function nv(r,e){if(r&1){let t=Ae();I(0,"div",46)(1,"div",47)(2,"app-generic-drop-down",48),ce("selectOption",function(i){fe(t);let o=z();return pe(o.onSelectProduct(i))}),D()(),ge(3,"app-generic-chart",49),D()}if(r&2){let t=z();H(2),Q("options",t.allProducts),H(),Q("chartOptions",t.lineChartOptions)}}function iv(r,e){r&1&&ge(0,"app-skelton",37),r&2&&Q("height",200)("maxHeight",200)}function rv(r,e){if(r&1&&(I(0,"div",46),ge(1,"app-generic-chart",49),D()),r&2){let t=z();H(),Q("chartOptions",t.barChartOptions)}}function ov(r,e){r&1&&ge(0,"app-skelton",37),r&2&&Q("height",200)("maxHeight",200)}function sv(r,e){if(r&1){let t=Ae();I(0,"div",50)(1,"app-product-card",51),ce("remove",function(i){fe(t);let o=z(2);return pe(o.removeFromRecommended(i))}),D()()}if(r&2){let t=e.$implicit;H(),Q("product",t)}}function av(r,e){if(r&1){let t=Ae();I(0,"div",50)(1,"div",52),ce("click",function(){fe(t);let i=z(3);return pe(i.productDialog=!0)}),ge(2,"i",53),D()()}}function lv(r,e){if(r&1&&Je(0,av,3,0,"div",50,et),r&2){let t=z(2);Ze(Pe(0,Ap).constructor(5-t.recommendedProducts.length))}}function cv(r,e){if(r&1&&(I(0,"h4"),oe(1,"List des Produits recommand\xE9s :"),D(),I(2,"div",0)(3,"div",1),Je(4,sv,2,1,"div",50,et),ye(6,lv,2,1),D()()),r&2){let t=z();H(4),Ze(t.recommendedProducts),H(2),Ee(t.recommendedProducts.length<5?6:-1)}}function dv(r,e){if(r&1){let t=Ae();I(0,"div",57)(1,"div",58)(2,"div",59)(3,"div",60)(4,"span",61),oe(5),D()(),I(6,"span"),oe(7),D()()(),I(8,"div",62),ge(9,"img",63),D(),I(10,"app-button",64),ce("click",function(){fe(t);let i=z(2);return pe(i.sendMail())}),D()()}if(r&2){let t,n=e.$implicit,i=z(2);H(3),Nt("height",30,"px")("width",30,"px")("background-color","var(--main-primary-color"),H(2),lt(n==null||n.email==null||(t=n.email.substring(0,1))==null?null:t.toUpperCase()),H(2),lt(n==null?null:n.email),H(2),pt("src",i.getProductImage(n.productId),Qt)}}function uv(r,e){if(r&1){let t=Ae();I(0,"div")(1,"div",54)(2,"h4"),oe(3,"List des utilisateur a notifier :"),D(),I(4,"app-button",55),ce("click",function(){return fe(t),pe(!0)}),D()(),I(5,"div",56),Je(6,dv,11,9,"div",57,et),D()()}if(r&2){let t=z();H(6),Ze(t.usersForNotifyList)}}function hv(r,e){}function fv(r,e){if(r&1){let t=Ae();I(0,"div",10)(1,"div",33)(2,"div",14),ge(3,"img",65),I(4,"span",66),oe(5),D()(),I(6,"app-button",67),ce("click",function(){let i=fe(t).$implicit,o=z();return pe(i.isRecommended?!0:o.addToRecommended(i))}),D()()()}if(r&2){let t=e.$implicit;H(3),pt("src",t.imagesUrls[0],Qt),H(2),lt(t.productName),H(),Q("disabled",t.isRecommended)}}var Mp=(()=>{let e=class e{constructor(n,i,o,s,a){this.authFirebaseService=n,this.cdr=i,this.crudService=o,this.applicationService=s,this.http=a,this.ordersCount=0,this.reviewsCount=0,this.visitorsPercentageAccordingToLastWeek=0,this.visitorsCount=0,this.barChartOptions=Sp,this.landingDetailsDialog=!1,this.productDialog=!1,this.weeksDropdownOptions=hp,this.selectedDate=this.weeksDropdownOptions[0],this.statsData=[{id:1,count:0,title:"Produits recommand\xE9s",action:"Modifier"},{id:2,count:0,title:"Utilisateurs \xE0 notifier",action:"Ouvrir"}],this.selectedStat={},this.lineChartOptions=Cp,this.allOrders=[],this.ordersPieChartOptions=Ep,this.allProducts=[],this.recommendedProducts=[],this.usersForNotifyList=[],this.getTopProducts=c=>c.sort((d,u)=>u.numberSales-d.numberSales).slice(0,5),this.DB_PATHS=Se,this.listOfLastSixMonths=s.getLastSixMonthsLabels();let l=this.getProductCountByMonth("-OADYFViBhXxP3QW9XR_");Array.from(l.values()),this.lineChartOptions.xaxis.categories=this.listOfLastSixMonths}ngOnInit(){return G(this,null,function*(){this.crudService.loading=!0,yield this.getStats(),yield this.findProducts(),yield this.findUsersNotification(),this.updateCount("Produits recommand\xE9s",this.recommendedProducts.length),yield this.findOrders(),this.crudService.loading=!1})}findProducts(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.PRODUCTS).subscribe({next:o=>{this.allProducts=o,this.recommendedProducts=[],this.allProducts.map(l=>{l.isRecommended&&this.recommendedProducts.push(l)});let s=this.getTopProducts(this.allProducts);this.barChartOptions.series[0].data=s.map(l=>l.numberSales);let a=this.getProductCountByMonth(this.allProducts[0].id);this.barChartOptions.xaxis.categories=s.map(l=>l.productName),this.lineChartOptions=Ft(it({},this.lineChartOptions),{series:[Ft(it({},this.lineChartOptions.series[0]),{data:Array.from(a.values())})]}),n()},error:o=>{i(o)}})})}findUsersNotification(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.STOCK_NOTIFICATIONS).subscribe({next:o=>{this.usersForNotifyList=o,this.updateCount("Utilisateurs \xE0 notifier",this.usersForNotifyList?.length),n()},error:o=>{i(o)}})})}findOrders(){return new Promise((n,i)=>{let o=new Date,s=new Date;s.setMonth(o.getMonth()-6),this.crudService.getItemsByDateRange("date",s,o,Se.ORDERS).subscribe({next:a=>{this.allOrders=a.sort((l,c)=>c.date-l.date),this.getProductCountByMonth(this.allProducts[0].id),n()},error:a=>{i(a)}})})}getOrdersByMonth(){let n=new Map;return this.listOfLastSixMonths.forEach(i=>{let o=this.allOrders.filter(s=>new Date(s.date).toLocaleString("default",{month:"long"}).trim()===i.trim());n.set(i,o)}),n}getProductCountByMonth(n){let i=new Map;return this.listOfLastSixMonths.forEach(o=>{let a=this.allOrders.filter(l=>new Date(l.date).toLocaleString("default",{month:"long"}).trim()===o.trim()).reduce((l,c)=>{let d=c.products.map(u=>u.productId===n?u.quantity:0).reduce((u,h)=>u+Number(h),0);return l+d},0);i.set(o,a)}),i}getStats(){return G(this,null,function*(){yield this.getCountOfData(Se.ORDERS).then(n=>{this.ordersCount=n?.todayCount||0,this.ordersPercentageAccordingToLastWeek=n.lastDayCountPercentage,this.orderChangesIconClass=n.iconClass}).catch(n=>{console.error(n)}),yield this.getCountOfData(Se.REVIEWS).then(n=>{this.reviewsCount=n?.todayCount||0,this.reviewsPercentageAccordingToLastWeek=n.lastDayCountPercentage,this.reviewsChangesIconClass=n.iconClass}).catch(n=>{console.error(n)})})}getCountOfData(n){return G(this,null,function*(){return new Promise((i,o)=>{this.crudService.getItemsList(n).subscribe(s=>{let a=new Date(this.selectedDate.value);a.setHours(0,0,0,0),new Date().setHours(0,0,0,0);let c=new Date(a);c.setDate(a.getDate()-1);let d=s.filter(v=>{let x=new Date(v.createdAt);return x.setHours(0,0,0,0),x.getTime()===a.getTime()}).length,u=s.filter(v=>{let x=new Date(v.createdAt);return x.setHours(0,0,0,0),x.getTime()===c.getTime()}).length,h=this.percentageOfChanges(u,d),g=d>u?"ri-arrow-right-up-line green-text":d===u?"ri-arrow-right-line ":"ri-arrow-right-down-line red-text";i({todayCount:d,lastDayCountPercentage:h,iconClass:g})},s=>o(s))})})}percentageOfChanges(n,i){let o=0;return n>0?o=(i-n)/n*100:n===0?o=i>0?100:0:o=0,Math.round(Math.abs(o))}onSelectDate(n){return G(this,null,function*(){this.selectedDate=n,this.crudService.loading=!0,yield this.getStats(),this.crudService.loading=!1})}onConsultCard(n){return G(this,null,function*(){this.selectedStat=n,this.landingDetailsDialog=!0})}addToRecommended(n){n.isRecommended=!0,this.recommendedProducts.push(n),this.crudService.updateItem(Se.PRODUCTS,n.id,n).then(i=>{this.updateCount("Produits recommand\xE9s",this.recommendedProducts.length),this.productDialog=!1,this.applicationService.showSwalDialog("Product added successfully","success","#cce5cc")})}removeFromRecommended(n){n.id,n.isRecommended=!1,this.crudService.updateItem(Se.PRODUCTS,n.id,n).then(i=>{this.recommendedProducts=this.recommendedProducts.filter(o=>o.id!=n.id),this.updateCount("Produits recommand\xE9s",this.recommendedProducts.length),this.productDialog=!1,this.applicationService.showSwalDialog("Product removed successfully successfully","success","#cce5cc")})}onSelectProduct(n){n.id;let i=this.getProductCountByMonth(n.id);this.lineChartOptions.xaxis.categories=this.listOfLastSixMonths,this.lineChartOptions=Ft(it({},this.lineChartOptions),{series:[Ft(it({},this.lineChartOptions.series[0]),{data:Array.from(i.values())})]})}updateCount(n,i){this.statsData=this.statsData.map(o=>o.title===n?Ft(it({},o),{count:i}):o)}getProductImage(n){return this.allProducts,this.allProducts?.filter(i=>i.id===n)[0]?.imagesUrls[0]}sendMail(){this.http.post("http://localhost:3000/mail/send-mail",{}).subscribe(n=>{console.log(n)})}};e.\u0275fac=function(i){return new(i||e)(ve(Ln),ve(ap),ve(He),ve(tt),ve(Fs))},e.\u0275cmp=ke({type:e,selectors:[["app-landing"]],standalone:!0,features:[Be],decls:52,vars:15,consts:[[1,"container"],[1,"row"],[1,"col-lg-10","col-md-12","col-sm-12","mb-30"],[1,"col-lg-4","col-md-12","col-sm-12"],[1,"col-lg-2","col-md-12","col-sm-12"],[1,"col-12","p-0"],[1,"col-lg-8","col-md-12","col-sm-12"],["height","100%","width","40%",3,"closeModal","modalId","showFooter","showModal"],["modal-body",""],["height","100%","width","30%",3,"closeModal","modalId","showModal"],[1,"card","main-background-color"],[1,"col-12"],[1,"welcome-card","row"],[1,"welcome-card-left","col-lg-6","col-sm-12","col-md-12"],[1,"d-flex","align-center","justify-start"],[1,"blank-user","mr-10"],[1,"d-flex","flex-column"],[1,"m-0","mb-3"],[1,"m-0","primary-text"],[1,"welcome-card-right","col-lg-6","col-sm-12","col-md-12"],[1,"welcome-card-right-top"],[2,"width","150px",3,"selectOption","options","selectedOption"],[1,"welcome-card-right-bottom"],[1,"orders-text-color"],[1,"reviews-text-color"],[1,"visitors-text-color"],[3,"height","maxHeight","shape"],[1,"banner-utility-card","reviews-bg-color","d-flex","flex-column"],[1,"banner-utility-card-header"],[1,"d-flex","align-center","justify-start","banner-utility-card-header-left"],[1,"ri-star-fill"],[1,"fade-in-fwd"],[1,"banner-utility-card-content"],[1,"d-flex","align-center","justify-content-between"],[1,"font-color-text"],[1,"mt-20"],["color","#ffffff","bgColor","transparent","hoverColor","transparent","label","voir plus","routerLink","reviews","icon","ri-arrow-right-s-line","size","small"],[3,"height","maxHeight"],[1,"banner-utility-card","visitors-card-bg-color","d-flex","flex-column"],[1,"ri-eye-fill"],["color","#ffffff","bgColor","transparent","hoverColor","transparent","label","voir plus","routerLink","orders","icon","ri-arrow-right-s-line","size","small"],[1,"banner-utility-card","orders-bg-color","d-flex","flex-column"],[1,"ri-shopping-bag-fill"],["color","#ffffff","bgColor","transparent","hoverColor","transparent","label","voir plus","routerLink","/orders","icon","ri-arrow-right-s-line","size","small"],[3,"disabledBtn","statData"],[3,"consultCard","disabledBtn","statData"],[1,"card"],[1,"col-lg-4","col-md-6","col-sm-12","mb-10"],["bindLabel","productName","bindValue","id",3,"selectOption","options"],[3,"chartOptions"],[1,"col-6","fade-in-fwd"],[3,"remove","product"],[1,"card","clickable","add-new-card","h-100",3,"click"],[1,"ri","ri-add-line"],[1,"d-flex","align-center","justify-content-between","mb-10"],["label","Tous Notifier","size","small","icon","ri-notification-line",3,"click"],[1,"d-flex","flex-column","gap-16"],[1,"card","main-background-color","w-100","d-flex","align-center","justify-content-between"],[1,"d-flex","align-baseline","justify-start"],[1,"d-flex","align-center","gap-4",2,"min-width","200px"],[1,"blank-user"],[2,"font-size","13px !important"],[1,"card","m-0","relative"],["alt","prd",1,"absolute",2,"top","0","left","0","height","100%","width","100%",3,"src"],["label","notifier","size","small","icon","ri-notification-line",3,"click"],["height","40","alt","p-image",1,"mr-5",3,"src"],[1,"font-color-text","bold"],["label","Add","size","small",3,"click","disabled"]],template:function(i,o){if(i&1&&(I(0,"div",0)(1,"div",1)(2,"div",2),ye(3,H1,42,20)(4,W1,1,3),Ot(5,3,N1,null,4),Kr(),I(7,"div",1)(8,"div",3),ye(9,G1,16,5)(10,$1,1,2),Ot(11,9,Fc,null,10),ot(13,"async"),D(),I(14,"div",3),ye(15,X1,16,5)(16,K1,1,2),Ot(17,15,Fc,null,16),ot(19,"async"),D(),I(20,"div",3),ye(21,Y1,16,5)(22,Q1,1,2),Ot(23,21,Fc,null,22),ot(25,"async"),D()()(),I(26,"div",4)(27,"div",5),ye(28,Z1,2,0)(29,tv,2,1),Ot(30,28,B1,null,29),Kr(),D()()(),I(32,"div",1)(33,"div",6),ye(34,nv,4,2)(35,iv,1,2),Ot(36,34,j1,null,35),Kr(),D(),I(38,"div",3),ye(39,rv,2,1)(40,ov,1,2),Ot(41,39,V1,null,40),Kr(),D()()(),I(43,"app-modal",7),ce("closeModal",function(a){return o.landingDetailsDialog=a}),I(44,"div",8),ye(45,cv,7,1)(46,uv,8,0,"div")(47,hv,0,0),D()(),I(48,"app-modal",9),ce("closeModal",function(a){return o.productDialog=a}),I(49,"div",8),Je(50,fv,7,3,"div",10,et),D()()),i&2){let s;H(11),$t(!gt(13,9,o.crudService.loading$)),H(6),$t(!gt(19,11,o.crudService.loading$)),H(6),$t(!gt(25,13,o.crudService.loading$)),H(20),Q("modalId","details-news-dialog")("showFooter",o.selectedStat.title=="Produits recommand\xE9s")("showModal",o.landingDetailsDialog),H(2),Ee((s=o.selectedStat.id)===1?45:s===2?46:47),H(3),Q("modalId","list-products-dialog")("showModal",o.productDialog),H(2),Ze(o.allProducts)}},dependencies:[Ds,Cn,xp,Ut,fi,pi],styles:[".welcome-card-bg[_ngcontent-%COMP%]{z-index:4}.banner-utility-card[_ngcontent-%COMP%]{box-shadow:#00000029 0 1px 4px;padding:1em;border:0!important;height:auto;box-sizing:border-box;border-radius:.4em;margin-bottom:20px;color:#fff}.banner-utility-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.banner-utility-card-header-left[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{padding:.2em;background-color:transparent;color:#fff;font-size:32px;font-weight:600;border-radius:.2em}.banner-utility-card-header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-weight:600;color:#fff}.banner-utility-card-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:10px;font-size:17px;font-weight:600;color:#fff}.visitors-card-bg-color[_ngcontent-%COMP%]{background-color:#8bc6ec;background-image:linear-gradient(135deg,#8bc6ec,#9599e2)}.visitors-text-color[_ngcontent-%COMP%]{color:#8bc6ec}.orders-bg-color[_ngcontent-%COMP%]{background-color:#fbab7e;background-image:linear-gradient(62deg,#fbab7e,#f7ce68)}.orders-text-color[_ngcontent-%COMP%]{color:#fbab7e}.reviews-bg-color[_ngcontent-%COMP%]{background-color:#ff3cac;background-image:linear-gradient(225deg,#ff3cac,#784ba0,#2b86c5)}.reviews-text-color[_ngcontent-%COMP%]{color:#ff3cac}.notification-container[_ngcontent-%COMP%]{position:relative}.notification-container-header[_ngcontent-%COMP%]{position:sticky;top:calc(0px - 1.25rem);padding-bottom:20px;background-color:var(--bg-color)}.notification-container-header[_ngcontent-%COMP%]   .notifications-count[_ngcontent-%COMP%]{background-color:red;color:#fff;padding:.7em;border-radius:50%;height:20px;width:20px}.notification-container-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px}.notification-container-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;margin-right:5px}.notification-container-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px}.notification-container-body[_ngcontent-%COMP%]{overflow-y:scroll}.notification-container-body[_ngcontent-%COMP%]   .notification-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:.7em!important;margin-bottom:10px!important}.notification-container-body[_ngcontent-%COMP%]   .notification-card-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color);font-size:17px}.notification-container-body[_ngcontent-%COMP%]   .notification-card-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:10px;color:#a60000e6}.notification-container-body[_ngcontent-%COMP%]   .notification-card-date[_ngcontent-%COMP%]{margin-top:5px;text-indent:5px}.notification-container-body[_ngcontent-%COMP%]   .notification-card-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;color:gray}.add-new-card[_ngcontent-%COMP%]{height:130px!important;border-radius:1em!important;display:flex;align-items:center;justify-content:center;flex-direction:column;color:var(--main-primary-color);background-color:var(--main-bg-color);cursor:pointer;box-shadow:#0000001a 0 1px 2px!important}.add-new-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:60px;font-weight:600;color:var(--main-primary-color)}"]});let r=e;return r})();var sd=Ms(Og(),1);var gr=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=wn({type:e}),e.\u0275inj=xn({});let r=e;return r})();var ea=(()=>{let e=class e{transform(n,i,o){if(!n||n.length===0)return[];if(o=o.toLowerCase(),o!=="asc"&&o!=="desc")throw new Error('Invalid sorting direction. Use "asc" or "desc".');return n.sort((s,a)=>{let l=s[i]<a[i]?-1:s[i]>a[i]?1:0;return o==="asc"?l:-l})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=ep({name:"sort",type:e,pure:!0,standalone:!0});let r=e;return r})();var mr=(()=>{let e=class e{constructor(){this.rootName=""}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ke({type:e,selectors:[["app-breadcrumbs"]],inputs:{rootName:"rootName"},standalone:!0,features:[Be],decls:6,vars:1,consts:[[1,"breadcrumbs"],[1,"ri-arrow-right-s-line"]],template:function(i,o){i&1&&(I(0,"div",0)(1,"span"),oe(2,"Sports gate"),D(),ge(3,"i",1),I(4,"span"),oe(5),D()()),i&2&&(H(5),lt(o.rootName))},styles:['@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--bg-color: #ffffff;--font-color: #000000;--hover-font-color: #000000;--input-border-color: rgba(128, 128, 128, .44);--main-bg-color: #f2f2f2;--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: #E8476057;--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(27, 31, 35, .15);--footer-color:#000;--box-shadow: $box-shadow}[data-theme=dark][_ngcontent-%COMP%]{--bg-color: #161625;--font-color: #ffffff;--hover-font-color: #000000;--input-border-color: #E8476057;--main-bg-color: rgb(14, 14, 27);--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: rgba(255, 255, 255, .16);--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(60, 64, 68, .78);--footer-color:#fff;--box-shadow: $box-shadow}[_ngcontent-%COMP%]:dir(ltr){font-family:Ubuntu,sans-serif;--small-font-size: 11px;--normal-font-size: 14px;--medium-font-size: 18px;--big-font-size: 21px}[_ngcontent-%COMP%]:dir(rtl){font-family:Ubuntu,sans-serif;--small-font-size: 13px;--normal-font-size: 16px;--medium-font-size: 20px;--big-font-size: 23px}.excel-color[_ngcontent-%COMP%]{color:green!important}.pdf-color[_ngcontent-%COMP%]{color:#ff4500!important}.focus-color[_ngcontent-%COMP%]{border-color:var(--main-secoundary-color);outline:0;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31);box-shadow:0 0 0 .1rem #c7253e4f}.breadcrumbs[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 17px;position:sticky;top:-40px;z-index:2;background-color:var(--main-bg-color);margin:0 -20px 10px}.breadcrumbs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .breadcrumbs[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--font-color);font-size:var(--medium-font-size);font-weight:600}.breadcrumbs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child, .breadcrumbs[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:last-child{font-size:var(--normal-font-size)}']});let r=e;return r})();var pn=(()=>{let e=class e{constructor(n,i){this.storage=n,this.http=i,this.apiUrl="https://www.ftp-api.com/ftp/checkconnection",this.listFilesSubject=new rr([]),this.$listFiles=this.listFilesSubject.asObservable(),this.uploadedFilesSubject=new rr(!1),this.$uploadedFiles=this.uploadedFilesSubject.asObservable()}uploadFile(n){return G(this,null,function*(){let o=Math.random().toString(36).substr(2,9)+n.name,s=this.storage.ref(o),a=this.storage.upload(o,n);return new Gf(l=>{a.snapshotChanges().pipe(Yf(()=>{s.getDownloadURL().subscribe(c=>{l.next(c),l.complete()})})).subscribe()})})}getDownloadablePath(n){return this.storage.ref(n).getDownloadURL()}deleteImageByUrl(n){let i=this.extractFilePath(n);return this.storage.ref(i).delete().toPromise()}extractFilePath(n){let i=n.split("/o/")[1]?.split("?")[0];return decodeURIComponent(i||"")}checkFtpConnection(){let n=new up({"Content-Type":"application/json",username:"u757451590.admin",password:"AdminFtp@123",port:"21","ftp-host":"ftp.activefitness-dz.com","ftp-type":"FTP"});return this.http.post(this.apiUrl,{},{headers:n})}checkFtp(){this.checkFtpConnection().subscribe(n=>{console.log("FTP connection successful:",n),this.uploadedFilesSubject.next(!0)},n=>{console.error("FTP connection failed:",n),this.uploadedFilesSubject.next(!1)})}};e.\u0275fac=function(i){return new(i||e)(Pc(bp),Pc(Fs))},e.\u0275prov=Jf({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var lb=["fileInput"],cb=r=>({"primary-border":r});function db(r,e){if(r&1){let t=Ae();I(0,"div",3)(1,"span",4),ce("click",function(){let i=fe(t).$index,o=z(2);return pe(o.onRemoveFile(i))}),oe(2,"x"),D()()}if(r&2){let t=e.$implicit,n=z(2);Yr("background-image: url('",n.fileType==="image"?t:"/assets/images/pdf_file_icon.svg","') ;background-size: cover; background-position:center")}}function ub(r,e){if(r&1&&(I(0,"div",0),Je(1,db,3,3,"div",2,et),D()),r&2){let t=z();H(),Ze(t.uploadedFiles)}}function hb(r,e){if(r&1){let t=Ae();I(0,"div",5),ce("drop",function(i){fe(t);let o=z();return pe(o.onFileDropped(i))})("dragover",function(i){fe(t);let o=z();return pe(o.onDragOver(i))}),I(1,"label",6)(2,"input",7),ce("change",function(i){fe(t);let o=z();return pe(o.onFilesSelected(i))}),D(),I(3,"div",8),ge(4,"i",9),I(5,"span",10),oe(6,"Importez ou faites glisser les fichiers ici "),D()()()()}if(r&2){let t=z();H(),Q("ngClass",Qr(2,cb,t.isDragging)),H(),Q("accept",t.fileType==="image"?"image/*":t.fileType==="pdf"?"application/pdf":"image/*")}}function fb(r,e){if(r&1&&(I(0,"div",12)(1,"div",20),ge(2,"i",21),I(3,"div",22)(4,"span"),oe(5),D(),I(6,"span",23),oe(7),D()()()()),r&2){let t=e.$implicit;H(5),lt(t.name),H(2),Xe("",t.size," KB")}}function pb(r,e){r&1&&ge(0,"i",17)}function gb(r,e){if(r&1){let t=Ae();I(0,"div",11),Je(1,fb,8,2,"div",12,et),D(),I(3,"div",13)(4,"div",14)(5,"label",15)(6,"input",16),ce("change",function(i){fe(t);let o=z();return pe(o.onFilesSelected(i))}),D(),ye(7,pb,1,0,"i",17),D(),I(8,"app-button",18),ce("handleClick",function(){fe(t);let i=z();return pe(i.uploadFile())}),D(),I(9,"app-button",19),ce("handleClick",function(){fe(t);let i=z();return pe(i.resetFiles())}),D()()()}if(r&2){let t=z();H(),Ze(t.listFiles),H(5),Q("accept",t.fileType==="image"?"image/*":t.fileType==="pdf"?"application/pdf":"image/*"),Is("multiple",t.multiple),H(),Ee(t.isUploaded?-1:7),H(),Q("disabled",t.isUploaded),H(),Q("disabled",t.isUploaded)("outlined",!0)}}var bi=(()=>{let e=class e{constructor(n,i){this.applicationService=n,this.fileService=i,this.fileType="image",this.multiple=!0,this.mode="",this.listFiles=[],this.uploadedFiles=[],this.isUploaded=!1,this.filesUpload=new xt,this.removeFile=new xt,this.isDragging=!1,this.fileService.$listFiles.subscribe(o=>{this.listFiles=o}),this.fileService.$uploadedFiles.subscribe(o=>{this.isUploaded=o})}ngOnDestroy(){this.listFiles=[]}ngOnInit(){this.listFiles=[]}onFilesSelected(n){for(let i of n.target.files)this.listFiles.push(i);this.listFiles=[...this.listFiles],this.listFiles}onDragOver(n){n.preventDefault(),this.isDragging=!0}onFileDropped(n){n.preventDefault(),this.isDragging=!1,n.dataTransfer&&n.dataTransfer.files&&(this.listFiles=n.dataTransfer.files)}uploadFile(){this.isUploaded=!0,this.filesUpload.emit(this.listFiles)}resetFiles(){this.listFiles=[],this.isUploaded=!1}clearFile(n){this.fileInput&&(this.fileInput.nativeElement.value="")}onRemoveFile(n){return G(this,null,function*(){if(this.uploadedFiles.length===1){this.applicationService.showSwalDialog(this.fileType==="image"?"une image au moins est obligatoire":"un fichier  au moins est obligatoire","info","#c3dbf3");return}(yield this.applicationService.showSuccessfulDeleteDialog("Votre image a \xE9t\xE9 supprim\xE9e."))&&(this.uploadedFiles.splice(n,1),this.removeFile.emit(this.uploadedFiles))})}};e.\u0275fac=function(i){return new(i||e)(ve(tt),ve(pn))},e.\u0275cmp=ke({type:e,selectors:[["app-custom-file-upload"]],viewQuery:function(i,o){if(i&1&&Ve(lb,5),i&2){let s;Ue(s=ze())&&(o.fileInput=s.first)}},inputs:{fileType:"fileType",multiple:"multiple",mode:"mode",uploadedFiles:"uploadedFiles"},outputs:{filesUpload:"filesUpload",removeFile:"removeFile"},standalone:!0,features:[Be],decls:3,vars:3,consts:[[1,"d-flex","align-center","justify-start",2,"gap","16px"],[1,"upload-container"],[1,"card","uploded-file",3,"style"],[1,"card","uploded-file"],[1,"uploded-file-clear",3,"click"],[1,"upload-container",3,"drop","dragover"],["tabindex","0",1,"upload-label",3,"ngClass"],["type","file","multiple","multiple",1,"file-input",3,"change","accept"],[1,"d-flex","flex-column","align-center"],[1,"ri-file-fill","primary-text","bold"],[1,"mt-5","font-color-text"],[1,"file-preview-card"],[1,"file-preview","d-flex","align-center","justify-content-between"],[1,"mt-5"],[1,"d-flex","align-center","justify-end"],[1,"upload-label"],["type","file",1,"file-input",3,"change","accept"],[1,"ri-add-line","add-plus-icon","clickable","cursor-pointer"],["icon","ri-upload-line","label","T\xE9l\xE9charger","size","small",1,"mr-5",3,"handleClick","disabled"],["icon","ri-refresh-line","label","R\xE9initialiser","size","small",1,"mr-5",3,"handleClick","disabled","outlined"],[1,"d-flex","justify-start","align-center"],[1,"ri-attachment-2","mr-5","primary-text","bold"],[1,"d-flex","flex-column","text-align-left"],[1,"mt-2"]],template:function(i,o){i&1&&ye(0,ub,3,0,"div",0)(1,hb,7,4,"div",1)(2,gb,10,6),i&2&&(Ee(o.mode==="editMode"?0:-1),H(),Ee(o.listFiles.length===0?1:-1),H(),Ee(o.listFiles.length>0?2:-1))},dependencies:[Ut,Wn],styles:['@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--bg-color: #ffffff;--font-color: #000000;--hover-font-color: #000000;--input-border-color: rgba(128, 128, 128, .44);--main-bg-color: #f2f2f2;--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: #E8476057;--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(27, 31, 35, .15);--footer-color:#000;--box-shadow: $box-shadow}[data-theme=dark][_ngcontent-%COMP%]{--bg-color: #161625;--font-color: #ffffff;--hover-font-color: #000000;--input-border-color: #E8476057;--main-bg-color: rgb(14, 14, 27);--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: rgba(255, 255, 255, .16);--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(60, 64, 68, .78);--footer-color:#fff;--box-shadow: $box-shadow}[_ngcontent-%COMP%]:dir(ltr){font-family:Ubuntu,sans-serif;--small-font-size: 11px;--normal-font-size: 14px;--medium-font-size: 18px;--big-font-size: 21px}[_ngcontent-%COMP%]:dir(rtl){font-family:Ubuntu,sans-serif;--small-font-size: 13px;--normal-font-size: 16px;--medium-font-size: 20px;--big-font-size: 23px}.excel-color[_ngcontent-%COMP%]{color:green!important}.pdf-color[_ngcontent-%COMP%]{color:#ff4500!important}.focus-color[_ngcontent-%COMP%]{border-color:var(--main-secoundary-color);outline:0;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31);box-shadow:0 0 0 .1rem #c7253e4f}.upload-container[_ngcontent-%COMP%]{width:100%;margin:0 auto}.upload-container[_ngcontent-%COMP%]   .upload-label[_ngcontent-%COMP%]{display:block;width:100%;border:2px dashed #ccc;padding:20px;text-align:center;cursor:pointer;transition:border-color .3s ease;border-radius:1em}.upload-container[_ngcontent-%COMP%]   .upload-label[_ngcontent-%COMP%]:focus{border:2px dashed var(--main-primary-color);outline:0}.upload-container[_ngcontent-%COMP%]   .upload-label[_ngcontent-%COMP%]:hover{border-color:#999}.upload-container[_ngcontent-%COMP%]   .upload-label[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.add-plus-icon[_ngcontent-%COMP%]{background-color:var(--main-primary-color);color:#fff;padding:8px;border-radius:.4em;margin-right:5px}.file-preview-card[_ngcontent-%COMP%]{padding:.5em;border:solid 2px rgba(203,203,203,.31);border-radius:1em;max-height:200px;overflow-y:auto}.file-preview-card[_ngcontent-%COMP%]   .file-preview[_ngcontent-%COMP%]{box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin:10px 0;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:40px}.file-preview-card[_ngcontent-%COMP%]   .file-preview[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color);font-size:14px;font-weight:700}.file-preview-card[_ngcontent-%COMP%]   .file-preview[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:12px;font-weight:400}.file-toolbar[_ngcontent-%COMP%]{box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin:10px 0;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:40px}.uploded-file[_ngcontent-%COMP%]{position:relative;height:40px;width:40px;aspect-ratio:1/1;transition:all .2s ease-in-out}.uploded-file-clear[_ngcontent-%COMP%]{position:absolute;color:#fff;background-color:red;padding:.2em;border-radius:50%;height:13px;width:13px;display:flex;align-items:center;justify-content:center;font-size:10px;top:-.4rem;right:-.2rem;cursor:pointer}.primary-border[_ngcontent-%COMP%]{border-color:var(--main-primary-color)!important}']});let r=e;return r})();var Tg=(()=>{let e=class e{constructor(){this.isVisible=!1,this.placeholder="",this.readonly=!1,this.styles={},this.inputValue=new xt}onInput(n){this.inputValue.emit(n.target.value)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ke({type:e,selectors:[["app-secure-password"]],inputs:{isVisible:"isVisible",placeholder:"placeholder",readonly:"readonly",styles:"styles",value:"value"},outputs:{inputValue:"inputValue"},standalone:!0,features:[Be],decls:3,vars:8,consts:[[1,"input-container"],[3,"input","type","readonly","placeholder","value"],[1,"cursor-pointer",3,"click","ngClass"]],template:function(i,o){i&1&&(I(0,"div",0)(1,"input",1),ce("input",function(a){return o.onInput(a)}),D(),I(2,"i",2),ce("click",function(){return o.isVisible?o.isVisible=!1:o.isVisible=!0}),D()()),i&2&&(H(),Ri(o.styles),Q("type",o.isVisible?"text":"password")("readonly",o.readonly)("placeholder",o.placeholder)("value",o.value),H(),Q("ngClass",o.isVisible?"ri-eye-off-line":"ri-eye-line"))},dependencies:[Jt,Wn]});let r=e;return r})();var rn=Ms(Ig(),1),um=Ms(lm(),1);var ax=["BarcodeScanner"];var lx={inputStream:{name:"Live",type:"LiveStream",target:null,constraints:{width:{min:640},height:{min:480},aspectRatio:{min:1,max:2},facingMode:"environment"},singleChannel:!1},locator:{patchSize:"medium",halfSample:!0},locate:!0,numOfWorkers:4,decoder:{readers:["code_128_reader"]}},cx=["code_128","code_39","code_39_vin","ean","ean_extended","ean_8","upc","upc_e","codabar","i2of5","2of5","code_93"];function dx(r){return typeof r=="string"?(cm(r),[dm(r)]):r.map(e=>(cm(e),dm(e)))}function cm(r){if(!cx.some(e=>e===r))throw new Error(`This barcode type '${r}' is not valid.`)}function dm(r){return`${r}_reader`}var da=(()=>{class r{constructor(){this.maxWidth="100%",this._valueChanges=new Mc,this.valueChanges=new xt,this.started=new xt,this._started=!1,this._destroyed=new Mc,this._valueChanges.pipe(Qf(this._destroyed),Kf(t=>{let n=t.codeResult.decodedCodes.filter(o=>o.error!==void 0).map(o=>o.error),i=this._getMedian(n);return!this.errorFilter||!(this.errorFilter.median&&i>this.errorFilter.median||this.errorFilter.threshold&&n.some(o=>o>this.errorFilter.threshold))})).subscribe(t=>{let n=rn.default.canvas.ctx.overlay;rn.default.ImageDebug.drawPath(t.line,{x:"x",y:"y"},n,{color:"red",lineWidth:3}),this.valueChanges.next(t)})}set torch(t){let n=rn.default.CameraAccess.getActiveTrack();n&&n.applyConstraints({advanced:[{torch:t}]})}get _maxWidth(){return this.maxWidth?`${this.maxWidth}`:"auto"}get _maxHeight(){return this.maxHeight?`${this.maxHeight}`:"auto"}get isStarted(){return this._started}ngOnDestroy(){this.stop(),this._destroyed.next(!0),this._destroyed.complete()}ngOnChanges(){this.restart()}_init(){return new Promise((t,n)=>{rn.default.onProcessed(i=>this.onProcessed(i)),rn.default.onDetected(i=>this.onDetected(i)),this.configQuagga=(0,um.default)({},this.config,lx),this.configQuagga.inputStream.target=this.barcodeScanner.nativeElement,this.type&&(this.configQuagga.decoder.readers=dx(this.type)),this.deviceId&&(this.configQuagga.inputStream.constraints.deviceId=this.deviceId),rn.default.init(this.configQuagga,i=>{if(i)return console.log(i),n(i);t()})})}_getMedian(t){t.sort((i,o)=>i-o);let n=Math.floor(t.length/2);return t.length%2===1?t[n]:(t[n-1]+t[n])/2}start(){return G(this,null,function*(){this._started||(yield this._init(),rn.default.start(),this._started=!0,this.started.next(!0))})}stop(){this._started&&(rn.default.stop(),this._started=!1,this.started.next(!1))}restart(){this._started&&(this.stop(),this.start())}onProcessed(t){let n=rn.default.canvas.ctx.overlay,i=rn.default.canvas.dom.overlay;t&&(t.boxes&&(n.clearRect(0,0,parseInt(i.getAttribute("width"),10),parseInt(i.getAttribute("height"),10)),t.boxes.filter(o=>o!==t.box).forEach(o=>{rn.default.ImageDebug.drawPath(o,{x:0,y:1},n,{color:"green",lineWidth:2})})),t.box&&rn.default.ImageDebug.drawPath(t.box,{x:0,y:1},n,{color:"#00F",lineWidth:2}))}onDetected(t){this._valueChanges.next(t)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ke({type:r,selectors:[["barcode-scanner-livestream"]],viewQuery:function(t,n){if(t&1&&Ve(ax,5),t&2){let i;Ue(i=ze())&&(n.barcodeScanner=i.first)}},inputs:{type:"type",deviceId:"deviceId",maxWidth:"maxWidth",maxHeight:"maxHeight",config:"config",errorFilter:"errorFilter",torch:"torch"},outputs:{valueChanges:"valueChanges",started:"started"},features:[Tn],decls:4,vars:13,consts:[["BarcodeScanner",""],[1,"scanner",3,"hidden"],[1,"drawingBuffer"]],template:function(t,n){t&1&&(I(0,"div",1,0),ge(2,"video")(3,"canvas",2),D()),t&2&&(Nt("max-height",n._maxHeight)("max-width",n._maxWidth),Q("hidden",!n.isStarted),H(2),Nt("max-height",n._maxHeight)("max-width",n._maxWidth),H(),Nt("max-height",n._maxHeight)("max-width",n._maxWidth))},styles:[`.scanner{position:relative}.scanner video,.scanner canvas{width:100%;height:100%}.scanner canvas.drawingBuffer{position:absolute;left:0;top:0}
`],encapsulation:2}),r})(),hm=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wn({type:r}),r.\u0275inj=xn({imports:[Ds]}),r})();var R0=Ms(k0(),1),WA=["bcElement"],Ca=(()=>{let e=class e{get options(){return{format:this.format,lineColor:this.lineColor,width:this.width,height:this.height,displayValue:this.displayValue,fontOptions:this.fontOptions,font:this.font,textAlign:this.textAlign,textPosition:this.textPosition,textMargin:this.textMargin,fontSize:this.fontSize,background:this.background,margin:this.margin,marginTop:this.marginTop,marginBottom:this.marginBottom,marginLeft:this.marginLeft,marginRight:this.marginRight,valid:this.valid}}constructor(n){this.renderer=n,this.elementType="svg",this.cssClass="barcode",this.format="CODE128",this.lineColor="#000000",this.width=2,this.height=100,this.displayValue=!1,this.fontOptions="",this.font="monospace",this.textAlign="center",this.textPosition="bottom",this.textMargin=2,this.fontSize=20,this.background="#ffffff",this.margin=10,this.marginTop=10,this.marginBottom=10,this.marginLeft=10,this.marginRight=10,this.value="",this.valid=()=>!0}ngAfterViewInit(){this.createBarcode()}ngOnChanges(){this.bcElement&&this.createBarcode()}createBarcode(){if(!this.value)return;let n;switch(this.elementType){case"img":n=this.renderer.createElement("img");break;case"canvas":n=this.renderer.createElement("canvas");break;case"svg":default:n=this.renderer.createElement("svg","svg")}(0,R0.default)(n,this.value,this.options);for(let i of this.bcElement.nativeElement.childNodes)this.renderer.removeChild(this.bcElement.nativeElement,i);this.renderer.appendChild(this.bcElement.nativeElement,n)}};e.\u0275fac=function(i){return new(i||e)(ve(Ic))},e.\u0275cmp=ke({type:e,selectors:[["ngx-barcode6"]],viewQuery:function(i,o){if(i&1&&Ve(WA,5),i&2){let s;Ue(s=ze())&&(o.bcElement=s.first)}},inputs:{elementType:[0,"bc-element-type","elementType"],cssClass:[0,"bc-class","cssClass"],format:[0,"bc-format","format"],lineColor:[0,"bc-line-color","lineColor"],width:[0,"bc-width","width"],height:[0,"bc-height","height"],displayValue:[0,"bc-display-value","displayValue"],fontOptions:[0,"bc-font-options","fontOptions"],font:[0,"bc-font","font"],textAlign:[0,"bc-text-align","textAlign"],textPosition:[0,"bc-text-position","textPosition"],textMargin:[0,"bc-text-margin","textMargin"],fontSize:[0,"bc-font-size","fontSize"],background:[0,"bc-background","background"],margin:[0,"bc-margin","margin"],marginTop:[0,"bc-margin-top","marginTop"],marginBottom:[0,"bc-margin-bottom","marginBottom"],marginLeft:[0,"bc-margin-left","marginLeft"],marginRight:[0,"bc-margin-right","marginRight"],value:[0,"bc-value","value"],valid:[0,"bc-valid","valid"]},features:[Tn],decls:2,vars:2,consts:[["bcElement",""]],template:function(i,o){i&1&&ge(0,"div",null,0),i&2&&or(o.cssClass)},encapsulation:2});let r=e;return r})(),Ea=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=wn({type:e}),e.\u0275inj=xn({});let r=e;return r})();var wu=(()=>{let e=class e{ngOnInit(){}ngAfterViewInit(){}startScanning(){this.barcodeScanner.start()}stopScanning(){this.barcodeScanner.stop()}onValueChanges(n){this.barcodeValue=n.codeResult.code}onStarted(n){console.log("Scanner started:",n)}onClose(n){this.stopScanning()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ke({type:e,selectors:[["app-barcode-scanner"]],viewQuery:function(i,o){if(i&1&&Ve(da,5),i&2){let s;Ue(s=ze())&&(o.barcodeScanner=s.first)}},standalone:!0,features:[Be],decls:3,vars:9,consts:[["type","code_128",3,"valueChanges","started","close","maxHeight"],[3,"hidden"],[3,"bc-background","bc-line-color","bc-font-size","bc-format","bc-value","bc-display-value","bc-height"]],template:function(i,o){i&1&&(I(0,"barcode-scanner-livestream",0),ce("valueChanges",function(a){return o.onValueChanges(a)})("started",function(a){return o.onStarted(a)})("close",function(a){return o.onClose(a)}),D(),I(1,"div",1),ge(2,"ngx-barcode6",2),D()),i&2&&(Q("maxHeight","55"),H(),Q("hidden",!o.barcodeValue),H(),pt("bc-value",o.barcodeValue),Q("bc-background","var(--bg-color)")("bc-line-color","var(--font-color)")("bc-font-size",12)("bc-format","MSI")("bc-display-value",!0)("bc-height",20))},dependencies:[hm,da,Ea,Ca]});let r=e;return r})();var Cu=()=>[];function GA(r,e){}function $A(r,e){}function XA(r,e){if(r&1&&(I(0,"label",1),oe(1),ye(2,$A,0,0),D()),r&2){let t=z();pt("for",t.input.id),H(),Xe("",t.input.label+":"," "),H(),Ee(t.mode=="addMode"||t.mode=="editMode"?2:-1)}}function KA(r,e){r&1&&(I(0,"span",2),oe(1,"*"),D())}function YA(r,e){if(r&1){let t=Ae();I(0,"app-generic-drop-down",11),ce("selectOption",function(i){fe(t);let o=z(2);return pe(o.onSelectOption(i))}),D()}if(r&2){let t=z(2);pt("dropDownId",t.input.id),Q("options",t.input.options||Pe(6,Cu))("multiple",!0)("bindLabel",t.input.bindLabel)("bindValue",t.input.bindValue)("selectedOption",t.selectedOptionList)}}function QA(r,e){if(r&1&&(I(0,"span",12),oe(1),D()),r&2){let t=e.$implicit,n=z(3);H(),Xe(" ",t[n.input.bindLabel?n.input.bindLabel:""]," ")}}function JA(r,e){if(r&1&&(I(0,"div",10),Je(1,QA,2,1,"span",12,et),D()),r&2){let t=z(2);H(),Ze(t.selectedOptionList)}}function ZA(r,e){if(r&1&&ye(0,YA,1,7,"app-generic-drop-down",9)(1,JA,3,0,"div",10),r&2){let t=z();Ee(t.mode=="addMode"||t.mode=="editMode"&&!t.input.disabledOnEditMode?0:-1),H(),Ee(t.mode!="addMode"&&t.mode=="detailsMode"?1:-1)}}function eM(r,e){if(r&1&&ge(0,"input",13),r&2){let t=z(2);Q("value",t.formValues[t.input.formControlName]?t.applicationService.filterList(t.input.optionsSnapShot?t.input.optionsSnapShot:t.input.options,t.input.bindValue,t.formValues[t.input.formControlName])[t.input.bindLabel?t.input.bindLabel:""]:"aucun(e)")}}function tM(r,e){if(r&1){let t=Ae();I(0,"app-generic-drop-down",15),ce("selectOption",function(i){fe(t);let o=z(2);return pe(o.onSelectOption(i))}),D()}if(r&2){let t=z(2);pt("dropDownId",t.input.id),Q("options",t.input.options?t.input.options:Pe(5,Cu))("bindLabel",t.input.bindLabel)("bindValue",t.input.bindValue)("selectedOption",t.selectedOption)}}function nM(r,e){if(r&1&&ye(0,eM,1,1,"input",13)(1,tM,1,6,"app-generic-drop-down",14),r&2){let t=z();Ee(t.mode=="detailsMode"?0:-1),H(),Ee(t.mode=="addMode"||t.mode=="editMode"?1:-1)}}function iM(r,e){if(r&1){let t=Ae();I(0,"div",16)(1,"app-custom-file-upload",17),ce("filesUpload",function(i){fe(t);let o=z(2);return pe(o.onInputFiles(i,o.input.formControlName))})("removeFile",function(i){fe(t);let o=z(2);return pe(o.onRemoveFiles(i,o.input.formControlName))}),D()()}if(r&2){let t=z(2);H(),Q("mode","editMode")("uploadedFiles",t.mode=="editMode"?t.formValues[t.input.formControlName]:Pe(4,Cu))("multiple",t.input.multiple)("fileType",t.input.fileType)}}function rM(r,e){if(r&1&&ye(0,iM,2,5,"div",16),r&2){let t=z();Ee(t.mode=="addMode"||t.mode=="editMode"?0:-1)}}function oM(r,e){if(r&1){let t=Ae();I(0,"app-secure-password",18),ce("change",function(i){fe(t);let o=z();return pe(o.onInput(i))}),D()}if(r&2){let t=z();Q("value",t.formValues[t.input.formControlName])("readonly",t.mode=="detailsMode")("isVisible",!1)("placeholder",t.input.placeholder)}}function sM(r,e){if(r&1){let t=Ae();I(0,"textarea",19),ce("input",function(i){fe(t);let o=z();return pe(o.onInput(i))}),D()}if(r&2){let t=z();Ri(t.input.styles),Q("id",t.input.id)("readonly",t.mode=="detailsMode")("placeholder",t.mode=="detailsMode"?"":t.input.placeholder)("value",t.formValues[t.input.formControlName])("inputMask",t.input.inputMask)("disabled",t.disabled)}}function aM(r,e){if(r&1){let t=Ae();I(0,"div",5),ge(1,"app-barcode-scanner"),I(2,"i",20),ce("click",function(){fe(t);let i=z();return pe(i.startScanner())}),D()()}}function lM(r,e){if(r&1&&(I(0,"span",24),oe(1),D()),r&2){let t=z(2);Nt("background-color",t.getStatusColor(t.formValues[t.input.formControlName]!=null&&t.formValues[t.input.formControlName].value?t.formValues[t.input.formControlName]==null?null:t.formValues[t.input.formControlName].value:t.formValues[t.input.formControlName])||"#fff"),H(),Xe(" ",t.getStatusLabel(t.formValues[t.input.formControlName],t.input.formControlName)," ")}}function cM(r,e){if(r&1){let t=Ae();I(0,"app-toggle",25),ce("toggle",function(i){fe(t);let o=z(2);return pe(o.onInput(i))}),D()}if(r&2){let t=z(2);Q("disable",t.mode==="detailsMode")("isToggled",t.formValues[t.input.formControlName])}}function dM(r,e){if(r&1&&(I(0,"div",6)(1,"div",21),ye(2,lM,2,3,"span",22)(3,cM,1,2,"app-toggle",23),D()()),r&2){let t=z();H(2),Ee(t.mode==="detailsMode"?2:3)}}function uM(r,e){if(r&1){let t=Ae();I(0,"input",26),ce("input",function(i){fe(t);let o=z();return pe(o.onInput(i))})("copy",function(i){fe(t);let o=z();return pe(o.copier(i))}),D()}if(r&2){let t=z();Ri(t.input.styles),Q("type",t.input.type)("id",t.input.id)("readonly",t.mode=="detailsMode")("placeholder",t.mode=="detailsMode"?"":t.input.placeholder)("value",t.formValues[t.input.formControlName])("inputMask",t.input.inputMask)("disabled",t.disabled),Is("min",t.input.min)("max",t.input.max)}}function hM(r,e){if(r&1&&(I(0,"span",8),oe(1),D()),r&2){let t=z();H(),lt(t.input.requiredMessage)}}function fM(r,e){if(r&1&&(I(0,"span",8),oe(1),D()),r&2){let t=z().$implicit;H(),lt(t.value)}}function pM(r,e){if(r&1&&ye(0,fM,2,1,"span",8),r&2){let t=e.$implicit,n=z(2);Ee(n.F[n.input.formControlName].errors!=null&&n.F[n.input.formControlName].errors[t.key[1]]?0:-1)}}function gM(r,e){if(r&1&&(Je(0,pM,1,1,null,null,et),ot(2,"keyvalue")),r&2){let t=z();Ze(gt(2,0,t.input.controls))}}var Sa=(()=>{let e=class e{constructor(n,i,o){this.crudService=n,this.fileService=i,this.applicationService=o,this.input={},this.form={},this.disabled=!1,this.inputValue=new xt,this.select=new xt,this.selectedOption={},this.selectedOptionList=[],this.listFilesPaths=[]}get F(){return this.form.controls}ngOnDestroy(){this.selectedOption={},this.selectedOptionList=[],this.listFilesPaths=[],this.formValues={}}ngOnInit(){return G(this,null,function*(){this.crudService.formValue$.subscribe(n=>{this.formValues=n,this.crudService.mode$.subscribe(i=>{this.mode=i,this.mode,this.mode=="detailsMode"||this.mode=="editMode"?(this.input.type=="select"&&(this.input.formControlName,this.selectedOption=this.applicationService.filterList(this.input.options,this.input.bindValue,this.formValues[this.input.formControlName]),this.selectedOption),this.input.type=="multi-select"&&(this.input.formControlName,this.selectedOptionList=this.input.options?this.input.options.filter(o=>(this.formValues[this.input.formControlName]?this.formValues[this.input.formControlName]:[]).includes(o[this.input.bindValue?this.input.bindValue:""])):[])):(this.selectedOption=null,this.selectedOptionList=[])})})})}copier(n){this.value=n.target.value,this.inputValue.emit(this.value)}onInput(n){this.input.type=="checkbox"?this.value=n:this.input.unite!=""?this.value=parseFloat(n.target.value):this.value=n.target.value,this.inputValue.emit(this.value)}onInputFiles(n,i){return G(this,null,function*(){let o={[i]:n};yield this.saveFile(o,i),yield this.applicationService.patchControlValue(i,this.listFilesPaths,this.form),this.inputValue.emit(this.listFilesPaths)})}saveFile(n,i){return G(this,null,function*(){if(this.mode=="editMode"&&(this.listFilesPaths=this.formValues[i]),n&&n[i])for(let o of n[i])try{(yield this.fileService.uploadFile(o)).subscribe(a=>{this.listFilesPaths.push(a)})}catch(s){console.error("File upload failed:",s)}})}onSelectOption(n){this.input.type==="select"?(this.selectedOption=n,this.value=this.selectedOption[this.input.bindValue?this.input.bindValue:""],this.value,this.select.emit(this.value)):this.input.type==="multi-select"&&(this.selectedOptionList=n,this.value=this.selectedOptionList,this.value,this.select.emit(this.getListValues(this.value,this.input.bindValue)))}getListValues(n,i){return n.map(o=>o[i||""])}startScanner(){this.barcodeScannerComponent.startScanning()}stopScanner(){this.barcodeScannerComponent.stopScanning()}onRemoveFiles(n,i){return G(this,null,function*(){this.formValues[i]=[],this.formValues[i]=n})}getStatusColor(n){try{switch(n){case!0:return"rgb(8,143,82)";case!1:return"#d65a5a";default:return"#fff"}}catch{return""+n,""}}getStatusLabel(n,i){if(n)switch(i){case"orderStatus":return"Expid\xE9";case"paymentStatus":return"Pay\xE9";case"isActive":return"Active";case"outOfStock":return"in stock";default:return"Active"}else switch(i){case"orderStatus":return"En cours";case"paymentStatus":return"impay\xE9";case"isActive":return"Inactive";case"outOfStock":return" out of  stock";default:return"Inactive"}}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(pn),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-generic-input"]],viewQuery:function(i,o){if(i&1&&Ve(wu,5),i&2){let s;Ue(s=ze())&&(o.barcodeScannerComponent=s.first)}},inputs:{input:"input",form:"form",showRequiredMessage:"showRequiredMessage",disabled:"disabled"},outputs:{inputValue:"inputValue",select:"select"},standalone:!0,features:[Be],decls:14,vars:5,consts:[[1,"form-group"],[1,"form-label","font-color-text",3,"for"],[1,"ml-4","required-message"],[3,"value","readonly","isVisible","placeholder"],["rows","3",1,"form-input",3,"id","readonly","placeholder","value","inputMask","style","disabled"],[1,"mt-10"],[1,"mt-20"],[1,"form-input",3,"type","id","readonly","placeholder","value","inputMask","style","disabled"],[1,"required-message"],[3,"options","multiple","dropDownId","bindLabel","bindValue","selectedOption"],[1,"row","d-flex","flex-wrap","scroll-overflow-y"],[3,"selectOption","options","multiple","dropDownId","bindLabel","bindValue","selectedOption"],[1,"tag","infos-bg-text","mr-2","mb-2"],["type","text","readonly","readonly",3,"value"],[3,"options","dropDownId","bindLabel","bindValue","selectedOption"],[3,"selectOption","options","dropDownId","bindLabel","bindValue","selectedOption"],[1,"col-lg-12","col-md-12","col-sm-12","form-group"],[3,"filesUpload","removeFile","mode","uploadedFiles","multiple","fileType"],[3,"change","value","readonly","isVisible","placeholder"],["rows","3",1,"form-input",3,"input","id","readonly","placeholder","value","inputMask","disabled"],[1,"ri-barcode-box-line","bold","scan-icon","clickable","cursor-pointer","primary-text",3,"click"],[1,"d-flex","align-center","justify-start"],[1,"tag","mr-2","mb-2",3,"background-color"],[3,"disable","isToggled"],[1,"tag","mr-2","mb-2"],[3,"toggle","disable","isToggled"],[1,"form-input",3,"input","copy","type","id","readonly","placeholder","value","inputMask","disabled"]],template:function(i,o){if(i&1&&(I(0,"div",0),ye(1,GA,0,0)(2,XA,3,3,"label",1)(3,KA,2,0,"span",2)(4,ZA,2,2)(5,nM,2,2)(6,rM,1,1)(7,oM,1,4,"app-secure-password",3)(8,sM,1,8,"textarea",4)(9,aM,3,0,"div",5)(10,dM,4,1,"div",6)(11,uM,1,11,"input",7)(12,hM,2,1,"span",8)(13,gM,3,2),D()),i&2){let s;H(),Ee(o.mode==="detailsMode"&&o.input.type==="file"?1:2),H(2),Ee(o.input.required&&(o.mode==="addMode"||o.mode==="editMode")?3:-1),H(),Ee((s=o.input.type)==="multi-select"?4:s==="select"?5:s==="file"?6:s==="password"?7:s==="textarea"?8:s==="barcode"?9:s==="checkbox"?10:11),H(8),Ee(o.showRequiredMessage?12:-1),H(),Ee(o.input.controls?13:-1)}},dependencies:[Rn,gp,hn,Jt,bi,Tg,wu,fp,cp],styles:[".checkbox-label[_ngcontent-%COMP%]{position:absolute;top:15px;left:40px;font-size:14px;color:var(--font-color)}"]});let r=e;return r})();var mM=[[["","crud-utilities",""]],[["","details-data",""]],[["","more-actions",""]]],_M=["[crud-utilities]","[details-data]","[more-actions]"],vM=()=>[Ut,import("./chunk-3OZQVGF3.js").then(r=>r.FadeInScaleDirective),lp,ea,import("./chunk-PGLR7MRY.js").then(r=>r.FilterPipe),import("./chunk-7F3PT4TH.js").then(r=>r.PaginatorPipe),Ca,Ls],bM=()=>[ea,Sa,Wn],Eu=()=>[],yM=()=>({width:"70px",minWidth:"70px"}),xM=()=>({label:5,value:5}),wM=()=>({label:10,value:10}),CM=()=>({label:20,value:20}),EM=()=>({label:50,value:50}),SM=()=>({label:100,value:100}),AM=(r,e,t,n,i)=>[r,e,t,n,i];function MM(r,e){if(r&1){let t=Ae();I(0,"app-button",31),ce("handleClick",function(){fe(t);let i=z();return pe(i.onShowDialog(null,!1))}),D()}if(r&2){let t=z();Hn("mt-10",t.applicationService.isMobile()),kc("label","Ajouter un  ",t.title,"")}}function PM(r,e){if(r&1){let t=Ae();I(0,"div",33),ge(1,"i",37),I(2,"input",38),ce("input",function(i){fe(t);let o=z().$implicit,s=z();return pe(s.filterList(o.col,i))}),D()()}}function OM(r,e){if(r&1){let t=Ae();I(0,"i",39),ce("click",function(){fe(t);let i=z().$implicit,o=z();return pe(o.sortList(i.col))}),D()}if(r&2){let t=z().$implicit,n=z();or(t.col===n.sortField&&n.sortDirection==="desc"?"ri-sort-alphabet-desc ":"ri-sort-alphabet-asc")}}function TM(r,e){if(r&1&&(I(0,"div")(1,"div",32),ye(2,PM,3,0,"div",33),I(3,"div",34),ye(4,OM,1,2,"i",35),I(5,"span",36),oe(6),D()()()()),r&2){let t=e.$implicit,n=z();sr("col-",n.Math.round(12/n.columns.length),""),H(2),Ee(t.filterable?2:-1),H(2),Ee(t.sortable?4:-1),H(2),Xe("",n.applicationService.formatStringCols(t.name)," ")}}function IM(r,e){if(r&1&&ge(0,"img",48),r&2){let t=z().$implicit,n=z().$implicit;Q("src",n[t.col]?n[t.col][0]:"assets/images/blank-product-img.png",Qt)}}function kM(r,e){if(r&1&&(I(0,"span",56),oe(1),D()),r&2){let t=z().$implicit,n=z().$implicit,i=z(3);Nt("background-color",i.getStatusColor(n[t.col].value?n[t.col].value:n[t.col])||"#fff"),H(),Xe(" ",i.getStatusLabel(n[t.col],t.col)," ")}}function RM(r,e){if(r&1&&(I(0,"span",52),oe(1),D()),r&2){let t=e.$implicit;H(),Xe(" ",t," ")}}function LM(r,e){if(r&1&&(I(0,"span",52),oe(1),D()),r&2){let t=z(2).$implicit,n=z().$implicit;H(),Xe(" ",(n[t.col]==null?null:n[t.col].slice(1,n[t.col].length).length)+" autres..."," ")}}function DM(r,e){if(r&1&&(I(0,"div",50),Je(1,RM,2,1,"span",52,et),ye(3,LM,2,1,"span",52),D()),r&2){let t=z().$implicit,n=z().$implicit;H(),Ze(n[t.col]==null?null:n[t.col].slice(0,1)),H(2),Ee(n[t.col].length>1?3:-1)}}function FM(r,e){if(r&1&&(I(0,"span",51),oe(1),ot(2,"number"),D()),r&2){let t=z().$implicit,n=z().$implicit,i=z(3);H(),op("",gt(2,2,n[t.col])," ",i.applicationService.filterList(i.fields,"formControlName",t.col).unite," ")}}function NM(r,e){if(r&1&&oe(0),r&2){let t=z(3).$implicit,n=z().$implicit,i=z(3);Xe(" ",i.applicationService.filterList(t.listSource,t.fieldSource,n[t.col])[t.labelSource?t.labelSource:""]," ")}}function BM(r,e){r&1&&oe(0," sans role ")}function jM(r,e){if(r&1&&ye(0,NM,1,1)(1,BM,1,0),r&2){let t=z(2).$implicit,n=z().$implicit;Ee(n[t.col]?0:1)}}function VM(r,e){if(r&1&&oe(0),r&2){let t=z(2).$implicit,n=z().$implicit,i=z(3);Xe(" ",i.applicationService.filterList(t.listSource,t.fieldSource,n[t.col])[t.labelSource?t.labelSource:""]," ")}}function UM(r,e){if(r&1&&(I(0,"span",52),ye(1,jM,2,1)(2,VM,1,1),D()),r&2){let t=z().$implicit;H(),Ee(t.col=="role"?1:2)}}function zM(r,e){if(r&1&&(I(0,"span"),oe(1),ot(2,"date"),D()),r&2){let t=z().$implicit,n=z().$implicit;H(),Xe("",gt(2,1,n[t.col])," ")}}function qM(r,e){r&1&&ge(0,"i",57)}function HM(r,e){if(r&1&&(I(0,"div",53),Je(1,qM,1,0,"i",57,et),D()),r&2){let t=z().$implicit,n=z().$implicit;H(),Ze(Pe(0,Eu).constructor(n[t.col]))}}function WM(r,e){if(r&1&&ge(0,"ngx-barcode6",54),r&2){let t=z().$implicit,n=z().$implicit;pt("bc-value",n[t.col]),Q("bc-background","var(--bg-color)")("bc-line-color","var(--font-color)")("bc-font-size",12)("bc-format","MSI")("bc-display-value",!0)("bc-height",20)}}function GM(r,e){if(r&1&&(I(0,"p",55),oe(1),D()),r&2){let t=z().$implicit,n=z().$implicit;H(),lt(n[t.col])}}function $M(r,e){if(r&1&&(I(0,"div",47),ye(1,IM,1,1,"img",48)(2,kM,2,3,"span",49)(3,DM,4,1,"div",50)(4,FM,3,4,"span",51)(5,UM,3,1,"span",52)(6,zM,3,3,"span")(7,HM,3,1,"div",53)(8,WM,1,7,"ngx-barcode6",54)(9,GM,2,1,"p",55),D()),r&2){let t,n=e.$implicit,i=z(4);or(i.applicationService.isMobile()?"col-12":"col-"+i.Math.round(12/i.columns.length)),H(),Ee((t=n.type)==="img"?1:t==="boolean"?2:t==="tags"?3:t==="numeric"?4:t==="select"?5:t==="date"?6:t==="rating"?7:t==="barcode"?8:9)}}function XM(r,e){if(r&1){let t=Ae();I(0,"app-button",58),ce("handleClick",function(){fe(t);let i=z().$implicit,o=z(3);return pe(o.onShowDetails(i,!1))}),D()}r&2&&Q("iconBtn",!0)("outlined",!1)}function KM(r,e){if(r&1){let t=Ae();I(0,"app-button",59),ce("handleClick",function(){fe(t);let i=z().$implicit,o=z(3);return pe(o.deleteData(i.id))}),D()}r&2&&Q("iconBtn",!0)("outlined",!1)}function YM(r,e){if(r&1&&(I(0,"div",41)(1,"div",42),Je(2,$M,10,3,"div",43,et),D(),I(4,"div",44),ye(5,XM,1,2,"app-button",45)(6,KM,1,2,"app-button",46),D()()),r&2){let t=z(3);H(),Hn("row",!t.applicationService.isMobile()),H(),Ze(t.columns),H(3),Ee(t.currentUserRolePermission.includes("read")?5:-1),H(),Ee(t.currentUserRolePermission.includes("delete")?6:-1)}}function QM(r,e){if(r&1&&(Je(0,YM,7,4,"div",41,et),ot(2,"filter"),ot(3,"paginator"),ot(4,"sort")),r&2){let t=z(2);Ze(ar(4,8,ar(3,4,ar(2,0,t.data,t.filterField,t.filterValue),t.currentPage,t.paginatorSize),t.sortField,t.sortDirection))}}function JM(r,e){r&1&&(I(0,"div",40)(1,"div",60),ge(2,"i",61),I(3,"h5",62),oe(4,"aucune data a \xE9t\xE9 trouv\xE9"),D()()())}function ZM(r,e){if(r&1&&ye(0,QM,5,12)(1,JM,5,0,"div",40),r&2){let t=z();Ee(t.data&&t.data.length>0?0:t.data.length===0?1:-1)}}function eP(r,e){if(r&1&&(I(0,"div",16)(1,"div",63),ge(2,"app-skelton",64),D()()),r&2){let t=z(2);H(2),Q("height",t.applicationService.isMobile()?200:100)("maxHeight",t.applicationService.isMobile()?200:100)("shape",t.applicationService.isMobile()?void 0:"data")}}function tP(r,e){r&1&&Je(0,eP,3,3,"div",16,et),r&2&&Ze(Pe(0,Eu).constructor(4))}function nP(r,e){if(r&1){let t=Ae();I(0,"div",11)(1,"h4",65),oe(2),D(),I(3,"div",66)(4,"div")(5,"i",67),ce("click",function(){fe(t);let i=z();return pe(i.changePage("prev"))}),D(),I(6,"span"),oe(7),D(),I(8,"i",68),ce("click",function(){fe(t);let i=z();return pe(i.changePage("next"))}),D()(),I(9,"app-generic-drop-down",69),ce("selectOption",function(i){fe(t);let o=z();return pe(o.changePaginatorSize(i.value))}),D()()()}if(r&2){let t=z();H(2),Xe("Il y'a au total ",t.totalRows," record(s)"),H(5),lt(t.currentPage+"/"+t.totalPages),H(2),Ri(Pe(9,yM)),pt("placeholder",t.paginatorSize),Q("dropDownDirectionTop",!0)("showDeleteSelected",!1)("showFilterInput",!1)("options",sp(15,AM,Pe(10,xM),Pe(11,wM),Pe(12,CM),Pe(13,EM),Pe(14,SM)))}}function iP(r,e){if(r&1){let t=Ae();I(0,"app-generic-input",71),ce("inputValue",function(i){fe(t);let o=z().$implicit,s=z(2);return pe(s.applicationService.patchControlValue(o.formControlName,i,s.formControl))})("select",function(i){fe(t);let o=z().$implicit,s=z(2);return pe(s.onSelect(i,o))}),D()}if(r&2){let t=z().$implicit,n=z(2);Q("form",n.formControl)("input",t)("disabled",n.applicationService.checkInputValue(t.depend,n.formControl))("showRequiredMessage",n.submitted&&(n.form[t.formControlName].errors==null?null:n.form[t.formControlName].errors.required))}}function rP(r,e){if(r&1&&(I(0,"div",30),ye(1,iP,1,4,"app-generic-input",70),D()),r&2){let t=e.$implicit,n=z(2);Q("ngClass",t.type==="file"||t.type==="textarea"?"col-lg-12":"col-lg-4"),H(),Ee(n.mode=="addMode"&&t.rendered||n.mode=="editMode"&&t.renderedOnEditMode?1:-1)}}function oP(r,e){if(r&1&&(Je(0,rP,2,2,"div",30,et),ot(2,"sort")),r&2){let t=z();Ze(ar(2,0,t.fields,"order","ASC"))}}function sP(r,e){r&1&&(I(0,"div",72),ge(1,"app-skelton",73),D()),r&2&&(H(),Q("height",100)("shape","inputs-shape"))}function aP(r,e){r&1&&Je(0,sP,2,2,"div",72,et),r&2&&Ze(Pe(0,Eu).constructor(12))}function lP(r,e){if(r&1){let t=Ae();I(0,"div",24)(1,"app-button",74),ce("handleClick",function(){fe(t);let i=z();return pe(i.crudService.modeSubject.next("editMode"))}),D(),ks(2,2),D()}r&2&&(H(),Q("label","Modifier")("icon","ri-pencil-line"))}function cP(r,e){if(r&1){let t=Ae();I(0,"app-generic-input",71),ce("inputValue",function(i){fe(t);let o=z().$implicit,s=z();return pe(s.applicationService.patchControlValue(o.formControlName,i,s.formControl))})("select",function(i){fe(t);let o=z().$implicit,s=z();return pe(s.onSelect(i,o))}),D()}if(r&2){let t=z().$implicit,n=z();Q("form",n.formControl)("input",t)("disabled",t.type=="checkbox"&&n.mode=="detailsMode"?!0:t.disabledOnEditMode)("showRequiredMessage",n.submitted&&(n.form[t.formControlName].errors==null?null:n.form[t.formControlName].errors.required))}}function dP(r,e){if(r&1&&(I(0,"div",30),ye(1,cP,1,4,"app-generic-input",70),D()),r&2){let t=e.$implicit;Q("ngClass",t.type==="file"?"col-lg-12":"col-lg-6"),H(),Ee(t.renderedOnEditMode?1:-1)}}function uP(r,e){if(r&1){let t=Ae();I(0,"div",18)(1,"app-button",75),ce("handleClick",function(){fe(t);let i=z();return pe(i.editData(i.selectedLine.id))}),D(),I(2,"app-button",76),ce("handleClick",function(){fe(t);let i=z();return pe(i.crudService.modeSubject.next("detailsMode"))}),D()()}r&2&&(H(2),Q("outlined",!0))}var nt=(()=>{let e=class e{get creationMode(){return this.creationModeSubject.getValue()}set creationMode(n){this.creationModeSubject.next(n)}get showDialogSnapshot(){return this.showDialogSubject.getValue()}set showDialog(n){this.showDialogSubject.next(n)}constructor(n,i,o,s,a,l){this.applicationService=n,this.crudService=i,this.authFirebaseService=o,this.fireStoreService=s,this.fileService=a,this.formBuilder=l,this.Math=Math,this.openRight=!1,this.mode="",this.showAdd=!0,this.title="",this.fields=[],this.columns=[],this.data=[],this.sortField="",this.sortDirection="desc",this.filterField="",this.filterValue="",this.showDetails=new xt,this.showAdding=new xt,this.save=new xt,this.delete=new xt,this.deleteAll=new xt,this.edit=new xt,this.currentPage=1,this.paginatorSize=5,this.totalRows=0,this.totalPages=0,this.formControl={},this.selectedLine={},this.submitted=!1,this.showDialogSubject=new rr(!1),this.showDialog$=this.showDialogSubject.asObservable(),this.creationModeSubject=new rr("new"),this.creationMode$=this.creationModeSubject.asObservable(),this.fileUrl=null,this.error=null,this.currentUser={},this.currentUserRole={},this.currentUserRolePermission=[],this.authFirebaseService.$user.subscribe(c=>{this.currentUser=c,this.currentUserRole=c?.role,this.currentUserRole,this.crudService.getItem(Se.ROLES,this.currentUserRole).subscribe(d=>{this.currentUserRolePermission=d?d.permissions:[]})}),this.crudService.mode$.subscribe(c=>{this.mode=c}),this.crudService.formValueSubject.next({}),this.crudService.totalRowsSubject.subscribe(c=>{this.totalRows=c,this.totalPages=Math.ceil(this.totalRows/this.paginatorSize)}),this.data=this.spliceList(this.data,0,this.paginatorSize)}ngOnChanges(n){}ngOnInit(){return G(this,null,function*(){yield this.initForm(this.fields)})}onSelect(n,i){this.applicationService.patchControlValue(i.formControlName,n,this.formControl),i.depend&&this.fields.map(o=>{if(o.formControlName===i.depend){o.options=[],o.options=o.optionsSnapShot?.filter(s=>s[i.dependBind]===n);return}})}onShowDialog(n,i){return G(this,null,function*(){yield this.initForm(this.fields),this.crudService.modeSubject.next("addMode"),this.submitted=!1,this.crudService.formValueSubject.next(this.formValues),this.showDialogSubject.next(!0),this.showAdding.emit()})}hideDialog(n){this.crudService.modeSubject.getValue()!=="editMode"&&(this.crudService.formValueSubject.next({}),this.genericInputComponent.ngOnDestroy(),this.fileService.listFilesSubject.next([]),this.fileService.uploadedFilesSubject.next(!1)),this.crudService.modeSubject.next("detailsMode"),this.showDialogSubject.next(n)}onShowDetails(n,i){return G(this,null,function*(){this.applicationService.addClassToDiv("right","slide-in-right"),setTimeout(()=>G(this,null,function*(){this.applicationService.removeClassFromDiv("right-container","d-none"),this.applicationService.addClassToDiv("right-container","d-block"),this.selectedLine=n,yield this.initForm(this.fields),yield this.patchForm(n),this.crudService.modeSubject.next("detailsMode"),this.crudService.formValueSubject.next(this.formValues),this.crudService.formValueSubject.getValue(),this.showDetails.emit(n)}),50)})}sortList(n){this.sortField=n,this.sortDirection=this.sortDirection==="asc"?"desc":"asc"}filterList(n,i){this.filterField=n,this.filterValue=i.target.value}changePage(n){this.crudService.loadingSubject.next(!0),setTimeout(()=>{n==="next"?this.currentPage=this.currentPage<Math.ceil(this.totalRows/this.paginatorSize)?this.currentPage+1:this.currentPage:n=="prev"&&(this.currentPage=this.currentPage>1?this.currentPage-1:this.currentPage),this.crudService.loadingSubject.next(!1)},500)}spliceList(n,i,o){return n.splice(i,o)}initForm(n){return G(this,null,function*(){let i={};n.forEach(o=>{let s=o.formControlName;if(s.includes(".")){let a=s.split(".");i[a[0]]||(i[a[0]]={}),i[a[0]][a[1]]=new Lc(o.type==="checkbox"?!1:null,this.initValidators(o))}else i[s]=new Lc(o.type==="checkbox"?!1:o.type==="list"?[]:null,this.initValidators(o))}),this.formControl=this.formBuilder.group(i)})}initValidators(n){let i=[];return n.required&&i.push(Bs.required),n.controls&&n.controls.forEach((o,s)=>{i.push(s[0])}),i}patchForm(n){return G(this,null,function*(){Object.keys(this.formValues).forEach(i=>{this.applicationService.patchControlValue(i,n[i],this.formControl)})})}get form(){return this.formControl.controls}get formValues(){return this.formControl.value}saveData(){return G(this,null,function*(){if(this.submitted=!0,this.formControl.patchValue({createdAt:new Date().toISOString().split("T")[0],createdBy:this.currentUser.email}),this.formControl.invalid){this.formValues,this.formControl;return}else this.save.emit(this.formControl.value),this.showDialogSubject.next(!1)})}editData(n){if(this.submitted=!0,this.formControl.invalid){this.applicationService.logInvalidFields(this.formControl),this.formValues;return}else this.formControl.patchValue({updatedAt:new Date().toISOString().split("T")[0],updatedBy:this.currentUser.email}),this.crudService.modeSubject.next("detailsMode"),this.edit.emit({id:n,data:this.formControl.value})}deleteData(n){return G(this,null,function*(){(yield this.applicationService.showSuccessfulDeleteDialog())&&this.delete.emit(n)})}deleteAllData(){return G(this,null,function*(){(yield this.applicationService.showSuccessfulDeleteDialog())&&this.deleteAll.emit()})}closeRight(){this.applicationService.addClassToDiv("right","slide-out-right"),setTimeout(()=>{this.applicationService.addClassToDiv("right-container","d-none"),this.applicationService.removeClassFromDiv("right","slide-out-right"),this.openRight=!1},500),setTimeout(()=>{this.formControl.reset(),this.crudService.formValueSubject.next({})},500)}getStatusColor(n){try{switch(n){case!0:return"rgb(8,143,82)";case!1:return"#d65a5a";default:return"#fff"}}catch{return""+n,""}}getStatusLabel(n,i){if(n)switch(i){case"orderStatus":return"Expid\xE9";case"paymentStatus":return"Pay\xE9";case"isActive":return"Active";case"outOfStock":return"in stock";default:return"Active"}else switch(i){case"orderStatus":return"En cours";case"paymentStatus":return"impay\xE9";case"isActive":return"Inactive";case"outOfStock":return" out of  stock";default:return"Inactive"}}getFileUrl(n){this.fireStoreService.getDownloadableUrl(n).subscribe(i=>(this.fileUrl=i,this.fileUrl),i=>{throw this.error="Error retrieving file URL: "+i.message,console.error(i),new Error(this.error)})}changePaginatorSize(n){this.paginatorSize=n,this.currentPage=1,this.crudService.loadingSubject.next(!0),setTimeout(()=>{this.crudService.totalRows=this.data.length,this.crudService.loadingSubject.next(!1)},500)}};e.\u0275fac=function(i){return new(i||e)(ve(tt),ve(He),ve(Ln),ve(yp),ve(pn),ve(lr))},e.\u0275cmp=ke({type:e,selectors:[["app-generic-crud"]],viewQuery:function(i,o){if(i&1&&Ve(Sa,5),i&2){let s;Ue(s=ze())&&(o.genericInputComponent=s.first)}},inputs:{showAdd:"showAdd",title:"title",fields:"fields",columns:"columns",data:"data",sortField:"sortField",sortDirection:"sortDirection",filterField:"filterField",filterValue:"filterValue"},outputs:{showDetails:"showDetails",showAdding:"showAdding",save:"save",delete:"delete",deleteAll:"deleteAll",edit:"edit"},standalone:!0,features:[Tn,Be],ngContentSelectors:_M,decls:52,vars:27,consts:[[3,"rootName"],[1,"container"],[1,"utilities","card","col-12"],[1,"col-lg-4","col-sm-12","col-md-12","h-100","align-center"],[1,"col-lg-8","col-sm-12","col-md-12","row","h-100","align-baseline"],["size","small","icon","ri-add-fill",1,"mr-5",3,"mt-10","label"],[1,"data"],[1,"data-header","d-sm-none"],[1,"row","h-100","col-10","align-center","justify-content-between"],[3,"class"],[1,"data-body"],[1,"card","h-20","mt-10","d-flex","align-center","justify-content-between"],["icon","ri-add-line","height","auto","width","70%",3,"closeModal","modalId","showModal","showFooter"],["modal-body",""],[1,"container","x-small-padding","fade-in-fwd","one-em-border-radius"],[1,"x-small-mt",3,"formGroup"],[1,"row"],["modal-footer",""],[1,"d-flex","align-center","justify-end"],["label","Validate","icon","ri-check-line",1,"mr-5",3,"handleClick"],["id","right-container",1,"right-container","d-none"],["id","right",1,"right","scroll-overflow-y"],[1,"d-flex","align-center","justify-content-between","right-header"],[1,"ri-close-fill","close-icon","clickable",3,"click"],[1,"d-flex","align-center","justify-start"],["right-content","",1,"w-100","p-10"],[1,"font-color-text","text-align-center"],[1,"d-flex","flex-column","align-center","justify-content-center","h-100"],[1,"row","p-10","mt-10","w-100"],[1,"x-small-mt",3,"keyup.enter","formGroup"],[1,"col-md-12","col-sm-12","form-group",3,"ngClass"],["size","small","icon","ri-add-fill",1,"mr-5",3,"handleClick","label"],[1,"d-flex","flex-column","justify-end"],[1,"d-flex","flex-row","align-center"],[1,"d-flex","flex-row"],[1,"clickable","cursor-pointer","mr-5",3,"class"],[1,"bold"],[1,"ri-filter-fill","clickable","mr-5"],["type","text",1,"filter-input",3,"input"],[1,"clickable","cursor-pointer","mr-5",3,"click"],[1,"data-body-card","fade-in-fwd","aucune"],["appFadeInScale","",1,"data-body-card"],[1,"col-10","h-100","align-center","justify-content-between"],[1,"fade-in-fwd","data-body-card-field",3,"class"],[1,"col-2","row","content-center","h-100","justify-end"],["size","small","icon","ri-search-line",1,"mr-5","mb-5",3,"iconBtn","outlined"],["size","small","icon","ri-close-circle-line",1,"mr-5",3,"iconBtn","outlined"],[1,"fade-in-fwd","data-body-card-field"],["height","40","width","40","alt","img",2,"box-shadow","var(--box-shadow)",3,"src"],[1,"tag","mr-2","mb-2",3,"background-color"],[1,"row","flex-wrap","m-h-100","hidden-overflow"],[1,"green-text","bold"],[1,"tag","infos-bg-text","mr-2","mb-2"],[1,"row","flex-wrap","m-h-100"],[3,"bc-background","bc-line-color","bc-font-size","bc-format","bc-value","bc-display-value","bc-height"],[1,"max-text-length"],[1,"tag","mr-2","mb-2"],[1,"rating-star","ri-star-fill","mr-2"],["size","small","icon","ri-search-line",1,"mr-5","mb-5",3,"handleClick","iconBtn","outlined"],["size","small","icon","ri-close-circle-line",1,"mr-5",3,"handleClick","iconBtn","outlined"],[1,"row","align-center","justify-content-center","w-100"],[1,"ri-error-warning-line","mr-2","font-color-text"],[1,"font-color-text"],[1,"col-12"],[3,"height","maxHeight","shape"],[1,"m-0"],[1,"d-flex","align-baseline"],[1,"primary-text","bold","ri-arrow-left-s-line","mr-5","clickable","cursor-pointer",3,"click"],[1,"primary-text","bold","ri-arrow-right-s-line","ml-5","clickable","cursor-pointer",3,"click"],["customClasses","mt-0 focus-none","bindLabel","label",3,"selectOption","dropDownDirectionTop","showDeleteSelected","showFilterInput","options","placeholder"],[3,"form","input","disabled","showRequiredMessage"],[3,"inputValue","select","form","input","disabled","showRequiredMessage"],[1,"col-6"],[3,"height","shape"],["size","small",1,"fade-in-fw","ml-5",3,"handleClick","label","icon"],["label","Sauvgarder","size","small","icon","ri-check-line",1,"fade-in-fwd","mr-5",3,"handleClick"],["label","Annuler","size","small","icon","ri-close-line",1,"fade-in-fwd",3,"handleClick","outlined"]],template:function(i,o){i&1&&(rp(mM),ge(0,"app-breadcrumbs",0),I(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),oe(5),D()(),I(6,"div",4),ks(7),ye(8,MM,1,4,"app-button",5),D()(),I(9,"div",6)(10,"div",7)(11,"div",8),Je(12,TM,7,6,"div",9,et),D()(),I(14,"div",10),ye(15,ZM,2,1)(16,tP,2,1),Ot(17,15,vM,null,16),ot(19,"async"),D()(),ye(20,nP,10,21,"div",11),D(),I(21,"app-modal",12),ot(22,"async"),ce("closeModal",function(a){return o.hideDialog(a)}),I(23,"div",13)(24,"div",14)(25,"form",15)(26,"div",16),ye(27,oP,3,4)(28,aP,2,1),Ot(29,27,bM,null,28),ot(31,"async"),D()()()(),I(32,"div",17)(33,"div",18)(34,"app-button",19),ce("handleClick",function(){return o.saveData()}),D()()()(),I(35,"div",20)(36,"div",21)(37,"div",22)(38,"i",23),ce("click",function(){return o.closeRight()}),D(),ye(39,lP,3,2,"div",24),D(),I(40,"app-right")(41,"div",25)(42,"h3",26),oe(43),D(),ks(44,1),I(45,"div",27)(46,"div",28)(47,"form",29),ce("keyup.enter",function(){return o.editData(o.selectedLine.id)}),Je(48,dP,2,2,"div",30,et),ot(50,"sort"),D()()(),ye(51,uP,3,1,"div",18),D()()()()),i&2&&(kc("rootName","",o.title,"s"),H(5),Xe("List des ",o.title,"s"),H(),Hn("justify-end",!o.applicationService.isMobile()),H(2),Ee(o.showAdd&&o.currentUserRolePermission.includes("write")?8:-1),H(4),Ze(o.columns),H(5),$t(!gt(19,17,o.crudService.loading$)),H(3),Ee(o.data?20:-1),H(),Q("modalId","add-modal")("showModal",gt(22,19,o.showDialog$))("showFooter",!0),H(4),Q("formGroup",o.formControl),H(4),$t(!gt(31,21,o.crudService.loading$)||o.formControl),H(10),Ee(o.currentUserRolePermission.includes("update")?39:-1),H(4),Xe("",o.title," D\xE9tails"),H(4),Q("formGroup",o.formControl),H(),Ze(ar(50,23,o.fields,"order","ASC")),H(3),Ee(o.mode==="editMode"?51:-1))},dependencies:[Ut,Rn,fi,gr,ea,mr,Sa,pi,Wn,Jt,kn,In,pp,vp,zt,Ea,Cn,hn],styles:['@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--bg-color: #ffffff;--font-color: #000000;--hover-font-color: #000000;--input-border-color: rgba(128, 128, 128, .44);--main-bg-color: #f2f2f2;--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: #E8476057;--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(27, 31, 35, .15);--footer-color:#000;--box-shadow: $box-shadow}[data-theme=dark][_ngcontent-%COMP%]{--bg-color: #161625;--font-color: #ffffff;--hover-font-color: #000000;--input-border-color: #E8476057;--main-bg-color: rgb(14, 14, 27);--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: rgba(255, 255, 255, .16);--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(60, 64, 68, .78);--footer-color:#fff;--box-shadow: $box-shadow}[_ngcontent-%COMP%]:dir(ltr){font-family:Ubuntu,sans-serif;--small-font-size: 11px;--normal-font-size: 14px;--medium-font-size: 18px;--big-font-size: 21px}[_ngcontent-%COMP%]:dir(rtl){font-family:Ubuntu,sans-serif;--small-font-size: 13px;--normal-font-size: 16px;--medium-font-size: 20px;--big-font-size: 23px}.excel-color[_ngcontent-%COMP%]{color:green!important}.pdf-color[_ngcontent-%COMP%]{color:#ff4500!important}.focus-color[_ngcontent-%COMP%]{border-color:var(--main-secoundary-color);outline:0;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31);box-shadow:0 0 0 .1rem #c7253e4f}.utilities[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;align-items:baseline;flex-wrap:wrap}.utilities[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--font-color);font-weight:700;margin:0;font-size:20px}.utilities[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .utilities[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color)}.data[_ngcontent-%COMP%]{display:flex;flex-direction:column}.data-header[_ngcontent-%COMP%]{box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin-bottom:20px;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:auto}.data-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1vw}.data-header[_ngcontent-%COMP%]   .filter-input[_ngcontent-%COMP%]{height:30px;margin-bottom:5px}.data-body[_ngcontent-%COMP%]{height:auto;padding:9px 0}.data-body-card[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin-bottom:20px;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:75px;border-left:solid 10px var(--main-primary-color)}.data-body-card[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--bg-color-hover)}.data-body-card-infos[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.data-body-card-infos[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;border:solid 1px var(--font-color)}.data-body-card-infos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1vw}.data-body-card-infos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-child{font-weight:700;font-size:12px}.img-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.img-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:90px;width:90px;border-radius:50%}.img-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:var(--font-color)}.img-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:14px;font-weight:400}@media (max-width: 767px){.utilities[_ngcontent-%COMP%]   .paginator[_ngcontent-%COMP%]{margin-left:0;margin-top:10px}h2[_ngcontent-%COMP%]{font-size:15px!important}.data-header[_ngcontent-%COMP%]{display:none}.data-body[_ngcontent-%COMP%]{max-height:500px;height:auto}.data-body-card[_ngcontent-%COMP%]{height:auto!important;padding:10px 10px 30px}.data-body-card-field[_ngcontent-%COMP%]{margin-top:15px!important}.data-body-card-infos[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.data-body-card-infos[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;border:solid 1px var(--font-color)}.data-body-card-infos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.data-body-card-infos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-weight:700;font-size:12px}}.aucune[_ngcontent-%COMP%]:hover{background-color:var(--bg-color)!important}']});let r=e;return r})();var Su=[{formControlName:"productName",type:"text",placeholder:"Entrez le nom du produit",styles:{},id:"product-name",label:"Nom du produit",requiredMessage:"Le nom du produit est requis",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"category",type:"select",placeholder:"S\xE9lectionnez une cat\xE9gorie",styles:{},id:"product-category",label:"Cat\xE9gorie",requiredMessage:"La cat\xE9gorie est requise",required:!0,options:[],bindLabel:"categoryName",bindValue:"id",inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:"subCategory",dependBind:"category",unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"subCategory",type:"select",placeholder:"S\xE9lectionnez une sous cat\xE9gorie",styles:{},id:"product-sub-category",label:"Sous Cat\xE9gorie",requiredMessage:"La sous cat\xE9gorie est requise",required:!0,options:[],bindLabel:"subcategoryName",bindValue:"id",inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"tags",type:"multi-select",placeholder:"S\xE9lectionnez les tags du produit",styles:{},id:"product-tags",label:"Tags",requiredMessage:"",required:!1,inputMask:null,options:[],bindLabel:"tagName",bindValue:"tagName",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"productDescription",type:"textarea",placeholder:"Entrez la description du produit",styles:{},id:"product-description",label:"Description du produit",requiredMessage:"La description est requise",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!1},{formControlName:"price",type:"text",placeholder:"Entrez le prix du produit",styles:{},id:"product-price",label:"Prix",requiredMessage:"Le prix est requis",required:!0,inputMask:En(0,void 0,"DA",2),options:[],min:0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"DA",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"discountPercentage",type:"text",placeholder:"Entrez le pourcentage de r\xE9duction",styles:{},id:"product-discount",label:"R\xE9duction (%)",requiredMessage:"Valeur de r\xE9duction invalide",required:!1,inputMask:En(0,100,"%",0),options:[],min:0,max:100,firstInput:null,secondInput:null,mode:null,depend:null,unite:"%",rendered:!0,renderedOnEditMode:!0,order:6,disabledOnEditMode:!1},{formControlName:"outOfStock",type:"checkbox",placeholder:"",styles:{"margin-top":"20px","margin-left":"5px"},id:"out-of-stock",label:"Stock status",requiredMessage:"",required:!1,options:[],inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:8,disabledOnEditMode:!1},{formControlName:"imagesUrls",type:"file",fileType:"image",placeholder:"Impoter le(s) image(s) du produit",styles:{},id:"product-image",label:"T\xE9l\xE9charger une image",requiredMessage:"L'image du produit est requise",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:8,disabledOnEditMode:!1},{formControlName:"maunalFile",type:"file",fileType:"pdf",placeholder:"Impoter le manuel du produit",styles:{},id:"product-manulal-file",label:"T\xE9l\xE9charger le manuel",requiredMessage:"Le manuel du produit est requis",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:9,disabledOnEditMode:!1},{formControlName:"brandName",type:"text",placeholder:"Entrez le nom de la marque",styles:{},id:"brand-name",label:"Nom de la marque",requiredMessage:"Le nom de la marque est requis",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:10,disabledOnEditMode:!1},{formControlName:"length",type:"text",placeholder:"Entrez la longueur en cm",styles:{},id:"product-length",label:"Longueur (cm)",requiredMessage:"",required:!1,inputMask:En(0,void 0,"cm",0),options:[],min:0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"cm",rendered:!0,renderedOnEditMode:!0,order:11,disabledOnEditMode:!1},{formControlName:"width",type:"text",placeholder:"Entrez la largeur en cm",styles:{},id:"product-width",label:"Largeur (cm)",requiredMessage:"",required:!1,inputMask:En(0,void 0,"cm",0),options:[],min:0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"cm",rendered:!0,renderedOnEditMode:!0,order:12,disabledOnEditMode:!1},{formControlName:"height",type:"text",placeholder:"Entrez la hauteur en cm",styles:{},id:"product-height",label:"Hauteur (cm)",requiredMessage:"",required:!1,inputMask:En(0,void 0,"cm",0),options:[],min:0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"cm",rendered:!0,renderedOnEditMode:!0,order:13,disabledOnEditMode:!1},{formControlName:"weight",type:"text",placeholder:"Entrez le poids en grammes",styles:{},id:"product-weight",label:"Poids (grammes)",requiredMessage:"",required:!1,inputMask:En(0,void 0,"grammes",0),options:[],min:0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"grammes",rendered:!0,renderedOnEditMode:!0,order:14,disabledOnEditMode:!1},{formControlName:"availabilityDate",type:"date",placeholder:"S\xE9lectionnez la date de disponibilit\xE9",styles:{},id:"product-availability-date",label:"Date de disponibilit\xE9",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:"",max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:15,disabledOnEditMode:!1},{formControlName:"isRecommended",type:"checkbox",placeholder:"",styles:{"margin-top":"20px","margin-left":"5px"},id:"is-active",label:"Recommand\xE9",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:16,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"product-created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:17,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"product-created-by",label:"Cr\xE9\xE9 par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:18,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de mise \xE0 jour",styles:{},id:"tag-updated-at",label:"Mis \xE0 jour le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:19,disabledOnEditMode:!1},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"product-updated-by",label:"Mis \xE0 jour par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:20,disabledOnEditMode:!0}],D0=[{col:"imagesUrls",name:"Image",sortable:!1,filterable:!1,type:"img"},{col:"productName",name:"Nom",sortable:!0,filterable:!0,type:"text"},{col:"price",name:"Prix",sortable:!0,filterable:!0,type:"numeric"},{col:"tags",name:"Tags",sortable:!1,filterable:!1,type:"tags",listSource:[],fieldSource:"tagName",labelSource:"tagName"},{col:"outOfStock",name:"Statut du stock",sortable:!1,filterable:!1,type:"boolean"}];var rf={};k1(rf,{AbortException:()=>c2,AnnotationEditorLayer:()=>d2,AnnotationEditorParamsType:()=>u2,AnnotationEditorType:()=>r_,AnnotationEditorUIManager:()=>h2,AnnotationLayer:()=>f2,AnnotationMode:()=>p2,ColorPicker:()=>g2,DOMSVGFactory:()=>m2,DrawLayer:()=>_2,FeatureTest:()=>v2,GlobalWorkerOptions:()=>o_,ImageKind:()=>b2,InvalidPDFException:()=>y2,MissingPDFException:()=>x2,OPS:()=>w2,OutputScale:()=>C2,PDFDataRangeTransport:()=>E2,PDFDateString:()=>S2,PDFWorker:()=>A2,PasswordResponses:()=>M2,PermissionFlag:()=>P2,PixelsPerInch:()=>O2,RenderingCancelledException:()=>T2,TextLayer:()=>I2,UnexpectedResponseException:()=>k2,Util:()=>R2,VerbosityLevel:()=>nf,XfaLayer:()=>L2,build:()=>D2,createValidAbsoluteUrl:()=>F2,fetchData:()=>N2,getDocument:()=>s_,getFilenameFromUrl:()=>B2,getPdfFilenameFromUrl:()=>j2,getXfaPageViewport:()=>V2,isDataScheme:()=>U2,isPdfFile:()=>z2,noContextMenu:()=>q2,normalizeUnicode:()=>H2,setLayerDimensions:()=>W2,shadow:()=>G2,version:()=>a_});var Mo={};Mo.d=(r,e)=>{for(var t in e)Mo.o(e,t)&&!Mo.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})};Mo.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var je=globalThis.pdfjsLib={};Mo.d(je,{AbortException:()=>ni,AnnotationEditorLayer:()=>l2,AnnotationEditorParamsType:()=>Fe,AnnotationEditorType:()=>qe,AnnotationEditorUIManager:()=>Ro,AnnotationLayer:()=>zh,AnnotationMode:()=>Ci,ColorPicker:()=>pl,DOMSVGFactory:()=>Bo,DrawLayer:()=>Xh,FeatureTest:()=>Bt,GlobalWorkerOptions:()=>Hi,ImageKind:()=>Ra,InvalidPDFException:()=>Ba,MissingPDFException:()=>ti,OPS:()=>Sn,OutputScale:()=>ko,PDFDataRangeTransport:()=>el,PDFDateString:()=>Va,PDFWorker:()=>kr,PasswordResponses:()=>mP,PermissionFlag:()=>gP,PixelsPerInch:()=>Ei,RenderingCancelledException:()=>Io,TextLayer:()=>Fo,UnexpectedResponseException:()=>Dr,Util:()=>Me,VerbosityLevel:()=>_l,XfaLayer:()=>il,build:()=>s2,createValidAbsoluteUrl:()=>yP,fetchData:()=>xl,getDocument:()=>n2,getFilenameFromUrl:()=>PP,getPdfFilenameFromUrl:()=>OP,getXfaPageViewport:()=>TP,isDataScheme:()=>wl,isPdfFile:()=>Qh,noContextMenu:()=>vn,normalizeUnicode:()=>SP,setLayerDimensions:()=>Wi,shadow:()=>Ke,version:()=>o2});var Ht=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Q0=[1,0,0,1,0,0],Iu=[.001,0,0,.001,0,0],hP=1e7,ka=1.35,fP=.35,cF=fP/ka,ln={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ci={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},pP="pdfjs_internal_editor_",qe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Fe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},gP={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ra={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Rt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};var Co={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};var _l={ERRORS:0,WARNINGS:1,INFOS:5},Sn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},mP={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},vl=_l.WARNINGS;function _P(r){Number.isInteger(r)&&(vl=r)}function vP(){return vl}function bl(r){vl>=_l.INFOS&&console.log(`Info: ${r}`)}function We(r){vl>=_l.WARNINGS&&console.log(`Warning: ${r}`)}function ft(r){throw new Error(r)}function Lt(r,e){r||ft(e)}function bP(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function yP(r,e=null,t=null){if(!r)return null;try{if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=EP(r)}catch{}let n=e?new URL(r,e):new URL(r);if(bP(n))return n}catch{}return null}function Ke(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}var Si=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}(),Po=class extends Si{constructor(e,t){super(e,"PasswordException"),this.code=t}},Oo=class extends Si{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},Ba=class extends Si{constructor(e){super(e,"InvalidPDFException")}},ti=class extends Si{constructor(e){super(e,"MissingPDFException")}},Dr=class extends Si{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},ku=class extends Si{constructor(e){super(e,"FormatError")}},ni=class extends Si{constructor(e){super(e,"AbortException")}};function J0(r){(typeof r!="object"||r?.length===void 0)&&ft("Invalid argument for bytesToString");let e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);let n=[];for(let i=0;i<e;i+=t){let o=Math.min(i+t,e),s=r.subarray(i,o);n.push(String.fromCharCode.apply(null,s))}return n.join("")}function yl(r){typeof r!="string"&&ft("Invalid argument for stringToBytes");let e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function xP(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function Kh(r){let e=Object.create(null);for(let[t,n]of r)e[t]=n;return e}function wP(){let r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function CP(){try{return new Function(""),!0}catch{return!1}}var Bt=class{static get isLittleEndian(){return Ke(this,"isLittleEndian",wP())}static get isEvalSupported(){return Ke(this,"isEvalSupported",CP())}static get isOffscreenCanvasSupported(){return Ke(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Ke(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Ke(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Ke(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}},Au=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0")),Me=class{static makeHexColor(e,t,n){return`#${Au[e]}${Au[t]}${Au[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){let n=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[n,i]}static applyInverseTransform(e,t){let n=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,o=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[i,o]}static getAxialAlignedBoundingBox(e,t){let n=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),o=this.applyTransform([e[0],e[3]],t),s=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],i[0],o[0],s[0]),Math.min(n[1],i[1],o[1],s[1]),Math.max(n[0],i[0],o[0],s[0]),Math.max(n[1],i[1],o[1],s[1])]}static inverseTransform(e){let t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){let t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],o=e[2]*t[0]+e[3]*t[2],s=e[2]*t[1]+e[3]*t[3],a=(n+s)/2,l=Math.sqrt((n+s)**2-4*(n*s-o*i))/2,c=a+l||1,d=a-l||1;return[Math.sqrt(c),Math.sqrt(d)]}static normalizeRect(e){let t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){let n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;let o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),s=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>s?null:[n,o,i,s]}static#e(e,t,n,i,o,s,a,l,c,d){if(c<=0||c>=1)return;let u=1-c,h=c*c,g=h*c,v=u*(u*(u*e+3*c*t)+3*h*n)+g*i,x=u*(u*(u*o+3*c*s)+3*h*a)+g*l;d[0]=Math.min(d[0],v),d[1]=Math.min(d[1],x),d[2]=Math.max(d[2],v),d[3]=Math.max(d[3],x)}static#t(e,t,n,i,o,s,a,l,c,d,u,h){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&this.#e(e,t,n,i,o,s,a,l,-u/d,h);return}let g=d**2-4*u*c;if(g<0)return;let v=Math.sqrt(g),x=2*c;this.#e(e,t,n,i,o,s,a,l,(-d+v)/x,h),this.#e(e,t,n,i,o,s,a,l,(-d-v)/x,h)}static bezierBoundingBox(e,t,n,i,o,s,a,l,c){return c?(c[0]=Math.min(c[0],e,a),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,a),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],this.#t(e,n,o,a,t,i,s,l,3*(-e+3*(n-o)+a),6*(e-2*n+o),3*(n-e),c),this.#t(e,n,o,a,t,i,s,l,3*(-t+3*(i-s)+l),6*(t-2*i+s),3*(i-t),c),c}};function EP(r){return decodeURIComponent(escape(r))}var Mu=null,F0=null;function SP(r){return Mu||(Mu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,F0=new Map([["\uFB05","\u017Ft"]])),r.replaceAll(Mu,(e,t,n)=>t?t.normalize("NFKC"):F0.get(n))}function AP(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let r=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(r);else for(let e=0;e<32;e++)r[e]=Math.floor(Math.random()*255);return J0(r)}var Yh="pdfjs_internal_id_",Qn={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function MP(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(J0(r))}var Zn="http://www.w3.org/2000/svg",Ei=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};function xl(r,e="text"){return G(this,null,function*(){if(Ao(r,document.baseURI)){let t=yield fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{let i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})})}var To=class r{constructor({viewBox:e,scale:t,rotation:n,offsetX:i=0,offsetY:o=0,dontFlip:s=!1}){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=i,this.offsetY=o;let a=(e[2]+e[0])/2,l=(e[3]+e[1])/2,c,d,u,h;switch(n%=360,n<0&&(n+=360),n){case 180:c=-1,d=0,u=0,h=1;break;case 90:c=0,d=1,u=1,h=0;break;case 270:c=0,d=-1,u=-1,h=0;break;case 0:c=1,d=0,u=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(u=-u,h=-h);let g,v,x,L;c===0?(g=Math.abs(l-e[1])*t+i,v=Math.abs(a-e[0])*t+o,x=(e[3]-e[1])*t,L=(e[2]-e[0])*t):(g=Math.abs(a-e[0])*t+i,v=Math.abs(l-e[1])*t+o,x=(e[2]-e[0])*t,L=(e[3]-e[1])*t),this.transform=[c*t,d*t,u*t,h*t,g-c*t*a-u*t*l,v-d*t*a-h*t*l],this.width=x,this.height=L}get rawDims(){let{viewBox:e}=this;return Ke(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:o=!1}={}){return new r({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:o})}convertToViewportPoint(e,t){return Me.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){let t=Me.applyTransform([e[0],e[1]],this.transform),n=Me.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return Me.applyInverseTransform([e,t],this.transform)}},Io=class extends Si{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}};function wl(r){let e=r.length,t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function Qh(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function PP(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function OP(r,e="document.pdf"){if(typeof r!="string")return e;if(wl(r))return We('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;let t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(r),o=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(o&&(o=o[0],o.includes("%")))try{o=n.exec(decodeURIComponent(o))[0]}catch{}return o||e}var ja=class{started=Object.create(null);times=[];time(e){e in this.started&&We(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||We(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){let e=[],t=0;for(let{name:n}of this.times)t=Math.max(n.length,t);for(let{name:n,start:i,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-i}ms
`);return e.join("")}};function Ao(r,e){try{let{protocol:t}=e?new URL(r,e):new URL(r);return t==="http:"||t==="https:"}catch{return!1}}function vn(r){r.preventDefault()}function N0(r){console.log("Deprecated API usage: "+r)}var Va=class{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let t=this.#e.exec(e);if(!t)return null;let n=parseInt(t[1],10),i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let s=parseInt(t[4],10);s=s>=0&&s<=23?s:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;let c=t[7]||"Z",d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(s+=d,a+=u):c==="+"&&(s-=d,a-=u),new Date(Date.UTC(n,i,o,s,a,l))}};function TP(r,{scale:e=1,rotation:t=0}){let{width:n,height:i}=r.attributes.style,o=[0,0,parseInt(n),parseInt(i)];return new To({viewBox:o,scale:e,rotation:t})}function Jh(r){if(r.startsWith("#")){let e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(We(`Not a valid color format: "${r}"`),[0,0,0])}function IP(r){let e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(let t of r.keys()){e.style.color=t;let n=window.getComputedStyle(e).color;r.set(t,Jh(n))}e.remove()}function vt(r){let{a:e,b:t,c:n,d:i,e:o,f:s}=r.getTransform();return[e,t,n,i,o,s]}function Jn(r){let{a:e,b:t,c:n,d:i,e:o,f:s}=r.getTransform().invertSelf();return[e,t,n,i,o,s]}function Wi(r,e,t=!1,n=!0){if(e instanceof To){let{pageWidth:i,pageHeight:o}=e.rawDims,{style:s}=r,a=Bt.isCSSRoundSupported,l=`var(--scale-factor) * ${i}px`,c=`var(--scale-factor) * ${o}px`,d=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,u=a?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(s.width=d,s.height=u):(s.width=u,s.height=d)}n&&r.setAttribute("data-main-rotation",e.rotation)}var ko=class{constructor(){let e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}},Ru=class r{#e=null;#t=null;#n;#i=null;#o=null;static#r=null;constructor(e){this.#n=e,r.#r||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){let e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");let t=this.#n._uiManager._signal;e.addEventListener("contextmenu",vn,{signal:t}),e.addEventListener("pointerdown",r.#l,{signal:t});let n=this.#i=document.createElement("div");n.className="buttons",e.append(n);let i=this.#n.toolbarPosition;if(i){let{style:o}=e,s=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),e}get div(){return this.#e}static#l(e){e.stopPropagation()}#c(e){this.#n._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()}#d(e){this.#n._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()}#a(e){let t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",vn,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#o?.shown()}#u(){let{editorType:e,_uiManager:t}=this.#n,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",r.#r[e]),this.#a(n),n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#i.append(n)}get#s(){let e=document.createElement("div");return e.className="divider",e}addAltText(e){return G(this,null,function*(){let t=yield e.render();this.#a(t),this.#i.prepend(t,this.#s),this.#o=e})}addColorPicker(e){this.#t=e;let t=e.renderButton();this.#a(t),this.#i.prepend(t,this.#s)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}},Lu=class{#e=null;#t=null;#n;constructor(e){this.#n=e}#i(){let e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",vn,{signal:this.#n._signal});let t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#r(),e}#o(e,t){let n=0,i=0;for(let o of e){let s=o.y+o.height;if(s<n)continue;let a=o.x+(t?o.width:0);if(s>n){i=a,n=s;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,n]}show(e,t,n){let[i,o]=this.#o(t,n),{style:s}=this.#t||=this.#i();e.append(this.#t),s.insetInlineEnd=`${100*i}%`,s.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#r(){let e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");let t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");let n=this.#n._signal;e.addEventListener("contextmenu",vn,{signal:n}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#e.append(e)}};function Ua(r,e,t){for(let n of t)e.addEventListener(n,r[n].bind(r))}function kP(r){return Math.round(Math.min(255,Math.max(1,255*r))).toString(16).padStart(2,"0")}var Du=class{#e=0;get id(){return`${pP}${this.#e++}`}},Fu=class r{#e=AP();#t=0;#n=null;static get _isSVGFittingCanvas(){let e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;let o=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ke(this,"_isSVGFittingCanvas",o)}#i(e,t){return G(this,null,function*(){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(n.url=t,i=yield xl(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){let o=r._isSVGFittingCanvas,s=new FileReader,a=new Image,l=new Promise((c,d)=>{a.onload=()=>{n.bitmap=a,n.isSvg=!0,c()},s.onload=()=>G(this,null,function*(){let u=n.svgUrl=s.result;a.src=(yield o)?`${u}#svgView(preserveAspectRatio(none))`:u}),a.onerror=s.onerror=d});s.readAsDataURL(i),yield l}else n.bitmap=yield createImageBitmap(i);n.refCounter=1}catch(i){console.error(i),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n})}getFromFile(e){return G(this,null,function*(){let{lastModified:t,name:n,size:i,type:o}=e;return this.#i(`${t}_${n}_${i}_${o}`,e)})}getFromUrl(e){return G(this,null,function*(){return this.#i(e,e)})}getFromBlob(e,t){return G(this,null,function*(){let n=yield t;return this.#i(e,n)})}getFromId(e){return G(this,null,function*(){this.#n||=new Map;let t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){let{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)})}getFromCanvas(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n?.bitmap)return n.refCounter+=1,n;let i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,n),this.#n.set(n.id,n),n}getSvgUrl(e){let t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;let t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;let{bitmap:n}=t;if(!t.url&&!t.file){let i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}},Nu=class{#e=[];#t=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:i,type:o=NaN,overwriteIfSameType:s=!1,keepUndo:a=!1}){if(i&&e(),this.#t)return;let l={cmd:e,undo:t,post:n,type:o};if(this.#i===-1){this.#e.length>0&&(this.#e.length=0),this.#i=0,this.#e.push(l);return}if(s&&this.#e[this.#i].type===o){a&&(l.undo=this.#e[this.#i].undo),this.#e[this.#i]=l;return}let c=this.#i+1;c===this.#n?this.#e.splice(0,1):(this.#i=c,c<this.#e.length&&this.#e.splice(c)),this.#e.push(l)}undo(){if(this.#i===-1)return;this.#t=!0;let{undo:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1,this.#i-=1}redo(){if(this.#i<this.#e.length-1){this.#i+=1,this.#t=!0;let{cmd:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#e.length-1}destroy(){this.#e=null}},Gi=class{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:t}=Bt.platform;for(let[n,i,o={}]of e)for(let s of n){let a=s.startsWith("mac+");t&&a?(this.callbacks.set(s.slice(4),{callback:i,options:o}),this.allKeys.add(s.split("+").at(-1))):!t&&!a&&(this.callbacks.set(s,{callback:i,options:o}),this.allKeys.add(s.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);let t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;let n=this.callbacks.get(this.#e(t));if(!n)return;let{callback:i,options:{bubbles:o=!1,args:s=[],checker:a=null}}=n;a&&!a(e,t)||(i.bind(e,...s,t)(),o||(t.stopPropagation(),t.preventDefault()))}},Bu=class r{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let e=new Map([["CanvasText",null],["Canvas",null]]);return IP(e),Ke(this,"_colors",e)}convert(e){let t=Jh(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(let[n,i]of this._colors)if(i.every((o,s)=>o===t[s]))return r._colorsMapping.get(n);return t}getHexCode(e){let t=this._colors.get(e);return t?Me.makeHexColor(...t):e}},Ro=(()=>{class r{#e=new AbortController;#t=null;#n=new Map;#i=new Map;#o=null;#r=null;#l=null;#c=new Nu;#d=null;#a=0;#u=new Set;#s=null;#h=null;#p=new Set;#f=!1;#g=!1;#_=!1;#m=null;#v=null;#y=null;#C=null;#x=!1;#w=null;#T=new Du;#M=!1;#E=!1;#P=null;#A=null;#I=null;#R=null;#S=qe.NONE;#b=new Set;#O=null;#k=null;#N=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#V=[0,0];#F=null;#B=null;#j=null;#L=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let t=r.prototype,n=a=>a.#B.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:l})=>{if(l instanceof HTMLInputElement){let{type:c}=l;return c!=="text"&&c!=="number"}return!0},o=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Ke(this,"_keyboardManager",new Gi([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#B.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#B.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:n}]]))}constructor(t,n,i,o,s,a,l,c,d,u,h){let g=this._signal=this.#e.signal;this.#B=t,this.#j=n,this.#o=i,this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:g}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),o._on("setpreference",this.onSetPreference.bind(this),{signal:g}),o._on("switchannotationeditorparams",v=>this.updateParams(v.type,v.value),{signal:g}),this.#ee(),this.#re(),this.#$(),this.#r=s.annotationStorage,this.#m=s.filterFactory,this.#k=a,this.#C=l||null,this.#f=c,this.#g=d,this.#_=u,this.#R=h||null,this.viewParameters={realScale:Ei.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#L?.resolve(),this.#L=null,this.#e?.abort(),this.#e=null,this._signal=null;for(let t of this.#i.values())t.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#b.clear(),this.#c.destroy(),this.#o?.destroy(),this.#w?.hide(),this.#w=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#F&&(clearTimeout(this.#F),this.#F=null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#R}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#_}get hcmFilter(){return Ke(this,"hcmFilter",this.#k?this.#m.addHCMFilter(this.#k.foreground,this.#k.background):"none")}get direction(){return Ke(this,"direction",getComputedStyle(this.#B).direction)}get highlightColors(){return Ke(this,"highlightColors",this.#C?new Map(this.#C.split(",").map(t=>t.split("=").map(n=>n.trim()))):null)}get highlightColorNames(){return Ke(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){this.#I=t}editAltText(t,n=!1){this.#o?.editAltText(this,t,n)}switchToMode(t,n){this._eventBus.on("annotationeditormodechanged",n,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,n){this._eventBus.dispatch("setpreference",{source:this,name:t,value:n})}onSetPreference({name:t,value:n}){switch(t){case"enableNewAltTextWhenAddingImage":this.#_=n;break}}onPageChanging({pageNumber:t}){this.#a=t-1}focusMainContainer(){this.#B.focus()}findParent(t,n){for(let i of this.#i.values()){let{x:o,y:s,width:a,height:l}=i.div.getBoundingClientRect();if(t>=o&&t<=o+a&&n>=s&&n<=s+l)return i}return null}disableUserSelect(t=!1){this.#j.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Ei.PDF_TO_CSS_UNITS;for(let n of this.#p)n.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#H({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#G(t){let{currentLayer:n}=this;if(n.hasTextLayer(t))return n;for(let i of this.#i.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t=""){let n=document.getSelection();if(!n||n.isCollapsed)return;let{anchorNode:i,anchorOffset:o,focusNode:s,focusOffset:a}=n,l=n.toString(),d=this.#H(n).closest(".textLayer"),u=this.getSelectionBoxes(d);if(!u)return;n.empty();let h=this.#G(d),g=this.#S===qe.NONE,v=()=>{h?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:u,anchorNode:i,anchorOffset:o,focusNode:s,focusOffset:a,text:l}),g&&this.showAllEditors("highlight",!0,!0)};if(g){this.switchToMode(qe.HIGHLIGHT,v);return}v()}#J(){let t=document.getSelection();if(!t||t.isCollapsed)return;let i=this.#H(t).closest(".textLayer"),o=this.getSelectionBoxes(i);o&&(this.#w||=new Lu(this),this.#w.show(i,o,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}#Z(){let t=document.getSelection();if(!t||t.isCollapsed){this.#O&&(this.#w?.hide(),this.#O=null,this.#D({hasSelectedText:!1}));return}let{anchorNode:n}=t;if(n===this.#O)return;let o=this.#H(t).closest(".textLayer");if(!o){this.#O&&(this.#w?.hide(),this.#O=null,this.#D({hasSelectedText:!1}));return}if(this.#w?.hide(),this.#O=n,this.#D({hasSelectedText:!0}),!(this.#S!==qe.HIGHLIGHT&&this.#S!==qe.NONE)&&(this.#S===qe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#x=this.isShiftKeyDown,!this.isShiftKeyDown)){let s=this.#S===qe.HIGHLIGHT?this.#G(o):null;s?.toggleDrawing();let a=new AbortController,l=this.combinedSignal(a),c=d=>{d.type==="pointerup"&&d.button!==0||(a.abort(),s?.toggleDrawing(!0),d.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",c,{signal:l}),window.addEventListener("blur",c,{signal:l})}}#W(t=""){this.#S===qe.HIGHLIGHT?this.highlightSelection(t):this.#f&&this.#J()}#ee(){document.addEventListener("selectionchange",this.#Z.bind(this),{signal:this._signal})}#te(){if(this.#y)return;this.#y=new AbortController;let t=this.combinedSignal(this.#y);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ne(){this.#y?.abort(),this.#y=null}blur(){if(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#W("main_toolbar")),!this.hasSelection)return;let{activeElement:t}=document;for(let n of this.#b)if(n.div.contains(t)){this.#A=[n,t],n._focusEventsAllowed=!1;break}}focus(){if(!this.#A)return;let[t,n]=this.#A;this.#A=null,n.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),n.focus()}#$(){if(this.#P)return;this.#P=new AbortController;let t=this.combinedSignal(this.#P);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ie(){this.#P?.abort(),this.#P=null}#X(){if(this.#d)return;this.#d=new AbortController;let t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#K(){this.#d?.abort(),this.#d=null}#re(){let t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#$(),this.#X()}removeEditListeners(){this.#ie(),this.#K()}dragOver(t){for(let{type:n}of t.dataTransfer.items)for(let i of this.#h)if(i.isHandlingMimeForPasting(n)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(let n of t.dataTransfer.items)for(let i of this.#h)if(i.isHandlingMimeForPasting(n.type)){i.paste(n,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;let n=[];for(let i of this.#b){let o=i.serialize(!0);o&&n.push(o)}n.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(t){this.copy(t),this.delete()}paste(t){return G(this,null,function*(){t.preventDefault();let{clipboardData:n}=t;for(let s of n.items)for(let a of this.#h)if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=n.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){We(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();let o=this.currentLayer;try{let s=[];for(let c of i){let d=yield o.deserialize(c);if(!d)return;s.push(d)}let a=()=>{for(let c of s)this.#Y(c);this.#Q(s)},l=()=>{for(let c of s)c.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(s){We(`paste: "${s.message}".`)}})}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==qe.NONE&&!this.isEditorHandlingKeyboard&&r._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#D(t){Object.entries(t).some(([i,o])=>this.#U[i]!==o)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,t)}),this.#S===qe.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#z([[Fe.HIGHLIGHT_FREE,!0]]))}#z(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#te(),this.#X(),this.#D({isEditing:this.#S!==qe.NONE,isEmpty:this.#q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#K(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(let n of this.#h)this.#z(n.defaultPropertiesToUpdate)}}getId(){return this.#T.id}get currentLayer(){return this.#i.get(this.#a)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#a}addLayer(t){this.#i.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}updateMode(t,n=null,i=!1){return G(this,null,function*(){if(this.#S!==t&&!(this.#L&&(yield this.#L.promise,!this.#L))){if(this.#L=Promise.withResolvers(),this.#S=t,t===qe.NONE){this.setEditingState(!1),this.#se(),this.#L.resolve();return}this.setEditingState(!0),yield this.#oe(),this.unselectAll();for(let o of this.#i.values())o.updateMode(t);if(!n){i&&this.addNewEditorFromKeyboard(),this.#L.resolve();return}for(let o of this.#n.values())o.annotationElementId===n?(this.setSelected(o),o.enterInEditMode()):o.unselect();this.#L.resolve()}})}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,n){if(this.#h){switch(t){case Fe.CREATE:this.currentLayer.addNewEditor();return;case Fe.HIGHLIGHT_DEFAULT_COLOR:this.#I?.updateColor(n);break;case Fe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#N||=new Map).set(t,n),this.showAllEditors("highlight",n);break}for(let i of this.#b)i.updateParams(t,n);for(let i of this.#h)i.updateDefaultParams(t,n)}}showAllEditors(t,n,i=!1){for(let s of this.#n.values())s.editorType===t&&s.show(n);(this.#N?.get(Fe.HIGHLIGHT_SHOW_ALL)??!0)!==n&&this.#z([[Fe.HIGHLIGHT_SHOW_ALL,n]])}enableWaiting(t=!1){if(this.#E!==t){this.#E=t;for(let n of this.#i.values())t?n.disableClick():n.enableClick(),n.div.classList.toggle("waiting",t)}}#oe(){return G(this,null,function*(){if(!this.#M){this.#M=!0;let t=[];for(let n of this.#i.values())t.push(n.enable());yield Promise.all(t);for(let n of this.#n.values())n.enable()}})}#se(){if(this.unselectAll(),this.#M){this.#M=!1;for(let t of this.#i.values())t.disable();for(let t of this.#n.values())t.disable()}}getEditors(t){let n=[];for(let i of this.#n.values())i.pageIndex===t&&n.push(i);return n}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#n.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#u.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#u.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#u.has(t)}removeDeletedAnnotationElement(t){this.#u.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Y(t){let n=this.#i.get(t.pageIndex);n?n.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#t!==t&&(this.#t=t,t&&this.#z(t.propertiesToUpdate))}get#ae(){let t=null;for(t of this.#b);return t}updateUI(t){this.#ae===t&&this.#z(t.propertiesToUpdate)}toggleSelected(t){if(this.#b.has(t)){this.#b.delete(t),t.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#b.add(t),t.select(),this.#z(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(t){for(let n of this.#b)n!==t&&n.unselect();this.#b.clear(),this.#b.add(t),t.select(),this.#z(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(t){return this.#b.has(t)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(t){t.unselect(),this.#b.delete(t),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#D({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#q()})}redo(){this.#c.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#q()})}addCommands(t){this.#c.add(t),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#q()})}#q(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(let t of this.#n.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let t=[...this.#b],n=()=>{for(let o of t)o.remove()},i=()=>{for(let o of t)this.#Y(o)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#Q(t){for(let n of this.#b)n.unselect();this.#b.clear();for(let n of t)n.isEmpty()||(this.#b.add(n),n.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(let t of this.#b)t.commit();this.#Q(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#S!==qe.NONE))&&this.hasSelection){for(let t of this.#b)t.unselect();this.#b.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(t,n,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#V[0]+=t,this.#V[1]+=n;let[o,s]=this.#V,a=[...this.#b],l=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#V[0]=this.#V[1]=0,this.addCommands({cmd:()=>{for(let c of a)this.#n.has(c.id)&&c.translateInPage(o,s)},undo:()=>{for(let c of a)this.#n.has(c.id)&&c.translateInPage(-o,-s)},mustExec:!1})},l);for(let c of a)c.translateInPage(t,n)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#s=new Map;for(let t of this.#b)this.#s.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#s)return!1;this.disableUserSelect(!1);let t=this.#s;this.#s=null;let n=!1;for(let[{x:o,y:s,pageIndex:a},l]of t)l.newX=o,l.newY=s,l.newPageIndex=a,n||=o!==l.savedX||s!==l.savedY||a!==l.savedPageIndex;if(!n)return!1;let i=(o,s,a,l)=>{if(this.#n.has(o.id)){let c=this.#i.get(l);c?o._setParentAndPosition(c,s,a):(o.pageIndex=l,o.x=s,o.y=a)}};return this.addCommands({cmd:()=>{for(let[o,{newX:s,newY:a,newPageIndex:l}]of t)i(o,s,a,l)},undo:()=>{for(let[o,{savedX:s,savedY:a,savedPageIndex:l}]of t)i(o,s,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,n){if(this.#s)for(let i of this.#s.keys())i.drag(t,n)}rebuild(t){if(t.parent===null){let n=this.getLayer(t.pageIndex);n?(n.changeParent(t),n.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#t===t}getActive(){return this.#t}getMode(){return this.#S}get imageManager(){return Ke(this,"imageManager",new Fu)}getSelectionBoxes(t){if(!t)return null;let n=document.getSelection();for(let d=0,u=n.rangeCount;d<u;d++)if(!t.contains(n.getRangeAt(d).commonAncestorContainer))return null;let{x:i,y:o,width:s,height:a}=t.getBoundingClientRect(),l;switch(t.getAttribute("data-main-rotation")){case"90":l=(d,u,h,g)=>({x:(u-o)/a,y:1-(d+h-i)/s,width:g/a,height:h/s});break;case"180":l=(d,u,h,g)=>({x:1-(d+h-i)/s,y:1-(u+g-o)/a,width:h/s,height:g/a});break;case"270":l=(d,u,h,g)=>({x:1-(u+g-o)/a,y:(d-i)/s,width:g/a,height:h/s});break;default:l=(d,u,h,g)=>({x:(d-i)/s,y:(u-o)/a,width:h/s,height:g/a});break}let c=[];for(let d=0,u=n.rangeCount;d<u;d++){let h=n.getRangeAt(d);if(!h.collapsed)for(let{x:g,y:v,width:x,height:L}of h.getClientRects())x===0||L===0||c.push(l(g,v,x,L))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:n}){(this.#l||=new Map).set(t,n)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){let n=this.#l?.get(t.data.id);if(!n)return;let i=this.#r.getRawValue(n);i&&(this.#S===qe.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}}return r})(),B0=(()=>{class r{#e=null;#t=!1;#n=null;#i=null;#o=null;#r=null;#l=!1;#c=null;#d=null;#a=null;#u=null;#s=!1;static#h=null;static _l10n=null;constructor(t){this.#d=t,this.#s=t._uiManager.useNewAltTextFlow,r.#h||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){r._l10n??=t}render(){return G(this,null,function*(){let t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";let n=this.#i=document.createElement("span");t.append(n),this.#s?(t.classList.add("new"),t.setAttribute("data-l10n-id",r.#h.missing),n.setAttribute("data-l10n-id",r.#h["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));let i=this.#d._uiManager._signal;t.addEventListener("contextmenu",vn,{signal:i}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});let o=s=>{s.preventDefault(),this.#d._uiManager.editAltText(this.#d),this.#s&&this.#d._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return t.addEventListener("click",o,{capture:!0,signal:i}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#l=!0,o(s))},{signal:i}),yield this.#f(),t})}get#p(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#s?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#s?this.#e!==null||!!this.#a:this.isEmpty()}get guessedText(){return this.#a}setGuessedText(t){return G(this,null,function*(){this.#e===null&&(this.#a=t,this.#u=yield r._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#f())})}toggleAltTextBadge(t=!1){if(!this.#s||this.#e){this.#c?.remove(),this.#c=null;return}if(!this.#c){let n=this.#c=document.createElement("div");n.className="noAltTextBadge",this.#d.div.append(n)}this.#c.classList.toggle("hidden",!t)}serialize(t){let n=this.#e;return!t&&this.#a===n&&(n=this.#u),{altText:n,decorative:this.#t,guessedText:this.#a,textWithDisclaimer:this.#u}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:t,decorative:n,guessedText:i,textWithDisclaimer:o,cancel:s=!1}){i&&(this.#a=i,this.#u=o),!(this.#e===t&&this.#t===n)&&(s||(this.#e=t,this.#t=n),this.#f())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#d._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#o=null,this.#c?.remove(),this.#c=null}#f(){return G(this,null,function*(){let t=this.#n;if(!t)return;if(this.#s){if(t.classList.toggle("done",!!this.#e),t.setAttribute("data-l10n-id",r.#h[this.#p]),this.#i?.setAttribute("data-l10n-id",r.#h[`${this.#p}-label`]),!this.#e){this.#o?.remove();return}}else{if(!this.#e&&!this.#t){t.classList.remove("done"),this.#o?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let n=this.#o;if(!n){this.#o=n=document.createElement("span"),n.className="tooltip",n.setAttribute("role","tooltip"),n.id=`alt-text-tooltip-${this.#d.id}`;let o=100,s=this.#d._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#o.classList.add("show"),this.#d._reportTelemetry({action:"alt_text_tooltip"})},o)},{signal:s}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#o?.classList.remove("show")},{signal:s})}this.#t?n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(n.removeAttribute("data-l10n-id"),n.textContent=this.#e),n.parentNode||t.append(n),this.#d.getImageForAltText()?.setAttribute("aria-describedby",n.id)})}}return r})(),st=class r{#e=null;#t=null;#n=null;#i=!1;#o=!1;#r=null;#l=null;#c=null;#d="";#a=!1;#u=null;#s=!1;#h=!1;#p=!1;#f=null;#g=0;#_=0;#m=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#v=!1;#y=r._zIndex++;static _borderLineWidth=-1;static _colorManager=new Bu;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){let e=r.prototype._resizeWithKeyboard,t=Ro.TRANSLATE_SMALL,n=Ro.TRANSLATE_BIG;return Ke(this,"_resizerKeyboardManager",new Gi([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],r.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;let{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:o,pageY:s}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[o,s];let[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Ke(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){let t=new ju({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(r._l10n??=e,r._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),r._borderLineWidth!==-1)return;let n=getComputedStyle(document.documentElement);r._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){ft("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#v}set _isDraggable(e){this.#v=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){let[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#y}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#N(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#a?this.#a=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){let[o,s]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/o,this.y=(t+i)/s,this.fixAndSetPosition()}#C([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this.fixAndSetPosition()}translate(e,t){this.#C(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y],this.#C(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#u||=[this.x,this.y];let[n,i]=this.parentDimensions;if(this.x+=e/n,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:c,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:s}=this,[a,l]=this.getBaseTranslation();o+=a,s+=l,this.div.style.left=`${(100*o).toFixed(2)}%`,this.div.style.top=`${(100*s).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}getBaseTranslation(){let[e,t]=this.parentDimensions,{_borderLineWidth:n}=r,i=n/e,o=n/t;switch(this.rotation){case 90:return[-i,o];case 180:return[i,o];case 270:return[i,-o];default:return[-i,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){let[t,n]=this.pageDimensions,{x:i,y:o,width:s,height:a}=this;if(s*=t,a*=n,i*=t,o*=n,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(t-s,i)),o=Math.max(0,Math.min(n-a,o));break;case 90:i=Math.max(0,Math.min(t-a,i)),o=Math.min(n,Math.max(s,o));break;case 180:i=Math.min(t,Math.max(s,i)),o=Math.min(n,Math.max(a,o));break;case 270:i=Math.min(t,Math.max(a,i)),o=Math.max(0,Math.min(n-s,o));break}this.x=i/=t,this.y=o/=n;let[l,c]=this.getBaseTranslation();i+=l,o+=c;let{style:d}=this.div;d.left=`${(100*i).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#x(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return r.#x(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return r.#x(e,t,360-this.parentRotation)}#w(e){switch(e){case 90:{let[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{let[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){let[n,i]=this.parentDimensions;this.div.style.width=`${(100*e/n).toFixed(2)}%`,this.#o||(this.div.style.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){let{style:e}=this.div,{height:t,width:n}=e,i=n.endsWith("%"),o=!this.#o&&t.endsWith("%");if(i&&o)return;let[s,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(n)/s).toFixed(2)}%`),!this.#o&&!o&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#T(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");let e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(let n of e){let i=document.createElement("div");this.#r.append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",this.#M.bind(this,n),{signal:t}),i.addEventListener("contextmenu",vn,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#r)}#M(e,t){t.preventDefault();let{isMac:n}=Bt.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);let i=this._isDraggable;this._isDraggable=!1;let o=new AbortController,s=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#P.bind(this,e),{passive:!0,capture:!0,signal:s}),window.addEventListener("contextmenu",vn,{signal:s});let a=this.x,l=this.y,c=this.width,d=this.height,u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;let g=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#E(a,l,c,d)};window.addEventListener("pointerup",g,{signal:s}),window.addEventListener("blur",g,{signal:s})}#E(e,t,n,i){let o=this.x,s=this.y,a=this.width,l=this.height;o===e&&s===t&&a===n&&l===i||this.addCommands({cmd:()=>{this.width=a,this.height=l,this.x=o,this.y=s;let[c,d]=this.parentDimensions;this.setDims(c*a,d*l),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=i,this.x=e,this.y=t;let[c,d]=this.parentDimensions;this.setDims(c*n,d*i),this.fixAndSetPosition()},mustExec:!0})}#P(e,t){let[n,i]=this.parentDimensions,o=this.x,s=this.y,a=this.width,l=this.height,c=r.MIN_SIZE/n,d=r.MIN_SIZE/i,u=Z=>Math.round(Z*1e4)/1e4,h=this.#w(this.rotation),g=(Z,ne)=>[h[0]*Z+h[2]*ne,h[1]*Z+h[3]*ne],v=this.#w(360-this.rotation),x=(Z,ne)=>[v[0]*Z+v[2]*ne,v[1]*Z+v[3]*ne],L,E,P=!1,S=!1;switch(e){case"topLeft":P=!0,L=(Z,ne)=>[0,0],E=(Z,ne)=>[Z,ne];break;case"topMiddle":L=(Z,ne)=>[Z/2,0],E=(Z,ne)=>[Z/2,ne];break;case"topRight":P=!0,L=(Z,ne)=>[Z,0],E=(Z,ne)=>[0,ne];break;case"middleRight":S=!0,L=(Z,ne)=>[Z,ne/2],E=(Z,ne)=>[0,ne/2];break;case"bottomRight":P=!0,L=(Z,ne)=>[Z,ne],E=(Z,ne)=>[0,0];break;case"bottomMiddle":L=(Z,ne)=>[Z/2,ne],E=(Z,ne)=>[Z/2,0];break;case"bottomLeft":P=!0,L=(Z,ne)=>[0,ne],E=(Z,ne)=>[Z,0];break;case"middleLeft":S=!0,L=(Z,ne)=>[0,ne/2],E=(Z,ne)=>[Z,ne/2];break}let w=L(a,l),T=E(a,l),V=g(...T),B=u(o+V[0]),W=u(s+V[1]),M=1,q=1,[U,ee]=this.screenToPageTranslation(t.movementX,t.movementY);if([U,ee]=x(U/n,ee/i),P){let Z=Math.hypot(a,l);M=q=Math.max(Math.min(Math.hypot(T[0]-w[0]-U,T[1]-w[1]-ee)/Z,1/a,1/l),c/a,d/l)}else S?M=Math.max(c,Math.min(1,Math.abs(T[0]-w[0]-U)))/a:q=Math.max(d,Math.min(1,Math.abs(T[1]-w[1]-ee)))/l;let ie=u(a*M),re=u(l*q);V=g(...E(ie,re));let ae=B-V[0],he=W-V[1];this.width=ie,this.height=re,this.x=ae,this.y=he,this.setDims(n*ie,i*re),this.fixAndSetPosition()}altTextFinish(){this.#n?.finish()}addEditToolbar(){return G(this,null,function*(){return this._editToolbar||this.#h?this._editToolbar:(this._editToolbar=new Ru(this),this.div.append(this._editToolbar.render()),this.#n&&(yield this._editToolbar.addAltText(this.#n)),this._editToolbar)})}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){let t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}addAltTextButton(){return G(this,null,function*(){this.#n||(B0.initialize(r._l10n),this.#n=new B0(this),this.#e&&(this.#n.data=this.#e,this.#e=null),yield this.addEditToolbar())})}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}setGuessedAltText(e){return G(this,null,function*(){yield this.#n?.setGuessedText(e)})}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#R();let[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);let[n,i]=this.getInitialTranslation();return this.translate(n,i),Ua(this,this.div,["pointerdown"]),this.div}pointerdown(e){let{isMac:t}=Bt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#a=!0,this._isDraggable){this.#I(e);return}this.#A(e)}get isSelected(){return this._uiManager.isSelected(this)}#A(e){let{isMac:t}=Bt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#I(e){let{isSelected:t}=this;this._uiManager.setUpDragSession();let n=new AbortController,i=this._uiManager.combinedSignal(n);if(t){this.div.classList.add("moving"),this.#g=e.clientX,this.#_=e.clientY;let s=a=>{let{clientX:l,clientY:c}=a,[d,u]=this.screenToPageTranslation(l-this.#g,c-this.#_);this.#g=l,this.#_=c,this._uiManager.dragSelectedEditors(d,u)};window.addEventListener("pointermove",s,{passive:!0,capture:!0,signal:i})}let o=()=>{n.abort(),t&&this.div.classList.remove("moving"),this.#a=!1,this._uiManager.endDragSession()||this.#A(e)};window.addEventListener("pointerup",o,{signal:i}),window.addEventListener("blur",o,{signal:i})}moveInDOM(){this.#f&&clearTimeout(this.#f),this.#f=setTimeout(()=>{this.#f=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition()}getRect(e,t,n=this.rotation){let i=this.parentScale,[o,s]=this.pageDimensions,[a,l]=this.pageTranslation,c=e/i,d=t/i,u=this.x*o,h=this.y*s,g=this.width*o,v=this.height*s;switch(n){case 0:return[u+c+a,s-h-d-v+l,u+c+g+a,s-h-d+l];case 90:return[u+d+a,s-h+c+l,u+d+v+a,s-h+c+g+l];case 180:return[u-c-g+a,s-h+d+l,u-c+a,s-h+d+v+l];case 270:return[u-d-v+a,s-h-c-g+l,u-d+a,s-h-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){let[n,i,o,s]=e,a=o-n,l=s-i;switch(this.rotation){case 0:return[n,t-s,a,l];case 90:return[n,t-i,l,a];case 180:return[o,t-i,a,l];case 270:return[o,t-s,l,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#h=!0}disableEditMode(){this.#h=!1}isInEditMode(){return this.#h}shouldGetKeyboardEvents(){return this.#p}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#R(){if(this.#c||!this.div)return;this.#c=new AbortController;let e=this._uiManager.combinedSignal(this.#c);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#R()}rotate(e){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){ft("An editor must be serializable")}static deserialize(e,t,n){return G(this,null,function*(){let i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});i.rotation=e.rotation,i.#e=e.accessibilityData;let[o,s]=i.pageDimensions,[a,l,c,d]=i.getRectInCurrentCoords(e.rect,s);return i.x=a/o,i.y=l/s,i.width=c/o,i.height=d/s,i})}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#c?.abort(),this.#c=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#f&&(clearTimeout(this.#f),this.#f=null),this.#N(),this.removeEditToolbar(),this.#m){for(let e of this.#m.values())clearTimeout(e);this.#m=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#T(),this.#r.classList.remove("hidden"),Ua(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let t=this.#r.children;if(!this.#t){this.#t=Array.from(t);let s=this.#S.bind(this),a=this.#b.bind(this),l=this._uiManager._signal;for(let c of this.#t){let d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",s,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",this.#O.bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",r._l10nResizer[d])}}let n=this.#t[0],i=0;for(let s of t){if(s===n)break;i++}let o=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(o!==i){if(o<i)for(let a=0;a<i-o;a++)this.#r.append(this.#r.firstChild);else if(o>i)for(let a=0;a<o-i;a++)this.#r.firstChild.before(this.#r.lastChild);let s=0;for(let a of t){let c=this.#t[s++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",r._l10nResizer[c])}}this.#k(0),this.#p=!0,this.#r.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#S(e){r._resizerKeyboardManager.exec(this,e)}#b(e){this.#p&&e.relatedTarget?.parentNode!==this.#r&&this.#N()}#O(e){this.#d=this.#p?e:""}#k(e){if(this.#t)for(let t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#p&&this.#P(this.#d,{movementX:e,movementY:t})}#N(){if(this.#p=!1,this.#k(-1),this.#l){let{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=this.#l;this.#E(e,t,n,i),this.#l=null}}_stopResizingWithKeyboard(){this.#N(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#s}set isEditing(e){this.#s=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#o=!0;let n=e/t,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#m||=new Map;let{action:n}=e,i=this.#m.get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#m.delete(n),this.#m.size===0&&(this.#m=null)},r._telemetryTimeout),this.#m.set(n,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){let n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){let{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}},ju=class extends st{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}},j0=3285377520,_n=4294901760,Fn=65535,za=class{constructor(e){this.h1=e?e&4294967295:j0,this.h2=e?e&4294967295:j0}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let x=0,L=e.length;x<L;x++){let E=e.charCodeAt(x);E<=255?t[n++]=E:(t[n++]=E>>>8,t[n++]=E&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");let i=n>>2,o=n-i*4,s=new Uint32Array(t.buffer,0,i),a=0,l=0,c=this.h1,d=this.h2,u=3432918353,h=461845907,g=u&Fn,v=h&Fn;for(let x=0;x<i;x++)x&1?(a=s[x],a=a*u&_n|a*g&Fn,a=a<<15|a>>>17,a=a*h&_n|a*v&Fn,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=s[x],l=l*u&_n|l*g&Fn,l=l<<15|l>>>17,l=l*h&_n|l*v&Fn,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,o){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*u&_n|a*g&Fn,a=a<<15|a>>>17,a=a*h&_n|a*v&Fn,i&1?c^=a:d^=a}this.h1=c,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&_n|e*36045&Fn,t=t*4283543511&_n|((t<<16|e>>>16)*2950163797&_n)>>>16,e^=t>>>1,e=e*444984403&_n|e*60499&Fn,t=t*3301882366&_n|((t<<16|e>>>16)*3120437893&_n)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}},Vu=Object.freeze({map:null,hash:"",transfer:void 0}),Lo=class{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){let n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let t of this.#n.values())if(t instanceof st)return;this.onAnnotationEditor(null)}}setValue(e,t){let n=this.#n.get(e),i=!1;if(n!==void 0)for(let[o,s]of Object.entries(t))n[o]!==s&&(i=!0,n[o]=s);else i=!0,this.#n.set(e,t);i&&this.#i(),t instanceof st&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?Kh(this.#n):null}setAll(e){for(let[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return this.#n.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new qa(this)}get serializable(){if(this.#n.size===0)return Vu;let e=new Map,t=new za,n=[],i=Object.create(null),o=!1;for(let[s,a]of this.#n){let l=a instanceof st?a.serialize(!1,i):a;l&&(e.set(s,l),t.update(`${s}:${JSON.stringify(l)}`),o||=!!l.bitmap)}if(o)for(let s of e.values())s.bitmap&&n.push(s.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Vu}get editorStats(){let e=null,t=new Map;for(let n of this.#n.values()){if(!(n instanceof st))continue;let i=n.telemetryFinalData;if(!i)continue;let{type:o}=i;t.has(o)||t.set(o,Object.getPrototypeOf(n).constructor),e||=Object.create(null);let s=e[o]||=new Map;for(let[a,l]of Object.entries(i)){if(a==="type")continue;let c=s.get(a);c||(c=new Map,s.set(a,c));let d=c.get(l)??0;c.set(l,d+1)}}for(let[n,i]of t)e[n]=i.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;let e=[];for(let t of this.#n.values())!(t instanceof st)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}},qa=class extends Lo{#e;constructor(e){super();let{map:t,hash:n,transfer:i}=e.serializable,o=structuredClone(t,i?{transfer:i}:null);this.#e={map:o,hash:n,transfer:i}}get print(){ft("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Ke(this,"modifiedIds",{ids:new Set,hash:""})}},Uu=class{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(let e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(n){return G(this,arguments,function*({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(Lt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:i,src:o,style:s}=e,a=new FontFace(i,o,s);this.addNativeFontFace(a);try{yield a.load(),this.#e.add(i),t?.(e)}catch{We(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}ft("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(e){return G(this,null,function*(){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){yield this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){let n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{yield n.loaded}catch(i){throw We(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}let t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;yield new Promise(n=>{let i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}})}get isFontLoadingAPISupported(){let e=!!this._document?.fonts;return Ke(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Ht||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Ke(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Lt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){let o=n.shift();setTimeout(o.callback,0)}}let{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){let e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ke(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(w,T){return w.charCodeAt(T)<<24|w.charCodeAt(T+1)<<16|w.charCodeAt(T+2)<<8|w.charCodeAt(T+3)&255}function i(w,T,V,B){let W=w.substring(0,T),M=w.substring(T+V);return W+B+M}let o,s,a=this._document.createElement("canvas");a.width=1,a.height=1;let l=a.getContext("2d"),c=0;function d(w,T){if(++c>30){We("Load test font never loaded."),T();return}if(l.font="30px "+w,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(d.bind(null,w,T))}let u=`lt${Date.now()}${this.loadTestFontId++}`,h=this._loadTestFont;h=i(h,976,u.length,u);let v=16,x=1482184792,L=n(h,v);for(o=0,s=u.length-3;o<s;o+=4)L=L-x+n(u,o)|0;o<u.length&&(L=L-x+n(u+"XXX",o)|0),h=i(h,v,4,xP(L));let E=`url(data:font/opentype;base64,${btoa(h)});`,P=`@font-face {font-family:"${u}";src:${E}}`;this.insertRule(P);let S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(let w of[e.loadedName,u]){let T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=w,S.append(T)}this._document.body.append(S),d(u,()=>{S.remove(),t.complete()})}},zu=class{constructor(e,{disableFontFace:t=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(let i in e)this[i]=e[i];this.disableFontFace=t===!0,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{let t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let e=`url(data:${this.mimetype};base64,${MP(this.data)});`,t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let n;try{n=e.get(this.loadedName+"_path_"+t)}catch(o){We(`getPathGenerator - ignoring character: "${o}".`)}if(!Array.isArray(n)||n.length===0)return this.compiledGlyphs[t]=function(o,s){};let i=[];for(let o=0,s=n.length;o<s;)switch(n[o++]){case Qn.BEZIER_CURVE_TO:{let[a,l,c,d,u,h]=n.slice(o,o+6);i.push(g=>g.bezierCurveTo(a,l,c,d,u,h)),o+=6}break;case Qn.MOVE_TO:{let[a,l]=n.slice(o,o+2);i.push(c=>c.moveTo(a,l)),o+=2}break;case Qn.LINE_TO:{let[a,l]=n.slice(o,o+2);i.push(c=>c.lineTo(a,l)),o+=2}break;case Qn.QUADRATIC_CURVE_TO:{let[a,l,c,d]=n.slice(o,o+4);i.push(u=>u.quadraticCurveTo(a,l,c,d)),o+=4}break;case Qn.RESTORE:i.push(a=>a.restore());break;case Qn.SAVE:i.push(a=>a.save());break;case Qn.SCALE:Lt(i.length===2,"Scale command is only valid at the third position.");break;case Qn.TRANSFORM:{let[a,l,c,d,u,h]=n.slice(o,o+6);i.push(g=>g.transform(a,l,c,d,u,h)),o+=6}break;case Qn.TRANSLATE:{let[a,l]=n.slice(o,o+2);i.push(c=>c.translate(a,l)),o+=2}break}return this.compiledGlyphs[t]=function(s,a){i[0](s),i[1](s),s.scale(a,-a);for(let l=2,c=i.length;l<c;l++)i[l](s)}}},Ha=class{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");let n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){ft("Abstract method `_createCanvas` called.")}},qu=class extends Ha{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){let n=this._document.createElement("canvas");return n.width=e,n.height=t,n}},Wa=class{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}fetch(t){return G(this,arguments,function*({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");let n=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(n).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${n}`)})})}_fetch(e){return G(this,null,function*(){ft("Abstract method `_fetch` called.")})}},Ga=class extends Wa{_fetch(e){return G(this,null,function*(){let t=yield xl(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):yl(t)})}},$a=class{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,o){return"none"}destroy(e=!1){}},Hu=class extends $a{#e;#t;#n;#i;#o;#r;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#i=e,this.#o=t}get#c(){return this.#t||=new Map}get#d(){return this.#r||=new Map}get#a(){if(!this.#n){let e=this.#o.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;let n=this.#o.createElementNS(Zn,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#o.createElementNS(Zn,"defs"),e.append(n),n.append(this.#n),this.#o.body.append(e)}return this.#n}#u(e){if(e.length===1){let l=e[0],c=new Array(256);for(let u=0;u<256;u++)c[u]=l[u]/255;let d=c.join(",");return[d,d,d]}let[t,n,i]=e,o=new Array(256),s=new Array(256),a=new Array(256);for(let l=0;l<256;l++)o[l]=t[l]/255,s[l]=n[l]/255,a[l]=i[l]/255;return[o.join(","),s.join(","),a.join(",")]}#s(e){if(this.#e===void 0){this.#e="";let t=this.#o.URL;t!==this.#o.baseURI&&(wl(t)?We('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#c.get(e);if(t)return t;let[n,i,o]=this.#u(e),s=e.length===1?n:`${n}${i}${o}`;if(t=this.#c.get(s),t)return this.#c.set(e,t),t;let a=`g_${this.#i}_transfer_map_${this.#l++}`,l=this.#s(a);this.#c.set(e,l),this.#c.set(s,l);let c=this.#f(a);return this.#_(n,i,o,c),l}addHCMFilter(e,t){let n=`${e}-${t}`,i="base",o=this.#d.get(i);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#d.set(i,o)),!e||!t))return o.url;let s=this.#v(e);e=Me.makeHexColor(...s);let a=this.#v(t);if(t=Me.makeHexColor(...a),this.#a.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return o.url;let l=new Array(256);for(let g=0;g<=255;g++){let v=g/255;l[g]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}let c=l.join(","),d=`g_${this.#i}_hcm_filter`,u=o.filter=this.#f(d);this.#_(c,c,c,u),this.#p(u);let h=(g,v)=>{let x=s[g]/255,L=a[g]/255,E=new Array(v+1);for(let P=0;P<=v;P++)E[P]=x+P/v*(L-x);return E.join(",")};return this.#_(h(0,5),h(1,5),h(2,5),u),o.url=this.#s(d),o.url}addAlphaFilter(e){let t=this.#c.get(e);if(t)return t;let[n]=this.#u([e]),i=`alpha_${n}`;if(t=this.#c.get(i),t)return this.#c.set(e,t),t;let o=`g_${this.#i}_alpha_map_${this.#l++}`,s=this.#s(o);this.#c.set(e,s),this.#c.set(i,s);let a=this.#f(o);return this.#m(n,a),s}addLuminosityFilter(e){let t=this.#c.get(e||"luminosity");if(t)return t;let n,i;if(e?([n]=this.#u([e]),i=`luminosity_${n}`):i="luminosity",t=this.#c.get(i),t)return this.#c.set(e,t),t;let o=`g_${this.#i}_luminosity_map_${this.#l++}`,s=this.#s(o);this.#c.set(e,s),this.#c.set(i,s);let a=this.#f(o);return this.#h(a),e&&this.#m(n,a),s}addHighlightHCMFilter(e,t,n,i,o){let s=`${t}-${n}-${i}-${o}`,a=this.#d.get(e);if(a?.key===s||(a?(a.filter?.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},this.#d.set(e,a)),!t||!n))return a.url;let[l,c]=[t,n].map(this.#v.bind(this)),d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[h,g]=[i,o].map(this.#v.bind(this));u<d&&([d,u,h,g]=[u,d,g,h]),this.#a.style.color="";let v=(E,P,S)=>{let w=new Array(256),T=(u-d)/S,V=E/255,B=(P-E)/(255*S),W=0;for(let M=0;M<=S;M++){let q=Math.round(d+M*T),U=V+M*B;for(let ee=W;ee<=q;ee++)w[ee]=U;W=q+1}for(let M=W;M<256;M++)w[M]=w[W-1];return w.join(",")},x=`g_${this.#i}_hcm_${e}_filter`,L=a.filter=this.#f(x);return this.#p(L),this.#_(v(h[0],g[0],5),v(h[1],g[1],5),v(h[2],g[2],5),L),a.url=this.#s(x),a.url}destroy(e=!1){e&&this.#d.size!==0||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#t&&(this.#t.clear(),this.#t=null),this.#l=0)}#h(e){let t=this.#o.createElementNS(Zn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){let t=this.#o.createElementNS(Zn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#f(e){let t=this.#o.createElementNS(Zn,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#a.append(t),t}#g(e,t,n){let i=this.#o.createElementNS(Zn,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}#_(e,t,n,i){let o=this.#o.createElementNS(Zn,"feComponentTransfer");i.append(o),this.#g(o,"feFuncR",e),this.#g(o,"feFuncG",t),this.#g(o,"feFuncB",n)}#m(e,t){let n=this.#o.createElementNS(Zn,"feComponentTransfer");t.append(n),this.#g(n,"feFuncA",e)}#v(e){return this.#a.style.color=e,Jh(getComputedStyle(this.#a).getPropertyValue("color"))}},Xa=class{constructor({baseUrl:e=null}){this.baseUrl=e}fetch(t){return G(this,arguments,function*({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");let n=`${this.baseUrl}${e}`;return this._fetch(n).catch(i=>{throw new Error(`Unable to load font data at: ${n}`)})})}_fetch(e){return G(this,null,function*(){ft("Abstract method `_fetch` called.")})}},Ka=class extends Xa{_fetch(e){return G(this,null,function*(){let t=yield xl(e,"arraybuffer");return new Uint8Array(t)})}};Ht&&(La=Promise.withResolvers(),Da=null,G(void 0,null,function*(){let e=yield import("./chunk-L2HEV66R.js"),t=yield import("./chunk-BMBYILCS.js"),n=yield import("./chunk-ALIQTIYY.js"),i=yield import("./chunk-NYZOWURK.js"),o,s;return new Map(Object.entries({fs:e,http:t,https:n,url:i,canvas:o,path2d:s}))}).then(e=>{Da=e,La.resolve()},e=>{We(`loadPackages: ${e}`),Da=new Map,La.resolve()}));var La,Da,Nn=class{static get promise(){return La.promise}static get(e){return Da?.get(e)}};function Z0(r){return G(this,null,function*(){let t=yield Nn.get("fs").promises.readFile(r);return new Uint8Array(t)})}var Wu=class extends $a{},Gu=class extends Ha{_createCanvas(e,t){return Nn.get("canvas").createCanvas(e,t)}},$u=class extends Wa{_fetch(e){return G(this,null,function*(){return Z0(e)})}},Xu=class extends Xa{_fetch(e){return G(this,null,function*(){return Z0(e)})}},Kt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ku(r,e){if(!e)return;let t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),r.clip(i)}var Do=class{getPattern(){ft("Abstract method `getPattern` called.")}},Yu=class extends Do{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let o;if(i===Kt.STROKE||i===Kt.FILL){let s=t.current.getClippedPathBoundingBox(i,vt(e))||[0,0,0,0],a=Math.ceil(s[2]-s[0])||1,l=Math.ceil(s[3]-s[1])||1,c=t.cachedCanvases.getCanvas("pattern",a,l),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-s[0],-s[1]),n=Me.transform(n,[1,0,0,1,s[0],s[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),Ku(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),o=e.createPattern(c.canvas,"no-repeat");let u=new DOMMatrix(n);o.setTransform(u)}else Ku(e,this._bbox),o=this._createGradient(e);return o}};function Pu(r,e,t,n,i,o,s,a){let l=e.coords,c=e.colors,d=r.data,u=r.width*4,h;l[t+1]>l[n+1]&&(h=t,t=n,n=h,h=o,o=s,s=h),l[n+1]>l[i+1]&&(h=n,n=i,i=h,h=s,s=a,a=h),l[t+1]>l[n+1]&&(h=t,t=n,n=h,h=o,o=s,s=h);let g=(l[t]+e.offsetX)*e.scaleX,v=(l[t+1]+e.offsetY)*e.scaleY,x=(l[n]+e.offsetX)*e.scaleX,L=(l[n+1]+e.offsetY)*e.scaleY,E=(l[i]+e.offsetX)*e.scaleX,P=(l[i+1]+e.offsetY)*e.scaleY;if(v>=P)return;let S=c[o],w=c[o+1],T=c[o+2],V=c[s],B=c[s+1],W=c[s+2],M=c[a],q=c[a+1],U=c[a+2],ee=Math.round(v),ie=Math.round(P),re,ae,he,Z,ne,Oe,Y,K;for(let te=ee;te<=ie;te++){if(te<L){let Ie=te<v?0:(v-te)/(v-L);re=g-(g-x)*Ie,ae=S-(S-V)*Ie,he=w-(w-B)*Ie,Z=T-(T-W)*Ie}else{let Ie;te>P?Ie=1:L===P?Ie=0:Ie=(L-te)/(L-P),re=x-(x-E)*Ie,ae=V-(V-M)*Ie,he=B-(B-q)*Ie,Z=W-(W-U)*Ie}let xe;te<v?xe=0:te>P?xe=1:xe=(v-te)/(v-P),ne=g-(g-E)*xe,Oe=S-(S-M)*xe,Y=w-(w-q)*xe,K=T-(T-U)*xe;let Ce=Math.round(Math.min(re,ne)),Ne=Math.round(Math.max(re,ne)),Re=u*te+Ce*4;for(let Ie=Ce;Ie<=Ne;Ie++)xe=(re-Ie)/(re-ne),xe<0?xe=0:xe>1&&(xe=1),d[Re++]=ae-(ae-Oe)*xe|0,d[Re++]=he-(he-Y)*xe|0,d[Re++]=Z-(Z-K)*xe|0,d[Re++]=255}}function RP(r,e,t){let n=e.coords,i=e.colors,o,s;switch(e.type){case"lattice":let a=e.verticesPerRow,l=Math.floor(n.length/a)-1,c=a-1;for(o=0;o<l;o++){let d=o*a;for(let u=0;u<c;u++,d++)Pu(r,t,n[d],n[d+1],n[d+a],i[d],i[d+1],i[d+a]),Pu(r,t,n[d+a+1],n[d+1],n[d+a],i[d+a+1],i[d+1],i[d+a])}break;case"triangles":for(o=0,s=n.length;o<s;o+=3)Pu(r,t,n[o],n[o+1],n[o+2],i[o],i[o+1],i[o+2]);break;default:throw new Error("illegal figure")}}var Qu=class extends Do{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){let a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),g=c/u,v=d/h,x={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/g,scaleY:1/v},L=u+2*2,E=h+2*2,P=n.getCanvas("mesh",L,E),S=P.context,w=S.createImageData(u,h);if(t){let V=w.data;for(let B=0,W=V.length;B<W;B+=4)V[B]=t[0],V[B+1]=t[1],V[B+2]=t[2],V[B+3]=255}for(let V of this._figures)RP(w,V,x);return S.putImageData(w,2,2),{canvas:P.canvas,offsetX:a-2*g,offsetY:l-2*v,scaleX:g,scaleY:v}}getPattern(e,t,n,i){Ku(e,this._bbox);let o;if(i===Kt.SHADING)o=Me.singularValueDecompose2dScale(vt(e));else if(o=Me.singularValueDecompose2dScale(t.baseTransform),this.matrix){let a=Me.singularValueDecompose2dScale(this.matrix);o=[o[0]*a[0],o[1]*a[1]]}let s=this._createMeshCanvas(o,i===Kt.SHADING?null:this._background,t.cachedCanvases);return i!==Kt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(s.offsetX,s.offsetY),e.scale(s.scaleX,s.scaleY),e.createPattern(s.canvas,"no-repeat")}},Ju=class extends Do{getPattern(){return"hotpink"}};function LP(r){switch(r[0]){case"RadialAxial":return new Yu(r);case"Mesh":return new Qu(r);case"Dummy":return new Ju}throw new Error(`Unknown IR type: ${r[0]}`)}var V0={COLORED:1,UNCOLORED:2},DP=(()=>{class r{static MAX_PATTERN_SIZE=3e3;constructor(t,n,i,o,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=n,this.ctx=i,this.canvasGraphicsFactory=o,this.baseTransform=s}createPatternCanvas(t){let{bbox:n,operatorList:i,paintType:o,tilingType:s,color:a,canvasGraphicsFactory:l}=this,{xstep:c,ystep:d}=this;c=Math.abs(c),d=Math.abs(d),bl("TilingType: "+s);let u=n[0],h=n[1],g=n[2],v=n[3],x=g-u,L=v-h,E=Me.singularValueDecompose2dScale(this.matrix),P=Me.singularValueDecompose2dScale(this.baseTransform),S=E[0]*P[0],w=E[1]*P[1],T=x,V=L,B=!1,W=!1,M=Math.ceil(c*S),q=Math.ceil(d*w),U=Math.ceil(x*S),ee=Math.ceil(L*w);M>=U?T=c:B=!0,q>=ee?V=d:W=!0;let ie=this.getSizeAndScale(T,this.ctx.canvas.width,S),re=this.getSizeAndScale(V,this.ctx.canvas.height,w),ae=t.cachedCanvases.getCanvas("pattern",ie.size,re.size),he=ae.context,Z=l.createCanvasGraphics(he);if(Z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Z,o,a),he.translate(-ie.scale*u,-re.scale*h),Z.transform(ie.scale,0,0,re.scale,0,0),he.save(),this.clipBbox(Z,u,h,g,v),Z.baseTransform=vt(Z.ctx),Z.executeOperatorList(i),Z.endDrawing(),he.restore(),B||W){let ne=ae.canvas;B&&(T=c),W&&(V=d);let Oe=this.getSizeAndScale(T,this.ctx.canvas.width,S),Y=this.getSizeAndScale(V,this.ctx.canvas.height,w),K=Oe.size,te=Y.size,xe=t.cachedCanvases.getCanvas("pattern-workaround",K,te),Ce=xe.context,Ne=B?Math.floor(x/c):0,Re=W?Math.floor(L/d):0;for(let Ie=0;Ie<=Ne;Ie++)for(let Qe=0;Qe<=Re;Qe++)Ce.drawImage(ne,K*Ie,te*Qe,K,te,0,0,K,te);return{canvas:xe.canvas,scaleX:Oe.scale,scaleY:Y.scale,offsetX:u,offsetY:h}}return{canvas:ae.canvas,scaleX:ie.scale,scaleY:re.scale,offsetX:u,offsetY:h}}getSizeAndScale(t,n,i){let o=Math.max(r.MAX_PATTERN_SIZE,n),s=Math.ceil(t*i);return s>=o?s=o:i=s/t,{scale:i,size:s}}clipBbox(t,n,i,o,s){let a=o-n,l=s-i;t.ctx.rect(n,i,a,l),t.current.updateRectMinMax(vt(t.ctx),[n,i,o,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,n,i){let o=t.ctx,s=t.current;switch(n){case V0.COLORED:let a=this.ctx;o.fillStyle=a.fillStyle,o.strokeStyle=a.strokeStyle,s.fillColor=a.fillStyle,s.strokeColor=a.strokeStyle;break;case V0.UNCOLORED:let l=Me.makeHexColor(i[0],i[1],i[2]);o.fillStyle=l,o.strokeStyle=l,s.fillColor=l,s.strokeColor=l;break;default:throw new ku(`Unsupported paint type: ${n}`)}}getPattern(t,n,i,o){let s=i;o!==Kt.SHADING&&(s=Me.transform(s,n.baseTransform),this.matrix&&(s=Me.transform(s,this.matrix)));let a=this.createPatternCanvas(n),l=new DOMMatrix(s);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);let c=t.createPattern(a.canvas,"repeat");return c.setTransform(l),c}}return r})();function FP({src:r,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:o=4294967295,inverseDecode:s=!1}){let a=Bt.isLittleEndian?4278190080:255,[l,c]=s?[o,a]:[a,o],d=n>>3,u=n&7,h=r.length;t=new Uint32Array(t.buffer);let g=0;for(let v=0;v<i;v++){for(let L=e+d;e<L;e++){let E=e<h?r[e]:255;t[g++]=E&128?c:l,t[g++]=E&64?c:l,t[g++]=E&32?c:l,t[g++]=E&16?c:l,t[g++]=E&8?c:l,t[g++]=E&4?c:l,t[g++]=E&2?c:l,t[g++]=E&1?c:l}if(u===0)continue;let x=e<h?r[e++]:255;for(let L=0;L<u;L++)t[g++]=x&1<<7-L?c:l}return{srcPos:e,destPos:g}}var U0=16,z0=100,NP=15,q0=10,H0=1e3,nn=16;function BP(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(n,i){e.translate(n,i),this.__originalTranslate(n,i)},r.scale=function(n,i){e.scale(n,i),this.__originalScale(n,i)},r.transform=function(n,i,o,s,a,l){e.transform(n,i,o,s,a,l),this.__originalTransform(n,i,o,s,a,l)},r.setTransform=function(n,i,o,s,a,l){e.setTransform(n,i,o,s,a,l),this.__originalSetTransform(n,i,o,s,a,l)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(n){e.rotate(n),this.__originalRotate(n)},r.clip=function(n){e.clip(n),this.__originalClip(n)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,i,o,s,a){e.bezierCurveTo(t,n,i,o,s,a),this.__originalBezierCurveTo(t,n,i,o,s,a)},r.rect=function(t,n,i,o){e.rect(t,n,i,o),this.__originalRect(t,n,i,o)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}var Zu=class{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(let e in this.cache){let t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}};function Ma(r,e,t,n,i,o,s,a,l,c){let[d,u,h,g,v,x]=vt(r);if(u===0&&h===0){let P=s*d+v,S=Math.round(P),w=a*g+x,T=Math.round(w),V=(s+l)*d+v,B=Math.abs(Math.round(V)-S)||1,W=(a+c)*g+x,M=Math.abs(Math.round(W)-T)||1;return r.setTransform(Math.sign(d),0,0,Math.sign(g),S,T),r.drawImage(e,t,n,i,o,0,0,B,M),r.setTransform(d,u,h,g,v,x),[B,M]}if(d===0&&g===0){let P=a*h+v,S=Math.round(P),w=s*u+x,T=Math.round(w),V=(a+c)*h+v,B=Math.abs(Math.round(V)-S)||1,W=(s+l)*u+x,M=Math.abs(Math.round(W)-T)||1;return r.setTransform(0,Math.sign(u),Math.sign(h),0,S,T),r.drawImage(e,t,n,i,o,0,0,M,B),r.setTransform(d,u,h,g,v,x),[M,B]}r.drawImage(e,t,n,i,o,s,a,l,c);let L=Math.hypot(d,u),E=Math.hypot(h,g);return[L*l,E*c]}function jP(r){let{width:e,height:t}=r;if(e>H0||t>H0)return null;let n=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=e+1,s=new Uint8Array(o*(t+1)),a,l,c,d=e+7&-8,u=new Uint8Array(d*t),h=0;for(let E of r.data){let P=128;for(;P>0;)u[h++]=E&P?0:255,P>>=1}let g=0;for(h=0,u[h]!==0&&(s[0]=1,++g),l=1;l<e;l++)u[h]!==u[h+1]&&(s[l]=u[h]?2:1,++g),h++;for(u[h]!==0&&(s[l]=2,++g),a=1;a<t;a++){h=a*d,c=a*o,u[h-d]!==u[h]&&(s[c]=u[h]?1:8,++g);let E=(u[h]?4:0)+(u[h-d]?8:0);for(l=1;l<e;l++)E=(E>>2)+(u[h+1]?4:0)+(u[h-d+1]?8:0),i[E]&&(s[c+l]=i[E],++g),h++;if(u[h-d]!==u[h]&&(s[c+l]=u[h]?2:4,++g),g>n)return null}for(h=d*(t-1),c=a*o,u[h]!==0&&(s[c]=8,++g),l=1;l<e;l++)u[h]!==u[h+1]&&(s[c+l]=u[h]?4:8,++g),h++;if(u[h]!==0&&(s[c+l]=4,++g),g>n)return null;let v=new Int32Array([0,o,-1,0,-o,0,0,0,1]),x=new Path2D;for(a=0;g&&a<=t;a++){let E=a*o,P=E+e;for(;E<P&&!s[E];)E++;if(E===P)continue;x.moveTo(E%o,a);let S=E,w=s[E];do{let T=v[w];do E+=T;while(!s[E]);let V=s[E];V!==5&&V!==10?(w=V,s[E]=0):(w=V&51*w>>4,s[E]&=w>>2|w<<2),x.lineTo(E%o,E/o|0),s[E]||--g}while(S!==E);--a}return u=null,s=null,function(E){E.save(),E.scale(1/e,-1/t),E.translate(0,-t),E.fill(x),E.beginPath(),E.restore()}}var Ya=class{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Q0,this.textMatrixScale=1,this.fontMatrix=Iu,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=qt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){let e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=Me.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){let n=Me.applyTransform(t,e),i=Me.applyTransform(t.slice(2),e),o=Me.applyTransform([t[0],t[3]],e),s=Me.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],i[0],o[0],s[0]),this.minY=Math.min(this.minY,n[1],i[1],o[1],s[1]),this.maxX=Math.max(this.maxX,n[0],i[0],o[0],s[0]),this.maxY=Math.max(this.maxY,n[1],i[1],o[1],s[1])}updateScalingPathMinMax(e,t){Me.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,i,o,s,a,l,c,d){let u=Me.bezierBoundingBox(t,n,i,o,s,a,l,c,d);d||this.updateRectMinMax(e,u)}getPathBoundingBox(e=Kt.FILL,t=null){let n=[this.minX,this.minY,this.maxX,this.maxY];if(e===Kt.STROKE){t||ft("Stroke bounding box must include transform.");let i=Me.singularValueDecompose2dScale(t),o=i[0]*this.lineWidth/2,s=i[1]*this.lineWidth/2;n[0]-=o,n[1]-=s,n[2]+=o,n[3]+=s}return n}updateClipFromPath(){let e=Me.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Kt.FILL,t=null){return Me.intersect(this.clipBox,this.getPathBoundingBox(e,t))}};function W0(r,e){if(typeof ImageData<"u"&&e instanceof ImageData){r.putImageData(e,0,0);return}let t=e.height,n=e.width,i=t%nn,o=(t-i)/nn,s=i===0?o:o+1,a=r.createImageData(n,nn),l=0,c,d=e.data,u=a.data,h,g,v,x;if(e.kind===Ra.GRAYSCALE_1BPP){let L=d.byteLength,E=new Uint32Array(u.buffer,0,u.byteLength>>2),P=E.length,S=n+7>>3,w=4294967295,T=Bt.isLittleEndian?4278190080:255;for(h=0;h<s;h++){for(v=h<o?nn:i,c=0,g=0;g<v;g++){let V=L-l,B=0,W=V>S?n:V*8-7,M=W&-8,q=0,U=0;for(;B<M;B+=8)U=d[l++],E[c++]=U&128?w:T,E[c++]=U&64?w:T,E[c++]=U&32?w:T,E[c++]=U&16?w:T,E[c++]=U&8?w:T,E[c++]=U&4?w:T,E[c++]=U&2?w:T,E[c++]=U&1?w:T;for(;B<W;B++)q===0&&(U=d[l++],q=128),E[c++]=U&q?w:T,q>>=1}for(;c<P;)E[c++]=0;r.putImageData(a,0,h*nn)}}else if(e.kind===Ra.RGBA_32BPP){for(g=0,x=n*nn*4,h=0;h<o;h++)u.set(d.subarray(l,l+x)),l+=x,r.putImageData(a,0,g),g+=nn;h<s&&(x=n*i*4,u.set(d.subarray(l,l+x)),r.putImageData(a,0,g))}else if(e.kind===Ra.RGB_24BPP)for(v=nn,x=n*v,h=0;h<s;h++){for(h>=o&&(v=i,x=n*v),c=0,g=x;g--;)u[c++]=d[l++],u[c++]=d[l++],u[c++]=d[l++],u[c++]=255;r.putImageData(a,0,h*nn)}else throw new Error(`bad image kind: ${e.kind}`)}function G0(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}let t=e.height,n=e.width,i=t%nn,o=(t-i)/nn,s=i===0?o:o+1,a=r.createImageData(n,nn),l=0,c=e.data,d=a.data;for(let u=0;u<s;u++){let h=u<o?nn:i;({srcPos:l}=FP({src:c,srcPos:l,dest:d,width:n,height:h,nonBlackColor:0})),r.putImageData(a,0,u*nn)}}function Eo(r,e){let t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function Pa(r){if(r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0),!Ht){let{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}}function $0(r,e){if(e)return!0;let t=Me.singularValueDecompose2dScale(r);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);let n=Math.fround((globalThis.devicePixelRatio||1)*Ei.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}var VP=["butt","round","square"],UP=["miter","round","bevel"],zP={},X0={},Ir=class r{constructor(e,t,n,i,o,{optionalContentConfig:s,markedContentStack:a=null},l,c){this.ctx=e,this.current=new Ya(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=s,this.cachedCanvases=new Zu(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){let o=this.ctx.canvas.width,s=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,o,s),this.ctx.fillStyle=a,n){let l=this.cachedCanvases.getCanvas("transparent",o,s);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...vt(this.compositeCtx))}this.ctx.save(),Pa(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=vt(this.ctx)}executeOperatorList(e,t,n,i){let o=e.argsArray,s=e.fnArray,a=t||0,l=o.length;if(l===a)return a;let c=l-a>q0&&typeof n=="function",d=c?Date.now()+NP:0,u=0,h=this.commonObjs,g=this.objs,v;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,n),a;if(v=s[a],v!==Sn.dependency)this[v].apply(this,o[a]);else for(let x of o[a]){let L=x.startsWith("g_")?h:g;if(!L.has(x))return L.get(x,n),a}if(a++,a===l)return a;if(c&&++u>q0){if(Date.now()>d)return n(),a;u=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let e of this._cachedBitmapsMap.values()){for(let t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){let e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){let t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){let n=e.width??e.displayWidth,i=e.height??e.displayHeight,o=Math.max(Math.hypot(t[0],t[1]),1),s=Math.max(Math.hypot(t[2],t[3]),1),a=n,l=i,c="prescale1",d,u;for(;o>2&&a>1||s>2&&l>1;){let h=a,g=l;o>2&&a>1&&(h=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),o/=a/h),s>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,s/=l/g),d=this.cachedCanvases.getCanvas(c,h,g),u=d.context,u.clearRect(0,0,h,g),u.drawImage(e,0,0,a,l,0,0,h,g),e=d.canvas,a=h,l=g,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){let t=this.ctx,{width:n,height:i}=e,o=this.current.fillColor,s=this.current.patternFill,a=vt(t),l,c,d,u;if((e.bitmap||e.data)&&e.count>1){let W=e.bitmap||e.data.buffer;c=JSON.stringify(s?a:[a.slice(0,4),o]),l=this._cachedBitmapsMap.get(W),l||(l=new Map,this._cachedBitmapsMap.set(W,l));let M=l.get(c);if(M&&!s){let q=Math.round(Math.min(a[0],a[2])+a[4]),U=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:M,offsetX:q,offsetY:U}}d=M}d||(u=this.cachedCanvases.getCanvas("maskCanvas",n,i),G0(u.context,e));let h=Me.transform(a,[1/n,0,0,-1/i,0,0]);h=Me.transform(h,[1,0,0,1,0,-i]);let[g,v,x,L]=Me.getAxialAlignedBoundingBox([0,0,n,i],h),E=Math.round(x-g)||1,P=Math.round(L-v)||1,S=this.cachedCanvases.getCanvas("fillCanvas",E,P),w=S.context,T=g,V=v;w.translate(-T,-V),w.transform(...h),d||(d=this._scaleImage(u.canvas,Jn(w)),d=d.img,l&&s&&l.set(c,d)),w.imageSmoothingEnabled=$0(vt(w),e.interpolate),Ma(w,d,0,0,d.width,d.height,0,0,n,i),w.globalCompositeOperation="source-in";let B=Me.transform(Jn(w),[1,0,0,1,-T,-V]);return w.fillStyle=s?o.getPattern(t,this,B,Kt.FILL):o,w.fillRect(0,0,n,i),l&&!s&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,S.canvas)),{canvas:S.canvas,offsetX:Math.round(T),offsetY:Math.round(V)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=VP[e]}setLineJoin(e){this.ctx.lineJoin=UP[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){let n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;let o=this.ctx;o.setTransform(...vt(this.suspendedCtx)),Eo(this.suspendedCtx,o),BP(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Eo(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){let o=i[0],s=i[1],a=i[2]-o,l=i[3]-s;a===0||l===0||(this.genericComposeSMask(t.context,n,a,l,t.subtype,t.backdrop,t.transferMap,o,s,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,o,s,a,l,c,d,u){let h=e.canvas,g=l-d,v=c-u;if(s){let L=Me.makeHexColor(...s);if(g<0||v<0||g+n>h.width||v+i>h.height){let E=this.cachedCanvases.getCanvas("maskExtension",n,i),P=E.context;P.drawImage(h,-g,-v),P.globalCompositeOperation="destination-atop",P.fillStyle=L,P.fillRect(0,0,n,i),P.globalCompositeOperation="source-over",h=E.canvas,g=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);let E=new Path2D;E.rect(g,v,n,i),e.clip(E),e.globalCompositeOperation="destination-atop",e.fillStyle=L,e.fillRect(g,v,n,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));let x=new Path2D;x.rect(l,c,n,i),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(h,g,v,n,i,l,c,n,i),t.restore()}save(){this.inSMaskMode?(Eo(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Eo(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,i,o,s){this.ctx.transform(e,t,n,i,o,s),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let i=this.ctx,o=this.current,s=o.x,a=o.y,l,c,d=vt(i),u=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,h=u?n.slice(0):null;for(let g=0,v=0,x=e.length;g<x;g++)switch(e[g]|0){case Sn.rectangle:s=t[v++],a=t[v++];let L=t[v++],E=t[v++],P=s+L,S=a+E;i.moveTo(s,a),L===0||E===0?i.lineTo(P,S):(i.lineTo(P,a),i.lineTo(P,S),i.lineTo(s,S)),u||o.updateRectMinMax(d,[s,a,P,S]),i.closePath();break;case Sn.moveTo:s=t[v++],a=t[v++],i.moveTo(s,a),u||o.updatePathMinMax(d,s,a);break;case Sn.lineTo:s=t[v++],a=t[v++],i.lineTo(s,a),u||o.updatePathMinMax(d,s,a);break;case Sn.curveTo:l=s,c=a,s=t[v+4],a=t[v+5],i.bezierCurveTo(t[v],t[v+1],t[v+2],t[v+3],s,a),o.updateCurvePathMinMax(d,l,c,t[v],t[v+1],t[v+2],t[v+3],s,a,h),v+=6;break;case Sn.curveTo2:l=s,c=a,i.bezierCurveTo(s,a,t[v],t[v+1],t[v+2],t[v+3]),o.updateCurvePathMinMax(d,l,c,s,a,t[v],t[v+1],t[v+2],t[v+3],h),s=t[v+2],a=t[v+3],v+=4;break;case Sn.curveTo3:l=s,c=a,s=t[v+2],a=t[v+3],i.bezierCurveTo(t[v],t[v+1],s,a,s,a),o.updateCurvePathMinMax(d,l,c,t[v],t[v+1],s,a,s,a,h),v+=4;break;case Sn.closePath:i.closePath();break}u&&o.updateScalingPathMinMax(d,h),o.setCurrentPoint(s,a)}closePath(){this.ctx.closePath()}stroke(e=!0){let t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&n?.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,Jn(t),Kt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){let t=this.ctx,n=this.current.fillColor,i=this.current.patternFill,o=!1;i&&(t.save(),t.fillStyle=n.getPattern(t,this,Jn(t),Kt.FILL),o=!0);let s=this.current.getClippedPathBoundingBox();this.contentVisible&&s!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),o&&t.restore(),e&&this.consumePath(s)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=zP}eoClip(){this.pendingClip=X0}beginText(){this.current.textMatrix=Q0,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(let n of e)t.setTransform(...n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){let n=this.commonObjs.get(e),i=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=n.fontMatrix||Iu,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&We("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;let o=n.loadedName||"sans-serif",s=n.systemFontInfo?.css||`"${o}", ${n.fallbackName}`,a="normal";n.black?a="900":n.bold&&(a="bold");let l=n.italic?"italic":"normal",c=t;t<U0?c=U0:t>z0&&(c=z0),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${a} ${c}px ${s}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,i,o,s){this.current.textMatrix=[e,t,n,i,o,s],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,i){let o=this.ctx,s=this.current,a=s.font,l=s.textRenderingMode,c=s.fontSize/s.fontSizeScale,d=l&qt.FILL_STROKE_MASK,u=!!(l&qt.ADD_TO_PATH_FLAG),h=s.patternFill&&!a.missingFile,g;(a.disableFontFace||u||h)&&(g=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace||h?(o.save(),o.translate(t,n),o.beginPath(),g(o,c),i&&o.setTransform(...i),(d===qt.FILL||d===qt.FILL_STROKE)&&o.fill(),(d===qt.STROKE||d===qt.FILL_STROKE)&&o.stroke(),o.restore()):((d===qt.FILL||d===qt.FILL_STROKE)&&o.fillText(e,t,n),(d===qt.STROKE||d===qt.FILL_STROKE)&&o.strokeText(e,t,n)),u&&(this.pendingTextPaths||=[]).push({transform:vt(o),x:t,y:n,fontSize:c,addToPath:g})}get isFontSubpixelAAEnabled(){let{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);let t=e.getImageData(0,0,10,10).data,n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return Ke(this,"isFontSubpixelAAEnabled",n)}showText(e){let t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);let i=t.fontSize;if(i===0)return;let o=this.ctx,s=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,d=t.textHScale*c,u=e.length,h=n.vertical,g=h?1:-1,v=n.defaultVMetrics,x=i*t.fontMatrix[0],L=t.textRenderingMode===qt.FILL&&!n.disableFontFace&&!t.patternFill;o.save(),o.transform(...t.textMatrix),o.translate(t.x,t.y+t.textRise),c>0?o.scale(d,-1):o.scale(d,1);let E;if(t.patternFill){o.save();let V=t.fillColor.getPattern(o,this,Jn(o),Kt.FILL);E=vt(o),o.restore(),o.fillStyle=V}let P=t.lineWidth,S=t.textMatrixScale;if(S===0||P===0){let V=t.textRenderingMode&qt.FILL_STROKE_MASK;(V===qt.STROKE||V===qt.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=S;if(s!==1&&(o.scale(s,s),P/=s),o.lineWidth=P,n.isInvalidPDFjsFont){let V=[],B=0;for(let W of e)V.push(W.unicode),B+=W.width;o.fillText(V.join(""),0,0),t.x+=B*x*d,o.restore(),this.compose();return}let w=0,T;for(T=0;T<u;++T){let V=e[T];if(typeof V=="number"){w+=g*V*i/1e3;continue}let B=!1,W=(V.isSpace?l:0)+a,M=V.fontChar,q=V.accent,U,ee,ie=V.width;if(h){let ae=V.vmetric||v,he=-(V.vmetric?ae[1]:ie*.5)*x,Z=ae[2]*x;ie=ae?-ae[0]:ie,U=he/s,ee=(w+Z)/s}else U=w/s,ee=0;if(n.remeasure&&ie>0){let ae=o.measureText(M).width*1e3/i*s;if(ie<ae&&this.isFontSubpixelAAEnabled){let he=ie/ae;B=!0,o.save(),o.scale(he,1),U/=he}else ie!==ae&&(U+=(ie-ae)/2e3*i/s)}if(this.contentVisible&&(V.isInFont||n.missingFile)){if(L&&!q)o.fillText(M,U,ee);else if(this.paintChar(M,U,ee,E),q){let ae=U+i*q.offset.x/s,he=ee-i*q.offset.y/s;this.paintChar(q.fontChar,ae,he,E)}}let re=h?ie*x-W*c:ie*x+W*c;w+=re,B&&o.restore()}h?t.y-=w:t.x+=w*d,o.restore(),this.compose()}showType3Text(e){let t=this.ctx,n=this.current,i=n.font,o=n.fontSize,s=n.fontDirection,a=i.vertical?1:-1,l=n.charSpacing,c=n.wordSpacing,d=n.textHScale*s,u=n.fontMatrix||Iu,h=e.length,g=n.textRenderingMode===qt.INVISIBLE,v,x,L,E;if(!(g||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(d,s),v=0;v<h;++v){if(x=e[v],typeof x=="number"){E=a*x*o/1e3,this.ctx.translate(E,0),n.x+=E*d;continue}let P=(x.isSpace?c:0)+l,S=i.charProcOperatorList[x.operatorListId];if(!S){We(`Type3 character "${x.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=x,this.save(),t.scale(o,o),t.transform(...u),this.executeOperatorList(S),this.restore()),L=Me.applyTransform([x.width,0],u)[0]*o+P,t.translate(L,0),n.x+=L*d}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,i,o,s){this.ctx.rect(n,i,o-n,s-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){let n=e[1],i=this.baseTransform||vt(this.ctx),o={createCanvasGraphics:s=>new r(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new DP(e,n,this.ctx,o,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=Me.makeHexColor(e,t,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=Me.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=LP(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;let t=this.ctx;this.save();let n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Jn(t),Kt.SHADING);let i=Jn(t);if(i){let{width:o,height:s}=t.canvas,[a,l,c,d]=Me.getAxialAlignedBoundingBox([0,0,o,s],i);this.ctx.fillRect(a,l,c-a,d-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ft("Should not call beginInlineImage")}beginImageData(){ft("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=vt(this.ctx),t)){let n=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],n,i),this.current.updateRectMinMax(vt(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let t=this.ctx;e.isolated||bl("TODO: Support non-isolated groups."),e.knockout&&We("Knockout groups not supported.");let n=vt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Me.getAxialAlignedBoundingBox(e.bbox,vt(t)),o=[0,0,t.canvas.width,t.canvas.height];i=Me.intersect(i,o)||[0,0,0,0];let s=Math.floor(i[0]),a=Math.floor(i[1]),l=Math.max(Math.ceil(i[2])-s,1),c=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,c]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);let u=this.cachedCanvases.getCanvas(d,l,c),h=u.context;h.translate(-s,-a),h.transform(...n),e.smask?this.smaskStack.push({canvas:u.canvas,context:h,offsetX:s,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(s,a),t.save()),Eo(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;let t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let i=vt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);let o=Me.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,n,i,o){if(this.#e(),Pa(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){let s=t[2]-t[0],a=t[3]-t[1];if(o&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=s,t[3]=a;let[l,c]=Me.singularValueDecompose2dScale(vt(this.ctx)),{viewportScale:d}=this,u=Math.ceil(s*this.outputScaleX*d),h=Math.ceil(a*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(u,h);let{canvas:g,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,a*c),Pa(this.ctx)}else Pa(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],s,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new Ya(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;let t=e.count;e=this.getObject(e.data,e),e.count=t;let n=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=jP(e)),i.compiled)){i.compiled(n);return}let o=this._createMaskCanvas(e),s=o.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(s,o.offsetX,o.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,i=0,o,s){if(!this.contentVisible)return;e=this.getObject(e.data,e);let a=this.ctx;a.save();let l=vt(a);a.transform(t,n,i,o,0,0);let c=this._createMaskCanvas(e);a.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let d=0,u=s.length;d<u;d+=2){let h=Me.transform(l,[t,n,i,o,s[d],s[d+1]]),[g,v]=Me.applyTransform([0,0],h);a.drawImage(c.canvas,g,v)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;let t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(let o of e){let{data:s,width:a,height:l,transform:c}=o,d=this.cachedCanvases.getCanvas("maskCanvas",a,l),u=d.context;u.save();let h=this.getObject(s,o);G0(u,h),u.globalCompositeOperation="source-in",u.fillStyle=i?n.getPattern(u,this,Jn(t),Kt.FILL):n,u.fillRect(0,0,a,l),u.restore(),t.save(),t.transform(...c),t.scale(1,-1),Ma(t,d.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;let t=this.getObject(e);if(!t){We("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,i){if(!this.contentVisible)return;let o=this.getObject(e);if(!o){We("Dependent image isn't ready yet");return}let s=o.width,a=o.height,l=[];for(let c=0,d=i.length;c<d;c+=2)l.push({transform:[t,0,0,n,i[c],i[c+1]],x:0,y:0,w:s,h:a});this.paintInlineImageXObjectGroup(o,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;let{bitmap:t,width:n,height:i}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,i),s=o.context;return s.filter=this.current.transferMaps,s.drawImage(t,0,0),s.filter="none",o.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;let t=e.width,n=e.height,i=this.ctx;if(this.save(),!Ht){let{filter:a}=i;a!=="none"&&a!==""&&(i.filter="none")}i.scale(1/t,-1/n);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{let l=this.cachedCanvases.getCanvas("inlineImage",t,n).context;W0(l,e),o=this.applyTransferMapsToCanvas(l)}let s=this._scaleImage(o,Jn(i));i.imageSmoothingEnabled=$0(vt(i),e.interpolate),Ma(i,s.img,0,0,s.paintWidth,s.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;let n=this.ctx,i;if(e.bitmap)i=e.bitmap;else{let o=e.width,s=e.height,l=this.cachedCanvases.getCanvas("inlineImage",o,s).context;W0(l,e),i=this.applyTransferMapsToCanvas(l)}for(let o of t)n.save(),n.transform(...o.transform),n.scale(1,-1),Ma(n,i,o.x,o.y,o.w,o.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){let t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);let n=this.ctx;this.pendingClip&&(t||(this.pendingClip===X0?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let e=vt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{let t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:e}=this.current,{a:t,b:n,c:i,d:o}=this.ctx.getTransform(),s,a;if(n===0&&i===0){let l=Math.abs(t),c=Math.abs(o);if(l===c)if(e===0)s=a=1/l;else{let d=l*e;s=a=d<1?1/d:1}else if(e===0)s=1/l,a=1/c;else{let d=l*e,u=c*e;s=d<1?1/d:1,a=u<1?1/u:1}}else{let l=Math.abs(t*o-n*i),c=Math.hypot(t,n),d=Math.hypot(i,o);if(e===0)s=d/l,a=c/l;else{let u=e*l;s=d>u?d/u:1,a=c>u?c/u:1}}this._cachedScaleForStroking[0]=s,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){let{ctx:t}=this,{lineWidth:n}=this.current,[i,o]=this.getScaleForStroking();if(t.lineWidth=n||1,i===1&&o===1){t.stroke();return}let s=t.getLineDash();if(e&&t.save(),t.scale(i,o),s.length>0){let a=Math.max(i,o);t.setLineDash(s.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(let r in Sn)Ir.prototype[r]!==void 0&&(Ir.prototype[Sn[r]]=Ir.prototype[r]);var Hi=class{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}},Oa={UNKNOWN:0,DATA:1,ERROR:2},Pt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function an(r){switch(r instanceof Error||typeof r=="object"&&r!==null||ft('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new ni(r.message);case"MissingPDFException":return new ti(r.message);case"PasswordException":return new Po(r.message,r.code);case"UnexpectedResponseException":return new Dr(r.message,r.status);case"UnknownErrorException":return new Oo(r.message,r.details);default:return new Oo(r.message,r.toString())}}var Ui=class{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#i(e);return}if(e.callback){let n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Oa.DATA)i.resolve(e.data);else if(e.callback===Oa.ERROR)i.reject(an(e.reason));else throw new Error("Unexpected callback case");return}let t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){let n=this.sourceName,i=e.sourceName,o=this.comObj;new Promise(function(s){s(t(e.data))}).then(function(s){o.postMessage({sourceName:n,targetName:i,callback:Oa.DATA,callbackId:e.callbackId,data:s})},function(s){o.postMessage({sourceName:n,targetName:i,callback:Oa.ERROR,callbackId:e.callbackId,reason:an(s)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){let n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){let i=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[i]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(s){o.reject(s)}return o.promise}sendWithStream(e,t,n,i){let o=this.streamId++,s=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{let d=Promise.withResolvers();return this.streamControllers[o]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:s,targetName:a,action:e,streamId:o,data:t,desiredSize:c.desiredSize},i),d.promise},pull:c=>{let d=Promise.withResolvers();return this.streamControllers[o].pullCall=d,l.postMessage({sourceName:s,targetName:a,stream:Pt.PULL,streamId:o,desiredSize:c.desiredSize}),d.promise},cancel:c=>{Lt(c instanceof Error,"cancel must have a valid reason");let d=Promise.withResolvers();return this.streamControllers[o].cancelCall=d,this.streamControllers[o].isClosed=!0,l.postMessage({sourceName:s,targetName:a,stream:Pt.CANCEL,streamId:o,reason:an(c)}),d.promise}},n)}#n(e){let t=e.streamId,n=this.sourceName,i=e.sourceName,o=this.comObj,s=this,a=this.actionHandler[e.action],l={enqueue(c,d=1,u){if(this.isCancelled)return;let h=this.desiredSize;this.desiredSize-=d,h>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:i,stream:Pt.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:i,stream:Pt.CLOSE,streamId:t}),delete s.streamSinks[t])},error(c){Lt(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:i,stream:Pt.ERROR,streamId:t,reason:an(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,new Promise(function(c){c(a(e.data,l))}).then(function(){o.postMessage({sourceName:n,targetName:i,stream:Pt.START_COMPLETE,streamId:t,success:!0})},function(c){o.postMessage({sourceName:n,targetName:i,stream:Pt.START_COMPLETE,streamId:t,reason:an(c)})})}#i(e){let t=e.streamId,n=this.sourceName,i=e.sourceName,o=this.comObj,s=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Pt.START_COMPLETE:e.success?s.startCall.resolve():s.startCall.reject(an(e.reason));break;case Pt.PULL_COMPLETE:e.success?s.pullCall.resolve():s.pullCall.reject(an(e.reason));break;case Pt.PULL:if(!a){o.postMessage({sourceName:n,targetName:i,stream:Pt.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,new Promise(function(l){l(a.onPull?.())}).then(function(){o.postMessage({sourceName:n,targetName:i,stream:Pt.PULL_COMPLETE,streamId:t,success:!0})},function(l){o.postMessage({sourceName:n,targetName:i,stream:Pt.PULL_COMPLETE,streamId:t,reason:an(l)})});break;case Pt.ENQUEUE:if(Lt(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(e.chunk);break;case Pt.CLOSE:if(Lt(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),this.#o(s,t);break;case Pt.ERROR:Lt(s,"error should have stream controller"),s.controller.error(an(e.reason)),this.#o(s,t);break;case Pt.CANCEL_COMPLETE:e.success?s.cancelCall.resolve():s.cancelCall.reject(an(e.reason)),this.#o(s,t);break;case Pt.CANCEL:if(!a)break;new Promise(function(l){l(a.onCancel?.(an(e.reason)))}).then(function(){o.postMessage({sourceName:n,targetName:i,stream:Pt.CANCEL_COMPLETE,streamId:t,success:!0})},function(l){o.postMessage({sourceName:n,targetName:i,stream:Pt.CANCEL_COMPLETE,streamId:t,reason:an(l)})}),a.sinkCapability.reject(an(e.reason)),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}#o(e,t){return G(this,null,function*(){yield Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]})}destroy(){this.#e?.abort(),this.#e=null}},eh=class{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return Kh(this.#e)}has(e){return this.#e.has(e)}},Tr=Symbol("INTERNAL"),th=class{#e=!1;#t=!1;#n=!1;#i=!0;constructor(e,{name:t,intent:n,usage:i,rbGroups:o}){this.#e=!!(e&ln.DISPLAY),this.#t=!!(e&ln.PRINT),this.name=t,this.intent=n,this.usage=i,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;let{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==Tr&&ft("Internal method `_setVisible` called."),this.#n=n,this.#i=t}},nh=class{#e=null;#t=new Map;#n=null;#i=null;constructor(e,t=ln.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#i=e.order;for(let n of e.groups)this.#t.set(n.id,new th(t,n));if(e.baseState==="OFF")for(let n of this.#t.values())n._setVisible(Tr,!1);for(let n of e.on)this.#t.get(n)._setVisible(Tr,!0);for(let n of e.off)this.#t.get(n)._setVisible(Tr,!1);this.#n=this.getHash()}}#o(e){let t=e.length;if(t<2)return!0;let n=e[0];for(let i=1;i<t;i++){let o=e[i],s;if(Array.isArray(o))s=this.#o(o);else if(this.#t.has(o))s=this.#t.get(o).visible;else return We(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return bl("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(We(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#o(e.expression);if(!e.policy||e.policy==="AnyOn"){for(let t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(let t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(let t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(let t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return We(`Unknown optional content policy ${e.policy}.`),!0}return We(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){let i=this.#t.get(e);if(!i){We(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(let o of i.rbGroups)for(let s of o)s!==e&&this.#t.get(s)?._setVisible(Tr,!1,!0);i._setVisible(Tr,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(let i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}let o=this.#t.get(i);if(o)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!o.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#i?this.#i.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?Kh(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;let e=new za;for(let[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}},ih=class{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Lt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');let{length:i,initialData:o,progressiveDone:s,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=s,this._contentDispositionFilename=a,o?.length>0){let l=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){let n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{let i=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});Lt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){let t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Lt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let e=this._queuedChunks;return this._queuedChunks=null,new rh(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new oh(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}},rh=class{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=Qh(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(let o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return G(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},oh=class{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return G(this,null,function*(){if(this._queuedChunk){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function qP(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let d=a(t);return d=unescape(d),d=l(d),d=c(d),o(d)}if(t=s(r),t){let d=c(t);return o(d)}if(t=n("filename","i").exec(r),t){t=t[1];let d=a(t);return d=c(d),o(d)}function n(d,u){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function i(d,u){if(d){if(!/^[\x00-\xFF]+$/.test(u))return u;try{let h=new TextDecoder(d,{fatal:!0}),g=yl(u);u=h.decode(g),e=!1}catch{}}return u}function o(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function s(d){let u=[],h,g=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=g.exec(d))!==null;){let[,x,L,E]=h;if(x=parseInt(x,10),x in u){if(x===0)break;continue}u[x]=[L,E]}let v=[];for(let x=0;x<u.length&&x in u;++x){let[L,E]=u[x];E=a(E),L&&(E=unescape(E),x===0&&(E=l(E))),v.push(E)}return v.join("")}function a(d){if(d.startsWith('"')){let u=d.slice(1).split('\\"');for(let h=0;h<u.length;++h){let g=u[h].indexOf('"');g!==-1&&(u[h]=u[h].slice(0,g),u.length=h+1),u[h]=u[h].replaceAll(/\\(.)/g,"$1")}d=u.join('"')}return d}function l(d){let u=d.indexOf("'");if(u===-1)return d;let h=d.slice(0,u),v=d.slice(u+1).replace(/^[^']*'/,"");return i(h,v)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,h,g,v){if(g==="q"||g==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,L){return String.fromCharCode(parseInt(L,16))}),i(h,v);try{v=atob(v)}catch{}return i(h,v)})}return""}function Zh(r,e){let t=new Headers;if(!r||!e||typeof e!="object")return t;for(let n in e){let i=e[n];i!==void 0&&t.append(n,i)}return t}function ef({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){let i={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(r.get("Content-Length"),10);return!Number.isInteger(o)||(i.suggestedLength=o,o<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function tf(r){let e=r.get("Content-Disposition");if(e){let t=qP(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Qh(t))return t}return null}function Cl(r,e){return r===404||r===0&&e.startsWith("file:")?new ti('Missing PDF "'+e+'".'):new Dr(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r)}function e_(r){return r===200||r===206}function t_(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function n_(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(We(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}var Qa=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Zh(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Lt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new sh(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new ah(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},sh=class{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;let t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;let n=new Headers(e.headers),i=t.url;fetch(i,t_(n,this._withCredentials,this._abortController)).then(o=>{if(!e_(o.status))throw Cl(o.status,i);this._reader=o.body.getReader(),this._headersCapability.resolve();let s=o.headers,{allowRangeRequests:a,suggestedLength:l}=ef({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=tf(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ni("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return G(this,null,function*(){yield this._headersCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:n_(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},ah=class{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;let i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;let o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);let s=i.url;fetch(s,t_(o,this._withCredentials,this._abortController)).then(a=>{if(!e_(a.status))throw Cl(a.status,s);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return G(this,null,function*(){yield this._readCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:n_(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},Ou=200,Tu=206;function HP(r){let e=r.response;return typeof e!="string"?e:yl(e).buffer}var lh=class{constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Zh(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){let i={begin:e,end:t};for(let o in n)i[o]=n[o];return this.request(i)}requestFull(e){return this.request(e)}request(e){let t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(let[o,s]of this.headers)t.setRequestHeader(o,s);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Tu):i.expectedStatus=Ou,t.responseType="arraybuffer",e.onError&&(t.onerror=function(o){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){let n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){let n=this.pendingRequests[e];if(!n)return;let i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){n.onError?.(i.status);return}let o=i.status||Ou;if(!(o===Ou&&n.expectedStatus===Tu)&&o!==n.expectedStatus){n.onError?.(i.status);return}let a=HP(i);if(o===Tu){let l=i.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);n.onDone({begin:parseInt(c[1],10),chunk:a})}else a?n.onDone({begin:0,chunk:a}):n.onError?.(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){let t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},ch=class{constructor(e){this._source=e,this._manager=new lh(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){let t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Lt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new dh(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){let n=new uh(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},dh=class{constructor(e,t){this._manager=e;let n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=new Headers(t.getAllResponseHeaders().trim().split(/[\r\n]+/).map(s=>{let[a,...l]=s.split(": ");return[a,l.join(": ")]})),{allowRangeRequests:i,suggestedLength:o}=ef({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=tf(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Cl(e,this._url),this._headersCapability.reject(this._storedError);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}read(){return G(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0,this._headersCapability.reject(e);for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},uh=class{constructor(e,t,n){this._manager=e;let i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){let t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=Cl(e,this._url);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}read(){return G(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},WP=/^[a-z][a-z0-9\-+.]+:/i;function GP(r){if(WP.test(r))return new URL(r);let e=Nn.get("url");return new URL(e.pathToFileURL(r))}function i_(r,e,t){return r.protocol==="http:"?Nn.get("http").request(r,{headers:e},t):Nn.get("https").request(r,{headers:e},t)}var hh=class{constructor(e){this.source=e,this.url=GP(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=Zh(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Lt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new gh(this):new fh(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=this.isFsUrl?new mh(this,e,t):new ph(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Ja=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;let t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return G(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ni("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},Za=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();let t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return G(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}},fh=class extends Ja{constructor(e){super(e);let t=Object.fromEntries(e.headers),n=i=>{if(i.statusCode===404){let l=new ti(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(i);let o=new Headers(this._readableStream.headers),{allowRangeRequests:s,suggestedLength:a}=ef({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=a||this._contentLength,this._filename=tf(o)};this._request=i_(this._url,t,n),this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}},ph=class extends Za{constructor(e,t,n){super(e);let i=Object.fromEntries(e.headers);i.Range=`bytes=${t}-${n-1}`;let o=s=>{if(s.statusCode===404){let a=new ti(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(s)};this._request=i_(this._url,i,o),this._request.on("error",s=>{this._storedError=s}),this._request.end()}},gh=class extends Ja{constructor(e){super(e);let t=Nn.get("fs");t.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(t.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new ti(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}},mh=class extends Za{constructor(e,t,n){super(e);let i=Nn.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:n-1}))}},$P=1e5,tn=30,XP=.8,Fo=class r{#e=Promise.withResolvers();#t=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#o=null;#r=null;#l=0;#c=0;#d=null;#a=null;#u=0;#s=0;#h=Object.create(null);#p=[];#f=null;#g=[];#_=new WeakMap;#m=null;static#v=new Map;static#y=new Map;static#C=new WeakMap;static#x=null;static#w=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#f=e;else if(typeof e=="object")this.#f=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#a=t,this.#s=n.scale*(globalThis.devicePixelRatio||1),this.#u=n.rotation,this.#r={div:null,properties:null,ctx:null};let{pageWidth:i,pageHeight:o,pageX:s,pageY:a}=n.rawDims;this.#m=[1,0,0,-1,-s,a+o],this.#c=i,this.#l=o,r.#I(),Wi(t,n),this.#e.promise.finally(()=>{r.#w.delete(this),this.#r=null,this.#h=null}).catch(()=>{})}static get fontFamilyMap(){let{isWindows:e,isFirefox:t}=Bt.platform;return Ke(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){let e=()=>{this.#d.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#o??=t.lang,Object.assign(this.#h,t.styles),this.#T(t.items),e()},this.#e.reject)};return this.#d=this.#f.getReader(),r.#w.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){let n=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==this.#u&&(t?.(),this.#u=i,Wi(this.#a,{rotation:i})),n!==this.#s){t?.(),this.#s=n;let o={div:null,properties:null,ctx:r.#P(this.#o)};for(let s of this.#g)o.properties=this.#_.get(s),o.div=s,this.#E(o)}}cancel(){let e=new ni("TextLayer task cancelled.");this.#d?.cancel(e).catch(()=>{}),this.#d=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#p}#T(e){if(this.#n)return;this.#r.ctx??=r.#P(this.#o);let t=this.#g,n=this.#p;for(let i of e){if(t.length>$P){We("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){let o=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id!==null&&this.#t.setAttribute("id",`${i.id}`),o.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(i.str),this.#M(i)}}#M(e){let t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);let i=Me.transform(this.#m,e.transform),o=Math.atan2(i[1],i[0]),s=this.#h[e.fontName];s.vertical&&(o+=Math.PI/2);let a=this.#i&&s.fontSubstitution||s.fontFamily;a=r.fontFamilyMap.get(a)||a;let l=Math.hypot(i[2],i[3]),c=l*r.#R(a,this.#o),d,u;o===0?(d=i[4],u=i[5]-c):(d=i[4]+c*Math.sin(o),u=i[5]-c*Math.cos(o));let h="calc(var(--scale-factor)*",g=t.style;this.#t===this.#a?(g.left=`${(100*d/this.#c).toFixed(2)}%`,g.top=`${(100*u/this.#l).toFixed(2)}%`):(g.left=`${h}${d.toFixed(2)}px)`,g.top=`${h}${u.toFixed(2)}px)`),g.fontSize=`${h}${(r.#x*l).toFixed(2)}px)`,g.fontFamily=a,n.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#i&&(t.dataset.fontName=s.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){let x=Math.abs(e.transform[0]),L=Math.abs(e.transform[3]);x!==L&&Math.max(x,L)/Math.min(x,L)>1.5&&(v=!0)}if(v&&(n.canvasWidth=s.vertical?e.height:e.width),this.#_.set(t,n),this.#r.div=t,this.#r.properties=n,this.#E(this.#r),n.hasText&&this.#t.append(t),n.hasEOL){let x=document.createElement("br");x.setAttribute("role","presentation"),this.#t.append(x)}}#E(e){let{div:t,properties:n,ctx:i}=e,{style:o}=t,s="";if(r.#x>1&&(s=`scale(${1/r.#x})`),n.canvasWidth!==0&&n.hasText){let{fontFamily:a}=o,{canvasWidth:l,fontSize:c}=n;r.#A(i,c*this.#s,a);let{width:d}=i.measureText(t.textContent);d>0&&(s=`scaleX(${l*this.#s/d}) ${s}`)}n.angle!==0&&(s=`rotate(${n.angle}deg) ${s}`),s.length>0&&(o.transform=s)}static cleanup(){if(!(this.#w.size>0)){this.#v.clear();for(let{canvas:e}of this.#y.values())e.remove();this.#y.clear()}}static#P(e=null){let t=this.#y.get(e||="");if(!t){let n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(e,t),this.#C.set(t,{size:0,family:""})}return t}static#A(e,t,n){let i=this.#C.get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)}static#I(){if(this.#x!==null)return;let e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#x=e.getBoundingClientRect().height,e.remove()}static#R(e,t){let n=this.#v.get(e);if(n)return n;let i=this.#P(t);i.canvas.width=i.canvas.height=tn,this.#A(i,tn,e);let o=i.measureText(""),s=o.fontBoundingBoxAscent,a=Math.abs(o.fontBoundingBoxDescent);if(s){let d=s/(s+a);return this.#v.set(e,d),i.canvas.width=i.canvas.height=0,d}i.strokeStyle="red",i.clearRect(0,0,tn,tn),i.strokeText("g",0,0);let l=i.getImageData(0,0,tn,tn).data;a=0;for(let d=l.length-1-3;d>=0;d-=4)if(l[d]>0){a=Math.ceil(d/4/tn);break}i.clearRect(0,0,tn,tn),i.strokeText("A",0,tn),l=i.getImageData(0,0,tn,tn).data,s=0;for(let d=0,u=l.length;d<u;d+=4)if(l[d]>0){s=tn-Math.floor(d/4/tn);break}i.canvas.width=i.canvas.height=0;let c=s?s/(s+a):XP;return this.#v.set(e,c),c}},No=class r{static textContent(e){let t=[],n={items:t,styles:Object.create(null)};function i(o){if(!o)return;let s=null,a=o.name;if(a==="#text")s=o.value;else if(r.shouldBuildText(a))o?.attributes?.textContent?s=o.attributes.textContent:o.value&&(s=o.value);else return;if(s!==null&&t.push({str:s}),!!o.children)for(let l of o.children)i(l)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}},KP=65536,YP=100,QP=5e3,JP=Ht?Gu:qu,ZP=Ht?$u:Ga,e2=Ht?Wu:Hu,t2=Ht?Xu:Ka;function n2(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});let e=new _h,{docId:t}=e,n=r.url?i2(r.url):null,i=r.data?r2(r.data):null,o=r.httpHeaders||null,s=r.withCredentials===!0,a=r.password??null,l=r.range instanceof el?r.range:null,c=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:KP,d=r.worker instanceof kr?r.worker:null,u=r.verbosity,h=typeof r.docBaseUrl=="string"&&!wl(r.docBaseUrl)?r.docBaseUrl:null,g=typeof r.cMapUrl=="string"?r.cMapUrl:null,v=r.cMapPacked!==!1,x=r.CMapReaderFactory||ZP,L=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,E=r.StandardFontDataFactory||t2,P=r.stopAtErrors!==!0,S=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,w=r.isEvalSupported!==!1,T=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Ht,V=typeof r.isChrome=="boolean"?r.isChrome:!Bt.platform.isFirefox&&typeof window<"u"&&!!window?.chrome,B=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,W=typeof r.disableFontFace=="boolean"?r.disableFontFace:Ht,M=r.fontExtraProperties===!0,q=r.enableXfa===!0,U=r.ownerDocument||globalThis.document,ee=r.disableRange===!0,ie=r.disableStream===!0,re=r.disableAutoFetch===!0,ae=r.pdfBug===!0,he=r.CanvasFactory||JP,Z=r.FilterFactory||e2,ne=r.enableHWA===!0,Oe=l?l.length:r.length??NaN,Y=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Ht&&!W,K=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:x===Ga&&E===Ka&&g&&L&&Ao(g,document.baseURI)&&Ao(L,document.baseURI);r.canvasFactory&&N0("`canvasFactory`-instance option, please use `CanvasFactory` instead."),r.filterFactory&&N0("`filterFactory`-instance option, please use `FilterFactory` instead.");let te=null;_P(u);let xe={canvasFactory:new he({ownerDocument:U,enableHWA:ne}),filterFactory:new Z({docId:t,ownerDocument:U}),cMapReaderFactory:K?null:new x({baseUrl:g,isCompressed:v}),standardFontDataFactory:K?null:new E({baseUrl:L})};if(!d){let Re={verbosity:u,port:Hi.workerPort};d=Re.port?kr.fromPort(Re):new kr(Re),e._worker=d}let Ce={docId:t,apiVersion:"4.8.69",data:i,password:a,disableAutoFetch:re,rangeChunkSize:c,length:Oe,docBaseUrl:h,enableXfa:q,evaluatorOptions:{maxImageSize:S,disableFontFace:W,ignoreErrors:P,isEvalSupported:w,isOffscreenCanvasSupported:T,isChrome:V,canvasMaxAreaInBytes:B,fontExtraProperties:M,useSystemFonts:Y,cMapUrl:K?g:null,standardFontDataUrl:K?L:null}},Ne={disableFontFace:W,fontExtraProperties:M,ownerDocument:U,pdfBug:ae,styleElement:te,loadingParams:{disableAutoFetch:re,enableXfa:q}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");let Re=d.messageHandler.sendWithPromise("GetDocRequest",Ce,i?[i.buffer]:null),Ie;if(l)Ie=new ih(l,{disableRange:ee,disableStream:ie});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let Qe;Ht?Qe=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&Ao(n)?Qa:hh:Qe=Ao(n)?Qa:ch,Ie=new Qe({url:n,length:Oe,httpHeaders:o,withCredentials:s,rangeChunkSize:c,disableRange:ee,disableStream:ie})}return Re.then(Qe=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");let _t=new Ui(t,Qe,d.port),jt=new xh(_t,e,Ie,Ne,xe);e._transport=jt,_t.send("Ready",null)})}).catch(e._capability.reject),e}function i2(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(Ht&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function r2(r){if(Ht&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return yl(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function K0(r){return typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0}var _h=class r{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${r.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return G(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}},el=class{constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(let n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(let n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(let t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){ft("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},vh=class{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ke(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},bh=class{#e=null;#t=!1;constructor(e,t,n,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new ja:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new tl,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:o=!1}={}){return new To({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:o})}getAnnotations({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ke(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return G(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:i=Ci.ENABLE,transform:o=null,background:s=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:u=!1}){this._stats?.time("Overall");let h=this._transport.getRenderingIntent(n,i,d,u),{renderingIntent:g,cacheKey:v}=h;this.#t=!1,this.#i(),a||=this._transport.getOptionalContentConfig(g);let x=this._intentStates.get(v);x||(x=Object.create(null),this._intentStates.set(v,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);let L=!!(g&ln.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));let E=w=>{x.renderTasks.delete(P),(this._maybeCleanupAfterRender||L)&&(this.#t=!0),this.#n(!L),w?(P.capability.reject(w),this._abortOperatorList({intentState:x,reason:w instanceof Error?w:new Error(w)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new Ch({callback:E,params:{canvasContext:e,viewport:t,transform:o,background:s},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!L,pdfBug:this._pdfBug,pageColors:c});(x.renderTasks||=new Set).add(P);let S=P.task;return Promise.all([x.displayReadyCapability.promise,a]).then(([w,T])=>{if(this.destroyed){E();return}if(this._stats?.time("Rendering"),!(T.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:w,optionalContentConfig:T}),P.operatorListChanged()}).catch(E),S}getOperatorList({intent:e="display",annotationMode:t=Ci.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){function o(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}let s=this._transport.getRenderingIntent(e,t,n,i,!0),a=this._intentStates.get(s.cacheKey);a||(a=Object.create(null),this._intentStates.set(s.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=o,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>No.textContent(n));let t=this.streamTextContent(e);return new Promise(function(n,i){function o(){s.read().then(function({value:l,done:c}){if(c){n(a);return}a.lang??=l.lang,Object.assign(a.styles,l.styles),a.items.push(...l.items),o()},i)}let s=t.getReader(),a={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(let n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,this.#i(),Promise.all(e)}cleanup(e=!1){this.#t=!0;let t=this.#n(!1);return e&&t&&(this._stats&&=new ja),t}#n(e=!1){if(this.#i(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},QP),!1;for(let{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#i(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){let n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(let n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){let{map:o,transfer:s}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:i},s).getReader(),c=this._intentStates.get(t);c.streamReader=l;let d=()=>{l.read().then(({value:u,done:h})=>{if(h){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),d())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(let h of c.renderTasks)h.operatorListChanged();this.#n(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};d()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Io){let i=YP;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new ni(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[i,o]of this._intentStates)if(o===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}},yh=class{#e=new Map;#t=Promise.resolve();postMessage(e,t){let n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(let[i]of this.#e)i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if(n?.signal instanceof AbortSignal){let{signal:o}=n;if(o.aborted){We("LoopbackPort - cannot use an `aborted` signal.");return}let s=()=>this.removeEventListener(e,t);i=()=>o.removeEventListener("abort",s),o.addEventListener("abort",s)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(let[,e]of this.#e)e?.();this.#e.clear()}},ml,zi,qi,Rr,Fa,Lr,Na,mt=class mt{constructor({name:e=null,port:t=null,verbosity:n=vP()}={}){ai(this,Rr);if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(Vt(mt,qi)?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(Vt(mt,qi)||Ps(mt,qi,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return Ht?Promise.all([Nn.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Ui("main","worker",e),this._messageHandler.on("ready",function(){}),Os(this,Rr,Fa).call(this)}_initialize(){if(Vt(mt,zi)||Vt(mt,Lr,Na)){this._setupFakeWorker();return}let{workerSrc:e}=mt;try{mt._isSameOrigin(window.location.href,e)||(e=mt._createCDNWrapper(new URL(e,window.location).href));let t=new Worker(e,{type:"module"}),n=new Ui("main","worker",t),i=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:o.signal}),n.on("test",a=>{if(o.abort(),this.destroyed||!a){i();return}this._messageHandler=n,this._port=t,this._webWorker=t,Os(this,Rr,Fa).call(this)}),n.on("ready",a=>{if(o.abort(),this.destroyed){i();return}try{s()}catch{this._setupFakeWorker()}});let s=()=>{let a=new Uint8Array;n.send("test",a,[a.buffer])};s();return}catch{bl("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Vt(mt,zi)||(We("Setting up fake worker."),Ps(mt,zi,!0)),mt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let t=new yh;this._port=t;let n=`fake${Hf(mt,ml)._++}`,i=new Ui(n+"_worker",n,t);e.setup(i,t),this._messageHandler=new Ui(n,n+"_worker",t),Os(this,Rr,Fa).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),Vt(mt,qi)?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let t=Vt(this,qi)?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new mt(e)}static get workerSrc(){if(Hi.workerSrc)return Hi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ke(this,"_setupFakeWorkerGlobal",G(this,null,function*(){return Vt(this,Lr,Na)?Vt(this,Lr,Na):(yield import(this.workerSrc)).WorkerMessageHandler}))}};ml=new WeakMap,zi=new WeakMap,qi=new WeakMap,Rr=new WeakSet,Fa=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Lr=new WeakSet,Na=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},ai(mt,Lr),ai(mt,ml,0),ai(mt,zi,!1),ai(mt,qi),Ht&&(Ps(mt,zi,!0),Hi.workerSrc||="./pdf.worker.mjs"),mt._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}let i=new URL(t,n);return n.origin===i.origin},mt._createCDNWrapper=e=>{let t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};var kr=mt,xh=class{#e=new Map;#t=new Map;#n=new Map;#i=new Map;#o=null;constructor(e,t,n,i,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new tl,this.fontLoader=new Uu({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#r(e,t=null){let n=this.#e.get(e);if(n)return n;let i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return Ke(this,"annotationStorage",new Lo)}getRenderingIntent(e,t=Ci.ENABLE,n=null,i=!1,o=!1){let s=ln.DISPLAY,a=Vu;switch(e){case"any":s=ln.ANY;break;case"display":break;case"print":s=ln.PRINT;break;default:We(`getRenderingIntent - invalid intent: ${e}`)}let l=s&ln.PRINT&&n instanceof qa?n:this.annotationStorage;switch(t){case Ci.DISABLE:s+=ln.ANNOTATIONS_DISABLE;break;case Ci.ENABLE:break;case Ci.ENABLE_FORMS:s+=ln.ANNOTATIONS_FORMS;break;case Ci.ENABLE_STORAGE:s+=ln.ANNOTATIONS_STORAGE,a=l.serializable;break;default:We(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(s+=ln.IS_EDITING),o&&(s+=ln.OPLIST);let{ids:c,hash:d}=l.modifiedIds,u=[s,a.hash,d];return{renderingIntent:s,cacheKey:u.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#o?.reject(new Error("Worker was destroyed during onPassword callback"));let e=[];for(let n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Fo.cleanup(),this._networkStream?.cancelAllRequests(new ni("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{Lt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},i.onPull=()=>{this._fullReader.read().then(function({value:o,done:s}){if(s){i.close();return}Lt(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{this._fullReader.cancel(o),i.ready.catch(s=>{if(!this.destroyed)throw s})}}),e.on("ReaderHeadersReady",n=>G(this,null,function*(){yield this._fullReader.headersReady;let{isStreamingSupported:i,isRangeSupported:o,contentLength:s}=this._fullReader;return(!i||!o)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=a=>{t.onProgress?.({loaded:a.loaded,total:a.total})}),{isStreamingSupported:i,isRangeSupported:o,contentLength:s}})),e.on("GetRangeReader",(n,i)=>{Lt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){i.close();return}i.onPull=()=>{o.read().then(function({value:s,done:a}){if(a){i.close();return}Lt(s instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{o.cancel(s),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new vh(n,this))}),e.on("DocException",function(n){let i;switch(n.name){case"PasswordException":i=new Po(n.message,n.code);break;case"InvalidPDFException":i=new Ba(n.message);break;case"MissingPDFException":i=new ti(n.message);break;case"UnexpectedResponseException":i=new Dr(n.message,n.status);break;case"UnknownErrorException":i=new Oo(n.message,n.details);break;default:ft("DocException - expected a valid Error.")}t._capability.reject(i)}),e.on("PasswordRequest",n=>{if(this.#o=Promise.withResolvers(),t.onPassword){let i=o=>{o instanceof Error?this.#o.reject(o):this.#o.resolve({password:o})};try{t.onPassword(i,n.code)}catch(o){this.#o.reject(o)}}else this.#o.reject(new Po(n.message,n.code));return this.#o.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":let{disableFontFace:s,fontExtraProperties:a,pdfBug:l}=this._params;if("error"in o){let h=o.error;We(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}let c=l&&globalThis.FontInspector?.enabled?(h,g)=>globalThis.FontInspector.fontAdded(h,g):null,d=new zu(o,{disableFontFace:s,inspectFont:c});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!a&&d.data&&(d.data=null),this.commonObjs.resolve(n,d)});break;case"CopyLocalImage":let{imageRef:u}=o;Lt(u,"The imageRef must be defined.");for(let h of this.#t.values())for(let[,g]of h.objs)if(g?.ref===u)return g.dataLen?(this.commonObjs.resolve(n,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,o,s])=>{if(this.destroyed)return;let a=this.#t.get(i);if(!a.objs.has(n)){if(a._intentStates.size===0){s?.bitmap?.close();return}switch(o){case"Image":a.objs.resolve(n,s),s?.dataLen>hP&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(n,s);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",n=>G(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)})),e.on("FetchStandardFontData",n=>G(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&We("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));let t=e-1,n=this.#n.get(t);if(n)return n;let i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#i.set(o.refStr,e);let s=new bh(t,o,this,this._params.pdfBug);return this.#t.set(t,s),s});return this.#n.set(t,i),i}getPageIndex(e){return K0(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#r("GetOptionalContentConfig").then(t=>new nh(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let e="GetMetadata",t=this.#e.get(e);if(t)return t;let n=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new eh(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){return G(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Fo.cleanup()}})}cachedPageNumber(e){if(!K0(e))return null;let t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#i.get(t)??null}},Ta=Symbol("INITIAL_DATA"),tl=class{#e=Object.create(null);#t(e){return this.#e[e]||=Ft(it({},Promise.withResolvers()),{data:Ta})}get(e,t=null){if(t){let i=this.#t(e);return i.promise.then(()=>t(i.data)),null}let n=this.#e[e];if(!n||n.data===Ta)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){let t=this.#e[e];return!!t&&t.data!==Ta}resolve(e,t=null){let n=this.#t(e);n.data=t,n.resolve()}clear(){for(let e in this.#e){let{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(let e in this.#e){let{data:t}=this.#e[e];t!==Ta&&(yield[e,t])}}},wh=class{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;let{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}},Ch=class r{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:o,operatorList:s,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:h=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new wh(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(r.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:n,viewport:i,transform:o,background:s}=this.params;this.gfx=new Ir(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:i,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),r.#t.delete(this._canvas),this.callback(e||new Io(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return G(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r.#t.delete(this._canvas),this.callback())))})}},o2="4.8.69",s2="3634dab10";function Y0(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function So(r){return Math.max(0,Math.min(255,255*r))}var nl=class{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=So(e),[e,e,e]}static G_HTML([e]){let t=Y0(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(So)}static RGB_HTML(e){return`#${e.map(Y0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[So(1-Math.min(1,e+i)),So(1-Math.min(1,n+i)),So(1-Math.min(1,t+i))]}static CMYK_HTML(e){let t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){let i=1-e,o=1-t,s=1-n,a=Math.min(i,o,s);return["CMYK",i,o,s,a]}},Eh=class{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");let i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){ft("Abstract method `_createSVG` called.")}},Bo=class extends Eh{_createSVG(e){return document.createElementNS(Zn,e)}},il=class{static setupStorage(e,t,n,i,o){let s=i.getValue(t,{value:null});switch(n.name){case"textarea":if(s.value!==null&&(e.textContent=s.value),o==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(s.value===n.attributes.xfaOn?e.setAttribute("checked",!0):s.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(s.value!==null&&e.setAttribute("value",s.value),o==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(s.value!==null){e.setAttribute("value",s.value);for(let a of n.children)a.attributes.value===s.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{let l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:o}){let{attributes:s}=t,a=e instanceof HTMLAnchorElement;s.type==="radio"&&(s.name=`${s.name}-${i}`);for(let[l,c]of Object.entries(s))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}a&&o.addLinkAttributes(e,s.href,s.newWindow),n&&s.dataId&&this.setupStorage(e,s.dataId,t,n)}static render(e){let t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,o=e.intent||"display",s=document.createElement(i.name);i.attributes&&this.setAttributes({html:s,element:i,intent:o,linkService:n});let a=o!=="richText",l=e.div;if(l.append(s),e.viewport){let u=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=u}a&&l.setAttribute("class","xfaLayer xfaFont");let c=[];if(i.children.length===0){if(i.value){let u=document.createTextNode(i.value);s.append(u),a&&No.shouldBuildText(i.name)&&c.push(u)}return{textDivs:c}}let d=[[i,-1,s]];for(;d.length>0;){let[u,h,g]=d.at(-1);if(h+1===u.children.length){d.pop();continue}let v=u.children[++d.at(-1)[1]];if(v===null)continue;let{name:x}=v;if(x==="#text"){let E=document.createTextNode(v.value);c.push(E),g.append(E);continue}let L=v?.attributes?.xmlns?document.createElementNS(v.attributes.xmlns,x):document.createElement(x);if(g.append(L),v.attributes&&this.setAttributes({html:L,element:v,storage:t,intent:o,linkService:n}),v.children?.length>0)d.push([v,-1,L]);else if(v.value){let E=document.createTextNode(v.value);a&&No.shouldBuildText(x)&&c.push(E),L.append(E)}}for(let u of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){let t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}},zo=1e3,a2=9,$i=new WeakSet;function ei(r){return{width:r[2]-r[0],height:r[3]-r[1]}}var Sh=class{static create(e){switch(e.data.annotationType){case Rt.LINK:return new rl(e);case Rt.TEXT:return new Ah(e);case Rt.WIDGET:switch(e.data.fieldType){case"Tx":return new Mh(e);case"Btn":return e.data.radioButton?new ol(e):e.data.checkBox?new Oh(e):new Th(e);case"Ch":return new Ih(e);case"Sig":return new Ph(e)}return new ii(e);case Rt.POPUP:return new jo(e);case Rt.FREETEXT:return new sl(e);case Rt.LINE:return new Rh(e);case Rt.SQUARE:return new Lh(e);case Rt.CIRCLE:return new Dh(e);case Rt.POLYLINE:return new al(e);case Rt.CARET:return new Nh(e);case Rt.INK:return new Vo(e);case Rt.POLYGON:return new Fh(e);case Rt.HIGHLIGHT:return new ll(e);case Rt.UNDERLINE:return new Bh(e);case Rt.SQUIGGLY:return new jh(e);case Rt.STRIKEOUT:return new Vh(e);case Rt.STAMP:return new cl(e);case Rt.FILEATTACHMENT:return new Uh(e);default:return new At(e)}}},At=class r{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e?.str||t?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return r._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};let{rect:t}=e;t&&this.#i(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#i(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#i(e){let{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:s,pageX:a,pageY:l}}}}=this;n?.splice(0,4,...e);let{width:c,height:d}=ei(e);t.left=`${100*(e[0]-a)/o}%`,t.top=`${100*(s-e[3]+l)/s}%`,i===0?(t.width=`${100*c/o}%`,t.height=`${100*d/s}%`):this.setRotation(i)}_createContainer(e){let{data:t,parent:{page:n,viewport:i}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),this instanceof ii||(o.tabIndex=zo);let{style:s}=o;if(s.zIndex=this.parent.zIndex++,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof jo){let{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,o),o}let{width:a,height:l}=ei(t.rect);if(!e&&t.borderStyle.width>0){s.borderWidth=`${t.borderStyle.width}px`;let x=t.borderStyle.horizontalCornerRadius,L=t.borderStyle.verticalCornerRadius;if(x>0||L>0){let P=`calc(${x}px * var(--scale-factor)) / calc(${L}px * var(--scale-factor))`;s.borderRadius=P}else if(this instanceof ol){let P=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;s.borderRadius=P}switch(t.borderStyle.style){case Co.SOLID:s.borderStyle="solid";break;case Co.DASHED:s.borderStyle="dashed";break;case Co.BEVELED:We("Unimplemented border style: beveled");break;case Co.INSET:We("Unimplemented border style: inset");break;case Co.UNDERLINE:s.borderBottomStyle="solid";break;default:break}let E=t.borderColor||null;E?(this.#t=!0,s.borderColor=Me.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):s.borderWidth=0}let c=Me.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:d,pageHeight:u,pageX:h,pageY:g}=i.rawDims;s.left=`${100*(c[0]-h)/d}%`,s.top=`${100*(c[1]-g)/u}%`;let{rotation:v}=t;return t.hasOwnCanvas||v===0?(s.width=`${100*a/d}%`,s.height=`${100*l/u}%`):this.setRotation(v,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;let{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:o,height:s}=ei(this.data.rect),a,l;e%180===0?(a=100*o/n,l=100*s/i):(a=100*s/n,l=100*o/i),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){let e=(t,n,i)=>{let o=i.detail[t],s=o[0],a=o.slice(1);i.target.style[n]=nl[`${s}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[n]:nl[`${s}_rgb`](a)})};return Ke(this,"_commonActions",{display:t=>{let{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{let{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{let n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){let n=this._commonActions;for(let i of Object.keys(t.detail))(e[i]||n[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;let t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;let n=this._commonActions;for(let[i,o]of Object.entries(t)){let s=n[i];if(s){let a={detail:{[i]:o},target:e};s(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:e}=this.data;if(!e)return;let[t,n,i,o]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){let[x,L,E,P]=e.subarray(2,6);if(i===x&&o===L&&t===E&&n===P)return}let{style:s}=this.container,a;if(this.#t){let{borderColor:x,borderWidth:L}=s;s.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${L}">`],this.container.classList.add("hasBorder")}let l=i-t,c=o-n,{svgFactory:d}=this,u=d.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0);let h=d.createElement("defs");u.append(h);let g=d.createElement("clipPath"),v=`clippath_${this.data.id}`;g.setAttribute("id",v),g.setAttribute("clipPathUnits","objectBoundingBox"),h.append(g);for(let x=2,L=e.length;x<L;x+=8){let E=e[x],P=e[x+1],S=e[x+2],w=e[x+3],T=d.createElement("rect"),V=(S-t)/l,B=(o-P)/c,W=(E-S)/l,M=(P-w)/c;T.setAttribute("x",V),T.setAttribute("y",B),T.setAttribute("width",W),T.setAttribute("height",M),g.append(T),a?.push(`<rect vector-effect="non-scaling-stroke" x="${V}" y="${B}" width="${W}" height="${M}"/>`)}this.#t&&(a.push("</g></svg>')"),s.backgroundImage=a.join("")),this.container.append(u),this.container.style.clipPath=`url(#${v})`}_createPopup(){let{data:e}=this,t=this.#n=new jo({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){ft("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){let n=[];if(this._fieldObjects){let i=this._fieldObjects[e];if(i)for(let{page:o,id:s,exportValues:a}of i){if(o===-1||s===t)continue;let l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${s}"]`);if(c&&!$i.has(c)){We(`_getElementsByName - element not allowed: ${s}`);continue}n.push({id:s,exportValue:l,domElement:c})}return n}for(let i of document.getElementsByName(e)){let{exportValue:o}=i,s=i.getAttribute("data-element-id");s!==t&&$i.has(i)&&n.push({id:s,exportValue:o,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(let t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;let{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}},rl=class extends At{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){let{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action),i=!0):e.attachment?(this.#t(n,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(this.#n(n,e.setOCGState),i=!0):e.dest?(this._bindLink(n,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,n=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,n),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");let n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let i of Object.keys(t.actions)){let o=n.get(i);o&&(e[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){let n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){We('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();let{fields:i,refs:o,include:s}=t,a=[];if(i.length!==0||o.length!==0){let d=new Set(o);for(let u of i){let h=this._fieldObjects[u]||[];for(let{id:g}of h)d.add(g)}for(let u of Object.values(this._fieldObjects))for(let h of u)d.has(h.id)===s&&a.push(h)}else for(let d of Object.values(this._fieldObjects))a.push(...d);let l=this.annotationStorage,c=[];for(let d of a){let{id:u}=d;switch(c.push(u),d.type){case"text":{let g=d.defaultValue||"";l.setValue(u,{value:g});break}case"checkbox":case"radiobutton":{let g=d.defaultValue===d.exportValues;l.setValue(u,{value:g});break}case"combobox":case"listbox":{let g=d.defaultValue||"";l.setValue(u,{value:g});break}default:continue}let h=document.querySelector(`[data-element-id="${u}"]`);if(h){if(!$i.has(h)){We(`_bindResetFormAction - element not allowed: ${u}`);continue}}else continue;h.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}},Ah=class extends At{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}},ii=class extends At{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Bt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,o){n.includes("mouse")?e.addEventListener(n,s=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:o(s),shift:s.shiftKey,modifier:this._getKeyModifier(s)}})}):e.addEventListener(n,s=>{if(n==="blur"){if(!t.focused||!s.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:o(s)}})})}_setEventListeners(e,t,n,i){for(let[o,s]of n)(s==="Action"||this.data.actions?.[s])&&((s==="Focus"||s==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,o,s,i),s==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):s==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){let t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Me.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){let t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||a2,o=e.style,s,a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){let c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(c/(ka*i))||1,u=c/d;s=Math.min(i,l(u/ka))}else{let c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);s=Math.min(i,l(c/ka))}o.fontSize=`calc(${s}px * var(--scale-factor))`,o.color=Me.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}},Mh=class extends ii{constructor(e){let t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){let o=this.annotationStorage;for(let s of this._getElementsByName(e.name,e.id))s.domElement&&(s.domElement[t]=n),o.setValue(s.id,{[i]:n})}render(){let e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){let i=e.getValue(t,{value:this.data.fieldValue}),o=i.value||"",s=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;s&&o.length>s&&(o=o.slice(0,s));let a=i.formattedValue||this.data.textContent?.join(`
`)||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));let l={userValue:o,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=a??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",a??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),$i.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=zo,this._setRequired(n,this.data.required),s&&(n.maxLength=s),n.addEventListener("input",d=>{e.setValue(t,{value:d.target.value}),this.setPropertyOnSiblings(n,"value",d.target.value,"value"),l.formattedValue=null}),n.addEventListener("resetform",d=>{let u=this.data.defaultFieldValue??"";n.value=l.userValue=u,l.formattedValue=null});let c=d=>{let{formattedValue:u}=l;u!=null&&(d.target.value=u),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",u=>{if(l.focused)return;let{target:h}=u;l.userValue&&(h.value=l.userValue),l.lastCommittedValue=h.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),n.addEventListener("updatefromsandbox",u=>{this.showElementAndHideCanvas(u.target);let h={value(g){l.userValue=g.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),g.target.value=l.userValue},formattedValue(g){let{formattedValue:v}=g.detail;l.formattedValue=v,v!=null&&g.target!==document.activeElement&&(g.target.value=v),e.setValue(t,{formattedValue:v})},selRange(g){g.target.setSelectionRange(...g.detail.selRange)},charLimit:g=>{let{charLimit:v}=g.detail,{target:x}=g;if(v===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",v);let L=l.userValue;!L||L.length<=v||(L=L.slice(0,v),x.value=l.userValue=L,e.setValue(t,{value:L}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:L,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(h,u)}),n.addEventListener("keydown",u=>{l.commitKey=1;let h=-1;if(u.key==="Escape"?h=0:u.key==="Enter"&&!this.data.multiLine?h=2:u.key==="Tab"&&(l.commitKey=3),h===-1)return;let{value:g}=u.target;l.lastCommittedValue!==g&&(l.lastCommittedValue=g,l.userValue=g,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:h,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}))});let d=c;c=null,n.addEventListener("blur",u=>{if(!l.focused||!u.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);let{value:h}=u.target;l.userValue=h,l.lastCommittedValue!==h&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,willCommit:!0,commitKey:l.commitKey,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}),d(u)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",u=>{l.lastCommittedValue=null;let{data:h,target:g}=u,{value:v,selectionStart:x,selectionEnd:L}=g,E=x,P=L;switch(u.inputType){case"deleteWordBackward":{let S=v.substring(0,x).match(/\w*[^\w]*$/);S&&(E-=S[0].length);break}case"deleteWordForward":{let S=v.substring(x).match(/^[^\w]*\w*/);S&&(P+=S[0].length);break}case"deleteContentBackward":x===L&&(E-=1);break;case"deleteContentForward":x===L&&(P+=1);break}u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,change:h||"",willCommit:!1,selStart:E,selEnd:P}})}),this._setEventListeners(n,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.value)}if(c&&n.addEventListener("blur",c),this.data.comb){let u=(this.data.rect[2]-this.data.rect[0])/s;n.classList.add("comb"),n.style.letterSpacing=`calc(${u}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},Ph=class extends ii{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}},Oh=class extends ii{constructor(e){super(e,{isRenderable:e.renderForms})}render(){let e=this.annotationStorage,t=this.data,n=t.id,i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let o=document.createElement("input");return $i.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,i&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=zo,o.addEventListener("change",s=>{let{name:a,checked:l}=s.target;for(let c of this._getElementsByName(a,n)){let d=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=d),e.setValue(c.id,{value:d})}e.setValue(n,{value:l})}),o.addEventListener("resetform",s=>{let a=t.defaultFieldValue||"Off";s.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",s=>{let a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(n,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,s)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],s=>s.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}},ol=class extends ii{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let e=this.annotationStorage,t=this.data,n=t.id,i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(let s of this._getElementsByName(t.fieldName,n))e.setValue(s.id,{value:!1});let o=document.createElement("input");if($i.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,i&&o.setAttribute("checked",!0),o.tabIndex=zo,o.addEventListener("change",s=>{let{name:a,checked:l}=s.target;for(let c of this._getElementsByName(a,n))e.setValue(c.id,{value:!1});e.setValue(n,{value:l})}),o.addEventListener("resetform",s=>{let a=t.defaultFieldValue;s.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){let s=t.buttonValue;o.addEventListener("updatefromsandbox",a=>{let l={value:c=>{let d=s===c.detail.value;for(let u of this._getElementsByName(c.target.name)){let h=d&&u.id===n;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}},Th=class extends rl{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){let e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");let t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}},Ih=class extends ii{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");$i.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=zo;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{let u=this.data.defaultFieldValue;for(let h of i.options)h.selected=h.value===u});for(let d of this.data.options){let u=document.createElement("option");u.textContent=d.displayValue,u.value=d.exportValue,n.value.includes(d.exportValue)&&(u.setAttribute("selected",!0),o=!1),i.append(u)}let s=null;if(o){let d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),s=()=>{d.remove(),i.removeEventListener("input",s),s=null},i.addEventListener("input",s)}let a=d=>{let u=d?"value":"textContent",{options:h,multiple:g}=i;return g?Array.prototype.filter.call(h,v=>v.selected).map(v=>v[u]):h.selectedIndex===-1?null:h[h.selectedIndex][u]},l=a(!1),c=d=>{let u=d.target.options;return Array.prototype.map.call(u,h=>({displayValue:h.textContent,exportValue:h.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{let u={value(h){s?.();let g=h.detail.value,v=new Set(Array.isArray(g)?g:[g]);for(let x of i.options)x.selected=v.has(x.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(h){i.multiple=!0},remove(h){let g=i.options,v=h.detail.remove;g[v].selected=!1,i.remove(v),g.length>0&&Array.prototype.findIndex.call(g,L=>L.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},clear(h){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(h){let{index:g,displayValue:v,exportValue:x}=h.detail.insert,L=i.children[g],E=document.createElement("option");E.textContent=v,E.value=x,L?L.before(E):i.append(E),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},items(h){let{items:g}=h.detail;for(;i.length!==0;)i.remove(0);for(let v of g){let{displayValue:x,exportValue:L}=v,E=document.createElement("option");E.textContent=x,E.value=L,i.append(E)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},indices(h){let g=new Set(h.detail.indices);for(let v of h.target.options)v.selected=g.has(v.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(h){h.target.disabled=!h.detail.editable}};this._dispatchEventFromSandbox(u,d)}),i.addEventListener("input",d=>{let u=a(!0),h=a(!1);e.setValue(t,{value:u}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:h,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},jo=class extends At{constructor(e){let{data:t,elements:n}=e;super(e,{isRenderable:At._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");let e=this.popup=new kh({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(let n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${Yh}${n}`).join(",")),this.container}},kh=class{#e=this.#T.bind(this);#t=this.#A.bind(this);#n=this.#P.bind(this);#i=this.#E.bind(this);#o=null;#r=null;#l=null;#c=null;#d=null;#a=null;#u=null;#s=!1;#h=null;#p=null;#f=null;#g=null;#_=null;#m=null;#v=!1;constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:o,contentsObj:s,richText:a,parent:l,rect:c,parentRect:d,open:u}){this.#r=e,this.#_=i,this.#l=s,this.#g=a,this.#a=l,this.#o=t,this.#f=c,this.#u=d,this.#d=n,this.#c=Va.toDateObject(o),this.trigger=n.flatMap(h=>h.getElementsToTriggerPopup());for(let h of this.trigger)h.addEventListener("click",this.#i),h.addEventListener("mouseenter",this.#n),h.addEventListener("mouseleave",this.#t),h.classList.add("popupTriggerArea");for(let h of n)h.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,u&&this.#E()}render(){if(this.#h)return;let e=this.#h=document.createElement("div");if(e.className="popup",this.#o){let o=e.style.outlineColor=Me.makeHexColor(...this.#o);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`:e.style.backgroundColor=Me.makeHexColor(...this.#o.map(a=>Math.floor(.7*(255-a)+a)))}let t=document.createElement("span");t.className="header";let n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=this.#_,e.append(t),this.#c){let o=document.createElement("span");o.classList.add("popupDate"),o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),t.append(o)}let i=this.#y;if(i)il.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{let o=this._formatContents(this.#l);e.append(o)}this.#r.append(e)}get#y(){let e=this.#g,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#C(){return this.#y?.attributes?.style?.fontSize||0}get#x(){return this.#y?.attributes?.style?.color||null}#w(e){let t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#x,fontSize:this.#C?`calc(${this.#C}px * var(--scale-factor))`:""}};for(let o of e.split(`
`))t.push({name:"span",value:o,attributes:i});return n}_formatContents({str:e,dir:t}){let n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;let i=e.split(/(?:\r\n?|\n)/);for(let o=0,s=i.length;o<s;++o){let a=i[o];n.append(document.createTextNode(a)),o<s-1&&n.append(document.createElement("br"))}return n}#T(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#s)&&this.#E()}updateEdited({rect:e,popupContent:t}){this.#m||={contentsObj:this.#l,richText:this.#g},e&&(this.#p=null),t&&(this.#g=this.#w(t),this.#l=null),this.#h?.remove(),this.#h=null}resetEdited(){this.#m&&({contentsObj:this.#l,richText:this.#g}=this.#m,this.#m=null,this.#h?.remove(),this.#h=null,this.#p=null)}#M(){if(this.#p!==null)return;let{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:o}}}=this.#a,s=!!this.#u,a=s?this.#u:this.#f;for(let v of this.#d)if(!a||Me.intersect(v.data.rect,a)!==null){a=v.data.rect,s=!0;break}let l=Me.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=s?a[2]-a[0]+5:0,u=l[0]+d,h=l[1];this.#p=[100*(u-i)/t,100*(h-o)/n];let{style:g}=this.#r;g.left=`${this.#p[0]}%`,g.top=`${this.#p[1]}%`}#E(){this.#s=!this.#s,this.#s?(this.#P(),this.#r.addEventListener("click",this.#i),this.#r.addEventListener("keydown",this.#e)):(this.#A(),this.#r.removeEventListener("click",this.#i),this.#r.removeEventListener("keydown",this.#e))}#P(){this.#h||this.render(),this.isVisible?this.#s&&this.#r.classList.add("focused"):(this.#M(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#A(){this.#r.classList.remove("focused"),!(this.#s||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#v=this.isVisible,this.#v&&(this.#r.hidden=!0)}maybeShow(){this.#v&&(this.#h||this.#P(),this.#v=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}},sl=class extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=qe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(let t of this.textContent){let n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},Rh=class extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let e=this.data,{width:t,height:n}=ei(e.rect),i=this.svgFactory.create(t,n,!0),o=this.#e=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},Lh=class extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let e=this.data,{width:t,height:n}=ei(e.rect),i=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,s=this.#e=this.svgFactory.createElement("svg:rect");return s.setAttribute("x",o/2),s.setAttribute("y",o/2),s.setAttribute("width",t-o),s.setAttribute("height",n-o),s.setAttribute("stroke-width",o||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},Dh=class extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let e=this.data,{width:t,height:n}=ei(e.rect),i=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,s=this.#e=this.svgFactory.createElement("svg:ellipse");return s.setAttribute("cx",t/2),s.setAttribute("cy",n/2),s.setAttribute("rx",t/2-o/2),s.setAttribute("ry",n/2-o/2),s.setAttribute("stroke-width",o||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},al=class extends At{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,vertices:t,borderStyle:n,popupRef:i}}=this;if(!t)return this.container;let{width:o,height:s}=ei(e),a=this.svgFactory.create(o,s,!0),l=[];for(let d=0,u=t.length;d<u;d+=2){let h=t[d]-e[0],g=e[3]-t[d+1];l.push(`${h},${g}`)}l=l.join(" ");let c=this.#e=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",n.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},Fh=class extends al{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},Nh=class extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},Vo=class extends At{#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?qe.HIGHLIGHT:qe.INK}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,inkLists:t,borderStyle:n,popupRef:i}}=this,{width:o,height:s}=ei(e),a=this.svgFactory.create(o,s,!0);for(let l of t){let c=[];for(let u=0,h=l.length;u<h;u+=2){let g=l[u]-e[0],v=e[3]-l[u+1];c.push(`${g},${v}`)}c=c.join(" ");let d=this.svgFactory.createElement(this.svgElementName);this.#e.push(d),d.setAttribute("points",c),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),a.append(d)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(a),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},ll=class extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=qe.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}},Bh=class extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},jh=class extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},Vh=class extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},cl=class extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=qe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},Uh=class extends At{#e=null;constructor(e){super(e,{isRenderable:!0});let{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",it({source:this},t))}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:e,data:t}=this,n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;let{isMac:i}=Bt.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(i?o.metaKey:o.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},zh=class{#e=null;#t=null;#n=new Map;#i=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:o,viewport:s,structTreeLayer:a}){this.div=e,this.#e=t,this.#t=n,this.#i=a||null,this.page=o,this.viewport=s,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}#o(e,t){return G(this,null,function*(){let n=e.firstChild||e,i=n.id=`${Yh}${t}`,o=yield this.#i?.getAriaAttributes(i);if(o)for(let[s,a]of o)n.setAttribute(s,a);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,n,!1)})}render(e){return G(this,null,function*(){let{annotations:t}=e,n=this.div;Wi(n,this.viewport);let i=new Map,o={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Bo,annotationStorage:e.annotationStorage||new Lo,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(let s of t){if(s.noHTML)continue;let a=s.annotationType===Rt.POPUP;if(a){let d=i.get(s.id);if(!d)continue;o.elements=d}else{let{width:d,height:u}=ei(s.rect);if(d<=0||u<=0)continue}o.data=s;let l=Sh.create(o);if(!l.isRenderable)continue;if(!a&&s.popupRef){let d=i.get(s.popupRef);d?d.push(l):i.set(s.popupRef,[l])}let c=l.render();s.hidden&&(c.style.visibility="hidden"),yield this.#o(c,s.id),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#r()})}update({viewport:e}){let t=this.div;this.viewport=e,Wi(t,{rotation:e.rotation}),this.#r(),t.hidden=!1}#r(){if(!this.#t)return;let e=this.div;for(let[t,n]of this.#t){let i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;n.className="annotationContent";let{firstChild:o}=i;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):i.append(n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}},Ia=/\r\n?|\n/g,qh=class r extends st{#e;#t="";#n=`${this.id}-editor`;#i=null;#o;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let e=r.prototype,t=o=>o.isEmpty(),n=Ro.TRANSLATE_SMALL,i=Ro.TRANSLATE_BIG;return Ke(this,"_keyboardManager",new Gi([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=qe.FREETEXT;constructor(e){super(Ft(it({},e),{name:"freeTextEditor"})),this.#e=e.color||r._defaultColor||st._defaultLineColor,this.#o=e.fontSize||r._defaultFontSize}static initialize(e,t){st.initialize(e,t);let n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Fe.FREETEXT_SIZE:r._defaultFontSize=t;break;case Fe.FREETEXT_COLOR:r._defaultColor=t;break}}updateParams(e,t){switch(e){case Fe.FREETEXT_SIZE:this.#r(t);break;case Fe.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[Fe.FREETEXT_SIZE,r._defaultFontSize],[Fe.FREETEXT_COLOR,r._defaultColor||st._defaultLineColor]]}get propertiesToUpdate(){return[[Fe.FREETEXT_SIZE,this.#o],[Fe.FREETEXT_COLOR,this.#e]]}#r(e){let t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-this.#o)*this.parentScale),this.#o=i,this.#d()},n=this.#o;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){let t=i=>{this.#e=this.editorDiv.style.color=i},n=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){let e=this.parentScale;return[-r._internalPadding*e,-(r._internalPadding+this.#o)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(qe.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;let e=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#c(){let e=[];this.editorDiv.normalize();let t=null;for(let n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(r.#a(n)),t=n);return e.join(`
`)}#d(){let[e,t]=this.parentDimensions,n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{let{currentLayer:i,div:o}=this,s=o.style.display,a=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",i.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=s,o.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let e=this.#t,t=this.#t=this.#c().trimEnd();if(e===t)return;let n=i=>{if(this.#t=i,!i){this.remove();return}this.#u(),this._uiManager.rebuild(this),this.#d()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){r._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;let{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#o}px * var(--scale-factor))`,n.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Ua(this,this.div,["dblclick","keydown"]),this.width){let[i,o]=this.parentDimensions;if(this.annotationElementId){let{position:s}=this._initialData,[a,l]=this.getInitialTranslation();[a,l]=this.pageTranslationToScreen(a,l);let[c,d]=this.pageDimensions,[u,h]=this.pageTranslation,g,v;switch(this.rotation){case 0:g=e+(s[0]-u)/c,v=t+this.height-(s[1]-h)/d;break;case 90:g=e+(s[0]-u)/c,v=t-(s[1]-h)/d,[a,l]=[l,-a];break;case 180:g=e-this.width+(s[0]-u)/c,v=t-(s[1]-h)/d,[a,l]=[-a,-l];break;case 270:g=e+(s[0]-u-this.height*d)/c,v=t+(s[1]-h-this.width*c)/d,[a,l]=[-l,a];break}this.setAt(g*i,v*o,a,l)}else this.setAt(e*i,t*o,this.width*i,this.height*o);this.#u(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#a(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ia,"")}editorDivPaste(e){let t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();let i=r.#h(t.getData("text")||"").replaceAll(Ia,`
`);if(!i)return;let o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();let s=o.getRangeAt(0);if(!i.includes(`
`)){s.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),o.collapseToStart();return}let{startContainer:a,startOffset:l}=s,c=[],d=[];if(a.nodeType===Node.TEXT_NODE){let g=a.parentElement;if(d.push(a.nodeValue.slice(l).replaceAll(Ia,"")),g!==this.editorDiv){let v=c;for(let x of this.editorDiv.childNodes){if(x===g){v=d;continue}v.push(r.#a(x))}}c.push(a.nodeValue.slice(0,l).replaceAll(Ia,""))}else if(a===this.editorDiv){let g=c,v=0;for(let x of this.editorDiv.childNodes)v++===l&&(g=d),g.push(r.#a(x))}this.#t=`${c.join(`
`)}${i}${d.join(`
`)}`,this.#u();let u=new Range,h=c.reduce((g,v)=>g+v.length,0);for(let{firstChild:g}of this.editorDiv.childNodes)if(g.nodeType===Node.TEXT_NODE){let v=g.nodeValue.length;if(h<=v){u.setStart(g,h),u.setEnd(g,h);break}h-=v}o.removeAllRanges(),o.addRange(u)}#u(){if(this.editorDiv.replaceChildren(),!!this.#t)for(let e of this.#t.split(`
`)){let t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#s(){return this.#t.replaceAll("\xA0"," ")}static#h(e){return e.replaceAll(" ","\xA0")}get contentDiv(){return this.editorDiv}static deserialize(e,t,n){return G(this,null,function*(){let i=null;if(e instanceof sl){let{data:{defaultAppearanceData:{fontSize:s,fontColor:a},rect:l,rotation:c,id:d,popupRef:u},textContent:h,textPosition:g,parent:{page:{pageNumber:v}}}=e;if(!h||h.length===0)return null;i=e={annotationType:qe.FREETEXT,color:Array.from(a),fontSize:s,value:h.join(`
`),position:g,pageIndex:v-1,rect:l.slice(0),rotation:c,id:d,deleted:!1,popupRef:u}}let o=yield ir(r,this,"deserialize").call(this,e,t,n);return o.#o=e.fontSize,o.#e=Me.makeHexColor(...e.color),o.#t=r.#h(e.value),o.annotationElementId=e.id||null,o._initialData=i,o})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let t=r._internalPadding*this.parentScale,n=this.getRect(t,t),i=st._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),o={annotationType:qe.FREETEXT,color:i,fontSize:this.#o,value:this.#s(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!this.#p(o)?null:(o.id=this.annotationElementId,o)}#p(e){let{value:t,fontSize:n,color:i,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((s,a)=>s!==i[a])||e.pageIndex!==o}renderAnnotationElement(e){let t=super.renderAnnotationElement(e);if(this.deleted)return t;let{style:n}=t;n.fontSize=`calc(${this.#o}px * var(--scale-factor))`,n.color=this.#e,t.replaceChildren();for(let o of this.#t.split(`
`)){let s=document.createElement("div");s.append(o?document.createTextNode(o):document.createElement("br")),t.append(s)}let i=r._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},dl=class{toSVGPath(){ft("Abstract method `toSVGPath` must be implemented.")}get box(){ft("Abstract getter `box` must be implemented.")}serialize(e,t){ft("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){ft("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){ft("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}},ul=class r{#e;#t=[];#n;#i;#o=[];#r=new Float64Array(18);#l;#c;#d;#a;#u;#s;#h=[];static#p=8;static#f=2;static#g=r.#p+r.#f;constructor({x:e,y:t},n,i,o,s,a=0){this.#e=n,this.#s=o*i,this.#i=s,this.#r.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=a,this.#a=r.#p*i,this.#d=r.#g*i,this.#u=i,this.#h.push(e,t)}isEmpty(){return isNaN(this.#r[8])}#_(){let e=this.#r.subarray(4,6),t=this.#r.subarray(16,18),[n,i,o,s]=this.#e;return[(this.#l+(e[0]-t[0])/2-n)/o,(this.#c+(e[1]-t[1])/2-i)/s,(this.#l+(t[0]-e[0])/2-n)/o,(this.#c+(t[1]-e[1])/2-i)/s]}add({x:e,y:t}){this.#l=e,this.#c=t;let[n,i,o,s]=this.#e,[a,l,c,d]=this.#r.subarray(8,12),u=e-c,h=t-d,g=Math.hypot(u,h);if(g<this.#d)return!1;let v=g-this.#a,x=v/g,L=x*u,E=x*h,P=a,S=l;a=c,l=d,c+=L,d+=E,this.#h?.push(e,t);let w=-E/v,T=L/v,V=w*this.#s,B=T*this.#s;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([c+V,d+B],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([c-V,d-B],16),isNaN(this.#r[6])?(this.#o.length===0&&(this.#r.set([a+V,l+B],2),this.#o.push(NaN,NaN,NaN,NaN,(a+V-n)/o,(l+B-i)/s),this.#r.set([a-V,l-B],14),this.#t.push(NaN,NaN,NaN,NaN,(a-V-n)/o,(l-B-i)/s)),this.#r.set([P,S,a,l,c,d],6),!this.isEmpty()):(this.#r.set([P,S,a,l,c,d],6),Math.abs(Math.atan2(S-l,P-a)-Math.atan2(E,L))<Math.PI/2?([a,l,c,d]=this.#r.subarray(2,6),this.#o.push(NaN,NaN,NaN,NaN,((a+c)/2-n)/o,((l+d)/2-i)/s),[a,l,P,S]=this.#r.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((P+a)/2-n)/o,((S+l)/2-i)/s),!0):([P,S,a,l,c,d]=this.#r.subarray(0,6),this.#o.push(((P+5*a)/6-n)/o,((S+5*l)/6-i)/s,((5*a+c)/6-n)/o,((5*l+d)/6-i)/s,((a+c)/2-n)/o,((l+d)/2-i)/s),[c,d,a,l,P,S]=this.#r.subarray(12,18),this.#t.push(((P+5*a)/6-n)/o,((S+5*l)/6-i)/s,((5*a+c)/6-n)/o,((5*l+d)/6-i)/s,((a+c)/2-n)/o,((l+d)/2-i)/s),!0))}toSVGPath(){if(this.isEmpty())return"";let e=this.#o,t=this.#t;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#m();let n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#y(n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#v(n),n.join(" ")}#m(){let[e,t,n,i]=this.#e,[o,s,a,l]=this.#_();return`M${(this.#r[2]-e)/n} ${(this.#r[3]-t)/i} L${(this.#r[4]-e)/n} ${(this.#r[5]-t)/i} L${o} ${s} L${a} ${l} L${(this.#r[16]-e)/n} ${(this.#r[17]-t)/i} L${(this.#r[14]-e)/n} ${(this.#r[15]-t)/i} Z`}#v(e){let t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#y(e){let[t,n,i,o]=this.#e,s=this.#r.subarray(4,6),a=this.#r.subarray(16,18),[l,c,d,u]=this.#_();e.push(`L${(s[0]-t)/i} ${(s[1]-n)/o} L${l} ${c} L${d} ${u} L${(a[0]-t)/i} ${(a[1]-n)/o}`)}newFreeDrawOutline(e,t,n,i,o,s){return new hl(e,t,n,i,o,s)}getOutlines(){let e=this.#o,t=this.#t,n=this.#r,[i,o,s,a]=this.#e,l=new Float64Array((this.#h?.length??0)+2);for(let u=0,h=l.length-2;u<h;u+=2)l[u]=(this.#h[u]-i)/s,l[u+1]=(this.#h[u+1]-o)/a;if(l[l.length-2]=(this.#l-i)/s,l[l.length-1]=(this.#c-o)/a,isNaN(n[6])&&!this.isEmpty())return this.#C(l);let c=new Float64Array(this.#o.length+24+this.#t.length),d=e.length;for(let u=0;u<d;u+=2){if(isNaN(e[u])){c[u]=c[u+1]=NaN;continue}c[u]=e[u],c[u+1]=e[u+1]}d=this.#w(c,d);for(let u=t.length-6;u>=6;u-=6)for(let h=0;h<6;h+=2){if(isNaN(t[u+h])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=t[u+h],c[d+1]=t[u+h+1],d+=2}return this.#x(c,d),this.newFreeDrawOutline(c,l,this.#e,this.#u,this.#n,this.#i)}#C(e){let t=this.#r,[n,i,o,s]=this.#e,[a,l,c,d]=this.#_(),u=new Float64Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-i)/s,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-i)/s,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-i)/s,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-i)/s],0),this.newFreeDrawOutline(u,e,this.#e,this.#u,this.#n,this.#i)}#x(e,t){let n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#w(e,t){let n=this.#r.subarray(4,6),i=this.#r.subarray(16,18),[o,s,a,l]=this.#e,[c,d,u,h]=this.#_();return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/a,(n[1]-s)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(i[0]-o)/a,(i[1]-s)/l],t),t+=24}},hl=class extends dl{#e;#t=null;#n;#i;#o;#r;#l;constructor(e,t,n,i,o,s){super(),this.#l=e,this.#o=t,this.#e=n,this.#r=i,this.#n=o,this.#i=s,this.#a(s);let{x:a,y:l,width:c,height:d}=this.#t;for(let u=0,h=e.length;u<h;u+=2)e[u]=(e[u]-a)/c,e[u+1]=(e[u+1]-l)/d;for(let u=0,h=t.length;u<h;u+=2)t[u]=(t[u]-a)/c,t[u+1]=(t[u+1]-l)/d}toSVGPath(){let e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,n=this.#l.length;t<n;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,i],o){let s=n-e,a=i-t,l,c;switch(o){case 0:l=this.#c(this.#l,e,i,s,-a),c=this.#c(this.#o,e,i,s,-a);break;case 90:l=this.#d(this.#l,e,t,s,a),c=this.#d(this.#o,e,t,s,a);break;case 180:l=this.#c(this.#l,n,t,-s,a),c=this.#c(this.#o,n,t,-s,a);break;case 270:l=this.#d(this.#l,n,i,-s,-a),c=this.#d(this.#o,n,i,-s,-a);break}return{outline:Array.from(l),points:[Array.from(c)]}}#c(e,t,n,i,o){let s=new Float64Array(e.length);for(let a=0,l=e.length;a<l;a+=2)s[a]=t+e[a]*i,s[a+1]=n+e[a+1]*o;return s}#d(e,t,n,i,o){let s=new Float64Array(e.length);for(let a=0,l=e.length;a<l;a+=2)s[a]=t+e[a+1]*i,s[a+1]=n+e[a]*o;return s}#a(e){let t=this.#l,n=t[4],i=t[5],o=n,s=i,a=n,l=i,c=n,d=i,u=e?Math.max:Math.min;for(let L=6,E=t.length;L<E;L+=6){if(isNaN(t[L]))o=Math.min(o,t[L+4]),s=Math.min(s,t[L+5]),a=Math.max(a,t[L+4]),l=Math.max(l,t[L+5]),d<t[L+5]?(c=t[L+4],d=t[L+5]):d===t[L+5]&&(c=u(c,t[L+4]));else{let P=Me.bezierBoundingBox(n,i,...t.slice(L,L+6));o=Math.min(o,P[0]),s=Math.min(s,P[1]),a=Math.max(a,P[2]),l=Math.max(l,P[3]),d<P[3]?(c=P[2],d=P[3]):d===P[3]&&(c=u(c,P[2]))}n=t[L+4],i=t[L+5]}let h=o-this.#n,g=s-this.#n,v=a-o+2*this.#n,x=l-s+2*this.#n;this.#t={x:h,y:g,width:v,height:x,lastPoint:[c,d]}}get box(){return this.#t}newOutliner(e,t,n,i,o,s=0){return new ul(e,t,n,i,o,s)}getNewOutline(e,t){let{x:n,y:i,width:o,height:s}=this.#t,[a,l,c,d]=this.#e,u=o*c,h=s*d,g=n*c+a,v=i*d+l,x=this.newOutliner({x:this.#o[0]*u+g,y:this.#o[1]*h+v},this.#e,this.#r,e,this.#i,t??this.#n);for(let L=2;L<this.#o.length;L+=2)x.add({x:this.#o[L]*u+g,y:this.#o[L+1]*h+v});return x.getOutlines()}get mustRemoveSelfIntersections(){return!0}},fl=class{#e;#t=[];#n=[];constructor(e,t=0,n=0,i=!0){let o=1/0,s=-1/0,a=1/0,l=-1/0,d=10**-4;for(let{x:E,y:P,width:S,height:w}of e){let T=Math.floor((E-t)/d)*d,V=Math.ceil((E+S+t)/d)*d,B=Math.floor((P-t)/d)*d,W=Math.ceil((P+w+t)/d)*d,M=[T,B,W,!0],q=[V,B,W,!1];this.#t.push(M,q),o=Math.min(o,T),s=Math.max(s,V),a=Math.min(a,B),l=Math.max(l,W)}let u=s-o+2*n,h=l-a+2*n,g=o-n,v=a-n,x=this.#t.at(i?-1:-2),L=[x[0],x[2]];for(let E of this.#t){let[P,S,w]=E;E[0]=(P-g)/u,E[1]=(S-v)/h,E[2]=(w-v)/h}this.#e={x:g,y:v,width:u,height:h,lastPoint:L}}getOutlines(){this.#t.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);let e=[];for(let t of this.#t)t[3]?(e.push(...this.#c(t)),this.#r(t)):(this.#l(t),e.push(...this.#c(t)));return this.#i(e)}#i(e){let t=[],n=new Set;for(let s of e){let[a,l,c]=s;t.push([a,l,s],[a,c,s])}t.sort((s,a)=>s[1]-a[1]||s[0]-a[0]);for(let s=0,a=t.length;s<a;s+=2){let l=t[s][2],c=t[s+1][2];l.push(c),c.push(l),n.add(l),n.add(c)}let i=[],o;for(;n.size>0;){let s=n.values().next().value,[a,l,c,d,u]=s;n.delete(s);let h=a,g=l;for(o=[a,c],i.push(o);;){let v;if(n.has(d))v=d;else if(n.has(u))v=u;else break;n.delete(v),[a,l,c,d,u]=v,h!==a&&(o.push(h,g,a,g===l?l:c),h=a),g=g===l?c:l}o.push(h,g)}return new Hh(i,this.#e)}#o(e){let t=this.#n,n=0,i=t.length-1;for(;n<=i;){let o=n+i>>1,s=t[o][0];if(s===e)return o;s<e?n=o+1:i=o-1}return i+1}#r([,e,t]){let n=this.#o(e);this.#n.splice(n,0,[e,t])}#l([,e,t]){let n=this.#o(e);for(let i=n;i<this.#n.length;i++){let[o,s]=this.#n[i];if(o!==e)break;if(o===e&&s===t){this.#n.splice(i,1);return}}for(let i=n-1;i>=0;i--){let[o,s]=this.#n[i];if(o!==e)break;if(o===e&&s===t){this.#n.splice(i,1);return}}}#c(e){let[t,n,i]=e,o=[[t,n,i]],s=this.#o(i);for(let a=0;a<s;a++){let[l,c]=this.#n[a];for(let d=0,u=o.length;d<u;d++){let[,h,g]=o[d];if(!(c<=h||g<=l)){if(h>=l){if(g>c)o[d][1]=c;else{if(u===1)return[];o.splice(d,1),d--,u--}continue}o[d][2]=l,g>c&&o.push([t,c,g])}}}return o}},Hh=class extends dl{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}toSVGPath(){let e=[];for(let t of this.#t){let[n,i]=t;e.push(`M${n} ${i}`);for(let o=2;o<t.length;o+=2){let s=t[o],a=t[o+1];s===n?(e.push(`V${a}`),i=a):a===i&&(e.push(`H${s}`),n=s)}e.push("Z")}return e.join(" ")}serialize([e,t,n,i],o){let s=[],a=n-e,l=i-t;for(let c of this.#t){let d=new Array(c.length);for(let u=0;u<c.length;u+=2)d[u]=e+c[u]*a,d[u+1]=i-c[u+1]*l;s.push(d)}return s}get box(){return this.#e}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}},Uo=class extends ul{newFreeDrawOutline(e,t,n,i,o,s){return new Wh(e,t,n,i,o,s)}get classNamesForDrawing(){return["highlight","free"]}},Wh=class extends hl{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(e,t,n,i,o,s=0){return new Uo(e,t,n,i,o,s)}},pl=class r{#e=null;#t=null;#n;#i=null;#o=!1;#r=!1;#l=null;#c;#d=null;#a=null;#u;static#s=null;static get _keyboardManager(){return Ke(this,"_keyboardManager",new Gi([[["Escape","mac+Escape"],r.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],r.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],r.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],r.prototype._moveToPrevious],[["Home","mac+Home"],r.prototype._moveToBeginning],[["End","mac+End"],r.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#r=!1,this.#u=Fe.HIGHLIGHT_COLOR,this.#l=e):(this.#r=!0,this.#u=Fe.HIGHLIGHT_DEFAULT_COLOR),this.#a=e?._uiManager||t,this.#c=this.#a._eventBus,this.#n=e?.color||this.#a?.highlightColors.values().next().value||"#FFFF98",r.#s||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){let e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);let t=this.#a._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#f.bind(this),{signal:t});let n=this.#t=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#n,e.append(n),e}renderMainDropdown(){let e=this.#i=this.#h();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#h(){let e=document.createElement("div"),t=this.#a._signal;e.addEventListener("contextmenu",vn,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(let[n,i]of this.#a.highlightColors){let o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",i),o.title=n,o.setAttribute("data-l10n-id",r.#s[n]);let s=document.createElement("span");o.append(s),s.className="swatch",s.style.backgroundColor=i,o.setAttribute("aria-selected",i===this.#n),o.addEventListener("click",this.#p.bind(this,i),{signal:t}),e.append(o)}return e.addEventListener("keydown",this.#f.bind(this),{signal:t}),e}#p(e,t){t.stopPropagation(),this.#c.dispatch("switchannotationeditorparams",{source:this,type:this.#u,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}let t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#m){this.#g(e);return}if(e.target===this.#e){this.#i.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#i?.firstChild||e.target===this.#e){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#m){this.#g(e);return}this.#i.firstChild?.focus()}_moveToEnd(e){if(!this.#m){this.#g(e);return}this.#i.lastChild?.focus()}#f(e){r._keyboardManager.exec(this,e)}#g(e){if(this.#m){this.hideDropdown();return}if(this.#o=e.detail===0,this.#d||(this.#d=new AbortController,window.addEventListener("pointerdown",this.#_.bind(this),{signal:this.#a.combinedSignal(this.#d)})),this.#i){this.#i.classList.remove("hidden");return}let t=this.#i=this.#h();this.#e.append(t)}#_(e){this.#i?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#d?.abort(),this.#d=null}get#m(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#m){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#o})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#i)return;let t=this.#a.highlightColors.values();for(let n of this.#i.children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#i?.remove(),this.#i=null}},gl=class r extends st{#e=null;#t=0;#n;#i=null;#o=null;#r=null;#l=null;#c=0;#d=null;#a=null;#u=null;#s=!1;#h=null;#p;#f=null;#g="";#_;#m="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=qe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){let e=r.prototype;return Ke(this,"_keyboardManager",new Gi([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(Ft(it({},e),{name:"highlightEditor"})),this.color=e.color||r._defaultColor,this.#_=e.thickness||r._defaultThickness,this.#p=e.opacity||r._defaultOpacity,this.#n=e.boxes||null,this.#m=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#s=!0,this.#y(e),this.#M()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#c=e.focusOffset,this.#v(),this.#M(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#s?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#_,methodOfCreation:this.#m}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#v(){let e=new fl(this.#n,.001);this.#a=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#a.box;let t=new fl(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=t.getOutlines();let{lastPoint:n}=this.#r.box;this.#h=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#y({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#a=e;let i=1.5;if(this.#r=e.getNewOutline(this.#_/2+i,.0025),t>=0)this.#u=t,this.#i=n,this.parent.drawLayer.finalizeLine(t,e),this.#f=this.parent.drawLayer.drawOutline(this.#r);else if(this.parent){let d=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#u,e),this.parent.drawLayer.updateBox(this.#u,r.#E(this.#a.box,(d-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#f,this.#r),this.parent.drawLayer.updateBox(this.#f,r.#E(this.#r.box,d))}let{x:o,y:s,width:a,height:l}=e.box;switch(this.rotation){case 0:this.x=o,this.y=s,this.width=a,this.height=l;break;case 90:{let[d,u]=this.parentDimensions;this.x=s,this.y=1-o,this.width=a*u/d,this.height=l*d/u;break}case 180:this.x=1-o,this.y=1-s,this.width=a,this.height=l;break;case 270:{let[d,u]=this.parentDimensions;this.x=1-s,this.y=o,this.width=a*u/d,this.height=l*d/u;break}}let{lastPoint:c}=this.#r.box;this.#h=[(c[0]-o)/a,(c[1]-s)/l]}static initialize(e,t){st.initialize(e,t),r._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Fe.HIGHLIGHT_DEFAULT_COLOR:r._defaultColor=t;break;case Fe.HIGHLIGHT_THICKNESS:r._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#h}updateParams(e,t){switch(e){case Fe.HIGHLIGHT_COLOR:this.#C(t);break;case Fe.HIGHLIGHT_THICKNESS:this.#x(t);break}}static get defaultPropertiesToUpdate(){return[[Fe.HIGHLIGHT_DEFAULT_COLOR,r._defaultColor],[Fe.HIGHLIGHT_THICKNESS,r._defaultThickness]]}get propertiesToUpdate(){return[[Fe.HIGHLIGHT_COLOR,this.color||r._defaultColor],[Fe.HIGHLIGHT_THICKNESS,this.#_||r._defaultThickness],[Fe.HIGHLIGHT_FREE,this.#s]]}#C(e){let t=(o,s)=>{this.color=o,this.parent?.drawLayer.changeColor(this.#u,o),this.#o?.updateColor(o),this.#p=s,this.parent?.drawLayer.changeOpacity(this.#u,s)},n=this.color,i=this.#p;this.addCommands({cmd:t.bind(this,e,r._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#x(e){let t=this.#_,n=i=>{this.#_=i,this.#w(i)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}addEditToolbar(){return G(this,null,function*(){let e=yield ir(r.prototype,this,"addEditToolbar").call(this);return e?(this._uiManager.highlightColors&&(this.#o=new pl({editor:this}),e.addColorPicker(this.#o)),e):null})}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#I())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#I())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#M(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#T():e&&(this.#M(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#w(e){if(!this.#s)return;this.#y({highlightOutlines:this.#a.getNewOutline(e/2)}),this.fixAndSetPosition();let[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}#T(){this.#u===null||!this.parent||(this.parent.drawLayer.remove(this.#u),this.#u=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#M(e=this.parent){this.#u===null&&({id:this.#u,clipPathId:this.#i}=e.drawLayer.draw(this.#a,this.color,this.#p),this.#f=e.drawLayer.drawOutline(this.#r),this.#d&&(this.#d.style.clipPath=this.#i))}static#E({x:e,y:t,width:n,height:i},o){switch(o){case 90:return{x:1-t-i,y:e,width:i,height:n};case 180:return{x:1-e-n,y:1-t-i,width:n,height:i};case 270:return{x:t,y:1-e-n,width:i,height:n}}return{x:e,y:t,width:n,height:i}}rotate(e){let{drawLayer:t}=this.parent,n;this.#s?(e=(e-this.rotation+360)%360,n=r.#E(this.#a.box,e)):n=r.#E(this,e),t.rotate(this.#u,e),t.rotate(this.#f,e),t.updateBox(this.#u,n),t.updateBox(this.#f,r.#E(this.#r.box,e))}render(){if(this.div)return this.div;let e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#s?e.classList.add("free"):this.div.addEventListener("keydown",this.#P.bind(this),{signal:this._uiManager._signal});let t=this.#d=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#i;let[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),Ua(this,this.#d,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(this.#f,"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(this.#f,"hovered")}#P(e){r._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#A(!0);break;case 1:case 3:this.#A(!1);break}}#A(e){if(!this.#e)return;let t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#c)}select(){super.select(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"hovered"),this.parent?.drawLayer.addClass(this.#f,"selected"))}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"selected"),this.#s||this.#A(!1))}get _mustFixPosition(){return!this.#s}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(this.#u,e),this.parent.drawLayer.show(this.#f,e))}#I(){return this.#s?this.rotation:0}#R(){if(this.#s)return null;let[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,o=this.#n,s=new Float32Array(o.length*8),a=0;for(let{x:l,y:c,width:d,height:u}of o){let h=l*e+n,g=(1-c-u)*t+i;s[a]=s[a+4]=h,s[a+1]=s[a+3]=g,s[a+2]=s[a+6]=h+d*e,s[a+5]=s[a+7]=g+u*t,a+=8}return s}#S(e){return this.#a.serialize(e,this.#I())}static startHighlighting(e,t,{target:n,x:i,y:o}){let{x:s,y:a,width:l,height:c}=n.getBoundingClientRect(),d=new AbortController,u=e.combinedSignal(d),h=v=>{v.preventDefault(),v.stopPropagation()},g=v=>{d.abort(),this.#O(e,v)};window.addEventListener("blur",g,{signal:u}),window.addEventListener("pointerup",g,{signal:u}),window.addEventListener("pointerdown",h,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",vn,{signal:u}),n.addEventListener("pointermove",this.#b.bind(this,e),{signal:u}),this._freeHighlight=new Uo({x:i,y:o},[s,a,l,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#b(e,t){this._freeHighlight.add(t)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#O(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(e,t,n){return G(this,null,function*(){let i=null;if(e instanceof ll){let{data:{quadPoints:v,rect:x,rotation:L,id:E,color:P,opacity:S,popupRef:w},parent:{page:{pageNumber:T}}}=e;i=e={annotationType:qe.HIGHLIGHT,color:Array.from(P),opacity:S,quadPoints:v,boxes:null,pageIndex:T-1,rect:x.slice(0),rotation:L,id:E,deleted:!1,popupRef:w}}else if(e instanceof Vo){let{data:{inkLists:v,rect:x,rotation:L,id:E,color:P,borderStyle:{rawWidth:S},popupRef:w},parent:{page:{pageNumber:T}}}=e;i=e={annotationType:qe.HIGHLIGHT,color:Array.from(P),thickness:S,inkLists:v,boxes:null,pageIndex:T-1,rect:x.slice(0),rotation:L,id:E,deleted:!1,popupRef:w}}let{color:o,quadPoints:s,inkLists:a,opacity:l}=e,c=yield ir(r,this,"deserialize").call(this,e,t,n);c.color=Me.makeHexColor(...o),c.#p=l||1,a&&(c.#_=e.thickness),c.annotationElementId=e.id||null,c._initialData=i;let[d,u]=c.pageDimensions,[h,g]=c.pageTranslation;if(s){let v=c.#n=[];for(let x=0;x<s.length;x+=8)v.push({x:(s[x]-h)/d,y:1-(s[x+1]-g)/u,width:(s[x+2]-s[x])/d,height:(s[x+1]-s[x+5])/u});c.#v(),c.#M(),c.rotate(c.rotation)}else if(a){c.#s=!0;let v=a[0],x={x:v[0]-h,y:u-(v[1]-g)},L=new Uo(x,[0,0,d,u],1,c.#_/2,!0,.001);for(let S=0,w=v.length;S<w;S+=2)x.x=v[S]-h,x.y=u-(v[S+1]-g),L.add(x);let{id:E,clipPathId:P}=t.drawLayer.draw(L,c.color,c._defaultOpacity,!0);c.#y({highlightOutlines:L.getOutlines(),highlightId:E,clipPathId:P}),c.#M()}return c})}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();let t=this.getRect(0,0),n=st._colorManager.convert(this.color),i={annotationType:qe.HIGHLIGHT,color:n,opacity:this.#p,thickness:this.#_,quadPoints:this.#R(),outlines:this.#S(t),pageIndex:this.pageIndex,rect:t,rotation:this.#I(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#k(i)?null:(i.id=this.annotationElementId,i)}#k(e){let{color:t}=this._initialData;return e.color.some((n,i)=>n!==t[i])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}},Gh=class r extends st{#e=0;#t=0;#n=null;#i=new Path2D;#o=!1;#r=null;#l=!1;#c=!1;#d=null;#a=null;#u=0;#s=0;#h=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=qe.INK;constructor(e){super(Ft(it({},e),{name:"inkEditor"})),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,t){st.initialize(e,t)}static updateDefaultParams(e,t){switch(e){case Fe.INK_THICKNESS:r._defaultThickness=t;break;case Fe.INK_COLOR:r._defaultColor=t;break;case Fe.INK_OPACITY:r._defaultOpacity=t/100;break}}updateParams(e,t){switch(e){case Fe.INK_THICKNESS:this.#p(t);break;case Fe.INK_COLOR:this.#f(t);break;case Fe.INK_OPACITY:this.#g(t);break}}static get defaultPropertiesToUpdate(){return[[Fe.INK_THICKNESS,r._defaultThickness],[Fe.INK_COLOR,r._defaultColor||st._defaultLineColor],[Fe.INK_OPACITY,Math.round(r._defaultOpacity*100)]]}get propertiesToUpdate(){return[[Fe.INK_THICKNESS,this.thickness||r._defaultThickness],[Fe.INK_COLOR,this.color||r._defaultColor||st._defaultLineColor],[Fe.INK_OPACITY,Math.round(100*(this.opacity??r._defaultOpacity))]]}#p(e){let t=i=>{this.thickness=i,this.#L()},n=this.thickness;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#f(e){let t=i=>{this.color=i,this.#E()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(e){let t=i=>{this.opacity=i,this.#E()};e/=100;let n=this.opacity;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#R(),this.#S()),this.isAttachedToDOM||(this.parent.add(this),this.#b()),this.#L()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#n&&(clearTimeout(this.#n),this.#n=null),this.#d?.disconnect(),this.#d=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){let[e,t]=this.parentDimensions,n=this.width*e,i=this.height*t;this.setDimensions(n,i)}enableEditMode(){this.#o||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.#P())}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#A())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#_(){let{parentRotation:e,parentDimensions:[t,n]}=this;switch(e){case 90:return[0,n,n,t];case 180:return[t,n,t,n];case 270:return[t,0,n,t];default:return[0,0,t,n]}}#m(){let{ctx:e,color:t,opacity:n,thickness:i,parentScale:o,scaleFactor:s}=this;e.lineWidth=i*o/s,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${kP(n)}`}#v(e,t){this.canvas.addEventListener("contextmenu",vn,{signal:this._uiManager._signal}),this.#A(),this.#r=new AbortController;let n=this._uiManager.combinedSignal(this.#r);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:n}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:n}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:n}),this.isEditing=!0,this.#c||(this.#c=!0,this.#b(),this.thickness||=r._defaultThickness,this.color||=r._defaultColor||st._defaultLineColor,this.opacity??=r._defaultOpacity),this.currentPath.push([e,t]),this.#l=!1,this.#m(),this.#h=()=>{this.#w(),this.#h&&window.requestAnimationFrame(this.#h)},window.requestAnimationFrame(this.#h)}#y(e,t){let[n,i]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&t===i)return;let o=this.currentPath,s=this.#i;if(o.push([e,t]),this.#l=!0,o.length<=2){s.moveTo(...o[0]),s.lineTo(e,t);return}o.length===3&&(this.#i=s=new Path2D,s.moveTo(...o[0])),this.#T(s,...o.at(-3),...o.at(-2),e,t)}#C(){if(this.currentPath.length===0)return;let e=this.currentPath.at(-1);this.#i.lineTo(...e)}#x(e,t){this.#h=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#y(e,t),this.#C();let n;if(this.currentPath.length!==1)n=this.#M();else{let l=[e,t];n=[[l,l.slice(),l.slice(),l]]}let i=this.#i,o=this.currentPath;this.currentPath=[],this.#i=new Path2D;let s=()=>{this.allRawPaths.push(o),this.paths.push(n),this.bezierPath2D.push(i),this._uiManager.rebuild(this)},a=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#R(),this.#S()),this.#L())};this.addCommands({cmd:s,undo:a,mustExec:!0})}#w(){if(!this.#l)return;this.#l=!1;let e=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),n=t.map(d=>d[0]),i=t.map(d=>d[1]),o=Math.min(...n)-e,s=Math.max(...n)+e,a=Math.min(...i)-e,l=Math.max(...i)+e,{ctx:c}=this;c.save(),c.clearRect(0,0,this.canvas.width,this.canvas.height);for(let d of this.bezierPath2D)c.stroke(d);c.stroke(this.#i),c.restore()}#T(e,t,n,i,o,s,a){let l=(t+i)/2,c=(n+o)/2,d=(i+s)/2,u=(o+a)/2;e.bezierCurveTo(l+2*(i-l)/3,c+2*(o-c)/3,d+2*(i-d)/3,u+2*(o-u)/3,d,u)}#M(){let e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];let t=[],n,[i,o]=e[0];for(n=1;n<e.length-2;n++){let[h,g]=e[n],[v,x]=e[n+1],L=(h+v)/2,E=(g+x)/2,P=[i+2*(h-i)/3,o+2*(g-o)/3],S=[L+2*(h-L)/3,E+2*(g-E)/3];t.push([[i,o],P,S,[L,E]]),[i,o]=[L,E]}let[s,a]=e[n],[l,c]=e[n+1],d=[i+2*(s-i)/3,o+2*(a-o)/3],u=[l+2*(s-l)/3,c+2*(a-c)/3];return t.push([[i,o],d,u,[l,c]]),t}#E(){if(this.isEmpty()){this.#k();return}this.#m();let{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#k();for(let n of this.bezierPath2D)t.stroke(n)}commit(){this.#o||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#o=!0,this.div.classList.add("disabled"),this.#L(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}#P(){if(this.#a)return;this.#a=new AbortController;let e=this._uiManager.combinedSignal(this.#a);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})}#A(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#o||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#v(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#y(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#I(e)}canvasPointerleave(e){this.#I(e)}#I(e){this.#r?.abort(),this.#r=null,this.#P(),this.#n&&clearTimeout(this.#n),this.#n=setTimeout(()=>{this.#n=null,this.canvas.removeEventListener("contextmenu",vn)},10),this.#x(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#R(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#S(){this.#d=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#d.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#d?.disconnect(),this.#d=null},{once:!0})}get isResizable(){return!this.isEmpty()&&this.#o}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");let[n,i,o,s]=this.#_();if(this.setAt(n,i,0,0),this.setDims(o,s),this.#R(),this.width){let[a,l]=this.parentDimensions;this.setAspectRatio(this.width*a,this.height*l),this.setAt(e*a,t*l,this.width*a,this.height*l),this.#c=!0,this.#b(),this.setDims(this.width*a,this.height*l),this.#E(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#S(),this.div}#b(){if(!this.#c)return;let[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#k()}setDimensions(e,t){let n=Math.round(e),i=Math.round(t);if(this.#u===n&&this.#s===i)return;this.#u=n,this.#s=i,this.canvas.style.visibility="hidden";let[o,s]=this.parentDimensions;this.width=e/o,this.height=t/s,this.fixAndSetPosition(),this.#o&&this.#O(e,t),this.#b(),this.#E(),this.canvas.style.visibility="visible",this.fixDims()}#O(e,t){let n=this.#j(),i=(e-n)/this.#t,o=(t-n)/this.#e;this.scaleFactor=Math.min(i,o)}#k(){let e=this.#j()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#N(e){let t=new Path2D;for(let n=0,i=e.length;n<i;n++){let[o,s,a,l]=e[n];n===0&&t.moveTo(...o),t.bezierCurveTo(s[0],s[1],a[0],a[1],l[0],l[1])}return t}static#U(e,t,n){let[i,o,s,a]=t;switch(n){case 0:for(let l=0,c=e.length;l<c;l+=2)e[l]+=i,e[l+1]=a-e[l+1];break;case 90:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=e[l+1]+i,e[l+1]=d+o}break;case 180:for(let l=0,c=e.length;l<c;l+=2)e[l]=s-e[l],e[l+1]+=o;break;case 270:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=s-e[l+1],e[l+1]=a-d}break;default:throw new Error("Invalid rotation")}return e}static#V(e,t,n){let[i,o,s,a]=t;switch(n){case 0:for(let l=0,c=e.length;l<c;l+=2)e[l]-=i,e[l+1]=a-e[l+1];break;case 90:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=e[l+1]-o,e[l+1]=d-i}break;case 180:for(let l=0,c=e.length;l<c;l+=2)e[l]=s-e[l],e[l+1]-=o;break;case 270:for(let l=0,c=e.length;l<c;l+=2){let d=e[l];e[l]=a-e[l+1],e[l+1]=s-d}break;default:throw new Error("Invalid rotation")}return e}#F(e,t,n,i){let o=[],s=this.thickness/2,a=e*t+s,l=e*n+s;for(let c of this.paths){let d=[],u=[];for(let h=0,g=c.length;h<g;h++){let[v,x,L,E]=c[h];if(v[0]===E[0]&&v[1]===E[1]&&g===1){let q=e*v[0]+a,U=e*v[1]+l;d.push(q,U),u.push(q,U);break}let P=e*v[0]+a,S=e*v[1]+l,w=e*x[0]+a,T=e*x[1]+l,V=e*L[0]+a,B=e*L[1]+l,W=e*E[0]+a,M=e*E[1]+l;h===0&&(d.push(P,S),u.push(P,S)),d.push(w,T,V,B,W,M),u.push(w,T),h===g-1&&u.push(W,M)}o.push({bezier:r.#U(d,i,this.rotation),points:r.#U(u,i,this.rotation)})}return o}#B(){let e=1/0,t=-1/0,n=1/0,i=-1/0;for(let o of this.paths)for(let[s,a,l,c]of o){let d=Me.bezierBoundingBox(...s,...a,...l,...c);e=Math.min(e,d[0]),n=Math.min(n,d[1]),t=Math.max(t,d[2]),i=Math.max(i,d[3])}return[e,n,t,i]}#j(){return this.#o?Math.ceil(this.thickness*this.parentScale):0}#L(e=!1){if(this.isEmpty())return;if(!this.#o){this.#E();return}let t=this.#B(),n=this.#j();this.#t=Math.max(st.MIN_SIZE,t[2]-t[0]),this.#e=Math.max(st.MIN_SIZE,t[3]-t[1]);let i=Math.ceil(n+this.#t*this.scaleFactor),o=Math.ceil(n+this.#e*this.scaleFactor),[s,a]=this.parentDimensions;this.width=i/s,this.height=o/a,this.setAspectRatio(i,o);let l=this.translationX,c=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#b(),this.#E(),this.#u=i,this.#s=o,this.setDims(i,o);let d=e?n/this.scaleFactor/2:0;this.translate(l-this.translationX-d,c-this.translationY-d)}static deserialize(e,t,n){return G(this,null,function*(){if(e instanceof Vo)return null;let i=yield ir(r,this,"deserialize").call(this,e,t,n);i.thickness=e.thickness,i.color=Me.makeHexColor(...e.color),i.opacity=e.opacity;let[o,s]=i.pageDimensions,a=i.width*o,l=i.height*s,c=i.parentScale,d=e.thickness/2;i.#o=!0,i.#u=Math.round(a),i.#s=Math.round(l);let{paths:u,rect:h,rotation:g}=e;for(let{bezier:x}of u){x=r.#V(x,h,g);let L=[];i.paths.push(L);let E=c*(x[0]-d),P=c*(x[1]-d);for(let w=2,T=x.length;w<T;w+=6){let V=c*(x[w]-d),B=c*(x[w+1]-d),W=c*(x[w+2]-d),M=c*(x[w+3]-d),q=c*(x[w+4]-d),U=c*(x[w+5]-d);L.push([[E,P],[V,B],[W,M],[q,U]]),E=q,P=U}let S=this.#N(L);i.bezierPath2D.push(S)}let v=i.#B();return i.#t=Math.max(st.MIN_SIZE,v[2]-v[0]),i.#e=Math.max(st.MIN_SIZE,v[3]-v[1]),i.#O(a,l),i})}serialize(){if(this.isEmpty())return null;let e=this.getRect(0,0),t=st._colorManager.convert(this.ctx.strokeStyle);return{annotationType:qe.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#F(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}},$h=class r extends st{#e=null;#t=null;#n=null;#i=null;#o=null;#r="";#l=null;#c=null;#d=null;#a=!1;#u=!1;static _type="stamp";static _editorType=qe.STAMP;constructor(e){super(Ft(it({},e),{name:"stampEditor"})),this.#i=e.bitmapUrl,this.#o=e.bitmapFile}static initialize(e,t){st.initialize(e,t)}static get supportedTypes(){return Ke(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return Ke(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(qe.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){let t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#s(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#a=e.isSvg),e.file&&(this.#r=e.file.name),this.#f()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}mlGuessAltText(e=null,t=!0){return G(this,null,function*(){if(this.hasAltTextData())return null;let{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!(yield n.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");let{data:i,width:o,height:s}=e||this.copyCanvas(null,null,!0).imageData,a=yield n.guess({name:"altText",request:{data:i,width:o,height:s,channels:i.length/(o*s)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");let l=a.output;return yield this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l})}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#s(n,!0)).finally(()=>this.#h());return}if(this.#i){let n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(i=>this.#s(i)).finally(()=>this.#h());return}if(this.#o){let n=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(i=>this.#s(i)).finally(()=>this.#h());return}let e=document.createElement("input");e.type="file",e.accept=r.supportedTypesStr;let t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",()=>G(this,null,function*(){if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let i=yield this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#s(i)}n()}),{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#h()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#c?.disconnect(),this.#c=null,this.#d&&(clearTimeout(this.#d),this.#d=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#i||this.#o||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#f():this.#p(),this.width&&!this.annotationElementId){let[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i)}return this.div}#f(){let{div:e}=this,{width:t,height:n}=this.#e,[i,o]=this.pageDimensions,s=.75;if(this.width)t=this.width*i,n=this.height*o;else if(t>s*i||n>s*o){let d=Math.min(s*i/t,s*o/n);t*=d,n*=d}let[a,l]=this.parentDimensions;this.setDims(t*a/i,n*l/o),this._uiManager.enableWaiting(!1);let c=this.#l=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#m(t,n),this.#y(),this.#u||(this.parent.addUndoableEditor(this),this.#u=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&c.setAttribute("aria-label",this.#r)}copyCanvas(e,t,n=!1){e||(e=224);let{width:i,height:o}=this.#e,s=new ko,a=this.#e,l=i,c=o,d=null;if(t){if(i>t||o>t){let V=Math.min(t/i,t/o);l=Math.floor(i*V),c=Math.floor(o*V)}d=document.createElement("canvas");let h=d.width=Math.ceil(l*s.sx),g=d.height=Math.ceil(c*s.sy);this.#a||(a=this.#_(h,g));let v=d.getContext("2d");v.filter=this._uiManager.hcmFilter;let x="white",L="#cfcfd8";this._uiManager.hcmFilter!=="none"?L="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(x="#8f8f9d",L="#42414d");let E=15,P=E*s.sx,S=E*s.sy,w=new OffscreenCanvas(P*2,S*2),T=w.getContext("2d");T.fillStyle=x,T.fillRect(0,0,P*2,S*2),T.fillStyle=L,T.fillRect(0,0,P,S),T.fillRect(P,S,P,S),v.fillStyle=v.createPattern(w,"repeat"),v.fillRect(0,0,h,g),v.drawImage(a,0,0,a.width,a.height,0,0,h,g)}let u=null;if(n){let h,g;if(s.symmetric&&a.width<e&&a.height<e)h=a.width,g=a.height;else if(a=this.#e,i>e||o>e){let L=Math.min(e/i,e/o);h=Math.floor(i*L),g=Math.floor(o*L),this.#a||(a=this.#_(h,g))}let x=new OffscreenCanvas(h,g).getContext("2d",{willReadFrequently:!0});x.drawImage(a,0,0,a.width,a.height,0,0,h,g),u={width:h,height:g,data:x.getImageData(0,0,h,g).data}}return{canvas:d,width:l,height:c,imageData:u}}#g(e,t){let[n,i]=this.parentDimensions;this.width=e/n,this.height=t/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#d!==null&&clearTimeout(this.#d);let o=200;this.#d=setTimeout(()=>{this.#d=null,this.#m(e,t)},o)}#_(e,t){let{width:n,height:i}=this.#e,o=n,s=i,a=this.#e;for(;o>2*e||s>2*t;){let l=o,c=s;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2));let d=new OffscreenCanvas(o,s);d.getContext("2d").drawImage(a,0,0,l,c,0,0,o,s),a=d.transferToImageBitmap()}return a}#m(e,t){let n=new ko,i=Math.ceil(e*n.sx),o=Math.ceil(t*n.sy),s=this.#l;if(!s||s.width===i&&s.height===o)return;s.width=i,s.height=o;let a=this.#a?this.#e:this.#_(i,o),l=s.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(a,0,0,a.width,a.height,0,0,i,o)}getImageForAltText(){return this.#l}#v(e){if(e){if(this.#a){let i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}let t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#a){let[t,n]=this.pageDimensions,i=Math.round(this.width*t*Ei.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*Ei.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(i,o);return s.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,o),s.transferToImageBitmap()}return structuredClone(this.#e)}#y(){this._uiManager._signal&&(this.#c=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.#g(t.width,t.height)}),this.#c.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#c?.disconnect(),this.#c=null},{once:!0}))}static deserialize(e,t,n){return G(this,null,function*(){let i=null;if(e instanceof cl){let{data:{rect:v,rotation:x,id:L,structParent:E,popupRef:P},container:S,parent:{page:{pageNumber:w}}}=e,T=S.querySelector("canvas"),V=n.imageManager.getFromCanvas(S.id,T);T.remove();let B=(yield t._structTree.getAriaAttributes(`${Yh}${L}`))?.get("aria-label")||"";i=e={annotationType:qe.STAMP,bitmapId:V.id,bitmap:V.bitmap,pageIndex:w-1,rect:v.slice(0),rotation:x,id:L,deleted:!1,accessibilityData:{decorative:!1,altText:B},isSvg:!1,structParent:E,popupRef:P}}let o=yield ir(r,this,"deserialize").call(this,e,t,n),{rect:s,bitmap:a,bitmapUrl:l,bitmapId:c,isSvg:d,accessibilityData:u}=e;c&&n.imageManager.isValidId(c)?(o.#t=c,a&&(o.#e=a)):o.#i=l,o.#a=d;let[h,g]=o.pageDimensions;return o.width=(s[2]-s[0])/h,o.height=(s[3]-s[1])/g,o.annotationElementId=e.id||null,u&&(o.altTextData=u),o._initialData=i,o.#u=!!i,o})}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let n={annotationType:qe.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#a,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#v(!0),n.accessibilityData=this.serializeAltText(!0),n;let{decorative:i,altText:o}=this.serializeAltText(!1);if(!i&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){let a=this.#C(n);if(a.isSame)return null;a.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,t===null)return n;t.stamps||=new Map;let s=this.#a?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:s,serialized:n}),n.bitmap=this.#v(!1);else if(this.#a){let a=t.stamps.get(this.#t);s>a.area&&(a.area=s,a.serialized.bitmap.close(),a.serialized.bitmap=this.#v(!1))}return n}#C(e){let{rect:t,pageIndex:n,accessibilityData:{altText:i}}=this._initialData,o=e.rect.every((l,c)=>Math.abs(l-t[c])<1),s=e.pageIndex===n,a=(e.accessibilityData?.alt||"")===i;return{isSame:o&&s&&a,isSameAltText:a}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}},l2=(()=>{class r{#e;#t=!1;#n=null;#i=null;#o=null;#r=new Map;#l=!1;#c=!1;#d=!1;#a=null;#u=null;#s;static _initialized=!1;static#h=new Map([qh,Gh,$h,gl].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:n,div:i,structTreeLayer:o,accessibilityManager:s,annotationLayer:a,drawLayer:l,textLayer:c,viewport:d,l10n:u}){let h=[...r.#h.values()];if(!r._initialized){r._initialized=!0;for(let g of h)g.initialize(u,t)}t.registerEditorTypes(h),this.#s=t,this.pageIndex=n,this.div=i,this.#e=s,this.#n=a,this.viewport=d,this.#a=c,this.drawLayer=l,this._structTree=o,this.#s.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#s.getMode()===qe.NONE}updateToolbar(t){this.#s.updateToolbar(t)}updateMode(t=this.#s.getMode()){switch(this.#m(),t){case qe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case qe.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case qe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);let{classList:n}=this.div;for(let i of r.#h.values())n.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#a?.div}addInkEditorIfNeeded(t){if(this.#s.getMode()!==qe.INK)return;if(!t){for(let i of this.#r.values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){this.#s.setEditingState(t)}addCommands(t){this.#s.addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}enable(){return G(this,null,function*(){this.div.tabIndex=0,this.togglePointerEvents(!0);let t=new Set;for(let i of this.#r.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#s.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#n)return;let n=this.#n.getEditableAnnotations();for(let i of n){if(i.hide(),this.#s.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;let o=yield this.deserialize(i);o&&(this.addOrRebuild(o),o.enableEditing())}})}disable(){this.#d=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);let t=new Map,n=new Map;for(let o of this.#r.values())if(o.disableEditing(),!!o.annotationElementId){if(o.serialize()!==null){t.set(o.annotationElementId,o);continue}else n.set(o.annotationElementId,o);this.getEditableAnnotation(o.annotationElementId)?.show(),o.remove()}if(this.#n){let o=this.#n.getEditableAnnotations();for(let s of o){let{id:a}=s.data;if(this.#s.isDeletedAnnotationElement(a))continue;let l=n.get(a);if(l){l.resetAnnotationElement(s),l.show(!1),s.show();continue}l=t.get(a),l&&(this.#s.addChangedExistingAnnotation(l),l.renderAnnotationElement(s)&&l.show(!1)),s.show()}}this.#m(),this.isEmpty&&(this.div.hidden=!0);let{classList:i}=this.div;for(let o of r.#h.values())i.remove(`${o._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#d=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#s.getActive()!==t&&this.#s.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#a?.div&&!this.#u){this.#u=new AbortController;let t=this.#s.combinedSignal(this.#u);this.#a.div.addEventListener("pointerdown",this.#p.bind(this),{signal:t}),this.#a.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#a?.div&&this.#u&&(this.#u.abort(),this.#u=null,this.#a.div.classList.remove("highlighting"))}#p(t){this.#s.unselectAll();let{target:n}=t;if(n===this.#a.div||(n.getAttribute("role")==="img"||n.classList.contains("endOfContent"))&&this.#a.div.contains(n)){let{isMac:i}=Bt.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#s.showAllEditors("highlight",!0,!0),this.#a.div.classList.add("free"),this.toggleDrawing(),gl.startHighlighting(this,this.#s.direction==="ltr",{target:this.#a.div,x:t.x,y:t.y}),this.#a.div.addEventListener("pointerup",()=>{this.#a.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#s._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;let t=this.#s.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#r.set(t.id,t);let{annotationElementId:n}=t;n&&this.#s.isDeletedAnnotationElement(n)&&this.#s.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#e?.removePointerInTextLayer(t.contentDiv),!this.#d&&t.annotationElementId&&this.#s.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#s.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#c||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#s.addDeletedAnnotationElement(t.annotationElementId),st.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#s.addEditor(t),this.attach(t),!t.isAttachedToDOM){let n=t.render();this.div.append(n),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#s.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;let{activeElement:n}=document;t.div.contains(n)&&!this.#o&&(t._focusEventsAllowed=!1,this.#o=setTimeout(()=>{this.#o=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#s._signal}),n.focus())},0)),t._structTreeParentId=this.#e?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){let n=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:n,undo:i,mustExec:!1})}getNextId(){return this.#s.getId()}get#f(){return r.#h.get(this.#s.getMode())}combinedSignal(t){return this.#s.combinedSignal(t)}#g(t){let n=this.#f;return n?new n.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#f?.canCreateNewEmptyEditor()}pasteEditor(t,n){this.#s.updateToolbar(t),this.#s.updateMode(t);let{offsetX:i,offsetY:o}=this.#_(),s=this.getNextId(),a=this.#g(it({parent:this,id:s,x:i,y:o,uiManager:this.#s,isCentered:!0},n));a&&this.add(a)}deserialize(t){return G(this,null,function*(){return(yield r.#h.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#s))||null})}createAndAddNewEditor(t,n,i={}){let o=this.getNextId(),s=this.#g(it({parent:this,id:o,x:t.offsetX,y:t.offsetY,uiManager:this.#s,isCentered:n},i));return s&&this.add(s),s}#_(){let{x:t,y:n,width:i,height:o}=this.div.getBoundingClientRect(),s=Math.max(0,t),a=Math.max(0,n),l=Math.min(window.innerWidth,t+i),c=Math.min(window.innerHeight,n+o),d=(s+l)/2-t,u=(a+c)/2-n,[h,g]=this.viewport.rotation%180===0?[d,u]:[u,d];return{offsetX:h,offsetY:g}}addNewEditor(){this.createAndAddNewEditor(this.#_(),!0)}setSelected(t){this.#s.setSelected(t)}toggleSelected(t){this.#s.toggleSelected(t)}unselect(t){this.#s.unselect(t)}pointerup(t){let{isMac:n}=Bt.platform;if(!(t.button!==0||t.ctrlKey&&n)&&t.target===this.div&&this.#l){if(this.#l=!1,!this.#t){this.#t=!0;return}if(this.#s.getMode()===qe.STAMP){this.#s.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#s.getMode()===qe.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}let{isMac:n}=Bt.platform;if(t.button!==0||t.ctrlKey&&n||t.target!==this.div)return;this.#l=!0;let i=this.#s.getActive();this.#t=!i||i.isEmpty()}findNewParent(t,n,i){let o=this.#s.findParent(n,i);return o===null||o===this?!1:(o.changeParent(t),!0)}destroy(){this.#s.getActive()?.parent===this&&(this.#s.commitOrRemove(),this.#s.setActiveEditor(null)),this.#o&&(clearTimeout(this.#o),this.#o=null);for(let t of this.#r.values())this.#e?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#s.removeLayer(this)}#m(){this.#c=!0;for(let t of this.#r.values())t.isEmpty()&&t.remove();this.#c=!1}render({viewport:t}){this.viewport=t,Wi(this.div,t);for(let n of this.#s.getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update({viewport:t}){this.#s.commitOrRemove(),this.#m();let n=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Wi(this.div,{rotation:i}),n!==i)for(let o of this.#r.values())o.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){let{pageWidth:t,pageHeight:n}=this.viewport.rawDims;return[t,n]}get scale(){return this.#s.viewParameters.realScale}}return r})(),Xh=class r{#e=null;#t=0;#n=new Map;#i=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(let t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Ke(this,"_svgFactory",new Bo)}static#o(e,{x:t=0,y:n=0,width:i=1,height:o=1}={}){let{style:s}=e;s.top=`${100*n}%`,s.left=`${100*t}%`,s.width=`${100*i}%`,s.height=`${100*o}%`}#r(e){let t=r._svgFactory.create(1,1,!0);return this.#e.append(t),t.setAttribute("aria-hidden",!0),r.#o(t,e),t}#l(e,t){let n=r._svgFactory.createElement("clipPath");e.append(n);let i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");let o=r._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),i}draw(e,t,n,i=!1){let o=this.#t++,s=this.#r(e.box);s.classList.add(...e.classNamesForDrawing);let a=r._svgFactory.createElement("defs");s.append(a);let l=r._svgFactory.createElement("path");a.append(l);let c=`path_p${this.pageIndex}_${o}`;l.setAttribute("id",c),l.setAttribute("d",e.toSVGPath()),i&&this.#i.set(o,l);let d=this.#l(a,c),u=r._svgFactory.createElement("use");return s.append(u),s.setAttribute("fill",t),s.setAttribute("fill-opacity",n),u.setAttribute("href",`#${c}`),this.#n.set(o,s),{id:o,clipPathId:`url(#${d})`}}drawOutline(e){let t=this.#t++,n=this.#r(e.box);n.classList.add(...e.classNamesForOutlining);let i=r._svgFactory.createElement("defs");n.append(i);let o=r._svgFactory.createElement("path");i.append(o);let s=`path_p${this.pageIndex}_${t}`;o.setAttribute("id",s),o.setAttribute("d",e.toSVGPath()),o.setAttribute("vector-effect","non-scaling-stroke");let a;if(e.mustRemoveSelfIntersections){let d=r._svgFactory.createElement("mask");i.append(d),a=`mask_p${this.pageIndex}_${t}`,d.setAttribute("id",a),d.setAttribute("maskUnits","objectBoundingBox");let u=r._svgFactory.createElement("rect");d.append(u),u.setAttribute("width","1"),u.setAttribute("height","1"),u.setAttribute("fill","white");let h=r._svgFactory.createElement("use");d.append(h),h.setAttribute("href",`#${s}`),h.setAttribute("stroke","none"),h.setAttribute("fill","black"),h.setAttribute("fill-rule","nonzero"),h.classList.add("mask")}let l=r._svgFactory.createElement("use");n.append(l),l.setAttribute("href",`#${s}`),a&&l.setAttribute("mask",`url(#${a})`);let c=l.cloneNode();return n.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.#n.set(t,n),t}finalizeLine(e,t){let n=this.#i.get(e);this.#i.delete(e),this.updateBox(e,t.box),n.setAttribute("d",t.toSVGPath())}updateLine(e,t){this.#n.get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}updatePath(e,t){this.#i.get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){r.#o(this.#n.get(e),t)}show(e,t){this.#n.get(e).classList.toggle("hidden",!t)}rotate(e,t){this.#n.get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){this.#n.get(e).setAttribute("fill",t)}changeOpacity(e,t){this.#n.get(e).setAttribute("fill-opacity",t)}addClass(e,t){this.#n.get(e).classList.add(t)}removeClass(e,t){this.#n.get(e).classList.remove(t)}getSVGRoot(e){return this.#n.get(e)}remove(e){this.#i.delete(e),this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(let e of this.#n.values())e.remove();this.#n.clear(),this.#i.clear()}};var c2=je.AbortException,d2=je.AnnotationEditorLayer,u2=je.AnnotationEditorParamsType,r_=je.AnnotationEditorType,h2=je.AnnotationEditorUIManager,f2=je.AnnotationLayer,p2=je.AnnotationMode,g2=je.ColorPicker,m2=je.DOMSVGFactory,_2=je.DrawLayer,v2=je.FeatureTest,o_=je.GlobalWorkerOptions,b2=je.ImageKind,y2=je.InvalidPDFException,x2=je.MissingPDFException,w2=je.OPS,C2=je.OutputScale,E2=je.PDFDataRangeTransport,S2=je.PDFDateString,A2=je.PDFWorker,M2=je.PasswordResponses,P2=je.PermissionFlag,O2=je.PixelsPerInch,T2=je.RenderingCancelledException,I2=je.TextLayer,k2=je.UnexpectedResponseException,R2=je.Util,nf=je.VerbosityLevel,L2=je.XfaLayer,D2=je.build,F2=je.createValidAbsoluteUrl,N2=je.fetchData,s_=je.getDocument,B2=je.getFilenameFromUrl,j2=je.getPdfFilenameFromUrl,V2=je.getXfaPageViewport,U2=je.isDataScheme,z2=je.isPdfFile,q2=je.noContextMenu,H2=je.normalizeUnicode,W2=je.setLayerDimensions,G2=je.shadow,a_=je.version;var Ho={};Ho.d=(r,e)=>{for(var t in e)Ho.o(e,t)&&!Ho.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})};Ho.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var bt=globalThis.pdfjsViewer={};Ho.d(bt,{AnnotationLayerBuilder:()=>Rl,DownloadManager:()=>_f,EventBus:()=>Ll,FindState:()=>Ai,GenericL10n:()=>jr,LinkTarget:()=>Xi,PDFFindController:()=>gf,PDFHistory:()=>Pf,PDFLinkService:()=>Il,PDFPageView:()=>Vl,PDFScriptingManager:()=>Nf,PDFSinglePageViewer:()=>Vf,PDFViewer:()=>Ul,ProgressBar:()=>pf,RenderingStates:()=>wt,ScrollMode:()=>Ye,SimpleLinkService:()=>$o,SpreadMode:()=>Wt,StructTreeLayerBuilder:()=>Nl,TextLayerBuilder:()=>Bl,XfaLayerBuilder:()=>jl,parseQueryString:()=>zl});var $2="auto",U_=1,l_=1.1,X2=.1,K2=10,of=0,Y2=1.25,c_=40,d_=5,wt={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},Fr={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};var jn={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},Ye={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},Wt={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};function z_(r,e,t=!1){let n=r.offsetParent;if(!n){console.error("offsetParent is not set -- cannot scroll");return}let i=r.offsetTop+r.clientTop,o=r.offsetLeft+r.clientLeft;for(;n.clientHeight===n.scrollHeight&&n.clientWidth===n.scrollWidth||t&&(n.classList.contains("markedContent")||getComputedStyle(n).overflow==="hidden");)if(i+=n.offsetTop,o+=n.offsetLeft,n=n.offsetParent,!n)return;e&&(e.top!==void 0&&(i+=e.top),e.left!==void 0&&(o+=e.left,n.scrollLeft=o)),n.scrollTop=i}function Q2(r,e,t=void 0){let n=function(s){o||(o=window.requestAnimationFrame(function(){o=null;let l=r.scrollLeft,c=i.lastX;l!==c&&(i.right=l>c),i.lastX=l;let d=r.scrollTop,u=i.lastY;d!==u&&(i.down=d>u),i.lastY=d,e(i)}))},i={right:!0,down:!0,lastX:r.scrollLeft,lastY:r.scrollTop,_eventHandler:n},o=null;return r.addEventListener("scroll",n,{useCapture:!0,signal:t}),t?.addEventListener("abort",()=>window.cancelAnimationFrame(o),{once:!0}),i}function zl(r){let e=new Map;for(let[t,n]of new URLSearchParams(r))e.set(t.toLowerCase(),n);return e}var u_=/[\x00-\x1F]/g;function Wo(r,e=!1){return u_.test(r)?e?r.replaceAll(u_,t=>t==="\0"?"":" "):r.replaceAll("\0",""):r}function Go(r,e,t=0){let n=t,i=r.length-1;if(i<0||!e(r[i]))return r.length;if(e(r[n]))return n;for(;n<i;){let o=n+i>>1,s=r[o];e(s)?i=o:n=o+1}return n}function h_(r){if(Math.floor(r)===r)return[r,1];let e=1/r,t=8;if(e>t)return[1,t];if(Math.floor(e)===e)return[1,e];let n=r>1?e:r,i=0,o=1,s=1,a=1;for(;;){let c=i+s,d=o+a;if(d>t)break;n<=c/d?(s=c,a=d):(i=c,o=d)}let l;return n-i/o<s/a-n?l=n===r?[i,o]:[o,i]:l=n===r?[s,a]:[a,s],l}function El(r,e){return r-r%e}function J2(r,e,t){if(r<2)return r;let n=e[r].div,i=n.offsetTop+n.clientTop;i>=t&&(n=e[r-1].div,i=n.offsetTop+n.clientTop);for(let o=r-2;o>=0&&(n=e[o].div,!(n.offsetTop+n.clientTop+n.clientHeight<=i));--o)r=o;return r}function Z2({scrollEl:r,views:e,sortByVisibility:t=!1,horizontal:n=!1,rtl:i=!1}){let o=r.scrollTop,s=o+r.clientHeight,a=r.scrollLeft,l=a+r.clientWidth;function c(P){let S=P.div;return S.offsetTop+S.clientTop+S.clientHeight>o}function d(P){let S=P.div,w=S.offsetLeft+S.clientLeft,T=w+S.clientWidth;return i?w<l:T>a}let u=[],h=new Set,g=e.length,v=Go(e,n?d:c);v>0&&v<g&&!n&&(v=J2(v,e,o));let x=n?l:-1;for(let P=v;P<g;P++){let S=e[P],w=S.div,T=w.offsetLeft+w.clientLeft,V=w.offsetTop+w.clientTop,B=w.clientWidth,W=w.clientHeight,M=T+B,q=V+W;if(x===-1)q>=s&&(x=q);else if((n?T:V)>x)break;if(q<=o||V>=s||M<=a||T>=l)continue;let U=Math.max(0,o-V)+Math.max(0,q-s),ee=Math.max(0,a-T)+Math.max(0,M-l),ie=(W-U)/W,re=(B-ee)/B,ae=ie*re*100|0;u.push({id:S.id,x:T,y:V,view:S,percent:ae,widthPercent:re*100|0}),h.add(S.id)}let L=u[0],E=u.at(-1);return t&&u.sort(function(P,S){let w=P.percent-S.percent;return Math.abs(w)>.001?-w:P.id-S.id}),{first:L,last:E,views:u,ids:h}}function q_(r){return Number.isInteger(r)&&r%90===0}function eO(r){return Number.isInteger(r)&&Object.values(Ye).includes(r)&&r!==Ye.UNKNOWN}function tO(r){return Number.isInteger(r)&&Object.values(Wt).includes(r)&&r!==Wt.UNKNOWN}function f_(r){return r.width<=r.height}var uF=new Promise(function(r){window.requestAnimationFrame(r)}),nO=document.documentElement.style;function iO(r,e,t){return Math.min(Math.max(r,e),t)}var pf=class{#e=null;#t=null;#n=0;#i=null;#o=!0;constructor(e){this.#e=e.classList,this.#i=e.style}get percent(){return this.#n}set percent(e){if(this.#n=iO(e,0,100),isNaN(e)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#i.setProperty("--progressBar-percent",`${this.#n}%`)}setWidth(e){if(!e)return;let n=e.parentNode.offsetWidth-e.offsetWidth;n>0&&this.#i.setProperty("--progressBar-end-offset",`${n}px`)}setDisableAutoFetch(e=5e3){this.#n===100||isNaN(this.#n)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},e))}hide(){this.#o&&(this.#o=!1,this.#e.add("hidden"))}show(){this.#o||(this.#o=!0,this.#e.remove("hidden"))}};function rO(r){let e=Ye.VERTICAL,t=Wt.NONE;switch(r){case"SinglePage":e=Ye.PAGE;break;case"OneColumn":break;case"TwoPageLeft":e=Ye.PAGE;case"TwoColumnLeft":t=Wt.ODD;break;case"TwoPageRight":e=Ye.PAGE;case"TwoColumnRight":t=Wt.EVEN;break}return{scrollMode:e,spreadMode:t}}var Sl=function(){let r=document.createElement("div");return r.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",r.style.width==="calc(1320px)"?Math.fround:e=>e}(),An={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function oO(r){return r<11904}function sO(r){return(r&65408)===0}function aO(r){return r>=97&&r<=122||r>=65&&r<=90}function lO(r){return r>=48&&r<=57}function cO(r){return r===32||r===9||r===13||r===10}function dO(r){return r>=13312&&r<=40959||r>=63744&&r<=64255}function uO(r){return r>=12448&&r<=12543}function hO(r){return r>=12352&&r<=12447}function fO(r){return r>=65376&&r<=65439}function pO(r){return(r&65408)===3584}function Al(r){return oO(r)?sO(r)?cO(r)?An.SPACE:aO(r)||lO(r)||r===95?An.ALPHA_LETTER:An.PUNCT:pO(r)?An.THAI_LETTER:r===160?An.SPACE:An.ALPHA_LETTER:dO(r)?An.HAN_LETTER:uO(r)?An.KATAKANA_LETTER:hO(r)?An.HIRAGANA_LETTER:fO(r)?An.HALFWIDTH_KATAKANA_LETTER:An.ALPHA_LETTER}var p_;function gO(){return p_||="\xA0\xA8\xAA\xAF\xB2-\xB5\xB8-\xBA\xBC-\xBE\u0132-\u0133\u013F-\u0140\u0149\u017F\u01C4-\u01CC\u01F1-\u01F3\u02B0-\u02B8\u02D8-\u02DD\u02E0-\u02E4\u0374\u037A\u037E\u0384-\u0385\u0387\u03D0-\u03D6\u03F0-\u03F2\u03F4-\u03F5\u03F9\u0587\u0675-\u0678\u0958-\u095F\u09DC-\u09DD\u09DF\u0A33\u0A36\u0A59-\u0A5B\u0A5E\u0B5C-\u0B5D\u0E33\u0EB3\u0EDC-\u0EDD\u0F0C\u0F43\u0F4D\u0F52\u0F57\u0F5C\u0F69\u10FC\u1D2C-\u1D2E\u1D30-\u1D3A\u1D3C-\u1D4D\u1D4F-\u1D6A\u1D78\u1D9B-\u1DBF\u1E9A-\u1E9B\u1F71\u1F73\u1F75\u1F77\u1F79\u1F7B\u1F7D\u1FBB\u1FBD-\u1FC1\u1FC9\u1FCB\u1FCD-\u1FCF\u1FD3\u1FDB\u1FDD-\u1FDF\u1FE3\u1FEB\u1FED-\u1FEF\u1FF9\u1FFB\u1FFD-\u1FFE\u2000-\u200A\u2011\u2017\u2024-\u2026\u202F\u2033-\u2034\u2036-\u2037\u203C\u203E\u2047-\u2049\u2057\u205F\u2070-\u2071\u2074-\u208E\u2090-\u209C\u20A8\u2100-\u2103\u2105-\u2107\u2109-\u2113\u2115-\u2116\u2119-\u211D\u2120-\u2122\u2124\u2126\u2128\u212A-\u212D\u212F-\u2131\u2133-\u2139\u213B-\u2140\u2145-\u2149\u2150-\u217F\u2189\u222C-\u222D\u222F-\u2230\u2329-\u232A\u2460-\u24EA\u2A0C\u2A74-\u2A76\u2ADC\u2C7C-\u2C7D\u2D6F\u2E9F\u2EF3\u2F00-\u2FD5\u3000\u3036\u3038-\u303A\u309B-\u309C\u309F\u30FF\u3131-\u318E\u3192-\u319F\u3200-\u321E\u3220-\u3247\u3250-\u327E\u3280-\u33FF\uA69C-\uA69D\uA770\uA7F2-\uA7F4\uA7F8-\uA7F9\uAB5C-\uAB5F\uAB69\uF900-\uFA0D\uFA10\uFA12\uFA15-\uFA1E\uFA20\uFA22\uFA25-\uFA26\uFA2A-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE10-\uFE19\uFE30-\uFE44\uFE47-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE72\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6",p_}var Ai={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},mO=250,_O=-50,vO=-400,g_={"\u2010":"-","\u2018":"'","\u2019":"'","\u201A":"'","\u201B":"'","\u201C":'"',"\u201D":'"',"\u201E":'"',"\u201F":'"',"\xBC":"1/4","\xBD":"1/2","\xBE":"3/4"},m_=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),__,bO=new RegExp("\\p{M}+","gu"),yO=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),xO=new RegExp("([^\\p{M}])\\p{M}*$","u"),wO=new RegExp("^\\p{M}*([^\\p{M}])","u"),CO=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,v_=new Map,EO="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",b_=new Map,sf=null,af=null;function lf(r){let e=[],t;for(;(t=CO.exec(r))!==null;){let{index:g}=t;for(let v of t[0]){let x=v_.get(v);x||(x=v.normalize("NFD").length,v_.set(v,x)),e.push([x,g++])}}let n;if(e.length===0&&sf)n=sf;else if(e.length>0&&af)n=af;else{let g=Object.keys(g_).join(""),v=gO(),P=`([${g}])|([${v}])|((?:\u3099|\u309A)\\n)|(\\p{M}+(?:-\\n)?)|(\\p{Ll}-\\n\\p{Lu})|(\\S-\\n)|((?:\\p{Ideographic}|[\u3040-\u30FF])\\n)|(\\n)`;e.length===0?n=sf=new RegExp(P+"|(\\u0000)","gum"):n=af=new RegExp(P+`|(${EO})`,"gum")}let i=[];for(;(t=bO.exec(r))!==null;)i.push([t[0].length,t.index]);let o=r.normalize("NFD"),s=[[0,0]],a=0,l=0,c=0,d=0,u=0,h=!1;return o=o.replace(n,(g,v,x,L,E,P,S,w,T,V,B)=>{if(B-=d,v){let W=g_[v],M=W.length;for(let q=1;q<M;q++)s.push([B-c+q,c-q]);return c-=M-1,W}if(x){let W=b_.get(x);W||(W=x.normalize("NFKC"),b_.set(x,W));let M=W.length;for(let q=1;q<M;q++)s.push([B-c+q,c-q]);return c-=M-1,W}if(L)return h=!0,B+u===i[a]?.[1]?++a:(s.push([B-1-c+1,c-1]),c-=1,d+=1),s.push([B-c+1,c]),d+=1,u+=1,L.charAt(0);if(E){let W=E.endsWith(`
`),M=W?E.length-2:E.length;h=!0;let q=M;B+u===i[a]?.[1]&&(q-=i[a][0],++a);for(let U=1;U<=q;U++)s.push([B-1-c+U,c-U]);return c-=q,d+=q,W?(B+=M-1,s.push([B-c+1,1+c]),c+=1,d+=1,u+=1,E.slice(0,M)):E}if(P)return s.push([B-c+3,1+c]),c+=1,d+=1,u+=1,P.replace(`
`,"");if(S){let W=S.length-2;return s.push([B-c+W,1+c]),c+=1,d+=1,u+=1,S.slice(0,-2)}if(w){let W=w.length-1;return s.push([B-c+W,c]),d+=1,u+=1,w.slice(0,-1)}if(T)return s.push([B-c+1,c-1]),c-=1,d+=1,u+=1," ";if(B+u===e[l]?.[1]){let W=e[l][0]-1;++l;for(let M=1;M<=W;M++)s.push([B-(c-M),c-M]);c-=W,d+=W}return V}),s.push([o.length,c]),[o,s,h]}function SO(r,e,t){if(!r)return[e,t];let n=e,i=e+t-1,o=Go(r,d=>d[0]>=n);r[o][0]>n&&--o;let s=Go(r,d=>d[0]>=i,o);r[s][0]>i&&--s;let a=n+r[o][1],c=i+r[s][1]+1-a;return[a,c]}var gf=class{#e=null;#t=!0;#n=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:n=!0}){this._linkService=e,this._eventBus=t,this.#t=n,this.onIsPageVisible=null,this.#o(),t._on("find",this.#i.bind(this)),t._on("findbarclose",this.#v.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(e){this._pdfDocument&&this.#o(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#i(e){if(!e)return;let t=this._pdfDocument,{type:n}=e;(this.#e===null||this.#l(e))&&(this._dirtyMatch=!0),this.#e=e,n!=="highlightallchange"&&this.#x(Ai.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this.#u();let i=!this._highlightMatches,o=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),n?this._dirtyMatch?this.#p():n==="again"?(this.#p(),i&&this.#e.highlightAll&&this.#h()):n==="highlightallchange"?(o?this.#p():this._highlightMatches=!0,this.#h()):this.#p():this._findTimeout=setTimeout(()=>{this.#p(),this._findTimeout=null},mO)})}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:n=-1,matchIndex:i=-1}){if(!this._scrollMatches||!e)return;if(i===-1||i!==this._selected.matchIdx)return;if(n===-1||n!==this._selected.pageIdx)return;this._scrollMatches=!1;let o={top:_O,left:t+vO};z_(e,o,!0)}#o(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#n=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#r(){let{query:e}=this.#e;return typeof e=="string"?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=lf(e)),this._normalizedQuery):(e||[]).filter(t=>!!t).map(t=>lf(t)[0])}#l(e){let t=e.query,n=this.#e.query,i=typeof t;if(i!==typeof n)return!0;if(i==="string"){if(t!==n)return!0}else if(JSON.stringify(t)!==JSON.stringify(n))return!0;switch(e.type){case"again":let s=this._selected.pageIdx+1,a=this._linkService;return s>=1&&s<=a.pagesCount&&s!==a.page&&!(this.onIsPageVisible?.(s)??!0);case"highlightallchange":return!1}return!0}#c(e,t,n){let i=e.slice(0,t).match(xO);if(i){let o=e.charCodeAt(t),s=i[1].charCodeAt(0);if(Al(o)===Al(s))return!1}if(i=e.slice(t+n).match(wO),i){let o=e.charCodeAt(t+n-1),s=i[1].charCodeAt(0);if(Al(o)===Al(s))return!1}return!0}#d(e,t){let{matchDiacritics:n}=this.#e,i=!1;e=e.replaceAll(yO,(s,a,l,c,d,u)=>a?`[ ]*\\${a}[ ]*`:l?`[ ]*${l}[ ]*`:c?"[ ]+":n?d||u:d?m_.has(d.charCodeAt(0))?d:"":t?(i=!0,`${u}\\p{M}*`):u);let o="[ ]*";return e.endsWith(o)&&(e=e.slice(0,e.length-o.length)),n&&t&&(__||=String.fromCharCode(...m_),i=!0,e=`${e}(?=[${__}]|[^\\p{M}]|$)`),[i,e]}#a(e){let t=this.#r;if(t.length===0)return;let n=this._pageContents[e],i=this.match(t,n,e),o=this._pageMatches[e]=[],s=this._pageMatchesLength[e]=[],a=this._pageDiffs[e];i?.forEach(({index:c,length:d})=>{let[u,h]=SO(a,c,d);h&&(o.push(u),s.push(h))}),this.#e.highlightAll&&this.#s(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#g());let l=o.length;this._matchesCountTotal+=l,this.#t?l>0&&this.#C():++this.#n===this._linkService.pagesCount&&this.#C()}match(e,t,n){let i=this._hasDiacritics[n],o=!1;if(typeof e=="string"?[o,e]=this.#d(e,i):e=e.sort().reverse().map(u=>{let[h,g]=this.#d(u,i);return o||=h,`(${g})`}).join("|"),!e)return;let{caseSensitive:s,entireWord:a}=this.#e,l=`g${o?"u":""}${s?"":"i"}`;e=new RegExp(e,l);let c=[],d;for(;(d=e.exec(t))!==null;)a&&!this.#c(t,d.index,d[0].length)||c.push({index:d.index,length:d[0].length});return c}#u(){if(this._extractTextPromises.length>0)return;let e=Promise.resolve(),t={disableNormalization:!0};for(let n=0,i=this._linkService.pagesCount;n<i;n++){let{promise:o,resolve:s}=Promise.withResolvers();this._extractTextPromises[n]=o,e=e.then(()=>this._pdfDocument.getPage(n+1).then(a=>a.getTextContent(t)).then(a=>{let l=[];for(let c of a.items)l.push(c.str),c.hasEOL&&l.push(`
`);[this._pageContents[n],this._pageDiffs[n],this._hasDiacritics[n]]=lf(l.join("")),s()},a=>{console.error(`Unable to get text content for page ${n+1}`,a),this._pageContents[n]="",this._pageDiffs[n]=null,this._hasDiacritics[n]=!1,s()}))}}#s(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#h(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#p(){let e=this.#e.findPrevious,t=this._linkService.page-1,n=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#n=0,this._matchesCountTotal=0,this.#h();for(let s=0;s<n;s++)this._pendingFindMatches.has(s)||(this._pendingFindMatches.add(s),this._extractTextPromises[s].then(()=>{this._pendingFindMatches.delete(s),this.#a(s)}))}if(this.#r.length===0){this.#x(Ai.FOUND);return}if(this._resumePageIdx)return;let o=this._offset;if(this._pagesToSearch=n,o.matchIdx!==null){let s=this._pageMatches[o.pageIdx].length;if(!e&&o.matchIdx+1<s||e&&o.matchIdx>0){o.matchIdx=e?o.matchIdx-1:o.matchIdx+1,this.#m(!0);return}this.#_(e)}this.#g()}#f(e){let t=this._offset,n=e.length,i=this.#e.findPrevious;return n?(t.matchIdx=i?n-1:0,this.#m(!0),!0):(this.#_(i),t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0)?(this.#m(!1),!0):!1)}#g(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let e=null;do{let t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this.#f(e))}#_(e){let t=this._offset,n=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=n||t.pageIdx<0)&&(t.pageIdx=e?n-1:0,t.wrapped=!0)}#m(e=!1){let t=Ai.NOT_FOUND,n=this._offset.wrapped;if(this._offset.wrapped=!1,e){let i=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=n?Ai.WRAPPED:Ai.FOUND,i!==-1&&i!==this._selected.pageIdx&&this.#s(i)}this.#x(t,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#s(this._selected.pageIdx))}#v(e){let t=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#x(Ai.FOUND),this._highlightMatches=!1,this.#h())})}#y(){let{pageIdx:e,matchIdx:t}=this._selected,n=0,i=this._matchesCountTotal;if(t!==-1){for(let o=0;o<e;o++)n+=this._pageMatches[o]?.length||0;n+=t+1}return(n<1||n>i)&&(n=i=0),{current:n,total:i}}#C(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#y()})}#x(e,t=!1){!this.#t&&(this.#n!==this._linkService.pagesCount||e===Ai.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,entireWord:this.#e?.entireWord??null,matchesCount:this.#y(),rawQuery:this.#e?.query??null})}},AO="noopener noreferrer nofollow",Xi={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},Il=class r{externalLinkEnabled=!0;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:n=null,ignoreDestinationZoom:i=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=n,this._ignoreDestinationZoom=i,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(e){this.pdfDocument&&(this.pdfViewer.currentPageNumber=e)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(e){this.pdfDocument&&(this.pdfViewer.pagesRotation=e)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}goToDestination(e){return G(this,null,function*(){if(!this.pdfDocument)return;let t,n,i;if(typeof e=="string"?(t=e,n=yield this.pdfDocument.getDestination(e)):(t=null,n=yield e),!Array.isArray(n)){console.error(`goToDestination: "${n}" is not a valid destination array, for dest="${e}".`);return}let[o]=n;if(o&&typeof o=="object"){if(i=this.pdfDocument.cachedPageNumber(o),!i)try{i=(yield this.pdfDocument.getPageIndex(o))+1}catch{console.error(`goToDestination: "${o}" is not a valid page reference, for dest="${e}".`);return}}else Number.isInteger(o)&&(i=o+1);if(!i||i<1||i>this.pagesCount){console.error(`goToDestination: "${i}" is not a valid page number, for dest="${e}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:t,explicitDest:n,pageNumber:i})),this.pdfViewer.scrollPageIntoView({pageNumber:i,destArray:n,ignoreDestinationZoom:this._ignoreDestinationZoom})})}goToPage(e){if(!this.pdfDocument)return;let t=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||e|0;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})}addLinkAttributes(e,t,n=!1){if(!t||typeof t!="string")throw new Error('A valid "url" parameter must provided.');let i=n?Xi.BLANK:this.externalLinkTarget,o=this.externalLinkRel;this.externalLinkEnabled?e.href=e.title=t:(e.href="",e.title=`Disabled: ${t}`,e.onclick=()=>!1);let s="";switch(i){case Xi.NONE:break;case Xi.SELF:s="_self";break;case Xi.BLANK:s="_blank";break;case Xi.PARENT:s="_parent";break;case Xi.TOP:s="_top";break}e.target=s,e.rel=typeof o=="string"?o:AO}getDestinationHash(e){if(typeof e=="string"){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){let t=JSON.stringify(e);if(t.length>0)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){if(!this.pdfDocument)return;let t,n;if(e.includes("=")){let i=zl(e);if(i.has("search")){let o=i.get("search").replaceAll('"',""),s=i.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:s?o:o.match(/\S+/g)})}if(i.has("page")&&(t=i.get("page")|0||1),i.has("zoom")){let o=i.get("zoom").split(","),s=o[0],a=parseFloat(s);s.includes("Fit")?s==="Fit"||s==="FitB"?n=[null,{name:s}]:s==="FitH"||s==="FitBH"||s==="FitV"||s==="FitBV"?n=[null,{name:s},o.length>1?o[1]|0:null]:s==="FitR"?o.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):n=[null,{name:s},o[1]|0,o[2]|0,o[3]|0,o[4]|0]:console.error(`PDFLinkService.setHash: "${s}" is not a valid zoom value.`):n=[null,{name:"XYZ"},o.length>1?o[1]|0:null,o.length>2?o[2]|0:null,a?a/100:s]}n?this.pdfViewer.scrollPageIntoView({pageNumber:t||this.page,destArray:n,allowNegativeOffset:!0}):t&&(this.page=t),i.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:i.get("pagemode")}),i.has("nameddest")&&this.goToDestination(i.get("nameddest"));return}n=unescape(e);try{n=JSON.parse(n),Array.isArray(n)||(n=n.toString())}catch{}if(typeof n=="string"||r.#e(n)){this.goToDestination(n);return}console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}executeNamedAction(e){if(this.pdfDocument){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break;default:break}this.eventBus.dispatch("namedaction",{source:this,action:e})}}executeSetOCGState(e){return G(this,null,function*(){if(!this.pdfDocument)return;let t=this.pdfDocument,n=yield this.pdfViewer.optionalContentConfigPromise;t===this.pdfDocument&&(n.setOCGState(e),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(n))})}static#e(e){if(!Array.isArray(e)||e.length<2)return!1;let[t,n,...i]=e;if(!(typeof t=="object"&&Number.isInteger(t?.num)&&Number.isInteger(t?.gen))&&!Number.isInteger(t)||!(typeof n=="object"&&typeof n?.name=="string"))return!1;let o=i.length,s=!0;switch(n.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;s=!1;break;default:return!1}for(let a of i)if(!(typeof a=="number"||s&&a===null))return!1;return!0}},$o=class extends Il{setDocument(e,t=null){}},{AbortException:MO,AnnotationEditorLayer:PO,AnnotationEditorParamsType:hF,AnnotationEditorType:cn,AnnotationEditorUIManager:OO,AnnotationLayer:TO,AnnotationMode:oi,build:fF,ColorPicker:pF,createValidAbsoluteUrl:IO,DOMSVGFactory:gF,DrawLayer:kO,FeatureTest:mF,fetchData:y_,getDocument:_F,getFilenameFromUrl:vF,getPdfFilenameFromUrl:RO,getXfaPageViewport:bF,GlobalWorkerOptions:yF,ImageKind:xF,InvalidPDFException:wF,isDataScheme:CF,isPdfFile:LO,MissingPDFException:EF,noContextMenu:SF,normalizeUnicode:DO,OPS:AF,OutputScale:FO,PasswordResponses:MF,PDFDataRangeTransport:PF,PDFDateString:OF,PDFWorker:TF,PermissionFlag:Ml,PixelsPerInch:ri,RenderingCancelledException:mf,setLayerDimensions:NO,shadow:kl,TextLayer:BO,UnexpectedResponseException:IF,Util:kF,VerbosityLevel:RF,version:x_,XfaLayer:cf}=globalThis.pdfjsLib,Rl=class{#e=null;#t=null;constructor({pdfPage:e,linkService:t,downloadManager:n,annotationStorage:i=null,imageResourcesPath:o="",renderForms:s=!0,enableScripting:a=!1,hasJSActionsPromise:l=null,fieldObjectsPromise:c=null,annotationCanvasMap:d=null,accessibilityManager:u=null,annotationEditorUIManager:h=null,onAppend:g=null}){this.pdfPage=e,this.linkService=t,this.downloadManager=n,this.imageResourcesPath=o,this.renderForms=s,this.annotationStorage=i,this.enableScripting=a,this._hasJSActionsPromise=l||Promise.resolve(!1),this._fieldObjectsPromise=c||Promise.resolve(null),this._annotationCanvasMap=d,this._accessibilityManager=u,this._annotationEditorUIManager=h,this.#e=g,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=t.eventBus}render(e,t,n="display"){return G(this,null,function*(){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:e.clone({dontFlip:!0})});return}let[i,o,s]=yield Promise.all([this.pdfPage.getAnnotations({intent:n}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;let a=this.div=document.createElement("div");if(a.className="annotationLayer",this.#e?.(a),i.length===0){this.hide();return}this.annotationLayer=new TO({div:a,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:e.clone({dontFlip:!0}),structTreeLayer:t?.structTreeLayer||null}),yield this.annotationLayer.render({annotations:i,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:o,fieldObjects:s}),this.linkService.isInPresentationMode&&this.#n(Fr.FULLSCREEN),this.#t||(this.#t=new AbortController,this._eventBus?._on("presentationmodechanged",l=>{this.#n(l.state)},{signal:this.#t.signal}))})}cancel(){this._cancelled=!0,this.#t?.abort(),this.#t=null}hide(){this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}#n(e){if(!this.div)return;let t=!1;switch(e){case Fr.FULLSCREEN:t=!0;break;case Fr.NORMAL:break;default:return}for(let n of this.div.childNodes)n.hasAttribute("data-internal-link")||(n.inert=t)}};function w_(r,e){let t=document.createElement("a");if(!t.click)throw new Error('DownloadManager: "a.click()" is not supported.');t.href=r,t.target="_parent","download"in t&&(t.download=e),(document.body||document.documentElement).append(t),t.click(),t.remove()}var _f=class{#e=new WeakMap;downloadData(e,t,n){let i=URL.createObjectURL(new Blob([e],{type:n}));w_(i,t)}openOrDownloadData(e,t,n=null){let o=LO(t)?"application/pdf":"";return this.downloadData(e,t,o),!1}download(e,t,n){let i;if(e)i=URL.createObjectURL(new Blob([e],{type:"application/pdf"}));else{if(!IO(t,"http://example.com")){console.error(`download - not a valid URL: ${t}`);return}i=t+"#pdfjs.action=download"}w_(i,n)}},C_={EVENT:"event",TIMEOUT:"timeout"};function jO(n){return G(this,arguments,function*({target:r,name:e,delay:t=0}){if(typeof r!="object"||!(e&&typeof e=="string")||!(Number.isInteger(t)&&t>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");let{promise:i,resolve:o}=Promise.withResolvers(),s=new AbortController;function a(d){s.abort(),clearTimeout(c),o(d)}let l=r instanceof Ll?"_on":"addEventListener";r[l](e,a.bind(null,C_.EVENT),{signal:s.signal});let c=setTimeout(a.bind(null,C_.TIMEOUT),t);return i})}var Ll=class{#e=Object.create(null);on(e,t,n=null){this._on(e,t,{external:!0,once:n?.once,signal:n?.signal})}off(e,t,n=null){this._off(e,t)}dispatch(e,t){let n=this.#e[e];if(!n||n.length===0)return;let i;for(let{listener:o,external:s,once:a}of n.slice(0)){if(a&&this._off(e,o),s){(i||=[]).push(o);continue}o(t)}if(i){for(let o of i)o(t);i=null}}_on(e,t,n=null){let i=null;if(n?.signal instanceof AbortSignal){let{signal:s}=n;if(s.aborted){console.error("Cannot use an `aborted` signal.");return}let a=()=>this._off(e,t);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}(this.#e[e]||=[]).push({listener:t,external:n?.external===!0,once:n?.once===!0,rmAbort:i})}_off(e,t,n=null){let i=this.#e[e];if(i)for(let o=0,s=i.length;o<s;o++){let a=i[o];if(a.listener===t){a.rmAbort?.(),i.splice(o,1);return}}}};var Nr=class{constructor(e){this.value=e}valueOf(){return this.value}},Ct=class extends Nr{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},Mn=class extends Nr{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},Yi=class extends Nr{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}},E_=100,VO="\u2068",UO="\u2069";function zO(r,e,t){if(t===e||t instanceof Mn&&e instanceof Mn&&t.value===e.value)return!0;if(e instanceof Mn&&typeof t=="string"){let n=r.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===n)return!0}return!1}function S_(r,e,t){return e[t]?Br(r,e[t].value):(r.reportError(new RangeError("No default")),new Ct)}function vf(r,e){let t=[],n=Object.create(null);for(let i of e)i.type==="narg"?n[i.name]=Xo(r,i.value):t.push(Xo(r,i));return{positional:t,named:n}}function Xo(r,e){switch(e.type){case"str":return e.value;case"num":return new Mn(e.value,{minimumFractionDigits:e.precision});case"var":return qO(r,e);case"mesg":return HO(r,e);case"term":return WO(r,e);case"func":return GO(r,e);case"select":return $O(r,e);default:return new Ct}}function qO(r,{name:e}){let t;if(r.params)if(Object.prototype.hasOwnProperty.call(r.params,e))t=r.params[e];else return new Ct(`$${e}`);else if(r.args&&Object.prototype.hasOwnProperty.call(r.args,e))t=r.args[e];else return r.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Ct(`$${e}`);if(t instanceof Nr)return t;switch(typeof t){case"string":return t;case"number":return new Mn(t);case"object":if(t instanceof Date)return new Yi(t.getTime());default:return r.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new Ct(`$${e}`)}}function HO(r,{name:e,attr:t}){let n=r.bundle._messages.get(e);if(!n)return r.reportError(new ReferenceError(`Unknown message: ${e}`)),new Ct(e);if(t){let i=n.attributes[t];return i?Br(r,i):(r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Ct(`${e}.${t}`))}return n.value?Br(r,n.value):(r.reportError(new ReferenceError(`No value: ${e}`)),new Ct(e))}function WO(r,{name:e,attr:t,args:n}){let i=`-${e}`,o=r.bundle._terms.get(i);if(!o)return r.reportError(new ReferenceError(`Unknown term: ${i}`)),new Ct(i);if(t){let a=o.attributes[t];if(a){r.params=vf(r,n).named;let l=Br(r,a);return r.params=null,l}return r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Ct(`${i}.${t}`)}r.params=vf(r,n).named;let s=Br(r,o.value);return r.params=null,s}function GO(r,{name:e,args:t}){let n=r.bundle._functions[e];if(!n)return r.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Ct(`${e}()`);if(typeof n!="function")return r.reportError(new TypeError(`Function ${e}() is not callable`)),new Ct(`${e}()`);try{let i=vf(r,t);return n(i.positional,i.named)}catch(i){return r.reportError(i),new Ct(`${e}()`)}}function $O(r,{selector:e,variants:t,star:n}){let i=Xo(r,e);if(i instanceof Ct)return S_(r,t,n);for(let o of t){let s=Xo(r,o.key);if(zO(r,i,s))return Br(r,o.value)}return S_(r,t,n)}function H_(r,e){if(r.dirty.has(e))return r.reportError(new RangeError("Cyclic reference")),new Ct;r.dirty.add(e);let t=[],n=r.bundle._useIsolating&&e.length>1;for(let i of e){if(typeof i=="string"){t.push(r.bundle._transform(i));continue}if(r.placeables++,r.placeables>E_)throw r.dirty.delete(e),new RangeError(`Too many placeables expanded: ${r.placeables}, max allowed is ${E_}`);n&&t.push(VO),t.push(Xo(r,i).toString(r)),n&&t.push(UO)}return r.dirty.delete(e),t.join("")}function Br(r,e){return typeof e=="string"?r.bundle._transform(e):H_(r,e)}var bf=class{constructor(e,t,n){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=n}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let n=this.bundle._intls.get(e);n||(n={},this.bundle._intls.set(e,n));let i=JSON.stringify(t);return n[i]||(n[i]=new e(this.bundle.locales,t)),n[i]}};function Dl(r,e){let t=Object.create(null);for(let[n,i]of Object.entries(r))e.includes(n)&&(t[n]=i.valueOf());return t}var A_=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function XO(r,e){let t=r[0];if(t instanceof Ct)return new Ct(`NUMBER(${t.valueOf()})`);if(t instanceof Mn)return new Mn(t.valueOf(),it(it({},t.opts),Dl(e,A_)));if(t instanceof Yi)return new Mn(t.valueOf(),it({},Dl(e,A_)));throw new TypeError("Invalid argument to NUMBER")}var M_=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function KO(r,e){let t=r[0];if(t instanceof Ct)return new Ct(`DATETIME(${t.valueOf()})`);if(t instanceof Yi)return new Yi(t.valueOf(),it(it({},t.opts),Dl(e,M_)));if(t instanceof Mn)return new Yi(t.valueOf(),it({},Dl(e,M_)));throw new TypeError("Invalid argument to DATETIME")}var P_=new Map;function YO(r){let e=Array.isArray(r)?r.join(" "):r,t=P_.get(e);return t===void 0&&(t=new Map,P_.set(e,t)),t}var yf=class{constructor(e,{functions:t,useIsolating:n=!0,transform:i=o=>o}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions=it({NUMBER:XO,DATETIME:KO},t),this._useIsolating=n,this._transform=i,this._intls=YO(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let n=[];for(let i=0;i<e.body.length;i++){let o=e.body[i];if(o.id.startsWith("-")){if(t===!1&&this._terms.has(o.id)){n.push(new Error(`Attempt to override an existing term: "${o.id}"`));continue}this._terms.set(o.id,o)}else{if(t===!1&&this._messages.has(o.id)){n.push(new Error(`Attempt to override an existing message: "${o.id}"`));continue}this._messages.set(o.id,o)}}return n}formatPattern(e,t=null,n=null){if(typeof e=="string")return this._transform(e);let i=new bf(this,n,t);try{return H_(i,e).toString(i)}catch(o){if(i.errors&&o instanceof Error)return i.errors.push(o),new Ct().toString(i);throw o}}},df=/^(-?[a-zA-Z][\w-]*) *= */gm,O_=/\.([a-zA-Z][\w-]*) *= */y,QO=/\*?\[/y,uf=/(-?[0-9]+(?:\.([0-9]+))?)/y,JO=/([a-zA-Z][\w-]*)/y,T_=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,ZO=/^[A-Z][A-Z0-9_-]*$/,Pl=/([^{}\n\r]+)/y,eT=/([^\\"\n\r]*)/y,I_=/\\([\\"])/y,k_=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,tT=/^\n+/,R_=/ +$/,nT=/ *\r?\n/g,iT=/( *)$/,rT=/{\s*/y,L_=/\s*}/y,oT=/\[\s*/y,sT=/\s*] */y,aT=/\s*\(\s*/y,lT=/\s*->\s*/y,cT=/\s*:\s*/y,dT=/\s*,?\s*/y,uT=/\s+/y,xf=class{constructor(e){this.body=[],df.lastIndex=0;let t=0;for(;;){let M=df.exec(e);if(M===null)break;t=df.lastIndex;try{this.body.push(l(M[1]))}catch(q){if(q instanceof SyntaxError)continue;throw q}}function n(M){return M.lastIndex=t,M.test(e)}function i(M,q){if(e[t]===M)return t++,!0;if(q)throw new q(`Expected ${M}`);return!1}function o(M,q){if(n(M))return t=M.lastIndex,!0;if(q)throw new q(`Expected ${M.toString()}`);return!1}function s(M){M.lastIndex=t;let q=M.exec(e);if(q===null)throw new SyntaxError(`Expected ${M.toString()}`);return t=M.lastIndex,q}function a(M){return s(M)[1]}function l(M){let q=d(),U=c();if(q===null&&Object.keys(U).length===0)throw new SyntaxError("Expected message value or attributes");return{id:M,value:q,attributes:U}}function c(){let M=Object.create(null);for(;n(O_);){let q=a(O_),U=d();if(U===null)throw new SyntaxError("Expected attribute value");M[q]=U}return M}function d(){let M;if(n(Pl)&&(M=a(Pl)),e[t]==="{"||e[t]==="}")return u(M?[M]:[],1/0);let q=V();return q?M?u([M,q],q.length):(q.value=B(q.value,tT),u([q],q.length)):M?B(M,R_):null}function u(M=[],q){for(;;){if(n(Pl)){M.push(a(Pl));continue}if(e[t]==="{"){M.push(h());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let re=V();if(re){M.push(re),q=Math.min(q,re.length);continue}break}let U=M.length-1,ee=M[U];typeof ee=="string"&&(M[U]=B(ee,R_));let ie=[];for(let re of M)re instanceof Fl&&(re=re.value.slice(0,re.value.length-q)),re&&ie.push(re);return ie}function h(){o(rT,SyntaxError);let M=g();if(o(L_))return M;if(o(lT)){let q=L();return o(L_,SyntaxError),it({type:"select",selector:M},q)}throw new SyntaxError("Unclosed placeable")}function g(){if(e[t]==="{")return h();if(n(T_)){let[,M,q,U=null]=s(T_);if(M==="$")return{type:"var",name:q};if(o(aT)){let ee=v();if(M==="-")return{type:"term",name:q,attr:U,args:ee};if(ZO.test(q))return{type:"func",name:q,args:ee};throw new SyntaxError("Function names must be all upper-case")}return M==="-"?{type:"term",name:q,attr:U,args:[]}:{type:"mesg",name:q,attr:U}}return P()}function v(){let M=[];for(;;){switch(e[t]){case")":return t++,M;case void 0:throw new SyntaxError("Unclosed argument list")}M.push(x()),o(dT)}}function x(){let M=g();return M.type!=="mesg"?M:o(cT)?{type:"narg",name:M.name,value:P()}:M}function L(){let M=[],q=0,U;for(;n(QO);){i("*")&&(U=q);let ee=E(),ie=d();if(ie===null)throw new SyntaxError("Expected variant value");M[q++]={key:ee,value:ie}}if(q===0)return null;if(U===void 0)throw new SyntaxError("Expected default variant");return{variants:M,star:U}}function E(){o(oT,SyntaxError);let M;return n(uf)?M=S():M={type:"str",value:a(JO)},o(sT,SyntaxError),M}function P(){if(n(uf))return S();if(e[t]==='"')return w();throw new SyntaxError("Invalid expression")}function S(){let[,M,q=""]=s(uf),U=q.length;return{type:"num",value:parseFloat(M),precision:U}}function w(){i('"',SyntaxError);let M="";for(;;){if(M+=a(eT),e[t]==="\\"){M+=T();continue}if(i('"'))return{type:"str",value:M};throw new SyntaxError("Unclosed string literal")}}function T(){if(n(I_))return a(I_);if(n(k_)){let[,M,q]=s(k_),U=parseInt(M||q,16);return U<=55295||57344<=U?String.fromCodePoint(U):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function V(){let M=t;switch(o(uT),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return W(e.slice(M,t))}return e[t-1]===" "?W(e.slice(M,t)):!1}function B(M,q){return M.replace(q,"")}function W(M){let q=M.replace(nT,`
`),U=iT.exec(M)[1].length;return new Fl(q,U)}}},Fl=class{constructor(e,t){this.value=e,this.length=t}},hT=/<|&#?\w+;/,fT={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},pT={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function gT(r,e){let{value:t}=e;if(typeof t=="string")if(r.localName==="title"&&r.namespaceURI==="http://www.w3.org/1999/xhtml")r.textContent=t;else if(!hT.test(t))r.textContent=t;else{let n=r.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");n.innerHTML=t,mT(n.content,r)}W_(e,r)}function mT(r,e){for(let t of r.childNodes)if(t.nodeType!==t.TEXT_NODE){if(t.hasAttribute("data-l10n-name")){let n=vT(e,t);r.replaceChild(n,t);continue}if(yT(t)){let n=bT(t);r.replaceChild(n,t);continue}console.warn(`An element of forbidden type "${t.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),r.replaceChild(wf(t),t)}e.textContent="",e.appendChild(r)}function _T(r,e){if(!r)return!1;for(let t of r)if(t.name===e)return!0;return!1}function W_(r,e){let t=e.hasAttribute("data-l10n-attrs")?e.getAttribute("data-l10n-attrs").split(",").map(n=>n.trim()):null;for(let n of Array.from(e.attributes))D_(n.name,e,t)&&!_T(r.attributes,n.name)&&e.removeAttribute(n.name);if(r.attributes)for(let n of Array.from(r.attributes))D_(n.name,e,t)&&e.getAttribute(n.name)!==n.value&&e.setAttribute(n.name,n.value)}function vT(r,e){let t=e.getAttribute("data-l10n-name"),n=r.querySelector(`[data-l10n-name="${t}"]`);if(!n)return console.warn(`An element named "${t}" wasn't found in the source.`),wf(e);if(n.localName!==e.localName)return console.warn(`An element named "${t}" was found in the translation but its type ${e.localName} didn't match the element found in the source (${n.localName}).`),wf(e);r.removeChild(n);let i=n.cloneNode(!1);return G_(e,i)}function bT(r){let e=r.ownerDocument.createElement(r.localName);return G_(r,e)}function wf(r){return r.ownerDocument.createTextNode(r.textContent)}function yT(r){let e=fT[r.namespaceURI];return e&&e.includes(r.localName)}function D_(r,e,t=null){if(t&&t.includes(r))return!0;let n=pT[e.namespaceURI];if(!n)return!1;let i=r.toLowerCase(),o=e.localName;if(n.global.includes(i))return!0;if(!n[o])return!1;if(n[o].includes(i))return!0;if(e.namespaceURI==="http://www.w3.org/1999/xhtml"&&o==="input"&&i==="value"){let s=e.type.toLowerCase();if(s==="submit"||s==="button"||s==="reset")return!0}return!1}function G_(r,e){return e.textContent=r.textContent,W_(r,e),e}var Cf=class extends Array{static from(e){return e instanceof this?e:new this(e)}};var Ef=class extends Cf{constructor(e){if(super(),Symbol.asyncIterator in Object(e))this.iterator=e[Symbol.asyncIterator]();else if(Symbol.iterator in Object(e))this.iterator=e[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){let e=this,t=0;return{next(){return G(this,null,function*(){return e.length<=t&&e.push(e.iterator.next()),e[t++]})}}}touchNext(e=1){return G(this,null,function*(){let t=0;for(;t++<e;){let n=this[this.length-1];if(n&&(yield n).done)break;this.push(this.iterator.next())}return this[this.length-1]})}},Sf=class{constructor(e=[],t){this.resourceIds=e,this.generateBundles=t,this.onChange(!0)}addResourceIds(e,t=!1){return this.resourceIds.push(...e),this.onChange(t),this.resourceIds.length}removeResourceIds(e){return this.resourceIds=this.resourceIds.filter(t=>!e.includes(t)),this.onChange(),this.resourceIds.length}formatWithFallback(e,t){return G(this,null,function*(){let n=[],i=!1;try{for(var o=Wf(this.bundles),s,a,l;s=!(a=yield o.next()).done;s=!1){let c=a.value;i=!0;let d=CT(t,c,e,n);if(d.size===0)break;if(typeof console<"u"){let u=c.locales[0],h=Array.from(d).join(", ");console.warn(`[fluent] Missing translations in ${u}: ${h}`)}}}catch{l=[a]}finally{try{s&&(a=o.return)&&(yield a.call(o))}finally{if(l)throw l[0]}}return!i&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(e)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),n})}formatMessages(e){return this.formatWithFallback(e,wT)}formatValues(e){return this.formatWithFallback(e,xT)}formatValue(e,t){return G(this,null,function*(){let[n]=yield this.formatValues([{id:e,args:t}]);return n})}handleEvent(){this.onChange()}onChange(e=!1){this.bundles=Ef.from(this.generateBundles(this.resourceIds)),e&&this.bundles.touchNext(2)}};function xT(r,e,t,n){return t.value?r.formatPattern(t.value,n,e):null}function wT(r,e,t,n){let i={value:null,attributes:null};t.value&&(i.value=r.formatPattern(t.value,n,e));let o=Object.keys(t.attributes);if(o.length>0){i.attributes=new Array(o.length);for(let[s,a]of o.entries()){let l=r.formatPattern(t.attributes[a],n,e);i.attributes[s]={name:a,value:l}}}return i}function CT(r,e,t,n){let i=[],o=new Set;return t.forEach(({id:s,args:a},l)=>{if(n[l]!==void 0)return;let c=e.getMessage(s);if(c){if(i.length=0,n[l]=r(e,i,c,a),i.length>0&&typeof console<"u"){let d=e.locales[0],u=i.join(", ");console.warn(`[fluent][resolver] errors in ${d}/${s}: ${u}.`)}}else o.add(s)}),o}var Ki="data-l10n-id",qo="data-l10n-args",ET=`[${Ki}]`,Af=class extends Sf{constructor(e,t){super(e,t),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[Ki,qo]}}onChange(e=!1){super.onChange(e),this.roots&&this.translateRoots()}setAttributes(e,t,n){return e.setAttribute(Ki,t),n?e.setAttribute(qo,JSON.stringify(n)):e.removeAttribute(qo),e}getAttributes(e){return{id:e.getAttribute(Ki),args:JSON.parse(e.getAttribute(qo)||null)}}connectRoot(e){for(let t of this.roots)if(t===e||t.contains(e)||e.contains(t))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==e.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=e.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(t=>this.translateMutations(t));this.roots.add(e),this.mutationObserver.observe(e,this.observerConfig)}disconnectRoot(e){return this.roots.delete(e),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){let e=Array.from(this.roots);return Promise.all(e.map(t=>this.translateFragment(t)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(let e of this.roots)this.mutationObserver.observe(e,this.observerConfig)}translateMutations(e){for(let t of e)switch(t.type){case"attributes":t.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(t.target);break;case"childList":for(let n of t.addedNodes)if(n.nodeType===n.ELEMENT_NODE)if(n.childElementCount)for(let i of this.getTranslatables(n))this.pendingElements.add(i);else n.hasAttribute(Ki)&&this.pendingElements.add(n);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(e){return this.translateElements(this.getTranslatables(e))}translateElements(e){return G(this,null,function*(){if(!e.length)return;let t=e.map(this.getKeysForElement),n=yield this.formatMessages(t);return this.applyTranslations(e,n)})}applyTranslations(e,t){this.pauseObserving();for(let n=0;n<e.length;n++)t[n]!==void 0&&gT(e[n],t[n]);this.resumeObserving()}getTranslatables(e){let t=Array.from(e.querySelectorAll(ET));return typeof e.hasAttribute=="function"&&e.hasAttribute(Ki)&&t.push(e),t}getKeysForElement(e){return{id:e.getAttribute(Ki),args:JSON.parse(e.getAttribute(qo)||null)}}},Mf=class r{#e;#t;#n;#i;constructor({lang:e,isRTL:t},n=null){this.#n=r.#o(e),this.#i=n,this.#e=t??r.#r(this.#n)?"rtl":"ltr"}_setL10n(e){this.#i=e}getLanguage(){return this.#n}getDirection(){return this.#e}get(e,t=null,n){return G(this,null,function*(){return Array.isArray(e)?(e=e.map(s=>({id:s})),(yield this.#i.formatMessages(e)).map(s=>s.value)):(yield this.#i.formatMessages([{id:e,args:t}]))[0]?.value||n})}translate(e){return G(this,null,function*(){(this.#t||=new Set).add(e);try{this.#i.connectRoot(e),yield this.#i.translateRoots()}catch{}})}translateOnce(e){return G(this,null,function*(){try{yield this.#i.translateElements([e])}catch(t){console.error(`translateOnce: "${t}".`)}})}destroy(){return G(this,null,function*(){if(this.#t){for(let e of this.#t)this.#i.disconnectRoot(e);this.#t.clear(),this.#t=null}this.#i.pauseObserving()})}pause(){this.#i.pauseObserving()}resume(){this.#i.resumeObserving()}static#o(e){return e=e?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[e]||e}static#r(e){let t=e.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(t)}};function F_(r,e){let t=new xf(e),n=new yf(r),i=n.addResource(t);return i.length&&console.error("L10n errors",i),n}var jr=class r extends Mf{constructor(e){super({lang:e});let t=e?r.#e.bind(r,"en-us",this.getLanguage()):r.#i.bind(r,this.getLanguage());this._setL10n(new Af([],t))}static#e(e,t){return Ac(this,null,function*(){let{baseURL:n,paths:i}=yield new Sc(this.#n()),o=[t];if(e!==t){let s=t.split("-",1)[0];s!==t&&o.push(s),o.push(e)}for(let s of o){let a=yield new Sc(this.#t(s,n,i));a?yield a:s==="en-us"&&(yield this.#o(s))}})}static#t(e,t,n){return G(this,null,function*(){let i=n[e];if(!i)return null;let o=new URL(i,t),s=yield y_(o,"text");return F_(e,s)})}static#n(){return G(this,null,function*(){try{let{href:e}=document.querySelector('link[type="application/l10n"]'),t=yield y_(e,"json");return{baseURL:e.replace(/[^/]*$/,"")||"./",paths:t}}catch{}return{baseURL:"./",paths:Object.create(null)}})}static#i(e){return Ac(this,null,function*(){yield this.#o(e)})}static#o(e){return G(this,null,function*(){return F_(e,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Properties\u2026
pdfjs-document-properties-button-label = Document Properties\u2026
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width } \xD7 { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width } \xD7 { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printing\u2026
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in document\u2026
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-free-text2 =
    .aria-label = Text Editor
    .default-content = Start typing\u2026
pdfjs-ink =
    .aria-label = Draw Editor
pdfjs-ink-canvas =
    .aria-label = User-created image
pdfjs-editor-alt-text-button =
    .aria-label = Alt text
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button =
    .aria-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can\u2019t see the image or when it doesn\u2019t load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, \u201CA young man sits down at a table to eat a meal\u201D
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner \u2014 resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle \u2014 resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner \u2014 resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right \u2014 resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner \u2014 resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle \u2014 resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner \u2014 resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left \u2014 resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description here\u2026
pdfjs-editor-new-alt-text-description = Short description for people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldn\u2019t create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button =
    .aria-label = Alt text added
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button =
    .aria-label = Missing alt text
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button =
    .aria-label = Review alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloading\u2026
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close`)})}},ST=1e3,hf=50,N_=1e3;function ff(){return document.location.hash}var Pf=class{#e=null;constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",n=>{this._isPagesLoaded=!!n.pagesCount},{once:!0})})}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:n=!1}){if(!e||typeof e!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();let i=this._fingerprint!==""&&this._fingerprint!==e;this._fingerprint=e,this._updateUrl=n===!0,this._initialized=!0,this.#u();let o=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=ff(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#o(o,!0)||t){let{hash:a,page:l,rotation:c}=this.#l(!0);if(!a||i||t){this.#t(null,!0);return}this.#t({hash:a,page:l,rotation:c},!0);return}let s=o.destination;this.#r(s,o.uid,!0),s.rotation!==void 0&&(this._initialRotation=s.rotation),s.dest?(this._initialBookmark=JSON.stringify(s.dest),this._destination.page=null):s.hash?this._initialBookmark=s.hash:s.page&&(this._initialBookmark=`page=${s.page}`)}reset(){this._initialized&&(this.#a(),this._initialized=!1,this.#s()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:e=null,explicitDest:t,pageNumber:n}){if(!this._initialized)return;if(e&&typeof e!="string"){console.error(`PDFHistory.push: "${e}" is not a valid namedDest parameter.`);return}else if(Array.isArray(t)){if(!this.#i(n)&&(n!==null||this._destination)){console.error(`PDFHistory.push: "${n}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${t}" is not a valid explicitDest parameter.`);return}let i=e||JSON.stringify(t);if(!i)return;let o=!1;if(this._destination&&(AT(this._destination.hash,i)||MT(this._destination.dest,t))){if(this._destination.page)return;o=!0}this._popStateInProgress&&!o||(this.#t({dest:t,hash:i,page:n,rotation:this.linkService.rotation},o),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(e){if(this._initialized){if(!this.#i(e)){console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`);return}this._destination?.page!==e&&(this._popStateInProgress||(this.#t({dest:null,hash:`page=${e}`,page:e,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#n()}back(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#o(e)&&e.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#o(e)&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#t(e,t=!1){let n=t||!this._destination,i={fingerprint:this._fingerprint,uid:n?this._uid:this._uid+1,destination:e};this.#r(e,i.uid);let o;if(this._updateUrl&&e?.hash){let s=document.location.href.split("#",1)[0];s.startsWith("file://")||(o=`${s}#${e.hash}`)}n?window.history.replaceState(i,"",o):window.history.pushState(i,"",o)}#n(e=!1){if(!this._position)return;let t=this._position;if(e&&(t=Object.assign(Object.create(null),this._position),t.temporary=!0),!this._destination){this.#t(t);return}if(this._destination.temporary){this.#t(t,!0);return}if(this._destination.hash===t.hash||!this._destination.page&&(hf<=0||this._numPositionUpdates<=hf))return;let n=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(this._destination.dest!==void 0||!this._destination.first)return;n=!0}this.#t(t,n)}#i(e){return Number.isInteger(e)&&e>0&&e<=this.linkService.pagesCount}#o(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint)if(t){if(typeof e.fingerprint!="string"||e.fingerprint.length!==this._fingerprint.length)return!1;let[n]=performance.getEntriesByType("navigation");if(n?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(e.uid)||e.uid<0||e.destination===null||typeof e.destination!="object")}#r(e,t,n=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),n&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}#l(e=!1){let t=unescape(ff()).substring(1),n=zl(t),i=n.get("nameddest")||"",o=n.get("page")|0;return(!this.#i(o)||e&&i.length>0)&&(o=null),{hash:t,page:o,rotation:this.linkService.rotation}}#c({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},!this._popStateInProgress&&(hf>0&&this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,N_>0&&(this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#n(!0),this._updateViewareaTimeout=null},N_)))}#d({state:e}){let t=ff(),n=this._currentHash!==t;if(this._currentHash=t,!e){this._uid++;let{hash:o,page:s,rotation:a}=this.#l();this.#t({hash:o,page:s,rotation:a},!0);return}if(!this.#o(e))return;this._popStateInProgress=!0,n&&(this._blockHashChange++,jO({target:window,name:"hashchange",delay:ST}).then(()=>{this._blockHashChange--}));let i=e.destination;this.#r(i,e.uid,!0),q_(i.rotation)&&(this.linkService.rotation=i.rotation),i.dest?this.linkService.goToDestination(i.dest):i.hash?this.linkService.setHash(i.hash):i.page&&(this.linkService.page=i.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#a(){(!this._destination||this._destination.temporary)&&this.#n()}#u(){if(this.#e)return;this.#e=new AbortController;let{signal:e}=this.#e;this.eventBus._on("updateviewarea",this.#c.bind(this),{signal:e}),window.addEventListener("popstate",this.#d.bind(this),{signal:e}),window.addEventListener("pagehide",this.#a.bind(this),{signal:e})}#s(){this.#e?.abort(),this.#e=null}};function AT(r,e){return typeof r!="string"||typeof e!="string"?!1:r===e||zl(r).get("nameddest")===e}function MT(r,e){function t(n,i){if(typeof n!=typeof i||Array.isArray(n)||Array.isArray(i))return!1;if(n!==null&&typeof n=="object"&&i!==null){if(Object.keys(n).length!==Object.keys(i).length)return!1;for(let o in n)if(!t(n[o],i[o]))return!1;return!0}return n===i||Number.isNaN(n)&&Number.isNaN(i)}if(!(Array.isArray(r)&&Array.isArray(e))||r.length!==e.length)return!1;for(let n=0,i=r.length;n<i;n++)if(!t(r[n],e[n]))return!1;return!0}var Of=class{#e=null;#t=null;#n=null;#i=null;#o=null;#r;constructor(e){this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n,this.l10n||=new jr,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#r=e.uiManager,this.#e=e.annotationLayer||null,this.#o=e.textLayer||null,this.#t=e.drawLayer||null,this.#n=e.onAppend||null,this.#i=e.structTreeLayer||null}render(e,t="display"){return G(this,null,function*(){if(t!=="display"||this._cancelled)return;let n=e.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:n}),this.show();return}let i=this.div=document.createElement("div");i.className="annotationEditorLayer",i.hidden=!0,i.dir=this.#r.direction,this.#n?.(i),this.annotationEditorLayer=new PO({uiManager:this.#r,div:i,structTreeLayer:this.#i,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:n,annotationLayer:this.#e,textLayer:this.#o,drawLayer:this.#t});let o={viewport:n,div:i,annotations:null,intent:t};this.annotationEditorLayer.render(o),this.show()})}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1)}};{Tl=new Map;let r=navigator.userAgent||"",e=navigator.platform||"",t=navigator.maxTouchPoints||1,n=/Android/.test(r),i=/\b(iPad|iPhone|iPod)(?=;)/.test(r)||e==="MacIntel"&&t>1;(function(){(i||n)&&Tl.set("maxCanvasPixels",5242880)})(),function(){n&&Tl.set("useSystemFonts",!1)}()}var Tl,se={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},Tf={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},Vn={allowedGlobalEvents:{value:null,kind:se.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:se.BROWSER+se.API},isInAutomation:{value:!1,kind:se.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:se.BROWSER},nimbusDataStr:{value:"",kind:se.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:se.BROWSER},supportsDocumentFonts:{value:!0,kind:se.BROWSER},supportsIntegratedFind:{value:!1,kind:se.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:se.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:se.BROWSER},supportsPinchToZoom:{value:!0,kind:se.BROWSER},toolbarDensity:{value:0,kind:se.BROWSER+se.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:se.VIEWER+se.PREFERENCE},annotationEditorMode:{value:0,kind:se.VIEWER+se.PREFERENCE},annotationMode:{value:2,kind:se.VIEWER+se.PREFERENCE},cursorToolOnLoad:{value:0,kind:se.VIEWER+se.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:se.VIEWER},defaultZoomDelay:{value:400,kind:se.VIEWER+se.PREFERENCE},defaultZoomValue:{value:"",kind:se.VIEWER+se.PREFERENCE},disableHistory:{value:!1,kind:se.VIEWER},disablePageLabels:{value:!1,kind:se.VIEWER+se.PREFERENCE},enableAltText:{value:!1,kind:se.VIEWER+se.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:se.VIEWER+se.PREFERENCE+se.EVENT_DISPATCH},enableGuessAltText:{value:!0,kind:se.VIEWER+se.PREFERENCE+se.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:se.VIEWER+se.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:se.VIEWER+se.PREFERENCE},enablePermissions:{value:!1,kind:se.VIEWER+se.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:se.VIEWER+se.PREFERENCE},enableScripting:{value:!0,kind:se.VIEWER+se.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:se.VIEWER+se.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:se.VIEWER},externalLinkTarget:{value:0,kind:se.VIEWER+se.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:se.VIEWER+se.PREFERENCE},historyUpdateUrl:{value:!1,kind:se.VIEWER+se.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:se.VIEWER+se.PREFERENCE},imageResourcesPath:{value:"./images/",kind:se.VIEWER},maxCanvasPixels:{value:2**25,kind:se.VIEWER},forcePageColors:{value:!1,kind:se.VIEWER+se.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:se.VIEWER+se.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:se.VIEWER+se.PREFERENCE},pdfBugEnabled:{value:!1,kind:se.VIEWER+se.PREFERENCE},printResolution:{value:150,kind:se.VIEWER},sidebarViewOnLoad:{value:-1,kind:se.VIEWER+se.PREFERENCE},scrollModeOnLoad:{value:-1,kind:se.VIEWER+se.PREFERENCE},spreadModeOnLoad:{value:-1,kind:se.VIEWER+se.PREFERENCE},textLayerMode:{value:1,kind:se.VIEWER+se.PREFERENCE},viewOnLoad:{value:0,kind:se.VIEWER+se.PREFERENCE},cMapPacked:{value:!0,kind:se.API},cMapUrl:{value:"../web/cmaps/",kind:se.API},disableAutoFetch:{value:!1,kind:se.API+se.PREFERENCE},disableFontFace:{value:!1,kind:se.API+se.PREFERENCE},disableRange:{value:!1,kind:se.API+se.PREFERENCE},disableStream:{value:!1,kind:se.API+se.PREFERENCE},docBaseUrl:{value:"",kind:se.API},enableHWA:{value:!0,kind:se.API+se.VIEWER+se.PREFERENCE},enableXfa:{value:!0,kind:se.API+se.PREFERENCE},fontExtraProperties:{value:!1,kind:se.API},isEvalSupported:{value:!0,kind:se.API},isOffscreenCanvasSupported:{value:!0,kind:se.API},maxImageSize:{value:-1,kind:se.API},pdfBug:{value:!1,kind:se.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:se.API},useSystemFonts:{value:void 0,kind:se.API,type:Tf.BOOLEAN+Tf.UNDEFINED},verbosity:{value:1,kind:se.API},workerPort:{value:null,kind:se.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:se.WORKER}};Vn.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:se.VIEWER},Vn.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:se.VIEWER},Vn.viewerCssTheme={value:0,kind:se.VIEWER+se.PREFERENCE},Vn.enableFakeMLManager={value:!0,kind:se.VIEWER};Vn.disablePreferences={value:!1,kind:se.VIEWER};var Mi,Bn=class Bn{static get(e){return Vt(this,Mi).get(e)}static getAll(e=null,t=!1){let n=Object.create(null);for(let i in Vn){let o=Vn[i];e&&!(e&o.kind)||(n[i]=t?o.value:Vt(this,Mi).get(i))}return n}static set(e,t){this.setAll({[e]:t})}static setAll(e,t=!1){this._hasInvokedSet||=!0;let n;for(let i in e){let o=Vn[i],s=e[i];if(!o||!(typeof s==typeof o.value||Tf[(typeof s).toUpperCase()]&o.type))continue;let{kind:a}=o;t&&!(a&se.BROWSER||a&se.PREFERENCE)||(this.eventBus&&a&se.EVENT_DISPATCH&&(n||=new Map).set(i,s),Vt(this,Mi).set(i,s))}if(n)for(let[i,o]of n)this.eventBus.dispatch(i.toLowerCase(),{source:this,value:o})}};Mi=new WeakMap,qf(Bn,"eventBus"),ai(Bn,Mi,new Map),(()=>{for(let e in Vn)Vt(Bn,Mi).set(e,Vn[e].value);for(let[e,t]of Tl)Vt(Bn,Mi).set(e,t);Bn._hasInvokedSet=!1,Bn._checkDisablePreferences=()=>Bn.get("disablePreferences")?!0:(Bn._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)})();var If=Bn,kf=class{#e=null;constructor(e){this.pageIndex=e.pageIndex}render(e="display"){return G(this,null,function*(){e!=="display"||this.#e||this._cancelled||(this.#e=new kO({pageIndex:this.pageIndex}))})}cancel(){this._cancelled=!0,this.#e&&(this.#e.destroy(),this.#e=null)}setParent(e){this.#e?.setParent(e)}getDrawLayer(){return this.#e}},B_={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},PT=/^H(\d+)$/,Nl=class{#e;#t=null;#n;#i=new Map;#o;#r=null;constructor(e,t){this.#e=e.getStructTree(),this.#o=t}render(){return G(this,null,function*(){if(this.#n)return this.#n;let{promise:e,resolve:t,reject:n}=Promise.withResolvers();this.#n=e;try{this.#t=this.#d(yield this.#e)}catch(i){n(i)}return this.#e=null,this.#t?.classList.add("structTree"),t(this.#t),e})}getAriaAttributes(e){return G(this,null,function*(){try{return yield this.render(),this.#i.get(e)}catch{}return null})}hide(){this.#t&&!this.#t.hidden&&(this.#t.hidden=!0)}show(){this.#t?.hidden&&(this.#t.hidden=!1)}#l(e,t){let{alt:n,id:i,lang:o}=e;if(n!==void 0){let s=!1,a=Wo(n);for(let l of e.children)if(l.type==="annotation"){let c=this.#i.get(l.id);c||(c=new Map,this.#i.set(l.id,c)),c.set("aria-label",a),s=!0}s||t.setAttribute("aria-label",a)}i!==void 0&&t.setAttribute("aria-owns",i),o!==void 0&&t.setAttribute("lang",Wo(o,!0))}#c(e,t){let{alt:n,bbox:i,children:o}=e,s=o?.[0];if(!this.#o||!n||!i||s?.type!=="content")return!1;let{id:a}=s;if(!a)return!1;t.setAttribute("aria-owns",a);let l=document.createElement("span");(this.#r||=new Map).set(a,l),l.setAttribute("role","img"),l.setAttribute("aria-label",Wo(n));let{pageHeight:c,pageX:d,pageY:u}=this.#o,h="calc(var(--scale-factor)*",{style:g}=l;return g.width=`${h}${i[2]-i[0]}px)`,g.height=`${h}${i[3]-i[1]}px)`,g.left=`${h}${i[0]-d}px)`,g.top=`${h}${c-i[3]+u}px)`,!0}addElementsToTextLayer(){if(this.#r){for(let[e,t]of this.#r)document.getElementById(e)?.append(t);this.#r.clear(),this.#r=null}}#d(e){if(!e)return null;let t=document.createElement("span");if("role"in e){let{role:n}=e,i=n.match(PT);if(i?(t.setAttribute("role","heading"),t.setAttribute("aria-level",i[1])):B_[n]&&t.setAttribute("role",B_[n]),n==="Figure"&&this.#c(e,t))return t}if(this.#l(e,t),e.children)if(e.children.length===1&&"id"in e.children[0])this.#l(e.children[0],t);else for(let n of e.children)t.append(this.#d(n));return t}},Rf=class r{#e=!1;#t=null;#n=new Map;#i=new Map;setTextMapping(e){this.#t=e}static#o(e,t){let n=e.getBoundingClientRect(),i=t.getBoundingClientRect();if(n.width===0&&n.height===0)return 1;if(i.width===0&&i.height===0)return-1;let o=n.y,s=n.y+n.height,a=n.y+n.height/2,l=i.y,c=i.y+i.height,d=i.y+i.height/2;if(a<=l&&d>=s)return-1;if(d<=o&&a>=c)return 1;let u=n.x+n.width/2,h=i.x+i.width/2;return u-h}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(r.#o),this.#n.size>0){let e=this.#t;for(let[t,n]of this.#n){if(!document.getElementById(t)){this.#n.delete(t);continue}this.#r(t,e[n])}}for(let[e,t]of this.#i)this.addPointerInTextLayer(e,t);this.#i.clear()}disable(){this.#e&&(this.#i.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(e){if(!this.#e){this.#i.delete(e);return}let t=this.#t;if(!t||t.length===0)return;let{id:n}=e,i=this.#n.get(n);if(i===void 0)return;let o=t[i];this.#n.delete(n);let s=o.getAttribute("aria-owns");s?.includes(n)&&(s=s.split(" ").filter(a=>a!==n).join(" "),s?o.setAttribute("aria-owns",s):(o.removeAttribute("aria-owns"),o.setAttribute("role","presentation")))}#r(e,t){let n=t.getAttribute("aria-owns");n?.includes(e)||t.setAttribute("aria-owns",n?`${n} ${e}`:e),t.removeAttribute("role")}addPointerInTextLayer(e,t){let{id:n}=e;if(!n)return null;if(!this.#e)return this.#i.set(e,t),null;t&&this.removePointerInTextLayer(e);let i=this.#t;if(!i||i.length===0)return null;let o=Go(i,c=>r.#o(e,c)<0),s=Math.max(0,o-1),a=i[s];this.#r(n,a),this.#n.set(n,s);let l=a.parentNode;return l?.classList.contains("markedContent")?l.id:null}moveElementInDOM(e,t,n,i){let o=this.addPointerInTextLayer(n,i);if(!e.hasChildNodes())return e.append(t),o;let s=Array.from(e.childNodes).filter(c=>c!==t);if(s.length===0)return o;let a=n||t,l=Go(s,c=>r.#o(a,c)<0);return l===0?s[0].before(t):s[l-1].after(t),o}},Lf=class{#e=null;constructor({findController:e,eventBus:t,pageIndex:n}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=n,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#e||(this.#e=new AbortController,this.eventBus._on("updatetextlayermatches",e=>{(e.pageIndex===this.pageIdx||e.pageIndex===-1)&&this._updateMatches()},{signal:this.#e.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#e?.abort(),this.#e=null,this._updateMatches(!0))}_convertMatches(e,t){if(!e)return[];let{textContentItemsStr:n}=this,i=0,o=0,s=n.length-1,a=[];for(let l=0,c=e.length;l<c;l++){let d=e[l];for(;i!==s&&d>=o+n[i].length;)o+=n[i].length,i++;i===n.length&&console.error("Could not find a matching mapping");let u={begin:{divIdx:i,offset:d-o}};for(d+=t[l];i!==s&&d>o+n[i].length;)o+=n[i].length,i++;u.end={divIdx:i,offset:d-o},a.push(u)}return a}_renderMatches(e){if(e.length===0)return;let{findController:t,pageIdx:n}=this,{textContentItemsStr:i,textDivs:o}=this,s=n===t.selected.pageIdx,a=t.selected.matchIdx,l=t.state.highlightAll,c=null,d={divIdx:-1,offset:void 0};function u(E,P){let S=E.divIdx;return o[S].textContent="",h(S,0,E.offset,P)}function h(E,P,S,w){let T=o[E];if(T.nodeType===Node.TEXT_NODE){let W=document.createElement("span");T.before(W),W.append(T),o[E]=W,T=W}let V=i[E].substring(P,S),B=document.createTextNode(V);if(w){let W=document.createElement("span");return W.className=`${w} appended`,W.append(B),T.append(W),w.includes("selected")?W.offsetLeft:0}return T.append(B),0}let g=a,v=g+1;if(l)g=0,v=e.length;else if(!s)return;let x=-1,L=-1;for(let E=g;E<v;E++){let P=e[E],S=P.begin;if(S.divIdx===x&&S.offset===L)continue;x=S.divIdx,L=S.offset;let w=P.end,T=s&&E===a,V=T?" selected":"",B=0;if(!c||S.divIdx!==c.divIdx?(c!==null&&h(c.divIdx,c.offset,d.offset),u(S)):h(c.divIdx,c.offset,S.offset),S.divIdx===w.divIdx)B=h(S.divIdx,S.offset,w.offset,"highlight"+V);else{B=h(S.divIdx,S.offset,d.offset,"highlight begin"+V);for(let W=S.divIdx+1,M=w.divIdx;W<M;W++)o[W].className="highlight middle"+V;u(w,"highlight end"+V)}c=w,T&&t.scrollMatchIntoView({element:o[S.divIdx],selectedLeft:B,pageIndex:n,matchIndex:a})}c&&h(c.divIdx,c.offset,d.offset)}_updateMatches(e=!1){if(!this.enabled&&!e)return;let{findController:t,matches:n,pageIdx:i}=this,{textContentItemsStr:o,textDivs:s}=this,a=-1;for(let d of n){let u=Math.max(a,d.begin.divIdx);for(let h=u,g=d.end.divIdx;h<=g;h++){let v=s[h];v.textContent=o[h],v.className=""}a=d.end.divIdx+1}if(!t?.highlightMatches||e)return;let l=t.pageMatches[i]||null,c=t.pageMatchesLength[i]||null;this.matches=this._convertMatches(l,c),this._renderMatches(this.matches)}},Bl=class r{#e=!1;#t=null;#n=!1;#i=null;static#o=new Map;static#r=null;constructor({pdfPage:e,highlighter:t=null,accessibilityManager:n=null,enablePermissions:i=!1,onAppend:o=null}){this.pdfPage=e,this.highlighter=t,this.accessibilityManager=n,this.#e=i===!0,this.#t=o,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}render(e,t=null){return G(this,null,function*(){if(this.#n&&this.#i){this.#i.update({viewport:e,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#i=new BO({textContentSource:this.pdfPage.streamTextContent(t||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:e});let{textDivs:n,textContentItemsStr:i}=this.#i;this.highlighter?.setTextMapping(n,i),this.accessibilityManager?.setTextMapping(n),yield this.#i.render(),this.#n=!0;let o=document.createElement("div");o.className="endOfContent",this.div.append(o),this.#l(o),this.#t?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()})}hide(){!this.div.hidden&&this.#n&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#n&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#i?.cancel(),this.#i=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),r.#c(this.div)}#l(e){let{div:t}=this;t.addEventListener("mousedown",()=>{t.classList.add("selecting")}),t.addEventListener("copy",n=>{if(!this.#e){let i=document.getSelection();n.clipboardData.setData("text/plain",Wo(DO(i.toString())))}n.preventDefault(),n.stopPropagation()}),r.#o.set(t,e),r.#d()}static#c(e){this.#o.delete(e),this.#o.size===0&&(this.#r?.abort(),this.#r=null)}static#d(){if(this.#r)return;this.#r=new AbortController;let{signal:e}=this.#r,t=(s,a)=>{a.append(s),s.style.width="",s.style.height="",a.classList.remove("selecting")},n=!1;document.addEventListener("pointerdown",()=>{n=!0},{signal:e}),document.addEventListener("pointerup",()=>{n=!1,this.#o.forEach(t)},{signal:e}),window.addEventListener("blur",()=>{n=!1,this.#o.forEach(t)},{signal:e}),document.addEventListener("keyup",()=>{n||this.#o.forEach(t)},{signal:e});var i,o;document.addEventListener("selectionchange",()=>{let s=document.getSelection();if(s.rangeCount===0){this.#o.forEach(t);return}let a=new Set;for(let g=0;g<s.rangeCount;g++){let v=s.getRangeAt(g);for(let x of this.#o.keys())!a.has(x)&&v.intersectsNode(x)&&a.add(x)}for(let[g,v]of this.#o)a.has(g)?g.classList.add("selecting"):t(v,g);if(i??=getComputedStyle(this.#o.values().next().value).getPropertyValue("-moz-user-select")==="none",i)return;let l=s.getRangeAt(0),c=o&&(l.compareBoundaryPoints(Range.END_TO_END,o)===0||l.compareBoundaryPoints(Range.START_TO_END,o)===0),d=c?l.startContainer:l.endContainer;d.nodeType===Node.TEXT_NODE&&(d=d.parentNode);let u=d.parentElement?.closest(".textLayer"),h=this.#o.get(u);h&&(h.style.width=u.style.width,h.style.height=u.style.height,d.parentElement.insertBefore(h,c?d:d.nextSibling)),o=l.cloneRange()},{signal:e})}},jl=class{constructor({pdfPage:e,annotationStorage:t=null,linkService:n,xfaHtml:i=null}){this.pdfPage=e,this.annotationStorage=t,this.linkService=n,this.xfaHtml=i,this.div=null,this._cancelled=!1}render(e,t="display"){return G(this,null,function*(){if(t==="print"){let o={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div=document.createElement("div"),o.div=this.div,cf.render(o)}let n=yield this.pdfPage.getXfa();if(this._cancelled||!n)return{textDivs:[]};let i={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:n,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?cf.update(i):(this.div=document.createElement("div"),i.div=this.div,cf.render(i))})}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}},OT={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new $o}},TT=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]),Vl=class{#e=oi.ENABLE_FORMS;#t=!1;#n=!1;#i=!1;#o=null;#r=null;#l=null;#c=1;#d=1;#a=null;#u=wt.INITIAL;#s=jn.ENABLE;#h={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#p=new WeakMap;#f=[null,null,null,null];constructor(e){let t=e.container,n=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.#o=e.layerProperties||OT,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||U_,this.viewport=n,this.pdfPageRotate=n.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.#s=e.textLayerMode??jn.ENABLE,this.#e=e.annotationMode??oi.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.maxCanvasPixels=e.maxCanvasPixels??If.get("maxCanvasPixels"),this.pageColors=e.pageColors||null,this.#t=e.enableHWA||!1,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.l10n=e.l10n,this.l10n||=new jr,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null;let i=document.createElement("div");if(i.className="page",i.setAttribute("data-page-number",this.id),i.setAttribute("role","region"),i.setAttribute("data-l10n-id","pdfjs-page-landmark"),i.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=i,this.#_(),t?.append(i),this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*ri.PDF_TO_CSS_UNITS),this.pageColors?.background&&t?.style.setProperty("--page-bg-color",this.pageColors.background);let{optionalContentConfigPromise:o}=e;o&&o.then(s=>{o===this._optionalContentConfigPromise&&(this.#h.initialOptionalContent=s.hasInitialVisibility)}),e.l10n||this.l10n.translate(this.div)}}#g(e,t){let n=TT.get(t),i=this.#f[n];if(this.#f[n]=e,i){i.replaceWith(e);return}for(let o=n-1;o>=0;o--){let s=this.#f[o];if(s){s.after(e);return}}this.div.prepend(e)}get renderingState(){return this.#u}set renderingState(e){if(e!==this.#u)switch(this.#u=e,this.#r&&(clearTimeout(this.#r),this.#r=null),e){case wt.PAUSED:this.div.classList.remove("loading");break;case wt.RUNNING:this.div.classList.add("loadingIcon"),this.#r=setTimeout(()=>{this.div.classList.add("loading"),this.#r=null},0);break;case wt.INITIAL:case wt.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#_(){let{viewport:e}=this;if(this.pdfPage){if(this.#l===e.rotation)return;this.#l=e.rotation}NO(this.div,e,!0,!1)}setPdfPage(e){this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=e,this.pdfPageRotate=e.rotate;let t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*ri.PDF_TO_CSS_UNITS,rotation:t}),this.#_(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return kl(this,"_textHighlighter",new Lf({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#o.findController}))}#m(e,t){this.eventBus.dispatch(e,{source:this,pageNumber:this.id,error:t})}#v(){return G(this,null,function*(){let e=null;try{yield this.annotationLayer.render(this.viewport,{structTreeLayer:this.structTreeLayer},"display")}catch(t){console.error(`#renderAnnotationLayer: "${t}".`),e=t}finally{this.#m("annotationlayerrendered",e)}})}#y(){return G(this,null,function*(){let e=null;try{yield this.annotationEditorLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationEditorLayer: "${t}".`),e=t}finally{this.#m("annotationeditorlayerrendered",e)}})}#C(){return G(this,null,function*(){try{yield this.drawLayer.render("display")}catch(e){console.error(`#renderDrawLayer: "${e}".`)}})}#x(){return G(this,null,function*(){let e=null;try{let t=yield this.xfaLayer.render(this.viewport,"display");t?.textDivs&&this._textHighlighter&&this.#M(t.textDivs)}catch(t){console.error(`#renderXfaLayer: "${t}".`),e=t}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#g(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#m("xfalayerrendered",e)}})}#w(){return G(this,null,function*(){if(!this.textLayer)return;let e=null;try{yield this.textLayer.render(this.viewport)}catch(t){if(t instanceof MO)return;console.error(`#renderTextLayer: "${t}".`),e=t}this.#m("textlayerrendered",e),this.#T()})}#T(){return G(this,null,function*(){if(!this.textLayer)return;let e=yield this.structTreeLayer?.render();e&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&e.parentNode!==this.canvas&&this.canvas.append(e),this.l10n.resume()),this.structTreeLayer?.show()})}#M(e){return G(this,null,function*(){let t=yield this.pdfPage.getTextContent(),n=[];for(let i of t.items)n.push(i.str);this._textHighlighter.setTextMapping(e,n),this._textHighlighter.enable()})}_resetZoomLayer(e=!1){if(!this.zoomLayer)return;let t=this.zoomLayer.firstChild;this.#p.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:e=!1,keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:n=!1,keepXfaLayer:i=!1,keepTextLayer:o=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:n,keepXfaLayer:i,keepTextLayer:o}),this.renderingState=wt.INITIAL;let s=this.div,a=s.childNodes,l=e&&this.zoomLayer||null,c=t&&this.annotationLayer?.div||null,d=n&&this.annotationEditorLayer?.div||null,u=i&&this.xfaLayer?.div||null,h=o&&this.textLayer?.div||null;for(let g=a.length-1;g>=0;g--){let v=a[g];switch(v){case l:case c:case d:case u:case h:continue}v.remove();let x=this.#f.indexOf(v);x>=0&&(this.#f[x]=null)}s.removeAttribute("data-loaded"),c&&this.annotationLayer.hide(),d&&this.annotationEditorLayer.hide(),u&&this.xfaLayer.hide(),h&&this.textLayer.hide(),this.structTreeLayer?.hide(),l||(this.canvas&&(this.#p.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}toggleEditingMode(e){this.hasEditableAnnotations()&&(this.#i=e,this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0}))}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:n=null,drawingDelay:i=-1}){this.scale=e||this.scale,typeof t=="number"&&(this.rotation=t),n instanceof Promise&&(this._optionalContentConfigPromise=n,n.then(s=>{n===this._optionalContentConfigPromise&&(this.#h.initialOptionalContent=s.hasInitialVisibility)})),this.#h.directDrawing=!0;let o=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*ri.PDF_TO_CSS_UNITS,rotation:o}),this.#_(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let s=!1;if(this.#n){if(this.maxCanvasPixels===0)s=!0;else if(this.maxCanvasPixels>0){let{width:l,height:c}=this.viewport,{sx:d,sy:u}=this.outputScale;s=(Math.floor(l)*d|0)*(Math.floor(c)*u|0)>this.maxCanvasPixels}}let a=i>=0&&i<1e3;if(a||s){if(a&&!s&&this.renderingState!==wt.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:i}),this.renderingState=wt.FINISHED,this.#h.directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!a,hideTextLayer:a}),a)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#a});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:n=!1,keepTextLayer:i=!1,cancelExtraDelay:o=0}={}){this.renderTask&&(this.renderTask.cancel(o),this.renderTask=null),this.resume=null,this.textLayer&&(!i||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!e||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!t||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!n||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:e,redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:n=!1,redrawXfaLayer:i=!1,redrawTextLayer:o=!1,hideTextLayer:s=!1}){if(!e.hasAttribute("zooming")){e.setAttribute("zooming",!0);let{style:l}=e;l.width=l.height=""}let a=this.#p.get(e);if(this.viewport!==a){let l=this.viewport.rotation-a.rotation,c=Math.abs(l),d=1,u=1;if(c===90||c===270){let{width:h,height:g}=this.viewport;d=g/h,u=h/g}e.style.transform=`rotate(${l}deg) scale(${d}, ${u})`}t&&this.annotationLayer&&this.#v(),n&&this.annotationEditorLayer&&(this.drawLayer&&this.#C(),this.#y()),i&&this.xfaLayer&&this.#x(),this.textLayer&&(s?(this.textLayer.hide(),this.structTreeLayer?.hide()):o&&this.#w())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}#E(e,t=null){return G(this,null,function*(){if(e===this.renderTask&&(this.renderTask=null),t instanceof mf){this.#a=null;return}if(this.#a=t,this.renderingState=wt.FINISHED,this._resetZoomLayer(!0),this.#h.regularAnnotations=!e.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#a}),t)throw t})}draw(){return G(this,null,function*(){this.renderingState!==wt.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());let{div:e,l10n:t,pageColors:n,pdfPage:i,viewport:o}=this;if(!i)throw this.renderingState=wt.FINISHED,new Error("pdfPage is not loaded");this.renderingState=wt.RUNNING;let s=document.createElement("div");if(s.classList.add("canvasWrapper"),this.#g(s,"canvasWrapper"),!this.textLayer&&this.#s!==jn.DISABLE&&!i.isPureXfa&&(this._accessibilityManager||=new Rf,this.textLayer=new Bl({pdfPage:i,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#s===jn.ENABLE_PERMISSIONS,onAppend:M=>{this.l10n.pause(),this.#g(M,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#e!==oi.DISABLE){let{annotationStorage:M,annotationEditorUIManager:q,downloadManager:U,enableScripting:ee,fieldObjectsPromise:ie,hasJSActionsPromise:re,linkService:ae}=this.#o;this._annotationCanvasMap||=new Map,this.annotationLayer=new Rl({pdfPage:i,annotationStorage:M,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===oi.ENABLE_FORMS,linkService:ae,downloadManager:U,enableScripting:ee,hasJSActionsPromise:re,fieldObjectsPromise:ie,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:q,onAppend:he=>{this.#g(he,"annotationLayer")}})}let a=M=>{if(h?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=wt.PAUSED,this.resume=()=>{this.renderingState=wt.RUNNING,M()};return}M()},{width:l,height:c}=o,d=document.createElement("canvas");d.setAttribute("role","presentation"),d.hidden=!0;let u=!!(n?.background&&n?.foreground),h=M=>{(!u||M)&&(d.hidden=!1,h=null)};s.append(d),this.canvas=d;let g=d.getContext("2d",{alpha:!1,willReadFrequently:!this.#t}),v=this.outputScale=new FO;if(this.maxCanvasPixels===0){let M=1/this.scale;v.sx*=M,v.sy*=M,this.#n=!0}else if(this.maxCanvasPixels>0){let M=l*c,q=Math.sqrt(this.maxCanvasPixels/M);v.sx>q||v.sy>q?(v.sx=q,v.sy=q,this.#n=!0):this.#n=!1}let x=h_(v.sx),L=h_(v.sy),E=d.width=El(Sl(l*v.sx),x[0]),P=d.height=El(Sl(c*v.sy),L[0]),S=El(Sl(l),x[1]),w=El(Sl(c),L[1]);v.sx=E/S,v.sy=P/w,this.#c!==x[1]&&(e.style.setProperty("--scale-round-x",`${x[1]}px`),this.#c=x[1]),this.#d!==L[1]&&(e.style.setProperty("--scale-round-y",`${L[1]}px`),this.#d=L[1]),this.#p.set(d,o);let T=v.scaled?[v.sx,0,0,v.sy,0,0]:null,V={canvasContext:g,transform:T,viewport:o,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:n,isEditing:this.#i},B=this.renderTask=i.render(V);B.onContinue=a;let W=B.promise.then(()=>G(this,null,function*(){h?.(!0),yield this.#E(B),this.structTreeLayer||=new Nl(i,o.rawDims),this.#w(),this.annotationLayer&&(yield this.#v());let{annotationEditorUIManager:M}=this.#o;M&&(this.drawLayer||=new kf({pageIndex:this.id}),yield this.#C(),this.drawLayer.setParent(s),this.annotationEditorLayer||=new Of({uiManager:M,pdfPage:i,l10n:t,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:q=>{this.#g(q,"annotationEditorLayer")}}),this.#y())}),M=>(M instanceof mf||h?.(!0),this.#E(B,M)));if(i.isPureXfa){if(!this.xfaLayer){let{annotationStorage:M,linkService:q}=this.#o;this.xfaLayer=new jl({pdfPage:i,annotationStorage:M,linkService:q})}this.#x()}return e.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),W})}setPageLabel(e){this.pageLabel=typeof e=="string"?e:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){let{directDrawing:e,initialOptionalContent:t,regularAnnotations:n}=this.#h;return e&&t&&n?this.canvas:null}};function IT(r){return G(this,null,function*(){let e="",t=e.split("#",1)[0],{info:n,metadata:i,contentDispositionFilename:o,contentLength:s}=yield r.getMetadata();if(!s){let{length:a}=yield r.getDownloadInfo();s=a}return Ft(it({},n),{baseURL:t,filesize:s,filename:o||RO(e),metadata:i?.getRaw(),authors:i?.get("dc:creator"),numPages:r.numPages,URL:e})})}var Df=class{constructor(e){this._ready=new Promise((t,n)=>{import(e).then(o=>{t(o.QuickJSSandbox())}).catch(n)})}createSandbox(e){return G(this,null,function*(){(yield this._ready).create(e)})}dispatchEventInSandbox(e){return G(this,null,function*(){let t=yield this._ready;setTimeout(()=>t.dispatchEvent(e),0)})}destroySandbox(){return G(this,null,function*(){(yield this._ready).nukeSandbox()})}},Ff=class{#e=null;#t=null;#n=null;#i=null;#o=null;#r=null;#l=null;#c=null;#d=!1;#a=null;#u=null;constructor({eventBus:e,externalServices:t=null,docProperties:n=null}){this.#o=e,this.#r=t,this.#n=n}setViewer(e){this.#c=e}setDocument(e){return G(this,null,function*(){if(this.#l&&(yield this.#g()),this.#l=e,!e)return;let[t,n,i]=yield Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(!t&&!i){yield this.#g();return}if(e!==this.#l)return;try{this.#a=this.#f()}catch(a){console.error(`setDocument: "${a.message}".`),yield this.#g();return}let o=this.#o;this.#i=new AbortController;let{signal:s}=this.#i;o._on("updatefromsandbox",a=>{a?.source===window&&this.#s(a.detail)},{signal:s}),o._on("dispatcheventinsandbox",a=>{this.#a?.dispatchEventInSandbox(a.detail)},{signal:s}),o._on("pagechanging",({pageNumber:a,previous:l})=>{a!==l&&(this.#p(l),this.#h(a))},{signal:s}),o._on("pagerendered",({pageNumber:a})=>{this._pageOpenPending.has(a)&&a===this.#c.currentPageNumber&&this.#h(a)},{signal:s}),o._on("pagesdestroy",()=>G(this,null,function*(){yield this.#p(this.#c.currentPageNumber),yield this.#a?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#e?.resolve()}),{signal:s});try{let a=yield this.#n(e);if(e!==this.#l)return;yield this.#a.createSandbox({objects:t,calculationOrder:n,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:Ft(it({},a),{actions:i})}),o.dispatch("sandboxcreated",{source:this})}catch(a){console.error(`setDocument: "${a.message}".`),yield this.#g();return}yield this.#a?.dispatchEventInSandbox({id:"doc",name:"Open"}),yield this.#h(this.#c.currentPageNumber,!0),Promise.resolve().then(()=>{e===this.#l&&(this.#d=!0)})})}dispatchWillSave(){return G(this,null,function*(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"WillSave"})})}dispatchDidSave(){return G(this,null,function*(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"DidSave"})})}dispatchWillPrint(){return G(this,null,function*(){if(this.#a){yield this.#u?.promise,this.#u=Promise.withResolvers();try{yield this.#a.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw this.#u.resolve(),this.#u=null,e}yield this.#u.promise}})}dispatchDidPrint(){return G(this,null,function*(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})})}get destroyPromise(){return this.#t?.promise||null}get ready(){return this.#d}get _pageOpenPending(){return kl(this,"_pageOpenPending",new Set)}get _visitedPages(){return kl(this,"_visitedPages",new Map)}#s(e){return G(this,null,function*(){let t=this.#c,n=t.isInPresentationMode||t.isChangingPresentationMode,{id:i,siblings:o,command:s,value:a}=e;if(!i){switch(s){case"clear":console.clear();break;case"error":console.error(a);break;case"layout":if(!n){let c=rO(a);t.spreadMode=c.spreadMode}break;case"page-num":t.currentPageNumber=a+1;break;case"print":yield t.pagesPromise,this.#o.dispatch("print",{source:this});break;case"println":console.log(a);break;case"zoom":n||(t.currentScaleValue=a);break;case"SaveAs":this.#o.dispatch("download",{source:this});break;case"FirstPage":t.currentPageNumber=1;break;case"LastPage":t.currentPageNumber=t.pagesCount;break;case"NextPage":t.nextPage();break;case"PrevPage":t.previousPage();break;case"ZoomViewIn":n||t.increaseScale();break;case"ZoomViewOut":n||t.decreaseScale();break;case"WillPrintFinished":this.#u?.resolve(),this.#u=null;break}return}if(n&&e.focus)return;delete e.id,delete e.siblings;let l=o?[i,...o]:[i];for(let c of l){let d=document.querySelector(`[data-element-id="${c}"]`);d?d.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#l?.annotationStorage.setValue(c,e)}})}#h(e,t=!1){return G(this,null,function*(){let n=this.#l,i=this._visitedPages;if(t&&(this.#e=Promise.withResolvers()),!this.#e)return;let o=this.#c.getPageView(e-1);if(o?.renderingState!==wt.FINISHED){this._pageOpenPending.add(e);return}this._pageOpenPending.delete(e);let s=G(this,null,function*(){let a=yield i.has(e)?null:o.pdfPage?.getJSActions();n===this.#l&&(yield this.#a?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:e,actions:a}))});i.set(e,s)})}#p(e){return G(this,null,function*(){let t=this.#l,n=this._visitedPages;if(!this.#e||this._pageOpenPending.has(e))return;let i=n.get(e);i&&(n.set(e,null),yield i,t===this.#l&&(yield this.#a?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e})))})}#f(){if(this.#t=Promise.withResolvers(),this.#a)throw new Error("#initScripting: Scripting already exists.");return this.#r.createScripting()}#g(){return G(this,null,function*(){if(!this.#a){this.#l=null,this.#t?.resolve();return}this.#e&&(yield Promise.race([this.#e.promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),this.#e=null),this.#l=null;try{yield this.#a.destroySandbox()}catch{}this.#u?.reject(new Error("Scripting destroyed.")),this.#u=null,this.#i?.abort(),this.#i=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#a=null,this.#d=!1,this.#t?.resolve()})}},Nf=class extends Ff{constructor(e){e.externalServices||window.addEventListener("updatefromsandbox",t=>{e.eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})}),e.externalServices||={createScripting:()=>new Df(e.sandboxBundleSrc)},e.docProperties||=t=>IT(t),super(e)}},kT=3e4,Bf=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(e)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),kT)))}getHighestPriority(e,t,n,i=!1){let o=e.views,s=o.length;if(s===0)return null;for(let u=0;u<s;u++){let h=o[u].view;if(!this.isViewFinished(h))return h}let a=e.first.id,l=e.last.id;if(l-a+1>s){let u=e.ids;for(let h=1,g=l-a;h<g;h++){let v=n?a+h:l-h;if(u.has(v))continue;let x=t[v-1];if(!this.isViewFinished(x))return x}}let c=n?l:a-2,d=t[c];return d&&!this.isViewFinished(d)||i&&(c+=n?1:-1,d=t[c],d&&!this.isViewFinished(d))?d:null}isViewFinished(e){return e.renderingState===wt.FINISHED}renderView(e){switch(e.renderingState){case wt.FINISHED:return!1;case wt.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case wt.RUNNING:this.highestPriorityPage=e.renderingId;break;case wt.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(t=>{t instanceof mf||console.error(`renderView: "${t}"`)});break}return!0}},j_=10,Ol={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function V_(r){return Object.values(cn).includes(r)&&r!==cn.DISABLE}var jf=class{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){let t=this.#e;t.has(e)&&t.delete(e),t.add(e),t.size>this.#t&&this.#n()}resize(e,t=null){this.#t=e;let n=this.#e;if(t){let i=n.size,o=1;for(let s of n)if(t.has(s.id)&&(n.delete(s),n.add(s)),++o>i)break}for(;n.size>this.#t;)this.#n()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#n(){let e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}},Ul=class{#e=null;#t=null;#n=null;#i=cn.NONE;#o=null;#r=oi.ENABLE_FORMS;#l=null;#c=!1;#d=!1;#a=!1;#u=!1;#s=!1;#h=null;#p=null;#f=null;#g=null;#_=!1;#m=null;#v=!1;#y=0;#C=new ResizeObserver(this.#B.bind(this));#x=null;#w=null;#T=jn.ENABLE;constructor(e){let t="4.8.69";if(x_!==t)throw new Error(`The API version "${x_}" does not match the Viewer version "${t}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#C.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new $o,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.#t=e.altTextManager||null,this.findController&&(this.findController.onIsPageVisible=i=>this._getVisiblePages().ids.has(i)),this._scriptingManager=e.scriptingManager||null,this.#T=e.textLayerMode??jn.ENABLE,this.#r=e.annotationMode??oi.ENABLE_FORMS,this.#i=e.annotationEditorMode??cn.NONE,this.#n=e.annotationEditorHighlightColors||null,this.#d=e.enableHighlightFloatingButton===!0,this.#u=e.enableUpdatedAddImage===!0,this.#s=e.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n,this.l10n||=new jr,this.#a=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.#p=e.mlManager||null,this.#c=e.enableHWA||!1,this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new Bf,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue;let{abortSignal:n}=e;n?.addEventListener("abort",()=>{this.#C.disconnect(),this.#C=null},{once:!0}),this.scroll=Q2(this.container,this._scrollUpdate.bind(this),n),this.presentationModeState=Fr.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#F(),this.eventBus._on("thumbnailrendered",({pageNumber:i,pdfPage:o})=>{let s=this._pages[i-1];this.#e.has(s)||o?.cleanup()}),e.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#e)}get pageViewsReady(){return this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#r===oi.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber===e)return t&&this.#k(),!0;if(!(0<e&&e<=this.pagesCount))return!1;let n=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:n}),t&&this.#k(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let t=e|0;if(this._pageLabels){let n=this._pageLabels.indexOf(e);n>=0&&(t=n+1)}this._setCurrentPageNumber(t,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==of?this._currentScale:U_}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#O(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#O(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!q_(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;let t=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#O(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){let e=this;return kl(this,"_layerProperties",{get annotationEditorUIManager(){return e.#o},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}})}#M(e){let t={annotationEditorMode:this.#i,annotationMode:this.#r,textLayerMode:this.#T};return e&&(!e.includes(Ml.COPY)&&this.#T===jn.ENABLE&&(t.textLayerMode=jn.ENABLE_PERMISSIONS),e.includes(Ml.MODIFY_CONTENTS)||(t.annotationEditorMode=cn.DISABLE),!e.includes(Ml.MODIFY_ANNOTATIONS)&&!e.includes(Ml.FILL_INTERACTIVE_FORMS)&&this.#r===oi.ENABLE_FORMS&&(t.annotationMode=oi.ENABLE)),t}#E(e){return G(this,null,function*(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;let t=Promise.withResolvers(),n=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&t.resolve()},{signal:typeof AbortSignal.any=="function"?AbortSignal.any([e,n.signal]):e}),yield Promise.race([this._onePageRenderedCapability.promise,t.promise]),n.abort()})}getAllText(){return G(this,null,function*(){let e=[],t=[];for(let n=1,i=this.pdfDocument.numPages;n<=i;++n){if(this.#v)return null;t.length=0;let o=yield this.pdfDocument.getPage(n),{items:s}=yield o.getTextContent();for(let a of s)a.str&&t.push(a.str),a.hasEOL&&t.push(`
`);e.push(Wo(t.join("")))}return e.join(`
`)})}#P(e,t){let n=document.getSelection(),{focusNode:i,anchorNode:o}=n;if(o&&i&&n.containsNode(this.#m)){if(this.#_||e===jn.ENABLE_PERMISSIONS){t.preventDefault(),t.stopPropagation();return}this.#_=!0;let{classList:s}=this.viewer;s.add("copyAll");let a=new AbortController;window.addEventListener("keydown",l=>this.#v=l.key==="Escape",{signal:a.signal}),this.getAllText().then(l=>G(this,null,function*(){l!==null&&(yield navigator.clipboard.writeText(l))})).catch(l=>{console.warn(`Something goes wrong when extracting the text: ${l.message}`)}).finally(()=>{this.#_=!1,this.#v=!1,a.abort(),s.remove("copyAll")}),t.preventDefault(),t.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#o?.destroy(),this.#o=null),this.pdfDocument=e,!e)return;let t=e.numPages,n=e.getPage(1),i=e.getOptionalContentConfig({intent:"display"}),o=this.#a?e.getPermissions():Promise.resolve(),{eventBus:s,pageColors:a,viewer:l}=this;this.#h=new AbortController;let{signal:c}=this.#h;if(t>Ol.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");let h=this._scrollMode=Ye.PAGE;s.dispatch("scrollmodechanged",{source:this,mode:h})}this._pagesCapability.promise.then(()=>{s.dispatch("pagesloaded",{source:this,pagesCount:t})},()=>{});let d=h=>{let g=this._pages[h.pageNumber-1];g&&this.#e.push(g)};s._on("pagerender",d,{signal:c});let u=h=>{h.cssTransform||(this._onePageRenderedCapability.resolve({timestamp:h.timestamp}),s._off("pagerendered",u))};s._on("pagerendered",u,{signal:c}),Promise.all([n,o]).then(([h,g])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(h),this._optionalContentConfigPromise=i;let{annotationEditorMode:v,annotationMode:x,textLayerMode:L}=this.#M(g);if(L!==jn.DISABLE){let w=this.#m=document.createElement("div");w.id="hiddenCopyElement",l.before(w)}if(typeof AbortSignal.any=="function"&&v!==cn.DISABLE){let w=v;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):V_(w)?(this.#o=new OO(this.container,l,this.#t,s,e,a,this.#n,this.#d,this.#u,this.#s,this.#p),s.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#o}),w!==cn.NONE&&(w===cn.STAMP&&this.#p?.loadModel("altText"),this.#o.updateMode(w))):console.error(`Invalid AnnotationEditor mode: ${w}`)}let E=this._scrollMode===Ye.PAGE?null:l,P=this.currentScale,S=h.getViewport({scale:P*ri.PDF_TO_CSS_UNITS});l.style.setProperty("--scale-factor",S.scale),a?.background&&l.style.setProperty("--page-bg-color",a.background),(a?.foreground==="CanvasText"||a?.background==="Canvas")&&(l.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),l.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let w=1;w<=t;++w){let T=new Vl({container:E,eventBus:s,id:w,scale:P,defaultViewport:S.clone(),optionalContentConfigPromise:i,renderingQueue:this.renderingQueue,textLayerMode:L,annotationMode:x,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,pageColors:a,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#c});this._pages.push(T)}this._pages[0]?.setPdfPage(h),this._scrollMode===Ye.PAGE?this.#A():this._spreadMode!==Wt.NONE&&this._updateSpreadMode(),this.#E(c).then(()=>G(this,null,function*(){if(e!==this.pdfDocument)return;if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#m&&document.addEventListener("copy",this.#P.bind(this,L),{signal:c}),this.#o&&s.dispatch("annotationeditormodechanged",{source:this,mode:this.#i}),e.loadingParams.disableAutoFetch||t>Ol.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let w=t-1;if(w<=0){this._pagesCapability.resolve();return}for(let T=2;T<=t;++T){let V=e.getPage(T).then(B=>{let W=this._pages[T-1];W.pdfPage||W.setPdfPage(B),--w===0&&this._pagesCapability.resolve()},B=>{console.error(`Unable to get page ${T} to initialize viewer`,B),--w===0&&this._pagesCapability.resolve()});T%Ol.PAUSE_EAGER_PAGE_INIT===0&&(yield V)}})),s.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:w})=>{e===this.pdfDocument&&w.Language&&(l.lang=w.Language)}),this.defaultRenderingQueue&&this.update()}).catch(h=>{console.error("Unable to initialize viewer",h),this._pagesCapability.reject(h)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,n=this._pages.length;t<n;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=of,this._currentScaleValue=null,this._pageLabels=null,this.#e=new jf(j_),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=Ye.VERTICAL,this._previousScrollMode=Ye.UNKNOWN,this._spreadMode=Wt.NONE,this.#x={previousPageNumber:1,scrollDown:!0,pages:[]},this.#h?.abort(),this.#h=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#m?.remove(),this.#m=null,this.#j()}#A(){if(this._scrollMode!==Ye.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");let e=this._currentPageNumber,t=this.#x,n=this.viewer;if(n.textContent="",t.pages.length=0,this._spreadMode===Wt.NONE&&!this.isInPresentationMode){let i=this._pages[e-1];n.append(i.div),t.pages.push(i)}else{let i=new Set,o=this._spreadMode-1;o===-1?i.add(e-1):e%2!==o?(i.add(e-1),i.add(e)):(i.add(e-2),i.add(e-1));let s=document.createElement("div");if(s.className="spread",this.isInPresentationMode){let a=document.createElement("div");a.className="dummyPage",s.append(a)}for(let a of i){let l=this._pages[a];l&&(s.append(l.div),t.pages.push(l))}n.append(s)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&this.update()}#I(e,t=null){let{div:n,id:i}=e;if(this._currentPageNumber!==i&&this._setCurrentPageNumber(i),this._scrollMode===Ye.PAGE&&(this.#A(),this.update()),!t&&!this.isInPresentationMode){let o=n.offsetLeft+n.clientLeft,s=o+n.clientWidth,{scrollLeft:a,clientWidth:l}=this.container;(this._scrollMode===Ye.HORIZONTAL||o<a||s>a+l)&&(t={left:0,top:0})}z_(n,t),!this._currentScaleValue&&this._location&&(this._location=null)}#R(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#S(e,t,{noScroll:n=!1,preset:i=!1,drawingDelay:o=-1,origin:s=null}){if(this._currentScaleValue=t.toString(),this.#R(e)){i&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t});return}this.viewer.style.setProperty("--scale-factor",e*ri.PDF_TO_CSS_UNITS);let a=o>=0&&o<1e3;this.refresh(!0,{scale:e,drawingDelay:a?o:-1}),a&&(this.#w=setTimeout(()=>{this.#w=null,this.refresh()},o));let l=this._currentScale;if(this._currentScale=e,!n){let c=this._currentPageNumber,d;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(c=this._location.pageNumber,d=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:c,destArray:d,allowNegativeOffset:!0}),Array.isArray(s)){let u=e/l-1,[h,g]=this.containerTopLeft;this.container.scrollLeft+=(s[0]-g)*u,this.container.scrollTop+=(s[1]-h)*u}}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:i?t:void 0}),this.defaultRenderingQueue&&this.update()}get#b(){return this._spreadMode!==Wt.NONE&&this._scrollMode!==Ye.HORIZONTAL?2:1}#O(e,t){let n=parseFloat(e);if(n>0)t.preset=!1,this.#S(n,e,t);else{let i=this._pages[this._currentPageNumber-1];if(!i)return;let o=c_,s=d_;this.isInPresentationMode?(o=s=4,this._spreadMode!==Wt.NONE&&(o*=2)):this.removePageBorders?o=s=0:this._scrollMode===Ye.HORIZONTAL&&([o,s]=[s,o]);let a=(this.container.clientWidth-o)/i.width*i.scale/this.#b,l=(this.container.clientHeight-s)/i.height*i.scale;switch(e){case"page-actual":n=1;break;case"page-width":n=a;break;case"page-height":n=l;break;case"page-fit":n=Math.min(a,l);break;case"auto":let c=f_(i)?a:Math.min(l,a);n=Math.min(Y2,c);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}t.preset=!0,this.#S(n,e,t)}}#k(){let e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#O(this._currentScaleValue,{noScroll:!0}),this.#I(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;let t=this._pageLabels.indexOf(e);return t<0?null:t+1}scrollPageIntoView({pageNumber:e,destArray:t=null,allowNegativeOffset:n=!1,ignoreDestinationZoom:i=!1}){if(!this.pdfDocument)return;let o=Number.isInteger(e)&&this._pages[e-1];if(!o){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!t){this._setCurrentPageNumber(e,!0);return}let s=0,a=0,l=0,c=0,d,u,h=o.rotation%180!==0,g=(h?o.height:o.width)/o.scale/ri.PDF_TO_CSS_UNITS,v=(h?o.width:o.height)/o.scale/ri.PDF_TO_CSS_UNITS,x=0;switch(t[1].name){case"XYZ":s=t[2],a=t[3],x=t[4],s=s!==null?s:0,a=a!==null?a:v;break;case"Fit":case"FitB":x="page-fit";break;case"FitH":case"FitBH":a=t[2],x="page-width",a===null&&this._location?(s=this._location.left,a=this._location.top):(typeof a!="number"||a<0)&&(a=v);break;case"FitV":case"FitBV":s=t[2],l=g,c=v,x="page-height";break;case"FitR":s=t[2],a=t[3],l=t[4]-s,c=t[5]-a;let S=c_,w=d_;this.removePageBorders&&(S=w=0),d=(this.container.clientWidth-S)/l/ri.PDF_TO_CSS_UNITS,u=(this.container.clientHeight-w)/c/ri.PDF_TO_CSS_UNITS,x=Math.min(Math.abs(d),Math.abs(u));break;default:console.error(`scrollPageIntoView: "${t[1].name}" is not a valid destination type.`);return}if(i||(x&&x!==this._currentScale?this.currentScaleValue=x:this._currentScale===of&&(this.currentScaleValue=$2)),x==="page-fit"&&!t[4]){this.#I(o);return}let L=[o.viewport.convertToViewportPoint(s,a),o.viewport.convertToViewportPoint(s+l,a+c)],E=Math.min(L[0][0],L[1][0]),P=Math.min(L[0][1],L[1][1]);n||(E=Math.max(E,0),P=Math.max(P,0)),this.#I(o,{left:E,top:P})}_updateLocation(e){let t=this._currentScale,n=this._currentScaleValue,i=parseFloat(n)===t?Math.round(t*1e4)/100:n,o=e.id,s=this._pages[o-1],a=this.container,l=s.getPagePoint(a.scrollLeft-e.x,a.scrollTop-e.y),c=Math.round(l[0]),d=Math.round(l[1]),u=`#page=${o}`;this.isInPresentationMode||(u+=`&zoom=${i},${c},${d}`),this._location={pageNumber:o,scale:i,top:d,left:c,rotation:this._pagesRotation,pdfOpenParams:u}}update(){let e=this._getVisiblePages(),t=e.views,n=t.length;if(n===0)return;let i=Math.max(j_,2*n+1);this.#e.resize(i,e.ids),this.renderingQueue.renderHighestPriority(e);let o=this._spreadMode===Wt.NONE&&(this._scrollMode===Ye.PAGE||this._scrollMode===Ye.VERTICAL),s=this._currentPageNumber,a=!1;for(let l of t){if(l.percent<100)break;if(l.id===s&&o){a=!0;break}}this._setCurrentPageNumber(a?s:t[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#N(){let e=this._getVisiblePages(),t=[],{ids:n,views:i}=e;for(let o of i){let{view:s}=o;if(!s.hasEditableAnnotations()){n.delete(s.id);continue}t.push(o)}return t.length===0?null:(this.renderingQueue.renderHighestPriority({first:t[0],last:t.at(-1),views:t,ids:n}),n)}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===Fr.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===Fr.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){let e=this._scrollMode===Ye.PAGE?this.#x.pages:this._pages,t=this._scrollMode===Ye.HORIZONTAL,n=t&&this._isContainerRtl;return Z2({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:n})}cleanup(){for(let e of this._pages)e.renderingState!==wt.FINISHED&&e.reset()}_cancelRendering(){for(let e of this._pages)e.cancelRendering()}#U(e){return G(this,null,function*(){if(e.pdfPage)return e.pdfPage;try{let t=yield this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),t}catch(t){return console.error("Unable to get page for page view",t),null}})}#V(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case Ye.PAGE:return this.#x.scrollDown;case Ye.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){let t=e||this._getVisiblePages(),n=this.#V(t),i=this._spreadMode!==Wt.NONE&&this._scrollMode!==Ye.HORIZONTAL,o=this.renderingQueue.getHighestPriority(t,this._pages,n,i);return o?(this.#U(o).then(()=>{this.renderingQueue.renderView(o)}),!0):!1}get hasEqualPageSizes(){let e=this._pages[0];for(let t=1,n=this._pages.length;t<n;++t){let i=this._pages[t];if(i.width!==e.width||i.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(t=>{let n=t.pdfPage.getViewport({scale:1}),i=f_(n);if(e===void 0)e=i;else if(this.enablePrintAutoRotate&&i!==e)return{width:n.height,height:n.width,rotation:(n.rotation-90)%360};return{width:n.width,height:n.height,rotation:n.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!eO(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>Ol.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){let t=this._scrollMode,n=this.viewer;n.classList.toggle("scrollHorizontal",t===Ye.HORIZONTAL),n.classList.toggle("scrollWrapped",t===Ye.WRAPPED),!(!this.pdfDocument||!e)&&(t===Ye.PAGE?this.#A():this._previousScrollMode===Ye.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#O(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!tO(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;let t=this.viewer,n=this._pages;if(this._scrollMode===Ye.PAGE)this.#A();else if(t.textContent="",this._spreadMode===Wt.NONE)for(let i of this._pages)t.append(i.div);else{let i=this._spreadMode-1,o=null;for(let s=0,a=n.length;s<a;++s)o===null?(o=document.createElement("div"),o.className="spread",t.append(o)):s%2===i&&(o=o.cloneNode(!1),t.append(o)),o.append(n[s].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#O(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,t=!1){switch(this._scrollMode){case Ye.WRAPPED:{let{views:n}=this._getVisiblePages(),i=new Map;for(let{id:o,y:s,percent:a,widthPercent:l}of n){if(a===0||l<100)continue;let c=i.get(s);c||i.set(s,c||=[]),c.push(o)}for(let o of i.values()){let s=o.indexOf(e);if(s===-1)continue;let a=o.length;if(a===1)break;if(t)for(let l=s-1,c=0;l>=c;l--){let d=o[l],u=o[l+1]-1;if(d<u)return e-u}else for(let l=s+1,c=a;l<c;l++){let d=o[l],u=o[l-1]+1;if(d>u)return u-e}if(t){let l=o[0];if(l<e)return e-l+1}else{let l=o[a-1];if(l>e)return l-e+1}break}break}case Ye.HORIZONTAL:break;case Ye.PAGE:case Ye.VERTICAL:{if(this._spreadMode===Wt.NONE)break;let n=this._spreadMode-1;if(t&&e%2!==n)break;if(!t&&e%2===n)break;let{views:i}=this._getVisiblePages(),o=t?e-1:e+1;for(let{id:s,percent:a,widthPercent:l}of i)if(s===o){if(a>0&&l===100)return 2;break}break}}return 1}nextPage(){let e=this._currentPageNumber,t=this.pagesCount;if(e>=t)return!1;let n=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+n,t),!0}previousPage(){let e=this._currentPageNumber;if(e<=1)return!1;let t=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-t,1),!0}updateScale({drawingDelay:e,scaleFactor:t=null,steps:n=null,origin:i}){if(n===null&&t===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let o=this._currentScale;if(t>0&&t!==1)o=Math.round(o*t*100)/100;else if(n){let s=n>0?l_:1/l_,a=n>0?Math.ceil:Math.floor;n=Math.abs(n);do o=a((o*s).toFixed(2)*10)/10;while(--n>0)}o=Math.max(X2,Math.min(K2,o)),this.#O(o,{noScroll:!1,drawingDelay:e,origin:i})}increaseScale(e={}){this.updateScale(Ft(it({},e),{steps:e.steps??1}))}decreaseScale(e={}){this.updateScale(Ft(it({},e),{steps:-(e.steps??1)}))}#F(e=this.container.clientHeight){e!==this.#y&&(this.#y=e,nO.setProperty("--viewer-container-height",`${e}px`))}#B(e){for(let t of e)if(t.target===this.container){this.#F(Math.floor(t.borderBoxSize[0].blockSize)),this.#l=null;break}}get containerTopLeft(){return this.#l||=[this.container.offsetTop,this.container.offsetLeft]}#j(){this.#f?.abort(),this.#f=null,this.#g!==null&&(clearTimeout(this.#g),this.#g=null)}get annotationEditorMode(){return this.#o?this.#i:cn.DISABLE}set annotationEditorMode({mode:e,editId:t=null,isFromKeyboard:n=!1}){if(!this.#o)throw new Error("The AnnotationEditor is not enabled.");if(this.#i===e)return;if(!V_(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);if(!this.pdfDocument)return;e===cn.STAMP&&this.#p?.loadModel("altText");let{eventBus:i}=this,o=()=>{this.#j(),this.#i=e,this.#o.updateMode(e,t,n),i.dispatch("annotationeditormodechanged",{source:this,mode:e})};if(e===cn.NONE||this.#i===cn.NONE){let s=e!==cn.NONE;s||this.pdfDocument.annotationStorage.resetModifiedIds();for(let l of this._pages)l.toggleEditingMode(s);let a=this.#N();if(s&&a){this.#j(),this.#f=new AbortController;let l=AbortSignal.any([this.#h.signal,this.#f.signal]);i._on("pagerendered",({pageNumber:c})=>{a.delete(c),a.size===0&&(this.#g=setTimeout(o,0))},{signal:l});return}}o()}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(let n of this._pages)n.update(t);this.#w!==null&&(clearTimeout(this.#w),this.#w=null),e||this.update()}}},Vf=class extends Ul{_resetView(){super._resetView(),this._scrollMode=Ye.PAGE,this._spreadMode=Wt.NONE}set scrollMode(e){}_updateScrollMode(){}set spreadMode(e){}_updateSpreadMode(){}};var LF=bt.AnnotationLayerBuilder,DF=bt.DownloadManager,FF=bt.EventBus,NF=bt.FindState,RT=bt.GenericL10n,LT=bt.LinkTarget,DT=bt.PDFFindController,BF=bt.PDFHistory,FT=bt.PDFLinkService,jF=bt.PDFPageView,VF=bt.PDFScriptingManager,NT=bt.PDFSinglePageViewer,BT=bt.PDFViewer,UF=bt.ProgressBar,zF=bt.RenderingStates,qF=bt.ScrollMode,HF=bt.SimpleLinkService,WF=bt.SpreadMode,GF=bt.StructTreeLayerBuilder,$F=bt.TextLayerBuilder,XF=bt.XfaLayerBuilder,KF=bt.parseQueryString;function VT(r,e,t){r[e]=t}function UT(){return typeof window>"u"}UT()||VT(rf,"verbosity",nf.INFOS);typeof Promise.withResolvers>"u"&&window&&(window.Promise.withResolvers=()=>{let r,e;return{promise:new Promise((n,i)=>{r=n,e=i}),resolve:r,reject:e}});var $_=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=wn({type:r});static \u0275inj=xn({})}return r})();var zT=()=>[import("./chunk-KLDVIGNK.js").then(r=>r.CarouselComponent)],X_=r=>({"varrainte-active":r}),qT=()=>[],HT=()=>({height:"250px",width:"250px"});function WT(r,e){if(r&1){let t=Ae();I(0,"app-button",9),ce("handleClick",function(){fe(t);let i=z();return pe(i.startAddingVarriante())}),D()}r&2&&Q("label","Ajouter Varriante")("size","small")}function GT(r,e){if(r&1){let t=Ae();I(0,"div",7),ce("click",function(){let i=fe(t).$implicit,o=z();return pe(o.selectVariante(i,!1))}),D()}if(r&2){let t=e.$implicit,n=z();Yr("background-image: url('",t.imagesUrls[0],"') ;background-size: cover ; background-position:center"),Q("ngClass",Qr(4,X_,n.selectedProduct===t))}}function $T(r,e){if(r&1&&(ge(0,"app-carousel",11),I(1,"a",12),oe(2),D()),r&2){let t=z(3);Q("navigations",t.selectedProduct.imagesUrls?t.selectedProduct.imagesUrls.length>1:!1)("numberSlides",t.selectedProduct.imagesUrls?t.selectedProduct.imagesUrls.length:0)("images",t.selectedProduct.imagesUrls?t.selectedProduct.imagesUrls:Pe(8,qT))("styles",Pe(9,HT)),H(),Nt("font-size",12,"px"),pt("href",t.SITE_URL+"?product_id="+t.selectedProduct.id,Qt),H(),Xe(" ",t.SITE_URL+"?product_id="+t.selectedProduct.id," ")}}function XT(r,e){r&1&&ge(0,"img",13)}function KT(r,e){if(r&1&&(I(0,"div",10),ye(1,$T,3,10)(2,XT,1,0),Ot(3,1,zT,null,2),D()),r&2){let t=z(2);H(3),$t(t.selectedProduct.imagesUrls!==void 0&&t.selectedProduct.imagesUrls!==null&&t.selectedProduct.imagesUrls.length>0)}}function YT(r,e){if(r&1&&(I(0,"div",10),ge(1,"img",15),I(2,"a",16),oe(3,"Telecharger le manuel"),D()()),r&2){let t=z(3);H(2),pt("href",t.manuelUrl,Qt)}}function QT(r,e){r&1&&(I(0,"div",14)(1,"span",17),oe(2,"il n'y a pas de fichier manuel"),D()())}function JT(r,e){if(r&1&&ye(0,YT,4,1,"div",10)(1,QT,3,0,"div",14),r&2){let t=z(2);Ee(t.manuelUrl?0:1)}}function ZT(r,e){if(r&1&&ye(0,KT,5,1,"div",10)(1,JT,2,1),r&2){let t,n=z();Ee((t=n.selectedButton.index)===1?0:t===2?1:-1)}}var K_=(()=>{let e=class e{changeOption(n){this.selectedButton=n,this.selectedButton.index==2&&(this.manuelUrl=this.selectedProduct.maunalFile?.toString(),this.manuelUrl)}constructor(n,i,o,s){this.crudService=n,this.categoriesService=i,this.tagsService=o,this.applicationService=s,this.manuelUrl="",this.listButtonsData=[{index:1,label:"Images ",active:!0},{index:2,label:"Manuel",active:!1}],this.selectedButton=this.listButtonsData[0],this.isSelectedVarraiente=!1,this.varriantes=[],this.columns=D0,this.productFormFields=Su,this.selectedProduct={},this.principalSelectedProduct={},this.selectedVariante={},this.Object=Object,this.SITE_URL=li}ngOnInit(){return G(this,null,function*(){yield this.findCategories(),yield this.findSubCategories(),yield this.findTags(),yield this.findProducts()})}findProducts(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.PRODUCTS).subscribe({next:o=>{this.products=o,n()},error:o=>{i(o)}})})}createProduct(n){this.genericCrudComponent.creationMode==="var"?(n.id=this.getMaxId(this.varriantes),this.selectedProduct,this.selectedProduct.varients===void 0&&(this.selectedProduct.varients=[]),this.selectedProduct.varients.push(n),this.selectedProduct=it({},this.selectedProduct),this.crudService.updateItem(Se.PRODUCTS,this.selectedProduct.id,this.selectedProduct).then(()=>{this.crudService.modeSubject.next("detailsMode"),this.applicationService.showSuccessfulSaveDialog("Creation du varainte","success","Varrainte cr\xE9\xE9 avec succ\xE8s"),this.varriantes=this.selectedProduct.varients})):(this.crudService.createItem(Se.PRODUCTS,n),this.applicationService.showSuccessfulSaveDialog("Creation du porduit","success","Produit cr\xE9\xE9 avec succ\xE8s"))}updateProduct(n){let i=n.id,o=n.data;this.genericCrudComponent.creationMode==="var"?this.crudService.getItem(Se.PRODUCTS,i).subscribe(s=>{if(s.varients){let a=s.varients.findIndex(l=>l.id===this.selectedProduct.id);a!==-1&&(s.varients[a]=n.data),this.crudService.updateItem(Se.PRODUCTS,i,s).then(l=>this.applicationService.showSuccessfulSaveDialog("Update Product","success","produit mis \xE0 jour avec succ\xE8s"),this.selectedProduct.id)}}):this.crudService.updateItem(Se.PRODUCTS,i,o).then(s=>this.applicationService.showSuccessfulSaveDialog("Update Product","success","produit mis \xE0 jour avec succ\xE8s")),this.genericCrudComponent.closeRight()}deleteProduct(n){this.crudService.deleteItem(Se.PRODUCTS,n).then(i=>"Produit supprim\xE9 avec succ\xE8s")}onShowAddProduct(){this.productFormFields.map(n=>{let i;n.formControlName=="subCategory"&&(i=n,i.options=[],this.productFormFields=[...this.productFormFields])})}onSelectProduct(n){this.selectedProduct=n,this.principalSelectedProduct=this.selectedProduct,this.varriantes=this.selectedProduct.varients||[],this.productFormFields.map(i=>{let o;i.formControlName=="subCategory"&&(o=i,o.options=this.applicationService.subList(o.optionsSnapShot,"category",this.selectedProduct.category),this.productFormFields=[...this.productFormFields])})}findCategories(){return G(this,null,function*(){return new Promise((n,i)=>{this.categoriesService.getItemsList(Se.CATEGORIES).subscribe({next:o=>{this.categories=o,this.productFormFields.map(s=>{let a;s.formControlName=="category"&&(a=s,a.options=this.categories,this.productFormFields=[...this.productFormFields])}),this.columns.map(s=>{let a;s.col=="category"&&(a=s,a.listSource=this.categories,this.columns=[...this.columns])}),n()},error:o=>{i(o)}})})})}findSubCategories(){return G(this,null,function*(){return new Promise((n,i)=>{this.categoriesService.getItemsList(Se.SUBCATEGORIES).subscribe({next:o=>{this.subCategories=o,this.productFormFields.map(s=>{let a;s.formControlName=="subCategory"&&(a=s,a.optionsSnapShot=this.subCategories,a.options=[],this.productFormFields=[...this.productFormFields])}),this.columns.map(s=>{let a;s.col=="subCategory"&&(a=s,a.listSource=this.subCategories,this.columns=[...this.columns])}),n()},error:o=>{i(o)}})})})}findTags(){return G(this,null,function*(){return new Promise((n,i)=>{this.tagsService.getItemsList(Se.TAGS).subscribe({next:o=>{this.tags=o,this.productFormFields.map(s=>{let a;s.formControlName=="tags"&&(a=s,a.options=this.tags,this.productFormFields=[...this.productFormFields])}),this.columns.map(s=>{let a;s.col=="tags"&&(a=s,a.listSource=this.categories,this.columns=[...this.columns])}),n()},error:o=>{i(o)}})})})}startAddingVarriante(){return G(this,null,function*(){this.genericCrudComponent.creationMode="var",this.crudService.modeSubject.next("editMode"),yield this.genericCrudComponent.initForm(this.productFormFields),yield this.genericCrudComponent.patchForm(this.selectedProduct),this.genericCrudComponent.showDialog=!0})}selectVariante(n,i){return G(this,null,function*(){i?(this.selectedProduct=this.principalSelectedProduct,this.isSelectedVarraiente=!1):(this.selectedProduct=n,this.isSelectedVarraiente=!0),yield this.genericCrudComponent.initForm(Su),yield this.genericCrudComponent.patchForm(this.selectedProduct),this.genericCrudComponent.crudService.formValueSubject.next(this.genericCrudComponent.formValues),this.crudService.formValueSubject.getValue(),this.genericCrudComponent.creationMode="var",this.crudService.modeSubject.next("detailsMode")})}getMaxId(n){return!n||n.length===0?1:Math.max(...n.map(i=>i.id||0))+1}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(He),ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-products"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:12,vars:18,consts:[[3,"showDetails","showAdding","save","edit","delete","data","fields","title","sortField","sortDirection","columns","showAdd"],["more-actions","",1,"ml-5"],["icon","ri-add-line",3,"label","size"],["details-data","",1,"w-100"],[1,"w-100","d-flex","align-center","justify-content-center","mb-10"],[3,"handleClick","listButtons"],[1,"d-flex","align-baseline","justify-start"],[1,"mr-10","varrainte",3,"click","ngClass"],[1,"mr-10","varrainte",3,"ngClass","style"],["icon","ri-add-line",3,"handleClick","label","size"],[1,"d-flex","flex-column","align-center","justify-content-center"],[3,"navigations","numberSlides","images","styles"],["target","_blank",1,"mt-0","primary-text","bold","clickable","cursor-pointer",3,"href"],["src","assets/images/blank-product-img.png","alt","blank-product-img"],[1,"d-flex","flex-column","align-center","justify-content-center",2,"min-height","322px"],["src","assets/images/pdf_file_icon.svg","alt","manuel",1,"manuel","scale-in-center"],["download","",1,"btn-link",3,"href"],[1,"font-color-text"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectProduct(a)})("showAdding",function(){return o.onShowAddProduct()})("save",function(a){return o.createProduct(a)})("edit",function(a){return o.updateProduct(a)})("delete",function(a){return o.deleteProduct(a)}),I(1,"div",1),ye(2,WT,1,2,"app-button",2),D(),I(3,"div",3)(4,"div",4)(5,"app-buttons",5),ce("handleClick",function(a){return o.changeOption(a)}),D()(),I(6,"div",6)(7,"div",7),ce("click",function(){return o.selectVariante(o.selectedProduct,!0)}),D(),Je(8,GT,1,6,"div",8,et),D(),ye(10,ZT,2,1),ot(11,"async"),D()()),i&2&&(Q("data",o.products)("fields",o.productFormFields)("title","Produit")("sortField","createdAt")("sortDirection","asc")("columns",o.columns)("showAdd",!0),H(2),Ee(o.isSelectedVarraiente?-1:2),H(3),Q("listButtons",o.listButtonsData),H(2),Yr("background-image: url('",o.selectedProduct.imagesUrls?o.selectedProduct.imagesUrls[0]:"","') ;background-size: cover; background-position:center"),Q("ngClass",Qr(16,X_,o.selectedProduct===o.principalSelectedProduct)),H(),Ze(o.varriantes),H(2),Ee(gt(11,14,o.crudService.mode$)==="detailsMode"?10:-1))},dependencies:[Rn,gr,Jt,nt,zt,Us,$_,Ut,Wn,Cn],styles:['@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--bg-color: #ffffff;--font-color: #000000;--hover-font-color: #000000;--input-border-color: rgba(128, 128, 128, .44);--main-bg-color: #f2f2f2;--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: #E8476057;--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(27, 31, 35, .15);--footer-color:#000;--box-shadow: $box-shadow}[data-theme=dark][_ngcontent-%COMP%]{--bg-color: #161625;--font-color: #ffffff;--hover-font-color: #000000;--input-border-color: #E8476057;--main-bg-color: rgb(14, 14, 27);--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: rgba(255, 255, 255, .16);--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(60, 64, 68, .78);--footer-color:#fff;--box-shadow: $box-shadow}[_ngcontent-%COMP%]:dir(ltr){font-family:Ubuntu,sans-serif;--small-font-size: 11px;--normal-font-size: 14px;--medium-font-size: 18px;--big-font-size: 21px}[_ngcontent-%COMP%]:dir(rtl){font-family:Ubuntu,sans-serif;--small-font-size: 13px;--normal-font-size: 16px;--medium-font-size: 20px;--big-font-size: 23px}.excel-color[_ngcontent-%COMP%]{color:green!important}.pdf-color[_ngcontent-%COMP%]{color:#ff4500!important}.focus-color[_ngcontent-%COMP%]{border-color:var(--main-secoundary-color);outline:0;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31);box-shadow:0 0 0 .1rem #c7253e4f}.user[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.user[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px;width:100px;border-radius:1em;box-shadow:#0000003d 0 3px 8px}.user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:var(--font-color)}.user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:14px;font-weight:400}.dental-anatomy[_ngcontent-%COMP%]{margin-top:10px}.dental-anatomy[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:230px;margin-bottom:10px}.history[_ngcontent-%COMP%]{margin:0 20px;height:180px;max-height:180px;overflow-y:scroll;padding:0 0 13px}.history-title[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--font-color);font-weight:600;font-size:17px;position:sticky;top:0;z-index:2;background-color:var(--bg-color);width:100%;text-align:center}.history-data[_ngcontent-%COMP%]{margin-bottom:10px;text-align:left}.history-data[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color);font-weight:600;font-size:10px}.utilities[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;align-items:center}.utilities[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--font-color);font-weight:700;margin:0;font-size:20px}.utilities[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .utilities[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color)}.data[_ngcontent-%COMP%]{display:flex;flex-direction:column}.data-header[_ngcontent-%COMP%]{box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin-bottom:20px;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:auto}.data-header[_ngcontent-%COMP%]   .filter-input[_ngcontent-%COMP%]{height:30px;margin-bottom:5px}.data-body[_ngcontent-%COMP%]{max-height:500px;height:auto;padding:9px 0}.data-body-card[_ngcontent-%COMP%]{box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin-bottom:20px;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:70px;border-left:solid 10px var(--main-primary-color)}.data-body-card-infos[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.data-body-card-infos[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;border:solid 1px var(--font-color)}.data-body-card-infos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.data-body-card-infos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-weight:700;font-size:12px}.varrainte[_ngcontent-%COMP%]{height:80px;width:80px;aspect-ratio:1/1;border:solid 2px rgba(128,128,128,.178);border-radius:1rem;cursor:pointer}.varrainte-active[_ngcontent-%COMP%]{border:solid 2px var(--main-primary-color);border-radius:1rem}.btn-link[_ngcontent-%COMP%]{position:relative;background-color:var(--btn-bg-color);border-radius:.5em;font-size:12px;color:var(--btn-color);padding:.8em 1.8em;cursor:pointer;-webkit-user-select:none;user-select:none;text-align:center;text-decoration:none;transition-duration:.4s;-webkit-transition-duration:.4s}.btn-link[_ngcontent-%COMP%]:hover{transition-duration:.2s;background-color:var(--btn-hover-color)}.btn-link[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;border-radius:.5em;left:0;top:0;width:100%;height:100%;opacity:0;transition:all .5s;box-shadow:0 0 10px 40px var(--main-secoundary-color)}.btn-link[_ngcontent-%COMP%]:active{top:1px}.btn-link[_ngcontent-%COMP%]:active:after{box-shadow:0 0 #fff;opacity:1;transition:0s}.manuel[_ngcontent-%COMP%]{height:100px;margin-bottom:10px}']});let r=e;return r})();var tI=["container"],nI=["firstInput"],iI=()=>[import("./chunk-Q5JN3TC3.js").then(r=>r.ButtonComponent),kn,ci,di,In,hi,ui],Uf=()=>({standalone:!0}),Y_=()=>[];function rI(r,e){if(r&1){let t=Ae();I(0,"i",9),ce("click",function(){fe(t);let i=z();return pe(i.startEdit())}),D()}}function oI(r,e){if(r&1){let t=Ae();I(0,"i",10),ce("click",function(){fe(t);let i=z();return pe(i.closeEdit())}),D()}}function sI(r,e){if(r&1){let t=Ae();I(0,"form",11),ce("keyup.enter",function(){fe(t);let i=z();return pe(i.updateCurrentUser(i.currentUser))}),I(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15)(5,"p"),oe(6,"Informations personnelles :"),D()(),I(7,"div",16),ge(8,"i",17),I(9,"input",18,0),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.currentUser.firstName,i)||(o.currentUser.firstName=i),pe(i)}),D()(),I(11,"div",16),ge(12,"i",17),I(13,"input",19),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.currentUser.lastName,i)||(o.currentUser.lastName=i),pe(i)}),D()(),ge(14,"div",16),I(15,"div",16),ge(16,"i",20)(17,"input",21),D()(),I(18,"div",14)(19,"div",15)(20,"p"),oe(21,"Informations de s\xE9curit\xE9 :"),D()(),I(22,"div",12)(23,"div",22)(24,"form",23)(25,"div",24)(26,"div",25)(27,"input",26),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.currentUser.email,i)||(o.currentUser.email=i),pe(i)}),D()(),I(28,"div",25)(29,"app-button",27),ce("handleClick",function(){fe(t);let i=z();return pe(i.sendPasswordReset(i.currentUser.email))}),D()()()()()()()(),I(30,"div",28)(31,"div",29)(32,"span"),oe(33),D()()()()()}if(r&2){let t,n=z();H(9),Tt("ngModel",n.currentUser.firstName),Q("ngModelOptions",Pe(21,Uf))("disabled",n.detailsFlag)("readonly",n.detailsFlag),H(4),Tt("ngModel",n.currentUser.lastName),Q("disabled",n.detailsFlag)("ngModelOptions",Pe(22,Uf))("readonly",n.detailsFlag),H(4),Q("value",n.currentUser.email)("disabled",!0),H(10),Q("readonly",!0),Tt("ngModel",n.currentUser.email),Q("ngModelOptions",Pe(23,Uf)),H(2),Q("outlined",!1),H(2),Nt("height",120,"px")("width",120,"px")("background-color",n.currentUser&&n.currentUser.profileColor?n.currentUser.profileColor:"var(--main-primary-color"),H(2),lt(n.currentUser==null||n.currentUser.lastName==null||(t=n.currentUser.lastName.substring(0,1))==null?null:t.toUpperCase())}}function aI(r,e){r&1&&ge(0,"app-skelton",31),r&2&&Q("height",100)("shape","inputs-shape")}function lI(r,e){r&1&&ge(0,"app-skelton",31),r&2&&Q("height",100)("shape","inputs-shape")}function cI(r,e){r&1&&(I(0,"div",24)(1,"div",30),Je(2,aI,1,2,"app-skelton",31,et),D(),I(4,"div",30),Je(5,lI,1,2,"app-skelton",31,et),D()()),r&2&&(H(2),Ze(Pe(0,Y_).constructor(3)),H(3),Ze(Pe(1,Y_).constructor(3)))}var Q_=(()=>{let e=class e{constructor(n,i,o,s,a,l){this.fb=n,this.afAuth=i,this.authFirebaseService=o,this.crudService=s,this.roleCrudService=a,this.applicationService=l,this.fistInput={},this.detailsFlag=!0,this.form={},this.currentUser={},this.roles=[],this.emailInputMask=mp,this.authFirebaseService.$user.subscribe(c=>G(this,null,function*(){this.currentUser=c,this.roleCrudService.getItemsList(Se.ROLES).subscribe(d=>{this.roles=d})}))}get formControl(){return this.form.controls}get formValues(){return this.form.value}ngOnInit(){return G(this,null,function*(){yield this.patchForm(this.currentUser)})}startEdit(){this.detailsFlag=!1,this.fistInput&&setTimeout(()=>{this.fistInput.nativeElement.focus()},0)}patchForm(n){return G(this,null,function*(){Object.keys(this.formValues).forEach(i=>{this.applicationService.patchControlValue(i,n[i],this.form)})})}closeEdit(){this.detailsFlag=!0}updateCurrentUser(n){let i=n.key;this.crudService.updateItem(Se.USERS,i,n).then(o=>this.applicationService.showSuccessfulSaveDialog("Mis a jours d'utilisqteur","success","Utilisateur mis a jours avec succ\xE8s"))}sendPasswordReset(n){return this.afAuth.sendPasswordResetEmail(n).then(i=>{this.applicationService.showSwalDialog("lien de r\xE9initialisation du mot de passe envoy\xE9 \xE0 votre e-mail","success","#cce5cc")})}};e.\u0275fac=function(i){return new(i||e)(ve(lr),ve(js),ve(Ln),ve(He),ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-profile"]],viewQuery:function(i,o){if(i&1&&(Ve(tI,5),Ve(nI,5)),i&2){let s;Ue(s=ze())&&(o.container=s.first),Ue(s=ze())&&(o.fistInput=s.first)}},standalone:!0,features:[Be],decls:13,vars:2,consts:[["firstInput",""],["rootName","Dashboard"],[1,"container"],[1,"card","pb-50","h-100","x-small-padding","fade-in-fwd","one-em-border-radius"],[1,"d-flex","align-center","justify-content-between"],[1,"d-flex","align-center","justify-start"],[1,"text-align-left","bold","mr-10"],[1,"ri-edit-2-line","primary-text","bold","clickable","cursor-pointer"],[1,"ri-close-line","primary-text","bold","clickable","cursor-pointer"],[1,"ri-edit-2-line","primary-text","bold","clickable","cursor-pointer",3,"click"],[1,"ri-close-line","primary-text","bold","clickable","cursor-pointer",3,"click"],[3,"keyup.enter"],[1,"row","d-flex","align-center","justify-content-between","fade-in-fwd"],[1,"col-lg-9","col-sm-12","col-md-12","d-flex","flex-wrap"],[1,"col-lg-6","col-sm-6","col-md-6"],[1,"col-12"],[1,"col-lg-12","col-md-12","col-sm-12","d-flex","align-center","justify-start"],[1,"ri-user-line","primary-text","mt-7"],["type","text",1,"details-input",3,"ngModelChange","ngModel","ngModelOptions","disabled","readonly"],["type","text",1,"details-input",3,"ngModelChange","ngModel","disabled","ngModelOptions","readonly"],[1,"ri-mail-line","primary-text","mt-7"],["type","text","placeholder","email","readonly","",1,"details-input",3,"value","disabled"],[1,"col-lg-12","col-sm-12","col-md-12"],["ngForm",""],[1,"row"],[1,"col-12","form-group"],["type","email","placeholder","entrez votre email",2,"height","55px",3,"ngModelChange","readonly","ngModel","ngModelOptions"],["label","R\xE9initialiser le mot de passe","icon","ri-arrow-right-circle-fill",1,"mr-5",3,"handleClick","outlined"],[1,"col-lg-3","col-sm-12","col-md-12","d-flex","align-center","justify-content-center"],[1,"blank-user"],[1,"col-6"],[3,"height","shape"]],template:function(i,o){i&1&&(ge(0,"app-breadcrumbs",1),I(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"p",6),oe(6,"Mettez \xE0 jour vos informations personnelles"),D(),ye(7,rI,1,0,"i",7)(8,oI,1,0,"i",8),D()(),ye(9,sI,34,24)(10,cI,7,2),Ot(11,9,iI,null,10),D()()),i&2&&(H(7),Ee(o.detailsFlag?7:8),H(4),$t(o.currentUser))},dependencies:[Rn,mr,Jt,zt,pi],styles:['@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--bg-color: #ffffff;--font-color: #000000;--hover-font-color: #000000;--input-border-color: rgba(128, 128, 128, .44);--main-bg-color: #f2f2f2;--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: #E8476057;--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(27, 31, 35, .15);--footer-color:#000;--box-shadow: $box-shadow}[data-theme=dark][_ngcontent-%COMP%]{--bg-color: #161625;--font-color: #ffffff;--hover-font-color: #000000;--input-border-color: #E8476057;--main-bg-color: rgb(14, 14, 27);--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: rgba(255, 255, 255, .16);--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(60, 64, 68, .78);--footer-color:#fff;--box-shadow: $box-shadow}[_ngcontent-%COMP%]:dir(ltr){font-family:Ubuntu,sans-serif;--small-font-size: 11px;--normal-font-size: 14px;--medium-font-size: 18px;--big-font-size: 21px}[_ngcontent-%COMP%]:dir(rtl){font-family:Ubuntu,sans-serif;--small-font-size: 13px;--normal-font-size: 16px;--medium-font-size: 20px;--big-font-size: 23px}.excel-color[_ngcontent-%COMP%]{color:green!important}.pdf-color[_ngcontent-%COMP%]{color:#ff4500!important}.focus-color[_ngcontent-%COMP%]{border-color:var(--main-secoundary-color);outline:0;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31);box-shadow:0 0 0 .1rem #c7253e4f}.profile-pic[_ngcontent-%COMP%]{height:auto;width:auto;max-height:180px;max-width:180px;border-radius:50%;border:solid 5px var(--main-secoundary-color);margin-right:-17px}.details-input[_ngcontent-%COMP%]{border:none;border-bottom:solid rgba(128,128,128,.1803921569) 1px;border-radius:0}.details-input[_ngcontent-%COMP%]:disabled{background-color:transparent!important}.details-input[_ngcontent-%COMP%]:focus{border-bottom:none;border-radius:1em;outline:0!important;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31)!important;box-shadow:0 0 0 .1rem #c7253e4f!important}textarea[_ngcontent-%COMP%]{resize:none}@media (max-width: 776px){.profile-pic[_ngcontent-%COMP%]{margin-top:20px;max-height:120px;max-width:120px;border:solid 3px var(--main-secoundary-color)}}']});let r=e;return r})();var ql=[{label:"Pay\xE9",value:!0},{label:"Impay\xE9",value:!1}],J_=[{label:"En cours",value:!1},{label:"Exp\xE9di\xE9",value:!0}],Z_=[{formControlName:"clientName",type:"text",placeholder:"Entrez le nom du client",styles:{},id:"client-name",label:"Nom du client",requiredMessage:"Le nom du client est requis",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!0},{formControlName:"clientPhone",type:"text",placeholder:"Entrez le num\xE9ro de t\xE9l\xE9phone du client",styles:{},id:"client-phone",label:"T\xE9l\xE9phone du client",requiredMessage:"Le num\xE9ro de t\xE9l\xE9phone du client est requis",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!0},{formControlName:"address",type:"text",placeholder:"Entrez l'adresse",styles:{},id:"client-address",label:"Adresse",requiredMessage:"L'adresse est requise",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!0},{formControlName:"wilaya",type:"text",placeholder:"Entrez la wilaya",styles:{},id:"client-wilaya",label:"Wilaya",requiredMessage:"La wilaya est requise",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!0},{formControlName:"date",type:"date",placeholder:"S\xE9lectionnez la date de commande",styles:{},id:"order-date",label:"Date de commande",requiredMessage:"La date de commande est requise",required:!0,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:"",max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!0},{formControlName:"products",type:"multi-select",placeholder:"S\xE9lectionnez les produits",styles:{},id:"order-products",label:"Produits",requiredMessage:"Au moins un produit est requis",required:!0,options:[],inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!1,order:6,disabledOnEditMode:!0},{formControlName:"total",type:"text",placeholder:"Entrez le montant total",styles:{},id:"order-total",label:"Montant total",requiredMessage:"Le montant total est requis",required:!0,inputMask:En(0,void 0,"DA",2),options:[],min:0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"DA",rendered:!0,renderedOnEditMode:!1,order:7,disabledOnEditMode:!0},{formControlName:"paymentStatus",type:"checkbox",placeholder:"",styles:{"margin-top":"20px","margin-left":"5px"},id:"payment-status",label:"Statut de paiement",requiredMessage:"Le statut de paiement est requis",required:!0,options:[],inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:8,disabledOnEditMode:!1},{formControlName:"orderStatus",type:"checkbox",placeholder:"",styles:{"margin-top":"20px","margin-left":"5px"},id:"order-status",label:"Statut de commande",requiredMessage:"Le statut de commande est requis",required:!0,options:[{label:"Livr\xE9",value:"Delivered"},{label:"Traitement",value:"Processing"},{label:"Exp\xE9di\xE9",value:"Shipped"},{label:"Annul\xE9",value:"Cancelled"}],inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:9,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"order-created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:10,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"order-created-by",label:"Cr\xE9\xE9 par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:11,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de mise \xE0 jour",styles:{},id:"order-updated-at",label:"Mis \xE0 jour le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:12,disabledOnEditMode:!1},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"order-updated-by",label:"Mis \xE0 jour par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:13,disabledOnEditMode:!0}];var e1=[{col:"date",name:"Date de commande",sortable:!0,filterable:!0,type:"date"},{col:"clientName",name:"Nom du client",sortable:!0,filterable:!0,type:"text"},{col:"clientPhone",name:"T\xE9l\xE9phone du client",sortable:!0,filterable:!0,type:"text"},{col:"total",name:"Prix total",sortable:!0,filterable:!0,type:"numeric"},{col:"orderStatus",name:"Statut de commande",sortable:!1,filterable:!1,type:"boolean"},{col:"paymentStatus",name:"Statut de paiement",sortable:!1,filterable:!1,type:"boolean"}];function dI(r,e){if(r&1&&(I(0,"div",5)(1,"div",8)(2,"div",9),ge(3,"img",10),I(4,"span",11),oe(5),D()(),I(6,"span",12),oe(7),D(),I(8,"span",12),oe(9),D()()()),r&2){let t=e.$implicit,n=z();H(3),pt("src",t.variant!==void 0?n.applicationService.filterList(n.products,"id",t.productId).varients[t.variant].imagesUrls[0]||"":n.applicationService.filterList(n.products,"id",t.productId).imagesUrls[0]||"",Qt),H(2),lt(t.variant!==void 0?n.applicationService.filterList(n.products,"id",t.productId).varients[t.variant].productName||"":n.applicationService.filterList(n.products,"id",t.productId).productName||""),H(2),lt(t.variant!==void 0?n.applicationService.filterList(n.products,"id",t.productId).varients[t.variant].price||"":n.applicationService.filterList(n.products,"id",t.productId).price||""),H(2),Xe("(x",t.quantity,")")}}var t1=(()=>{let e=class e{constructor(n,i,o){this.crudService=n,this.productsCrudService=i,this.applicationService=o,this.selectedOrder={},this.filters={},this.orderFormFields=Z_,this.orderColumns=e1,this.Number=Number,this.paymentOptions=ql,this.orderOptions=J_}ngOnInit(){return G(this,null,function*(){yield this.findProducts(),yield this.findOrders()})}findOrders(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.ORDERS).subscribe({next:o=>{this.orders=o.sort((s,a)=>new Date(a.date).getTime()-new Date(s.date).getTime()),this.allOrders=this.orders,n()},error:o=>{i(o)}})})}onSelectOrder(n){this.selectedOrder=n}createOrder(n){this.crudService.createItem(Se.ORDERS,n),this.applicationService.showSuccessfulSaveDialog("Order Creation","success","Orders created successfully")}updateOrder(n){let i=n.id,o=n.data;this.crudService.updateItem(Se.ORDERS,i,o).then(s=>this.applicationService.showSuccessfulSaveDialog("Update Order","success","Order Updated successfully")),this.genericCrudComponent.closeRight()}deleteOrder(n){this.crudService.deleteItem(Se.ORDERS,n).then(i=>"order deleted successfully")}printGoogleSheet(n){this.applicationService.downloadExcel(n)}findProducts(){return G(this,null,function*(){return new Promise((n,i)=>{this.productsCrudService.getItemsList(Se.PRODUCTS).subscribe({next:o=>{this.products=o,this.orderFormFields.map(s=>{let a;s.formControlName=="products"&&(a=s,a.options=this.products,this.orderFormFields=[...this.orderFormFields])}),n()},error:o=>{i(o)}})})})}filterListOrders(n,i){i!=null?this.filters[n]=i.value:this.filters[n]=null,this.orders=this.allOrders.filter(o=>Object.keys(this.filters).every(s=>this.filters[s]==null||o[s]==this.filters[s])),this.crudService.totalRows=this.orders.length}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-orders"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:13,vars:13,consts:[["sortDirection","desc",3,"showDetails","save","edit","delete","showAdd","data","fields","title","sortField","columns"],["crud-utilities","",1,"d-flex","align-center","justify-content-between","flex-wrap"],["bindLabel","label",1,"mr-5",2,"width","200px",3,"selectOption","options","placeholder","selectedOption"],["details-data","",1,"w-100"],[1,"main-background-color","p-10"],[1,"card","background-color"],[1,"card","primary-background-color","text-align-right"],[1,"m-0","white-text"],[1,"d-flex","align-center","justify-content-between"],[1,"d-flex","align-center","justify-start"],["height","35",3,"src"],[1,"font-color-text"],[1,"green-text"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectOrder(a)})("save",function(a){return o.createOrder(a)})("edit",function(a){return o.updateOrder(a)})("delete",function(a){return o.deleteOrder(a)}),I(1,"div",1)(2,"app-generic-drop-down",2),ce("selectOption",function(a){return o.filterListOrders("paymentStatus",a)}),D(),I(3,"app-generic-drop-down",2),ce("selectOption",function(a){return o.filterListOrders("orderStatus",a)}),D()(),I(4,"div",3)(5,"div",4),Je(6,dI,10,4,"div",5,et),I(8,"div",6)(9,"h3",7),oe(10," Prix totale : "),I(11,"b"),oe(12),D()()()()()()),i&2&&(Q("showAdd",!1)("data",o.orders)("fields",o.orderFormFields)("title","Order")("sortField","date")("columns",o.orderColumns),H(2),Q("options",o.paymentOptions)("placeholder","Payment status")("selectedOption",o.paymentOptions[0]),H(),Q("options",o.orderOptions)("placeholder","Order status")("selectedOption",o.orderOptions[0]),H(3),Ze(o.selectedOrder.products),H(6),Xe("",o.selectedOrder.total," DA "))},dependencies:[nt,hn]});let r=e;return r})();var n1=[{col:"email",name:"E-mail",sortable:!0,filterable:!0,type:"text"},{col:"firstName",name:"Pr\xE9nom",sortable:!0,filterable:!0,type:"text"},{col:"lastName",name:"Nom de famille",sortable:!0,filterable:!0,type:"text"},{col:"role",name:"R\xF4le",sortable:!1,filterable:!1,type:"select",listSource:[],fieldSource:"id",labelSource:"name"},{col:"isActive",name:"Statut",sortable:!0,filterable:!0,type:"boolean"}],i1=[{formControlName:"email",type:"text",placeholder:"Entrez l'adresse e-mail",styles:{},id:"email",label:"E-mail",requiredMessage:"Un e-mail valide est requis",required:!0,inputMask:"",options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!0,controls:new Map([[[Bs.email,"email"]," L'e-mail doit \xEAtre valide"]])},{formControlName:"password",type:"password",placeholder:"Entrez le mot de passe",styles:{},id:"password",label:"Mot de passe",requiredMessage:"Le mot de passe est requis",required:!0,inputMask:null,options:[],min:6,max:20,firstInput:null,secondInput:null,mode:"password",depend:null,unite:"",rendered:!0,renderedOnEditMode:!1,order:3,disabledOnEditMode:!0},{formControlName:"firstName",type:"text",placeholder:"Entrez le pr\xE9nom",styles:{},id:"first-name",label:"Pr\xE9nom",requiredMessage:"Le pr\xE9nom est requis",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!1},{formControlName:"lastName",type:"text",placeholder:"Entrez le nom de famille",styles:{},id:"last-name",label:"Nom de famille",requiredMessage:"Le nom de famille est requis",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"role",type:"select",placeholder:"S\xE9lectionnez un r\xF4le",styles:{},id:"user-role",label:"R\xF4le",requiredMessage:"Le r\xF4le est requis",required:!1,options:[],bindLabel:"name",bindValue:"id",inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:6,disabledOnEditMode:!1},{formControlName:"isActive",type:"checkbox",placeholder:"",styles:{"margin-top":"20px","margin-left":"5px"},id:"is-active",label:"Est actif",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:7,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:9,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de mise \xE0 jour",styles:{},id:"updated-at",label:"Mis \xE0 jour le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:10,disabledOnEditMode:!1},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"user-updated-by",label:"Mis \xE0 jour par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:11,disabledOnEditMode:!0},{formControlName:"profileColor",type:"text",placeholder:"",styles:{},id:"profile-color",label:"",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:11,disabledOnEditMode:!0}];var uI=()=>({label:"Utilisateur interne",value:1}),hI=()=>({label:"Utilisateur sans role",value:2}),fI=(r,e)=>[r,e];function pI(r,e){if(r&1&&(I(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),oe(4),D()()()()),r&2){let t=z();H(2),Nt("height",120,"px")("width",120,"px")("background-color",t.selectedUser&&t.selectedUser.profileColor?t.selectedUser.profileColor:"var(--main-primary-color"),H(2),lt(t.selectedUser&&t.selectedUser.firstName.substring(0,1).toUpperCase())}}var r1=(()=>{let e=class e{constructor(n,i,o,s,a){this.crudService=n,this.rolesService=i,this.afAuth=o,this.authService=s,this.applicationService=a,this.userColumns=n1,this.userFormFields=i1,this.dbPath=Se.USERS,this.rolesDbPath=Se.ROLES,this.roles=[],this.Object=Object}ngOnInit(){return G(this,null,function*(){try{yield this.findUsers()}catch(n){console.error("Error fetching users:",n)}try{yield this.findRoles()}catch(n){console.error("Error fetching roles:",n)}})}onSelectUser(n){this.selectedUser=n}findUsers(){return G(this,null,function*(){return new Promise((n,i)=>{this.crudService.getItemsList(this.dbPath).subscribe({next:o=>{this.users=o,this.allUsers=this.users,n()},error:o=>{i(o)}})})})}findRoles(){return G(this,null,function*(){return new Promise((n,i)=>{this.rolesService.getItemsList(this.rolesDbPath).subscribe({next:o=>{this.roles=o,this.userFormFields.map(s=>{let a;s.formControlName=="role"&&(a=s,a.options=this.roles,this.userFormFields=[...this.userFormFields])}),this.userColumns.map(s=>{let a;s.col=="role"&&(a=s,a.listSource=this.roles,this.userColumns=[...this.userColumns])}),n()},error:o=>{i(o)}})})})}createUser(n){return G(this,null,function*(){Xf(this.afAuth.createUserWithEmailAndPassword(n.email,n.password)).subscribe(i=>G(this,null,function*(){let o=i.user;o&&(n.uid=o.uid,n.email=o.email,n.password=yield this.applicationService.hashPassword(n.password),n.profileColor=this.applicationService.setRandomColor(),n.createdAt=new Date().toISOString().split("T")[0],this.crudService.createItem(this.dbPath,n),yield o.sendEmailVerification(),this.applicationService.showSuccessfulSaveDialog("cr\xE9ation utilisateur","success","Utilisateur cr\xE9\xE9 avec succ\xE8s"))}),i=>{this.applicationService.showSuccessfulSaveDialog("Utilisateur existant","error","un erreur est survenue lors de la cr\xE9ation de l'utilisateur")})})}updateUser(n){let i=n.id,o=n.data;this.crudService.updateItem(this.dbPath,i,o).then(s=>this.applicationService.showSuccessfulSaveDialog("Mis \xE0 jour utilisateur ","success","Utilisateur mis \xE0 jour avec succ\xE8s")),this.genericCrudComponent.closeRight()}deleteUser(n){return G(this,null,function*(){let i;this.crudService.getItemBy_(n,n,this.dbPath).subscribe(o=>{i=o.uid,this.crudService.deleteItem(this.dbPath,n).then(s=>{"Utilisateur supprim\xE9 avec succ\xE8s"})})})}deleteAllUsers(){this.crudService.deleteAll(this.dbPath).then(n=>"utilsateurs supprim\xE9s avec succ\xE8s")}filterListUsers(n){this.users=this.allUsers,n===2?this.users=this.allUsers.filter(i=>i.role===void 0):this.users=this.allUsers.filter(i=>i.role!==void 0)}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(He),ve(js),ve(Ln),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-users"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:4,vars:14,consts:[[3,"showDetails","save","edit","delete","deleteAll","data","fields","title","sortField","columns","showAdd"],["crud-utilities","",1,"d-flex","align-center","justify-content-between","flex-wrap"],["bindLabel","label",1,"mr-5",2,"width","200px",3,"selectOption","options","placeholder"],["details-data","",1,"w-100"],[1,"user"],[1,"blank-user"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectUser(a)})("save",function(a){return o.createUser(a)})("edit",function(a){return o.updateUser(a)})("delete",function(a){return o.deleteUser(a)})("deleteAll",function(){return o.deleteAllUsers()}),I(1,"div",1)(2,"app-generic-drop-down",2),ce("selectOption",function(a){return o.filterListUsers(a.value)}),D()(),ye(3,pI,5,7,"div",3),D()),i&2&&(Q("data",o.users)("fields",o.userFormFields)("title","Utilisateur")("sortField","name")("columns",o.userColumns)("showAdd",!1),H(2),Q("options",Rs(11,fI,Pe(9,uI),Pe(10,hI)))("placeholder","type d'utilisateur"),H(),Ee(o.selectedUser?3:-1))},dependencies:[nt,zt,hn],styles:[".user[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.user[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:90px;width:90px;border-radius:50%;border:solid 3px var(--main-primary-color)}.user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:var(--font-color)}.user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:14px;font-weight:400}"]});let r=e;return r})();var o1=[{label:"Read",value:"read"},{label:"Write",value:"write"},{label:"Delete",value:"delete"},{label:"Update",value:"update"},{label:"Manage users",value:"user"}],Hl=[{col:"name",name:"Role Name",sortable:!0,filterable:!0,type:"text"},{col:"description",name:"Description",sortable:!1,filterable:!1,type:"text"},{col:"permissions",name:"Permissions",sortable:!1,filterable:!1,type:"tags",listSource:o1,fieldSource:"value",labelSource:"label"}],Wl=[{formControlName:"name",type:"text",placeholder:"Enter role name",styles:{},id:"role-name",label:"Role Name",requiredMessage:"Role name is required",required:!0,inputMask:null,options:[],min:3,max:50,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"description",type:"textarea",placeholder:"Enter role description",styles:{},id:"role-description",label:"Description",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:500,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"permissions",type:"multi-select",placeholder:"Select permissions",styles:{},id:"role-permissions",label:"Permissions",requiredMessage:"At least one permission must be selected",required:!0,inputMask:null,options:o1,bindLabel:"label",bindValue:"value",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"Select creation date",styles:{},id:"role-created-at",label:"Created At",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:4,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"Select last update date",styles:{},id:"role-updated-at",label:"Updated At",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:5,disabledOnEditMode:!0}];var s1=(()=>{let e=class e{constructor(n,i){this.crudService=n,this.applicationService=i,this.dbPath=Se.ROLES,this.roleColumns=Hl,this.roleFormFields=Wl,this.selectedRole={}}ngOnInit(){return G(this,null,function*(){yield this.findRoles()})}findRoles(){return new Promise((n,i)=>{this.crudService.getItemsList(this.dbPath).subscribe({next:o=>{this.roles=o,n()},error:o=>{i(o)}})})}onSelectRole(n){this.selectedRole=n}createRole(n){this.crudService.createItem(this.dbPath,n),this.applicationService.showSuccessfulSaveDialog("Cr\xE9ation du role","success","Role cr\xE9\xE9 avec succ\xE8s")}updateRole(n){let i=n.id,o=n.data;this.crudService.updateItem(this.dbPath,i,o).then(s=>this.applicationService.showSuccessfulSaveDialog("Mis \xE0  jours du role","success","Role mise \xE0 jour avec succ\xE8s")),this.genericCrudComponent.closeRight()}deleteRole(n){this.crudService.deleteItem(this.dbPath,n).then(i=>"role deleted successfully")}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-rols"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:1,vars:5,consts:[[3,"showDetails","save","edit","delete","data","fields","title","sortField","columns"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectRole(a)})("save",function(a){return o.createRole(a)})("edit",function(a){return o.updateRole(a)})("delete",function(a){return o.deleteRole(a)}),D()),i&2&&Q("data",o.roles)("fields",o.roleFormFields)("title","Role")("sortField","name")("columns",o.roleColumns)},dependencies:[nt]});let r=e;return r})();var a1=[{col:"tagName",name:"Nom du Tag",sortable:!0,filterable:!0,type:"text"},{col:"tagDescription",name:"Description",sortable:!1,filterable:!1,type:"textarea"},{col:"createdAt",name:"Cr\xE9\xE9 le",sortable:!0,filterable:!0,type:"date"},{col:"createdBy",name:"Cr\xE9\xE9 par",sortable:!1,filterable:!1,type:"text"}],l1=[{formControlName:"tagName",type:"text",placeholder:"Entrez le nom du tag",styles:{},id:"tag-name",label:"Nom du Tag",requiredMessage:"Le nom du tag est requis",required:!0,inputMask:null,options:[],min:3,max:50,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"tagDescription",type:"textarea",placeholder:"Entrez la description du tag",styles:{},id:"tag-description",label:"Description",requiredMessage:"",required:!1,inputMask:null,options:[],min:3,max:500,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"product-created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:4,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"product-created-by",label:"Cr\xE9\xE9 par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:5,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de derni\xE8re mise \xE0 jour",styles:{},id:"tag-updated-at",label:"Mis \xE0 jour le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:6,disabledOnEditMode:!0},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"product-updated-by",label:"Mis \xE0 jour par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:7,disabledOnEditMode:!0}];var c1=(()=>{let e=class e{constructor(n,i){this.crudService=n,this.applicationService=i,this.dbPath=Se.TAGS,this.tagColumns=a1,this.tagFormFields=l1,this.selectedTag={},this.roleFormFields=Wl,this.roleColumns=Hl}ngOnInit(){return G(this,null,function*(){yield this.findTags()})}findTags(){return new Promise((n,i)=>{this.crudService.getItemsList(this.dbPath).subscribe({next:o=>{this.tags=o,n()},error:o=>{i(o)}})})}onSelectTag(n){this.selectedTag=n}createTag(n){this.crudService.createItem(this.dbPath,n),this.applicationService.showSuccessfulSaveDialog("Cr\xE9ation Tag","success","Tag cr\xE9\xE9 avec success")}updateTag(n){let i=n.id,o=n.data;this.crudService.updateItem(this.dbPath,i,o).then(s=>this.applicationService.showSuccessfulSaveDialog("Mis \xE0 jour tag","success","Tag mis \xE0 jour avec succ\xE8s")),this.genericCrudComponent.closeRight()}deleteTag(n){this.crudService.deleteItem(this.dbPath,n).then(i=>"Tag supprim\xE9 avec succ\xE8s")}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-tags"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:1,vars:5,consts:[[3,"showDetails","save","edit","delete","data","fields","title","sortField","columns"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectTag(a)})("save",function(a){return o.createTag(a)})("edit",function(a){return o.updateTag(a)})("delete",function(a){return o.deleteTag(a)}),D()),i&2&&Q("data",o.tags)("fields",o.tagFormFields)("title","Tag")("sortField","name")("columns",o.tagColumns)},dependencies:[nt]});let r=e;return r})();var d1=[{col:"reviewerName",name:"Nom de l'\xE9valuateur",sortable:!0,filterable:!0,type:"text"},{col:"reviewText",name:"Texte de l'\xE9valuation",sortable:!1,filterable:!1,type:"textarea"},{col:"rating",name:"\xC9valuation",sortable:!0,filterable:!1,type:"rating"},{col:"associatedProduct",name:"Produit associ\xE9",sortable:!1,filterable:!1,type:"select",listSource:[],fieldSource:"id",labelSource:"productName"},{col:"status",name:"Statut",sortable:!1,filterable:!1,type:"boolean"}],u1=[{formControlName:"reviewerName",type:"text",placeholder:"Entrez le nom de l'\xE9valuateur",styles:{},id:"reviewer-name",label:"Nom de l'\xE9valuateur",requiredMessage:"Le nom de l'\xE9valuateur est requis",required:!0,inputMask:null,options:[],min:3,max:50,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"reviewText",type:"textarea",placeholder:"Entrez l'\xE9valuation",styles:{},id:"review-text",label:"Texte de l'\xE9valuation",requiredMessage:"Le texte de l'\xE9valuation est requis",required:!0,inputMask:null,options:[],min:void 0,max:1e3,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"rating",type:"text",placeholder:"Entrez l'\xE9valuation (1-5)",styles:{},id:"review-rating",label:"\xC9valuation",requiredMessage:"L'\xE9valuation est requise",required:!0,inputMask:En(0,5,"",0),options:[],min:1,max:5,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"associatedProduct",type:"select",placeholder:"Entrez le produit associ\xE9",styles:{},id:"associated-product",label:"Produit associ\xE9",requiredMessage:"Le produit associ\xE9 est requis",required:!0,inputMask:null,options:[],bindLabel:"productName",bindValue:"id",min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!1},{formControlName:"status",type:"checkbox",placeholder:"S\xE9lectionnez le statut",styles:{},id:"review-status",label:"Statut",requiredMessage:"Le statut est requis",required:!0,inputMask:null,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"product-created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:6,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"product-created-by",label:"Cr\xE9\xE9 par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:7,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de mise \xE0 jour",styles:{},id:"tag-updated-at",label:"Mis \xE0 jour le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:8,disabledOnEditMode:!1},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"product-updated-by",label:"Mis \xE0 jour par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:9,disabledOnEditMode:!0}];var h1=(()=>{let e=class e{constructor(n,i,o){this.crudService=n,this.productCrudService=i,this.applicationService=o,this.dbPath=Se.REVIEWS,this.reviewColumns=d1,this.reviewFormFields=u1,this.filters={},this.selectedReview={},this.products=[],this.selectedOption={},this.paymentOptions=ql}ngOnInit(){return G(this,null,function*(){yield this.findReviews(),yield this.findProducts()})}findReviews(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.REVIEWS).subscribe({next:o=>{this.reviews=o,this.allReviews=this.reviews,n()},error:o=>{i(o)}})})}findProducts(){return G(this,null,function*(){return new Promise((n,i)=>{this.productCrudService.getItemsList(Se.PRODUCTS).subscribe({next:o=>{this.products=o,this.reviewFormFields.map(s=>{let a;s.formControlName=="associatedProduct"&&(a=s,a.options=this.products,this.reviewFormFields=[...this.reviewFormFields])}),this.reviewColumns.map(s=>{let a;s.col=="associatedProduct"&&(a=s,a.listSource=this.products,this.reviewColumns=[...this.reviewColumns])}),n()},error:o=>{i(o)}})})})}onSelectReview(n){this.selectedReview=n}createReview(n){n.rating=+n.rating.trim(),this.crudService.createItem(Se.REVIEWS,n),this.applicationService.showSuccessfulSaveDialog("Cr\xE9ation Avis","success","Avis cr\xE9\xE9 avec succ\xE8s")}updateReview(n){let i=n.id,o=n.data;this.crudService.updateItem(Se.REVIEWS,i,o).then(s=>this.applicationService.showSuccessfulSaveDialog("Mis a jours Avis","success","Avi mis \xE0 jour avec succ\xE8s")),this.genericCrudComponent.closeRight()}deleteReview(n){this.crudService.deleteItem(Se.REVIEWS,n).then(i=>"Avis supprim\xE9 avec succ\xE8s")}filterListReviews(n,i){i!=null?this.filters[n]=i.id:this.filters[n]=null,this.reviews=this.allReviews.filter(o=>Object.keys(this.filters).every(s=>this.filters[s]==null||o[s]==this.filters[s])),this.crudService.totalRows=this.reviews.length}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-reviews"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:3,vars:9,consts:[[3,"showDetails","save","edit","delete","data","fields","title","sortField","columns","showAdd"],["crud-utilities","",1,"d-flex","align-center","justify-content-between"],["bindLabel","productName",1,"mr-5",2,"width","200px",3,"selectOption","options","placeholder","selectedOption"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectReview(a)})("save",function(a){return o.createReview(a)})("edit",function(a){return o.updateReview(a)})("delete",function(a){return o.deleteReview(a)}),I(1,"div",1)(2,"app-generic-drop-down",2),ce("selectOption",function(a){return o.filterListReviews("associatedProduct",a)}),D()()()),i&2&&(Q("data",o.reviews)("fields",o.reviewFormFields)("title","Avis")("sortField","name")("columns",o.reviewColumns)("showAdd",!0),H(2),Q("options",o.products)("placeholder","product")("selectedOption",o.products[0]))},dependencies:[nt,hn]});let r=e;return r})();var f1=[{formControlName:"categoryName",type:"text",placeholder:"Entrez le nom de la cat\xE9gorie",styles:{},id:"category-name",label:"Nom de la cat\xE9gorie",requiredMessage:"Le nom de la cat\xE9gorie est obligatoire",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"categoryDescription",type:"textarea",placeholder:"Entrez la description de la cat\xE9gorie",styles:{},id:"category-description",label:"Description de la cat\xE9gorie",requiredMessage:"La description est obligatoire",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"imagesUrls",type:"file",fileType:"image",multiple:!1,placeholder:"T\xE9l\xE9chargez une image de produit",styles:{},id:"category-image",label:"T\xE9l\xE9charger une image",requiredMessage:"L'image de la cat\xE9gorie est obligatoire",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"category-created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:3,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"category-created-by",label:"Cr\xE9\xE9 par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:4,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de derni\xE8re mise \xE0 jour",styles:{},id:"category-updated-at",label:"Mis \xE0 jour le",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"category-updated-by",label:"Mis \xE0 jour par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:6,disabledOnEditMode:!0}],p1=[{col:"imagesUrls",name:"Image",sortable:!1,filterable:!1,type:"img"},{col:"categoryName",name:"Nom de la cat\xE9gorie",sortable:!0,filterable:!0,type:"text"},{col:"categoryDescription",name:"Description",sortable:!1,filterable:!1,type:"text"},{col:"createdAt",name:"Cr\xE9\xE9 le",sortable:!0,filterable:!0,type:"date"},{col:"createdBy",name:"Cr\xE9\xE9 par",sortable:!1,filterable:!1,type:"text"}],g1=[{formControlName:"category",type:"select",placeholder:"S\xE9lectionnez une cat\xE9gorie",styles:{},id:"product-category",label:"Cat\xE9gorie",requiredMessage:"La cat\xE9gorie est obligatoire",required:!0,options:[],bindLabel:"categoryName",bindValue:"id",inputMask:null,min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"subcategoryName",type:"text",placeholder:"Entrez le nom de la sous-cat\xE9gorie",styles:{},id:"subcategory-name",label:"Nom de la sous-cat\xE9gorie",requiredMessage:"Le nom de la sous-cat\xE9gorie est obligatoire",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:"categoryId",unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"subcategoryDescription",type:"textarea",placeholder:"Entrez la description de la sous-cat\xE9gorie",styles:{},id:"subcategory-description",label:"Description de la sous-cat\xE9gorie",requiredMessage:"La description est obligatoire",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:"categoryId",unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"subcategoryImagesUrls",type:"file",fileType:"image",multiple:!1,placeholder:"T\xE9l\xE9chargez une image de sous-cat\xE9gorie",styles:{},id:"subcategory-image",label:"T\xE9l\xE9charger une image",requiredMessage:"L'image de la sous-cat\xE9gorie est obligatoire",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:"categoryId",unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"subcategory-created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:5,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"subcategory-created-by",label:"Cr\xE9\xE9 par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:6,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de derni\xE8re mise \xE0 jour",styles:{},id:"subcategory-updated-at",label:"Mis \xE0 jour le",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:7,disabledOnEditMode:!0},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"subcategory-updated-by",label:"Mis \xE0 jour par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:8,disabledOnEditMode:!0}],m1=[{col:"subcategoryImagesUrls",name:"Image",sortable:!1,filterable:!1,type:"img"},{col:"subcategoryName",name:"Nom de la sous-cat\xE9gorie",sortable:!0,filterable:!0,type:"text"},{col:"subcategoryDescription",name:"Description",sortable:!1,filterable:!1,type:"text"},{col:"createdAt",name:"Cr\xE9\xE9 le",sortable:!0,filterable:!0,type:"date"},{col:"createdBy",name:"Cr\xE9\xE9 par",sortable:!1,filterable:!1,type:"text"}];var _1=()=>[import("./chunk-KLDVIGNK.js").then(r=>r.CarouselComponent)],v1=()=>({height:"250px",width:"250px"});function gI(r,e){if(r&1&&ge(0,"app-carousel",6),r&2){let t=z(2);Q("navigations",t.selectedCategory.imagesUrls.length>1)("numberSlides",t.selectedCategory.imagesUrls.length)("images",t.selectedCategory.imagesUrls)("styles",Pe(4,v1))}}function mI(r,e){r&1&&ge(0,"img",7)}function _I(r,e){if(r&1){let t=Ae();I(0,"app-generic-crud",3),ce("showDetails",function(i){fe(t);let o=z();return pe(o.onSelectCategory(i))})("save",function(i){fe(t);let o=z();return pe(o.createCategory(i))})("edit",function(i){fe(t);let o=z();return pe(o.updateCategory(i))})("delete",function(i){fe(t);let o=z();return pe(o.deleteCategory(i))}),I(1,"div",4)(2,"div",5),ye(3,gI,1,5)(4,mI,1,0),Ot(5,3,_1,null,4),D()()()}if(r&2){let t=z();Q("data",t.categories)("fields",t.categoryFormFields)("title","categorie")("sortField","createdAt")("columns",t.columns)("showAdd",!0),H(5),$t(t.selectedCategory.imagesUrls!==void 0&&t.selectedCategory.imagesUrls!==null&&t.selectedCategory.imagesUrls.length>0)}}function vI(r,e){if(r&1&&ge(0,"app-carousel",6),r&2){let t=z(2);Q("navigations",t.selectedCategory.imagesUrls.length>1)("numberSlides",t.selectedCategory.imagesUrls.length)("images",t.selectedCategory.imagesUrls)("styles",Pe(4,v1))}}function bI(r,e){r&1&&ge(0,"img",7)}function yI(r,e){if(r&1){let t=Ae();I(0,"app-generic-crud",3),ce("showDetails",function(i){fe(t);let o=z();return pe(o.onSelectSubcategory(i))})("save",function(i){fe(t);let o=z();return pe(o.createSubcategory(i))})("edit",function(i){fe(t);let o=z();return pe(o.updateSubcategory(i))})("delete",function(i){fe(t);let o=z();return pe(o.deleteSubcategory(i))}),I(1,"div",4)(2,"div",5),ye(3,vI,1,5)(4,bI,1,0),Ot(5,3,_1,null,4),D()()()}if(r&2){let t=z();Q("data",t.subCategories)("fields",t.subcategoryFormFields)("title","Sous categorie")("sortField","createdAt")("columns",t.subcategoryColumns)("showAdd",!0),H(5),$t(t.selectedCategory.imagesUrls!==void 0&&t.selectedCategory.imagesUrls!==null&&t.selectedCategory.imagesUrls.length>0)}}var b1=(()=>{let e=class e{constructor(n,i){this.crudService=n,this.applicationService=i,this.columns=p1,this.categoryFormFields=f1,this.subcategoryColumns=m1,this.subcategoryFormFields=g1,this.listButtonsData=[{index:1,label:"Categorie ",active:!0},{index:2,label:"Sous categorie",active:!1}],this.selectedButton=this.listButtonsData[0],this.selectedCategory={},this.selectedSubCategory={},this.Object=Object}ngOnInit(){return G(this,null,function*(){yield this.findCategories()})}changeOption(n){return G(this,null,function*(){this.selectedButton=n,this.selectedButton.index==2?yield this.findSubcategories():yield this.findCategories()})}findCategories(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.CATEGORIES).subscribe({next:o=>{this.categories=o,this.subcategoryFormFields.map(s=>{let a;s.formControlName=="category"&&(a=s,a.options=this.categories,this.subcategoryFormFields=[...this.subcategoryFormFields])}),this.columns.map(s=>{let a;s.col=="category"&&(a=s,a.listSource=this.categories,this.subcategoryColumns=[...this.subcategoryColumns])}),n()},error:o=>{i(o)}})})}createCategory(n){n=n,this.crudService.createItem(Se.CATEGORIES,n).then(()=>{this.applicationService.showSuccessfulSaveDialog("Creation du categorie","success","Categorie cr\xE9\xE9e avec succ\xE8s"),this.findCategories()})}updateCategory(n){let i=n.id,o=n.data;this.crudService.updateItem(Se.CATEGORIES,i,o).then(()=>{this.applicationService.showSuccessfulSaveDialog("Mis a jours du cateorie","success","Categorie mis a jours avec succ\xE8s"),this.findCategories()}),this.genericCrudComponent.closeRight()}deleteCategory(n){this.crudService.deleteItem(Se.CATEGORIES,n).then(()=>{"Category deleted successfully";this.findCategories()})}onSelectCategory(n){this.selectedCategory=n,this.selectedCategory}findSubcategories(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.SUBCATEGORIES).subscribe({next:o=>{this.subCategories=o,n()},error:o=>{i(o)}})})}createSubcategory(n){n=n,this.crudService.createItem(Se.SUBCATEGORIES,n).then(()=>{this.applicationService.showSuccessfulSaveDialog("Creation du sous-categorie","success","Sous-categorie cr\xE9\xE9e avec succ\xE8s"),this.findSubcategories()})}updateSubcategory(n){let i=n.id,o=n.data;this.crudService.updateItem(Se.SUBCATEGORIES,i,o).then(()=>{this.applicationService.showSuccessfulSaveDialog("Mis a jour du sous-categorie","success","Sous-categorie mis a jour avec succ\xE8s"),this.findSubcategories()}),this.genericCrudComponent.closeRight()}deleteSubcategory(n){this.crudService.deleteItem(Se.SUBCATEGORIES,n).then(()=>{"Subcategory deleted successfully";this.findSubcategories()})}onSelectSubcategory(n){this.selectedSubCategory=n,this.selectedSubCategory}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-categories"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:4,vars:2,consts:[[1,"w-100","d-flex","align-center","justify-end"],[3,"handleClick","listButtons"],[3,"data","fields","title","sortField","columns","showAdd"],[3,"showDetails","save","edit","delete","data","fields","title","sortField","columns","showAdd"],["details-data","",1,"w-100"],[1,"d-flex","flex-column","align-center","justify-content-center"],[3,"navigations","numberSlides","images","styles"],["src","assets/images/blank-product-img.png","alt","blank-product-img"]],template:function(i,o){if(i&1&&(I(0,"div",0)(1,"app-buttons",1),ce("handleClick",function(a){return o.changeOption(a)}),D()(),ye(2,_I,7,7,"app-generic-crud",2)(3,yI,7,7,"app-generic-crud",2)),i&2){let s;H(),Q("listButtons",o.listButtonsData),H(),Ee((s=o.selectedButton.index)===1?2:s===2?3:-1)}},dependencies:[Rn,gr,Jt,nt,zt,Us],styles:['@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:Ubuntu;src:url("./media/Ubuntu-Regular-55DNWN2R.ttf") format("truetype");font-weight:400;font-style:normal}[_ngcontent-%COMP%]:root{--bg-color: #ffffff;--font-color: #000000;--hover-font-color: #000000;--input-border-color: rgba(128, 128, 128, .44);--main-bg-color: #f2f2f2;--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: #E8476057;--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(27, 31, 35, .15);--footer-color:#000;--box-shadow: $box-shadow}[data-theme=dark][_ngcontent-%COMP%]{--bg-color: #161625;--font-color: #ffffff;--hover-font-color: #000000;--input-border-color: #E8476057;--main-bg-color: rgb(14, 14, 27);--main-primary-color: #C7253E;--main-secoundary-color: #f9e9eb;--focus-border-color: rgba(255, 255, 255, .16);--btn-bg-color:#C7253E;--btn-color:#ffffff;--btn-hover-color:#8b192b;--card-footer-border-color:rgba(60, 64, 68, .78);--footer-color:#fff;--box-shadow: $box-shadow}[_ngcontent-%COMP%]:dir(ltr){font-family:Ubuntu,sans-serif;--small-font-size: 11px;--normal-font-size: 14px;--medium-font-size: 18px;--big-font-size: 21px}[_ngcontent-%COMP%]:dir(rtl){font-family:Ubuntu,sans-serif;--small-font-size: 13px;--normal-font-size: 16px;--medium-font-size: 20px;--big-font-size: 23px}.excel-color[_ngcontent-%COMP%]{color:green!important}.pdf-color[_ngcontent-%COMP%]{color:#ff4500!important}.focus-color[_ngcontent-%COMP%]{border-color:var(--main-secoundary-color);outline:0;-webkit-box-shadow:0 0 0 .1rem rgba(199,37,62,.31);box-shadow:0 0 0 .1rem #c7253e4f}.user[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.user[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px;width:100px;border-radius:1em;box-shadow:#0000003d 0 3px 8px}.user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:var(--font-color)}.user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:14px;font-weight:400}.dental-anatomy[_ngcontent-%COMP%]{margin-top:10px}.dental-anatomy[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:230px;margin-bottom:10px}.history[_ngcontent-%COMP%]{margin:0 20px;height:180px;max-height:180px;overflow-y:scroll;padding:0 0 13px}.history-title[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--font-color);font-weight:600;font-size:17px;position:sticky;top:0;z-index:2;background-color:var(--bg-color);width:100%;text-align:center}.history-data[_ngcontent-%COMP%]{margin-bottom:10px;text-align:left}.history-data[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color);font-weight:600;font-size:10px}.utilities[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;align-items:center}.utilities[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--font-color);font-weight:700;margin:0;font-size:20px}.utilities[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .utilities[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color)}.data[_ngcontent-%COMP%]{display:flex;flex-direction:column}.data-header[_ngcontent-%COMP%]{box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin-bottom:20px;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:auto}.data-header[_ngcontent-%COMP%]   .filter-input[_ngcontent-%COMP%]{height:30px;margin-bottom:5px}.data-body[_ngcontent-%COMP%]{max-height:500px;height:auto;padding:9px 0}.data-body-card[_ngcontent-%COMP%]{box-shadow:#0000001a 0 0 5px,#0000001a 0 0 1px;border-radius:.5em;margin-bottom:20px;padding:.3em 1em;background-color:var(--bg-color);color:var(--font-color);height:70px;border-left:solid 10px var(--main-primary-color)}.data-body-card-infos[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.data-body-card-infos[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;border:solid 1px var(--font-color)}.data-body-card-infos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.data-body-card-infos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-weight:700;font-size:12px}']});let r=e;return r})();var y1=[{col:"flashSaleName",name:"Nom",sortable:!0,filterable:!0,type:"text"},{col:"flashSaleContent",name:"Contenu",sortable:!1,filterable:!1,type:"text"},{col:"mediaType",name:"Type de M\xE9dia",sortable:!1,filterable:!0,type:"text"},{col:"associatedProduct",name:"Produit Associ\xE9",sortable:!1,filterable:!1,type:"select",listSource:[],fieldSource:"id",labelSource:"productName"},{col:"flashSaleStatus",name:"Statut",sortable:!1,filterable:!1,type:"boolean"}],x1=[{formControlName:"flashSaleName",type:"text",placeholder:"Entrez le nom de la vente flash",styles:{},id:"flash-sale-name",label:"Nom de la Vente Flash",requiredMessage:"Le nom de la vente flash est requis",required:!0,inputMask:null,options:[],min:3,max:50,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"flashSaleContent",type:"textarea",placeholder:"Entrez le contenu de la vente flash",styles:{},id:"flash-sale-description",label:"Description",requiredMessage:"",required:!1,inputMask:null,options:[],min:3,max:500,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"mediaType",type:"select",placeholder:"S\xE9lectionnez le type de m\xE9dia",styles:{},id:"flash-sale-media-type",label:"Type de M\xE9dia",requiredMessage:"Le type de m\xE9dia est requis",required:!0,inputMask:null,options:[{label:"Photo",value:"photo"},{label:"Vid\xE9o",value:"video"}],bindLabel:"label",bindValue:"value",min:null,max:null,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!0},{formControlName:"associatedProduct",type:"select",placeholder:"Entrez le produit associ\xE9",styles:{},id:"associated-product",label:"Produit Associ\xE9",requiredMessage:"Le produit associ\xE9 est requis",required:!0,inputMask:null,options:[],bindLabel:"productName",bindValue:"id",min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!1},{formControlName:"flashSaleStatus",type:"checkbox",placeholder:"",styles:{},id:"flash-sale-status",label:"Statut",requiredMessage:"",required:!0,inputMask:"",options:[],min:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"S\xE9lectionnez la date de cr\xE9ation",styles:{},id:"flash-sale-created-at",label:"Cr\xE9\xE9 le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:6,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"flash-sale-created-by",label:"Cr\xE9\xE9 Par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:7,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"S\xE9lectionnez la date de mise \xE0 jour",styles:{},id:"flash-sale-updated-at",label:"Mis \xE0 Jour le",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:8,disabledOnEditMode:!0},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"flash-sale-updated-by",label:"Mis \xE0 Jour Par",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:9,disabledOnEditMode:!0}];var wI=()=>({height:"250px",width:"250px"}),CI=()=>({standalone:!0});function EI(r,e){if(r&1&&(I(0,"div",2),ge(1,"app-carousel",18),D()),r&2){let t=z();H(),Q("numberSlides",t.selectedFlashSale.mediaContent.length)("images",t.selectedFlashSale.mediaContent)("styles",Pe(3,wI))}}function SI(r,e){if(r&1&&ge(0,"iframe",3),r&2){let t=z();Q("src",t.sanitizer.bypassSecurityTrustResourceUrl(t.selectedFlashSale.mediaContent),Ts)}}function AI(r,e){r&1&&ge(0,"app-loading-spinner")}function MI(r,e){if(r&1){let t=Ae();I(0,"label",19),oe(1,"Video Path :"),D(),I(2,"input",20),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.selectedFlashSale.mediaContent,i)||(o.selectedFlashSale.mediaContent=i),pe(i)}),D()}if(r&2){let t=z();H(2),Q("placeholder","enter the video path")("ngModelOptions",Pe(3,CI)),Tt("ngModel",t.selectedFlashSale.mediaContent)}}function PI(r,e){r&1&&(I(0,"span",23),oe(1," this field is required "),D())}function OI(r,e){if(r&1){let t=Ae();I(0,"label",21),oe(1,"Media :"),D(),I(2,"app-custom-file-upload",22),ce("filesUpload",function(i){fe(t);let o=z();return pe(o.onInputFiles(i))}),D(),ye(3,PI,2,0,"span",23)}if(r&2){let t=z();H(3),Ee(t.submitted&&t.listFilesPaths.length==0?3:-1)}}var w1=(()=>{let e=class e{constructor(n,i,o,s,a){this.crudService=n,this.productsCrudService=i,this.fileService=o,this.applicationService=s,this.sanitizer=a,this.dbPath=Se.FLASH_SALES,this.flashSaleColumns=y1,this.flashSaleFormFields=x1,this.mediasList=[],this.listFilesPaths=[],this.selectedFlashSale={},this.showAddMediaDialog=!1,this.allProducts=[],this.loading=!1,this.submitted=!1,this.listButtonsData=[{index:1,label:"Flash Sale",active:!0},{index:2,label:"Medias",active:!1}],this.SITE_URL=li}ngOnInit(){return G(this,null,function*(){yield this.findFlashSales(),yield this.findProducts()})}findFlashSales(){return new Promise((n,i)=>{this.crudService.getItemsList(this.dbPath).subscribe({next:o=>{this.flashSales=o,n()},error:o=>{i(o)}})})}onSelectFlashSale(n){this.selectedFlashSale=n}createFlashSale(n){this.crudService.createItem(this.dbPath,n),this.applicationService.showSuccessfulSaveDialog("Creation Flash Sale","success","Flash sale created successfully")}updateFlashSale(n){let i=n.id,o=n.data;this.crudService.updateItem(this.dbPath,i,o).then(()=>this.applicationService.showSuccessfulSaveDialog("Update Flash Sale","success","Flash sale updated successfully")),this.genericCrudComponent.closeRight()}deleteFlashSale(n){this.crudService.deleteItem(this.dbPath,n).then(()=>"Flash sale deleted successfully")}onShowAddMediaDialog(n){this.selectedFlashSale.mediaType=="photo"&&this.selectedFlashSale.mediaContent.length>0&&(this.mediasList=this.selectedFlashSale.mediaContent,this.mediasList),this.showAddMediaDialog=!0}showElement(n){let i=document.getElementById(n);i&&(i.style.transition="max-height 0.2s ease-in-out ",i.style.maxHeight="200px",i.style.padding="1em")}hideElement(n){let i=document.getElementById(n);i&&(i.style.transition="max-height 0.2s ease-in-out ",i.style.maxHeight="0",i.style.padding="0")}findProducts(){return G(this,null,function*(){return new Promise((n,i)=>{this.productsCrudService.getItemsList(Se.PRODUCTS).subscribe({next:o=>{this.allProducts=o,this.bindProductList(this.flashSaleFormFields,this.flashSaleColumns,this.allProducts),n()},error:o=>{i(o)}})})})}onInputFiles(n){return G(this,null,function*(){yield this.saveFile(n),this.mediasList})}saveFile(n){return G(this,null,function*(){this.loading=!0;try{let i=n.map(o=>G(this,null,function*(){let s=yield this.fileService.uploadFile(o);return new Promise((a,l)=>{s.subscribe(c=>{this.listFilesPaths.push(c),a()},c=>{console.error("File upload failed:",c),l(c)})})}));yield Promise.all(i)}catch(i){console.error("One or more file uploads failed:",i)}finally{this.loading=!1,this.listFilesPaths.map(i=>this.mediasList.push(i)),this.selectedFlashSale.mediaContent=this.mediasList}})}onInputVideoPath(n){this.selectedFlashSale.mediaContent=n.target.value}setMedia(){if(this.submitted=!0,!(this.submitted&&this.selectedFlashSale.mediaType=="photo")||this.listFilesPaths.length>0)this.crudService.updateItem(this.dbPath,this.selectedFlashSale.id,this.selectedFlashSale).then(()=>this.applicationService.showSuccessfulSaveDialog("Update Flash Sale","success","Flash sale updated successfully")),this.submitted=!1,this.showAddMediaDialog=!1;else return}bindProductList(n,i,o){n.map(s=>{let a;s.formControlName=="associatedProduct"&&(a=s,a.options=o,n=[...n])}),i.map(s=>{let a;s.col=="associatedProduct"&&(a=s,a.listSource=o,i=[...i])})}patchForm(n,i,o){return G(this,null,function*(){Object.keys(i).forEach(s=>{this.applicationService.patchControlValue(s,n[s],o)})})}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(He),ve(pn),ve(tt),ve(Ns))},e.\u0275cmp=ke({type:e,selectors:[["app-flash-sale"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:22,vars:14,consts:[[3,"showDetails","save","edit","delete","data","fields","title","sortField","columns"],["details-data","",1,"w-100"],[1,"d-flex","flex-column","align-center","justify-content-center"],["width","100%","height","300",3,"src"],["more-actions","",1,"ml-5"],[3,"handleClick","label","size"],["height","60vh","width","50%",3,"closeModal","modalId","showModal","showFooter"],["modal-body",""],["ngForm",""],[1,"container"],[1,"row"],[1,"col-lg-6","col-sm-12","col-md-12"],[1,"form-group"],["for","media-type",1,"form-label","font-color-text"],["type","text","readonly","","id","media-type",3,"value"],[1,"col-lg-12","col-md-12","col-sm-12","form-group"],["modal-footer","",1,"d-flex","align-center","justify-end"],["label","save",3,"handleClick"],[3,"numberSlides","images","styles"],[1,"form-label","font-color-text"],["type","text",3,"ngModelChange","placeholder","ngModelOptions","ngModel"],["for","media-type",1,"form-label","font-color-text","mb-10"],[3,"filesUpload"],[1,"required-message"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectFlashSale(a)})("save",function(a){return o.createFlashSale(a)})("edit",function(a){return o.updateFlashSale(a)})("delete",function(a){return o.deleteFlashSale(a)}),I(1,"div",1),ye(2,EI,2,4,"div",2)(3,SI,1,1,"iframe",3),D(),I(4,"div",4)(5,"app-button",5),ce("handleClick",function(){return o.onShowAddMediaDialog(o.selectedFlashSale)}),D()()(),I(6,"app-modal",6),ce("closeModal",function(a){return o.showAddMediaDialog=a}),I(7,"div",7),ye(8,AI,1,0,"app-loading-spinner"),I(9,"form",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),oe(15,"Media Type :"),D(),ge(16,"input",14),D()(),I(17,"div",15),ye(18,MI,3,4)(19,OI,4,1),D()()()()(),I(20,"div",16)(21,"app-button",17),ce("handleClick",function(){return o.setMedia()}),D()()()),i&2&&(Q("data",o.flashSales)("fields",o.flashSaleFormFields)("title","Vente Flash")("sortField","flashSaleName")("columns",o.flashSaleColumns),H(2),Ee(o.selectedFlashSale.mediaType=="photo"?2:3),H(3),Q("label",o.selectedFlashSale.mediaContent?"Modifier M\xE9dia":"Ajouter M\xE9dia")("size","small"),H(),Q("modalId","add-media-dialog")("showModal",o.showAddMediaDialog)("showFooter",!0),H(2),Ee(o.loading?8:-1),H(8),pt("value",o.selectedFlashSale.mediaType),H(2),Ee(o.selectedFlashSale.mediaType=="video"?18:19))},dependencies:[nt,Ut,fi,bi,zt,kn,ci,di,In,hi,ui,Vs,cr]});let r=e;return r})();var C1=[{col:"invoiceNumber",name:"Num\xE9ro de Facture",sortable:!0,filterable:!0,type:"text"},{col:"purchaseDate",name:"Date d'Achat",sortable:!0,filterable:!0,type:"date"},{col:"productType",name:"Type de Produit",sortable:!0,filterable:!0,type:"text"},{col:"productName",name:"Nom du Produit",sortable:!0,filterable:!0,type:"text"},{col:"phoneNumber",name:"Num\xE9ro de T\xE9l\xE9phone",sortable:!0,filterable:!0,type:"text"}],E1=[{formControlName:"invoiceNumber",type:"text",placeholder:"Entrez le num\xE9ro de facture",styles:{},id:"invoice-number",label:"Num\xE9ro de Facture",requiredMessage:"Le num\xE9ro de facture est requis",required:!0,inputMask:null,options:[],min:3,max:50,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"purchaseDate",type:"date",placeholder:"S\xE9lectionnez la date d'achat",styles:{},id:"purchase-date",label:"Date d'Achat",requiredMessage:"La date d'achat est requise",required:!0,inputMask:null,options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"productType",type:"text",placeholder:"Entrez le type de produit",styles:{},id:"product-type",label:"Type de Produit",requiredMessage:"Le type de produit est requis",required:!0,inputMask:null,options:[],min:3,max:100,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"productName",type:"text",placeholder:"Entrez le nom du produit",styles:{},id:"product-name",label:"Nom du Produit",requiredMessage:"Le nom du produit est requis",required:!0,inputMask:null,options:[],min:3,max:100,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!1},{formControlName:"phoneNumber",type:"text",placeholder:"Entrez le num\xE9ro de t\xE9l\xE9phone",styles:{},id:"phone-number",label:"Num\xE9ro de T\xE9l\xE9phone",requiredMessage:"Le num\xE9ro de t\xE9l\xE9phone est requis",required:!0,inputMask:null,options:[],min:10,max:15,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"contactEmail",type:"email",placeholder:"Entrez l'email de contact",styles:{},id:"contact-email",label:"Email de Contact",requiredMessage:"L'email est requis",required:!0,inputMask:null,options:[],min:5,max:100,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:6,disabledOnEditMode:!1},{formControlName:"isUnderWarranty",type:"checkbox",placeholder:"Le produit est-il sous garantie ?",styles:{},id:"is-under-warranty",label:"Est-il sous Garantie ?",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:7,disabledOnEditMode:!1}];var S1=(()=>{let e=class e{constructor(n,i){this.crudService=n,this.applicationService=i,this.dbPath=Se.AFTER_SALES_SERVICE,this.afterSaleColumns=C1,this.afterSaleFormFields=E1,this.afterSales=[],this.selectedAfterSale={}}ngOnInit(){return G(this,null,function*(){yield this.findAfterSales()})}findAfterSales(){return new Promise((n,i)=>{this.crudService.getItemsList(this.dbPath).subscribe({next:o=>{this.afterSales=o,n()},error:o=>i(o)})})}onSelectAfterSale(n){this.selectedAfterSale=n}createAfterSale(n){this.crudService.createItem(this.dbPath,n),this.applicationService.showSuccessfulSaveDialog("Cr\xE9er un service apr\xE8s-vente","success","Service apr\xE8s-vente cr\xE9\xE9 avec succ\xE8s")}updateAfterSale(n){let i=n.id,o=n;this.crudService.updateItem(this.dbPath,i,o).then(()=>this.applicationService.showSuccessfulSaveDialog("Mettre \xE0 jour le service apr\xE8s-vente","success","Service apr\xE8s-vente mis \xE0 jour avec succ\xE8s")),this.genericCrudComponent.closeRight()}deleteAfterSale(n){this.crudService.deleteItem(this.dbPath,n).then(()=>this.applicationService.showSuccessfulSaveDialog("Supprimer le service apr\xE8s-vente","success","Service apr\xE8s-vente supprim\xE9 avec succ\xE8s"))}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-after-sales-services"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:1,vars:6,consts:[[3,"showDetails","save","edit","delete","showAdd","data","fields","title","sortField","columns"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectAfterSale(a)})("save",function(a){return o.createAfterSale(a)})("edit",function(a){return o.updateAfterSale(a)})("delete",function(a){return o.deleteAfterSale(a)}),D()),i&2&&Q("showAdd",!1)("data",o.afterSales)("fields",o.afterSaleFormFields)("title","Service apr\xE8s-vente")("sortField","name")("columns",o.afterSaleColumns)},dependencies:[nt]});let r=e;return r})();var A1=[{col:"mediaName",name:"Name",sortable:!0,filterable:!0,type:"text"},{col:"mediaType",name:"Media Type",sortable:!1,filterable:!0,type:"text"},{col:"mediaDescription",name:"description",sortable:!1,filterable:!1,type:"text"},{col:"mediaStatus",name:"Status",sortable:!1,filterable:!1,type:"boolean"}],M1=[{formControlName:"mediaName",type:"text",placeholder:"Enter media name",styles:{},id:"media-name",label:"media Name",requiredMessage:"media name is required",required:!0,inputMask:null,options:[],min:3,max:50,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"mediaType",type:"select",placeholder:"Select media type",styles:{},id:"media-media-type",label:"Media Type",requiredMessage:"Media type is required",required:!0,inputMask:null,options:[{label:"Photo",value:"photo"},{label:"Video",value:"video"}],bindLabel:"label",bindValue:"value",min:null,max:null,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!0},{formControlName:"mediaDescription",type:"textarea",placeholder:"Enter media Content",styles:{},id:"media-description",label:"Description ",requiredMessage:"",required:!1,inputMask:null,options:[],min:3,max:500,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"mediaStatus",type:"checkbox",placeholder:"",styles:{},id:"media-status",label:"Status",requiredMessage:"",required:!0,inputMask:"",options:[],min:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"createdAt",type:"date",placeholder:"Select creation date",styles:{},id:"media-created-at",label:"Created At",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:6,disabledOnEditMode:!0},{formControlName:"createdBy",type:"text",placeholder:"",styles:{},id:"media-created-by",label:"Created By",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!1,order:7,disabledOnEditMode:!0},{formControlName:"updatedAt",type:"date",placeholder:"Select last update date",styles:{},id:"media-updated-at",label:"Updated At",requiredMessage:"",required:!1,inputMask:dt(new Date().toISOString().split("T")[0],""),options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:8,disabledOnEditMode:!0},{formControlName:"updatedBy",type:"text",placeholder:"",styles:{},id:"media-updated-by",label:"Updated By",requiredMessage:"",required:!1,inputMask:"",options:[],min:void 0,max:"",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!1,renderedOnEditMode:!0,order:9,disabledOnEditMode:!0}];var TI=()=>({height:"250px",width:"250px"}),II=()=>({standalone:!0});function kI(r,e){if(r&1&&(I(0,"div",18),ge(1,"app-carousel",19),D()),r&2){let t=z(2);H(),Q("numberSlides",t.selectedMedia.mediaContent==null?null:t.selectedMedia.mediaContent.length)("images",t.selectedMedia.mediaContent)("styles",Pe(3,TI))}}function RI(r,e){r&1&&(I(0,"div",3)(1,"span",20),oe(2,"aucune media a \xE9t\xE9 ins\xE9r\xE9e"),D()())}function LI(r,e){if(r&1&&ye(0,kI,2,4,"div",18)(1,RI,3,0,"div",3),r&2){let t=z();Ee((t.selectedMedia.mediaContent==null?null:t.selectedMedia.mediaContent.length)>0?0:1)}}function DI(r,e){if(r&1&&(I(0,"video",2),ge(1,"source",21),oe(2," Your browser does not support the video tag. "),D()),r&2){let t=z();H(),pt("src",t.selectedMedia.mediaContent,Qt)}}function FI(r,e){r&1&&(I(0,"div",3)(1,"span",20),oe(2,"aucune media a \xE9t\xE9 ins\xE9r\xE9e"),D()())}function NI(r,e){r&1&&ge(0,"app-loading-spinner")}function BI(r,e){if(r&1){let t=Ae();I(0,"label",22),oe(1,"Video Path :"),D(),I(2,"input",23),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.selectedMedia.mediaContent,i)||(o.selectedMedia.mediaContent=i),pe(i)}),D()}if(r&2){let t=z();H(2),Q("placeholder","enter the video path")("ngModelOptions",Pe(3,II)),Tt("ngModel",t.selectedMedia.mediaContent)}}function jI(r,e){r&1&&(I(0,"span",26),oe(1," this field is required "),D())}function VI(r,e){if(r&1){let t=Ae();I(0,"label",24),oe(1,"Media :"),D(),I(2,"app-custom-file-upload",25),ce("filesUpload",function(i){fe(t);let o=z();return pe(o.onInputFiles(i))}),D(),ye(3,jI,2,0,"span",26)}if(r&2){let t=z();H(3),Ee(t.submitted&&t.listFilesPaths.length==0?3:-1)}}var P1=(()=>{let e=class e{constructor(n,i,o,s){this.crudService=n,this.productsCrudService=i,this.fileService=o,this.applicationService=s,this.dbPath=Se.MEDIAS,this.mediaColumns=A1,this.mediaFormFields=M1,this.mediasList=[],this.listFilesPaths=[],this.selectedMedia={},this.showAddMediaDialog=!1,this.allProducts=[],this.loading=!1,this.submitted=!1,this.listButtonsData=[{index:1,label:"Media",active:!0},{index:2,label:"Medias",active:!1}],this.SITE_URL=li}ngOnInit(){return G(this,null,function*(){yield this.findMedias(),yield this.findProducts()})}findMedias(){return new Promise((n,i)=>{this.crudService.getItemsList(this.dbPath).subscribe({next:o=>{this.medias=o,n()},error:o=>{i(o)}})})}onSelectMedia(n){this.selectedMedia=n}createMedia(n){this.crudService.createItem(this.dbPath,n),this.applicationService.showSuccessfulSaveDialog("Creation Media","success","Media created successfully")}updateMedia(n){let i=n.id,o=n.data;this.crudService.updateItem(this.dbPath,i,o).then(()=>this.applicationService.showSuccessfulSaveDialog("Update Media","success","Media updated successfully")),this.genericCrudComponent.closeRight()}deleteMedia(n){this.crudService.deleteItem(this.dbPath,n).then(()=>console.log("Media deleted successfully"))}onShowAddMediaDialog(n){this.selectedMedia.mediaType=="photo"&&this.selectedMedia.mediaContent?.length>0&&(this.mediasList=this.selectedMedia.mediaContent),this.showAddMediaDialog=!0}showElement(n){let i=document.getElementById(n);i&&(i.style.transition="max-height 0.2s ease-in-out ",i.style.maxHeight="200px",i.style.padding="1em")}hideElement(n){let i=document.getElementById(n);i&&(i.style.transition="max-height 0.2s ease-in-out ",i.style.maxHeight="0",i.style.padding="0")}findProducts(){return G(this,null,function*(){return new Promise((n,i)=>{this.productsCrudService.getItemsList(Se.PRODUCTS).subscribe({next:o=>{this.allProducts=o,this.bindProductList(this.mediaFormFields,this.mediaColumns,this.allProducts),n()},error:o=>{i(o)}})})})}onInputFiles(n){return G(this,null,function*(){yield this.saveFile(n)})}saveFile(n){return G(this,null,function*(){this.loading=!0;try{let i=n.map(o=>G(this,null,function*(){let s=yield this.fileService.uploadFile(o);return new Promise((a,l)=>{s.subscribe(c=>{this.listFilesPaths.push(c),console.log("File uploaded! Download URL:",c),a()},c=>{console.error("File upload failed:",c),l(c)})})}));yield Promise.all(i)}catch(i){console.error("One or more file uploads failed:",i)}finally{this.loading=!1,this.listFilesPaths.map(i=>this.mediasList.push(i)),this.selectedMedia.mediaContent=this.mediasList}})}onInputVideoPath(n){this.selectedMedia.mediaContent=n.target.value}setMedia(){if(this.submitted=!0,!(this.submitted&&this.selectedMedia.mediaType=="photo")||this.listFilesPaths.length>0)this.crudService.updateItem(this.dbPath,this.selectedMedia.id,this.selectedMedia).then(()=>this.applicationService.showSuccessfulSaveDialog("Update Media","success","Media updated successfully")),this.submitted=!1,this.showAddMediaDialog=!1;else return}bindProductList(n,i,o){n.map(s=>{let a;s.formControlName=="associatedProduct"&&(a=s,a.options=o,n=[...n])}),i.map(s=>{let a;s.col=="associatedProduct"&&(a=s,a.listSource=o,i=[...i])})}patchForm(n,i,o){return G(this,null,function*(){Object.keys(i).forEach(s=>{this.applicationService.patchControlValue(s,n[s],o)})})}};e.\u0275fac=function(i){return new(i||e)(ve(He),ve(He),ve(pn),ve(tt))},e.\u0275cmp=ke({type:e,selectors:[["app-flash-sale"]],viewQuery:function(i,o){if(i&1&&Ve(nt,5),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first)}},standalone:!0,features:[Be],decls:23,vars:13,consts:[[3,"showDetails","save","edit","delete","data","fields","title","sortField","columns"],["details-data","",1,"w-100"],["width","100%","height","240","controls",""],[1,"d-flex","align-center","justify-content-center"],["more-actions","",1,"ml-5"],["label","add media",3,"handleClick","size"],["height","60vh","width","50%",3,"closeModal","modalId","showModal","showFooter"],["modal-body",""],["ngForm",""],[1,"container"],[1,"row"],[1,"col-lg-6","col-sm-12","col-md-12"],[1,"form-group"],["for","media-type",1,"form-label","font-color-text"],["type","text","readonly","","id","media-type",3,"value"],[1,"col-lg-12","col-md-12","col-sm-12","form-group"],["modal-footer","",1,"d-flex","align-center","justify-end"],["label","save",3,"handleClick"],[1,"d-flex","flex-column","align-center","justify-content-center"],[3,"numberSlides","images","styles"],[1,"bold"],["type","video/mp4",3,"src"],[1,"form-label","font-color-text"],["type","text",3,"ngModelChange","placeholder","ngModelOptions","ngModel"],["for","media-type",1,"form-label","font-color-text","mb-10"],[3,"filesUpload"],[1,"required-message"]],template:function(i,o){i&1&&(I(0,"app-generic-crud",0),ce("showDetails",function(a){return o.onSelectMedia(a)})("save",function(a){return o.createMedia(a)})("edit",function(a){return o.updateMedia(a)})("delete",function(a){return o.deleteMedia(a)}),I(1,"div",1),ye(2,LI,2,1)(3,DI,3,1,"video",2)(4,FI,3,0,"div",3),D(),I(5,"div",4)(6,"app-button",5),ce("handleClick",function(){return o.onShowAddMediaDialog(o.selectedMedia)}),D()()(),I(7,"app-modal",6),ce("closeModal",function(a){return o.showAddMediaDialog=a}),I(8,"div",7),ye(9,NI,1,0,"app-loading-spinner"),I(10,"form",8)(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"label",13),oe(16,"Media Type :"),D(),ge(17,"input",14),D()(),I(18,"div",15),ye(19,BI,3,4)(20,VI,4,1),D()()()()(),I(21,"div",16)(22,"app-button",17),ce("handleClick",function(){return o.setMedia()}),D()()()),i&2&&(Q("data",o.medias)("fields",o.mediaFormFields)("title","Media")("sortField","mediaName")("columns",o.mediaColumns),H(2),Ee(o.selectedMedia.mediaType=="photo"?2:o.selectedMedia.mediaContent?3:4),H(4),Q("size","small"),H(),Q("modalId","add-media-dialog")("showModal",o.showAddMediaDialog)("showFooter",!0),H(2),Ee(o.loading?9:-1),H(8),pt("value",o.selectedMedia.mediaType),H(2),Ee(o.selectedMedia.mediaType=="video"?19:20))},dependencies:[nt,Ut,fi,bi,zt,kn,ci,di,In,hi,ui,Vs,cr]});let r=e;return r})();var O1=[{formControlName:"homeHeading",type:"text",placeholder:"Entrez le titre principal",styles:{},id:"home-heading",label:"Titre Principal",requiredMessage:"Le titre principal est requis",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:1,disabledOnEditMode:!1},{formControlName:"homeDescription",type:"textarea",placeholder:"Entrez la description principale",styles:{},id:"home-description",label:"Description Principale",requiredMessage:"La description est requise",required:!0,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:2,disabledOnEditMode:!1},{formControlName:"relevantProducts",type:"multi-select",placeholder:"S\xE9lectionnez les produits pertinents",styles:{},id:"relevant-products",label:"Produits Pertinents",requiredMessage:"",required:!1,inputMask:null,options:[],bindLabel:"productName",bindValue:"id",firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:3,disabledOnEditMode:!1},{formControlName:"homeBackground",type:"file",fileType:"image",multiple:!0,placeholder:"T\xE9l\xE9chargez l'image d'arri\xE8re-plan",styles:{},id:"home-background",label:"Image d'Arri\xE8re-plan",requiredMessage:"L'image d'arri\xE8re-plan est requise",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:4,disabledOnEditMode:!1},{formControlName:"contactInfoEmail",type:"email",placeholder:"Entrez l'email de contact",styles:{},id:"contact-email",label:"Email de Contact",requiredMessage:"L'email de contact est requis",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:5,disabledOnEditMode:!1},{formControlName:"contactInfoPhone",type:"text",placeholder:"Entrez le num\xE9ro de t\xE9l\xE9phone",styles:{},id:"contact-phone",label:"Num\xE9ro de t\xE9l\xE9phone",requiredMessage:"Le num\xE9ro de t\xE9l\xE9phone est requis",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:6,disabledOnEditMode:!1},{formControlName:"contactInfoFacebook",type:"text",placeholder:"Entrez le lien Facebook",styles:{},id:"contact-facebook",label:"Facebook",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:7,disabledOnEditMode:!1},{formControlName:"contactInfoInstagram",type:"text",placeholder:"Entrez le lien Instagram",styles:{},id:"contact-instagram",label:"Instagram",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:8,disabledOnEditMode:!1},{formControlName:"contactInfoTikTok",type:"text",placeholder:"Entrez le lien TikTok",styles:{},id:"contact-tiktok",label:"TikTok",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:9,disabledOnEditMode:!1},{formControlName:"contactInfoYoutube",type:"text",placeholder:"Entrez le lien YouTube",styles:{},id:"contact-youtube",label:"YouTube",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:10,disabledOnEditMode:!1},{formControlName:"contactInfoMap",type:"text",placeholder:"Entrez le lien de la carte",styles:{},id:"contact-map",label:"Carte",requiredMessage:"",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:11,disabledOnEditMode:!1},{formControlName:"second-slider-images",type:"file",fileType:"image",multiple:!0,placeholder:"T\xE9l\xE9chargez Image de 2\xE8me diaporama",styles:{},id:"second-slider-images",label:"Image de 2\xE8me diaporama",requiredMessage:"Image de 2\xE8me diaporama est requise",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:12,disabledOnEditMode:!1},{formControlName:"third-slider-images",type:"file",fileType:"image",multiple:!0,placeholder:"T\xE9l\xE9chargez Image de 3\xE8me diaporama",styles:{},id:"third-slider-images",label:"Image de 3\xE8me diaporama",requiredMessage:"Image de 3\xE8me diaporama est requise",required:!1,inputMask:null,options:[],min:void 0,max:void 0,firstInput:null,secondInput:null,mode:null,depend:null,unite:"",rendered:!0,renderedOnEditMode:!0,order:13,disabledOnEditMode:!1}];var UI=["firstInput"],zI=()=>[],Un=()=>({standalone:!0}),zf=()=>({height:"250px",width:"100%"}),T1=()=>({label:"image",value:"image"}),qI=()=>({label:"video",value:"video"}),HI=(r,e)=>[r,e];function WI(r,e){if(r&1){let t=Ae();I(0,"app-button",8),ce("handleClick",function(){fe(t);let i=z();return pe(i.startEdit())}),D()}if(r&2){let t=z();Hn("mt-10",t.applicationService.isMobile())}}function GI(r,e){r&1&&ge(0,"app-skelton",10),r&2&&Q("shape","inputs-shape")}function $I(r,e){r&1&&(I(0,"div",2)(1,"div",9),Je(2,GI,1,1,"app-skelton",10,ip),D()()),r&2&&(H(2),Ze(Pe(0,zI).constructor(8)))}function XI(r,e){if(r&1&&ge(0,"iframe",22),r&2){let t=z(3);Q("src",t.sanitizer.bypassSecurityTrustResourceUrl(t.contentManagementObject["home-background"]),Ts)}}function KI(r,e){if(r&1&&(I(0,"div",23),ge(1,"app-carousel",19),D()),r&2){let t=z(3);H(),Q("navigations",t.contentManagementObject["second-slider-images"].length>1)("numberSlides",t.contentManagementObject["home-background"].length)("images",t.contentManagementObject["home-background"])("styles",Pe(4,zf))}}function YI(r,e){if(r&1&&ye(0,XI,1,1,"iframe",22)(1,KI,2,5,"div",23),r&2){let t=z(2);Ee(t.isArray(t.contentManagementObject["home-background"])?1:0)}}function QI(r,e){if(r&1){let t=Ae();I(0,"input",28),kt("ngModelChange",function(i){fe(t);let o=z(4);return It(o.contentManagementObject["home-background"],i)||(o.contentManagementObject["home-background"]=i),pe(i)}),D()}if(r&2){let t=z(4);Tt("ngModel",t.contentManagementObject["home-background"]),Q("ngModelOptions",Pe(2,Un))}}function JI(r,e){if(r&1){let t=Ae();I(0,"app-custom-file-upload",29),ce("filesUpload",function(i){fe(t);let o=z(4);return pe(o.onInputFiles(i,"home-background"))}),D()}if(r&2){let t=z(4);Q("multiple",!1)("uploadedFiles",t.contentManagementObject["home-background"])}}function ZI(r,e){if(r&1&&ye(0,QI,1,3,"input",26)(1,JI,1,2,"app-custom-file-upload",27),r&2){let t=z(3);Ee(t.mediaType==="video"?0:1)}}function ek(r,e){if(r&1){let t=Ae();I(0,"div",24)(1,"app-generic-drop-down",25),ce("selectOption",function(i){fe(t);let o=z(2);return pe(o.mediaType=i.value)}),D()(),ye(2,ZI,2,1)}if(r&2){let t=z(2);H(),Q("options",Rs(6,HI,Pe(4,T1),Pe(5,qI)))("showDeleteSelected",!1)("selectedOption",Pe(9,T1)),H(),Ee(t.mediaType?2:-1)}}function tk(r,e){if(r&1&&(I(0,"span",30),oe(1),D()),r&2){let t=e.$implicit;H(),Xe(" ",t.productName," ")}}function nk(r,e){if(r&1&&Je(0,tk,2,1,"span",30,et),r&2){let t=z(2);Ze(t.selectedProducts)}}function ik(r,e){if(r&1){let t=Ae();I(0,"app-generic-drop-down",31),ce("selectOption",function(i){fe(t);let o=z(2);return pe(o.onSelectOption(i))}),D()}if(r&2){let t=z(2);Q("options",t.products)("multiple",!0)("selectedOption",t.selectedProducts)}}function rk(r,e){if(r&1&&ge(0,"app-carousel",19),r&2){let t=z(2);Q("navigations",t.contentManagementObject["second-slider-images"].length>1)("numberSlides",t.contentManagementObject["second-slider-images"].length)("images",t.contentManagementObject["second-slider-images"])("styles",Pe(4,zf))}}function ok(r,e){if(r&1){let t=Ae();I(0,"app-custom-file-upload",32),ce("filesUpload",function(i){fe(t);let o=z(2);return pe(o.onInputFiles(i,"second-slider-images"))}),D()}if(r&2){let t=z(2);Q("uploadedFiles",t.contentManagementObject["second-slider-images"])("multiple",!1)}}function sk(r,e){if(r&1&&ge(0,"app-carousel",19),r&2){let t=z(2);Q("navigations",t.contentManagementObject["third-slider-images"].length>1)("numberSlides",t.contentManagementObject["third-slider-images"].length)("images",t.contentManagementObject["third-slider-images"])("styles",Pe(4,zf))}}function ak(r,e){if(r&1){let t=Ae();I(0,"app-custom-file-upload",32),ce("filesUpload",function(i){fe(t);let o=z(2);return pe(o.onInputFiles(i,"third-slider-images"))}),D()}if(r&2){let t=z(2);Q("uploadedFiles",t.contentManagementObject["third-slider-images"])("multiple",!1)}}function lk(r,e){if(r&1){let t=Ae();I(0,"div",21)(1,"app-button",33),ce("handleClick",function(){fe(t);let i=z(2);return pe(i.detailsFlag=!i.detailsFlag)}),D(),I(2,"app-button",34),ce("handleClick",function(){fe(t);let i=z(2);return pe(i.editData())}),D()()}if(r&2){let t=z(2);H(),Hn("mt-10",t.applicationService.isMobile()),Q("outlined",!0),H(),Hn("mt-10",t.applicationService.isMobile())}}function ck(r,e){if(r&1){let t=Ae();I(0,"div",7)(1,"form")(2,"fieldset")(3,"legend"),oe(4,"Home informations :"),D(),I(5,"div",11)(6,"label",12),oe(7," home heading"),D(),I(8,"input",13,0),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["home-heading"],i)||(o.contentManagementObject["home-heading"]=i),pe(i)}),D()(),I(10,"div",11)(11,"label",12),oe(12," Home description"),D(),I(13,"textarea",14),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["home-description"],i)||(o.contentManagementObject["home-description"]=i),pe(i)}),oe(14,"          "),D()(),I(15,"div",11)(16,"label",12),oe(17," home background "),D(),ye(18,YI,2,1)(19,ek,3,10),D()(),I(20,"fieldset")(21,"legend"),oe(22,"Infromations du contact :"),D(),I(23,"div",15)(24,"div",16)(25,"div",11)(26,"label",12),oe(27,"Email"),D(),I(28,"input",13),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["contact-info"].email,i)||(o.contentManagementObject["contact-info"].email=i),pe(i)}),D()()(),I(29,"div",16)(30,"div",11)(31,"label",12),oe(32,"Facebook"),D(),I(33,"input",13),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["contact-info"].facebook,i)||(o.contentManagementObject["contact-info"].facebook=i),pe(i)}),D()()(),I(34,"div",16)(35,"div",11)(36,"label",12),oe(37,"Instagram"),D(),I(38,"input",13),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["contact-info"].instagram,i)||(o.contentManagementObject["contact-info"].instagram=i),pe(i)}),D()()(),I(39,"div",16)(40,"div",11)(41,"label",12),oe(42,"Map"),D(),I(43,"input",13),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["contact-info"].map,i)||(o.contentManagementObject["contact-info"].map=i),pe(i)}),D()()(),I(44,"div",16)(45,"div",11)(46,"label",12),oe(47,"Phone"),D(),I(48,"input",13),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["contact-info"].phone,i)||(o.contentManagementObject["contact-info"].phone=i),pe(i)}),D()()(),I(49,"div",16)(50,"div",11)(51,"label",12),oe(52,"TikTok"),D(),I(53,"input",13),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["contact-info"].tiktok,i)||(o.contentManagementObject["contact-info"].tiktok=i),pe(i)}),D()()(),I(54,"div",16)(55,"div",11)(56,"label",12),oe(57,"YouTube"),D(),I(58,"input",13),kt("ngModelChange",function(i){fe(t);let o=z();return It(o.contentManagementObject["contact-info"].youtube,i)||(o.contentManagementObject["contact-info"].youtube=i),pe(i)}),D()()()()(),I(59,"fieldset")(60,"legend"),oe(61,"Relevent products :"),D(),I(62,"div",17),ye(63,nk,2,0)(64,ik,1,3,"app-generic-drop-down",18),D()(),I(65,"fieldset")(66,"legend"),oe(67,"Images des diaporamas"),D(),I(68,"div",11)(69,"label",12),oe(70," Images de 2\xE8me diaporama : "),D(),ye(71,rk,1,5,"app-carousel",19)(72,ok,1,2,"app-custom-file-upload",20),D(),I(73,"div")(74,"label",12),oe(75," Images de 3\xE8me diaporama : "),D(),ye(76,sk,1,5,"app-carousel",19)(77,ak,1,2,"app-custom-file-upload",20),D()()(),ye(78,lk,3,5,"div",21),D()}if(r&2){let t=z();H(8),Tt("ngModel",t.contentManagementObject["home-heading"]),Q("ngModelOptions",Pe(41,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Tt("ngModel",t.contentManagementObject["home-description"]),Q("ngModelOptions",Pe(42,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Ee(t.detailsFlag?18:19),H(10),Tt("ngModel",t.contentManagementObject["contact-info"].email),Q("ngModelOptions",Pe(43,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Tt("ngModel",t.contentManagementObject["contact-info"].facebook),Q("ngModelOptions",Pe(44,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Tt("ngModel",t.contentManagementObject["contact-info"].instagram),Q("ngModelOptions",Pe(45,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Tt("ngModel",t.contentManagementObject["contact-info"].map),Q("ngModelOptions",Pe(46,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Tt("ngModel",t.contentManagementObject["contact-info"].phone),Q("ngModelOptions",Pe(47,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Tt("ngModel",t.contentManagementObject["contact-info"].tiktok),Q("ngModelOptions",Pe(48,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Tt("ngModel",t.contentManagementObject["contact-info"].youtube),Q("ngModelOptions",Pe(49,Un))("disabled",t.detailsFlag)("readonly",t.detailsFlag),H(5),Ee(t.detailsFlag?63:64),H(8),Ee(t.detailsFlag?71:72),H(5),Ee(t.detailsFlag?76:77),H(2),Ee(t.detailsFlag?-1:78)}}var I1=(()=>{let e=class e{constructor(n,i,o,s,a,l,c){this.db=n,this.crudService=i,this.fileService=o,this.formBuilder=s,this.applicationService=a,this.sanitizer=l,this.authFirebaseService=c,this.firstInput={},this.dbPath=Se.CONTENT_MANAGEMENT,this.contentManagementFields=O1,this.formControl={},this.mediasList=[],this.listFilesPaths=[],this.contentManagementObject={},this.showAddMediaDialog=!1,this.loading=!1,this.submitted=!1,this.detailsFlag=!0,this.mediaType="photo",this.products=[],this.selectedProducts=[],this.SITE_URL=li}ngOnInit(){return G(this,null,function*(){this.loading=!0,yield this.findContentManegementObject(),yield this.findProducts(),this.loading=!1})}findProducts(){return new Promise((n,i)=>{this.crudService.getItemsList(Se.PRODUCTS).subscribe({next:o=>{this.products=o,this.products.map(s=>{this.contentManagementObject["relevent-products"].includes(s.id)&&this.selectedProducts.push(s)}),n()},error:o=>{i(o)}})})}findContentManegementObject(){return new Promise((n,i)=>{this.crudService.getItem(Se.CONTENT_MANAGEMENT,"").subscribe({next:o=>{this.contentManagementObject=o,n()},error:o=>{i(o)}})})}onSelectObjet(n){}updateContentMangement(n){let i=n.id,o=n.data;this.crudService.updateItem(this.dbPath,i,o).then(()=>this.applicationService.showSuccessfulSaveDialog("Update Content Management","success","Content Management updated successfully")),this.genericCrudComponent.closeRight()}showElement(n){let i=document.getElementById(n);i&&(i.style.transition="max-height 0.2s ease-in-out ",i.style.maxHeight="200px",i.style.padding="1em")}hideElement(n){let i=document.getElementById(n);i&&(i.style.transition="max-height 0.2s ease-in-out ",i.style.maxHeight="0",i.style.padding="0")}onInputFiles(n,i){return G(this,null,function*(){yield this.saveFile(n,i)})}onSelectOption(n){this.contentManagementObject["relevent-products"]=n.map(i=>i.id),this.contentManagementObject["relevent-products"]}saveFile(n,i){return G(this,null,function*(){try{let o=n.map(s=>G(this,null,function*(){let a=yield this.fileService.uploadFile(s);return new Promise((l,c)=>{a.subscribe(d=>{this.listFilesPaths.push(d),l()},d=>{console.error("File upload failed:",d),c(d)})})}));yield Promise.all(o)}catch(o){console.error("One or more file uploads failed:",o)}finally{switch(i){case"home-background":{this.contentManagementObject["home-background"]=this.listFilesPaths;break}case"second-slider-images":{this.contentManagementObject["second-slider-images"]=this.listFilesPaths;break}case"third-slider-images":{this.contentManagementObject["third-slider-images"]=this.listFilesPaths;break}}}})}editData(){return this.submitted=!0,this.detailsFlag=!1,this.contentManagementObject,this.db.object(this.dbPath).update(this.contentManagementObject).then(i=>{this.detailsFlag=!0,this.applicationService.showSuccessfulSaveDialog("Modification du contenue","success","Contenue mis \xE0 jour avec succ\xE8s")})}startEdit(){this.detailsFlag=!1,this.firstInput&&setTimeout(()=>{this.firstInput.nativeElement.focus()},0)}isArray(n){return Array.isArray(n)}};e.\u0275fac=function(i){return new(i||e)(ve(_p),ve(He),ve(pn),ve(lr),ve(tt),ve(Ns),ve(Ln))},e.\u0275cmp=ke({type:e,selectors:[["app-content-management"]],viewQuery:function(i,o){if(i&1&&(Ve(nt,5),Ve(UI,5)),i&2){let s;Ue(s=ze())&&(o.genericCrudComponent=s.first),Ue(s=ze())&&(o.firstInput=s.first)}},standalone:!0,features:[Be],decls:11,vars:6,consts:[["firstInput",""],["rootName","gestion de contenue"],[1,"container"],[1,"utilities","card","col-12","d-flex","align-center","justify-between"],[1,"col-lg-6","h-100","align-center"],[1,"col-lg-6","col-sm-12","col-md-12","row","h-100","align-center"],["size","small","label","Modifier le Contenue","icon","ri-pencil-fill",1,"mr-5",3,"mt-10"],[1,"card","relative"],["size","small","label","Modifier le Contenue","icon","ri-pencil-fill",1,"mr-5",3,"handleClick"],[1,"w-100"],[3,"shape"],[1,"form-group"],[1,"form-label","font-color-text"],["type","text",3,"ngModelChange","ngModel","ngModelOptions","disabled","readonly"],["rows","5",3,"ngModelChange","ngModel","ngModelOptions","disabled","readonly"],[1,"row"],[1,"col-lg-6","col-md-12","col-sm-12"],[1,"col-12"],["dropDownId","Relevent-products","bindLabel","productName","bindValue","id",3,"options","multiple","selectedOption"],[3,"navigations","numberSlides","images","styles"],["fileType","image",3,"uploadedFiles","multiple"],[1,"d-flex","align-center","justify-end","mt-10"],["width","100%","height","300",3,"src"],[1,"w-100","d-flex","align-center","justify-content-center"],[1,"col-3","mb-10"],["bindLabel","label","bindValue","value","dropDownId","media-type",3,"selectOption","options","showDeleteSelected","selectedOption"],["type","text",3,"ngModel","ngModelOptions"],["fileType","image",3,"multiple","uploadedFiles"],["type","text",3,"ngModelChange","ngModel","ngModelOptions"],["fileType","image",3,"filesUpload","multiple","uploadedFiles"],[1,"tag","infos-bg-text","mr-2","mb-2"],["dropDownId","Relevent-products","bindLabel","productName","bindValue","id",3,"selectOption","options","multiple","selectedOption"],["fileType","image",3,"filesUpload","uploadedFiles","multiple"],["size","small","label","Annuler","icon","ri-close-line",1,"mr-5",3,"handleClick","outlined"],["size","small","label","Valider","icon","ri-check-line",1,"mr-5",3,"handleClick"]],template:function(i,o){if(i&1&&(ge(0,"app-breadcrumbs",1),I(1,"div",2)(2,"div",3)(3,"div",4)(4,"h2"),oe(5,"Gestion de contenue"),D()(),I(6,"div",5),ye(7,WI,1,2,"app-button",6),ot(8,"async"),D()(),ye(9,$I,4,1,"div",2)(10,ck,79,50,"div",7),D()),i&2){let s;H(6),Hn("justify-end",!o.applicationService.isMobile()),H(),Ee(!((s=gt(8,4,o.authFirebaseService.$userRole))==null||s.permissions==null)&&s.permissions.includes("write")?7:-1),H(2),Ee(o.loading?9:o.contentManagementObject?10:-1)}},dependencies:[mr,Ut,Jt,kn,ci,di,In,zt,hi,ui,bi,hn,cr,pi,Cn]});let r=e;return r})();var dn="Sports gate",VB=Zf(He),dk=[{path:"",component:Mp,title:`${dn} | Accueil`},{path:"users",component:r1,title:`${dn} | Utilisateurs`,data:{roles:["Admin"]}},{path:"roles",component:s1,title:`${dn} | R\xF4les`,data:{roles:["Admin"]}},{path:"profile",component:Q_,title:`${dn} | Profil`},{path:"tags",component:c1,title:`${dn} | Tags`},{path:"reviews",component:h1,title:`${dn} | Avis`},{path:"products",component:K_,title:`${dn} | Produits`},{path:"orders",component:t1,title:`${dn} | Commandes`},{path:"product-categories",component:b1,title:`${dn} | Cat\xE9gories de produits`},{path:"flash-sales",component:w1,title:`${dn} | Ventes flash`},{path:"after-sales-service",component:S1,title:`${dn} | Service apr\xE8s-vente`},{path:"medias",component:P1,title:`${dn} | M\xE9dias`},{path:"content-management",component:I1,title:`${dn} | Gestion de contenu`}],UB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=wn({type:e}),e.\u0275inj=xn({imports:[Rc.forChild(dk),Rc]});let r=e;return r})();export{UB as PagesRoutes,dk as routes};
